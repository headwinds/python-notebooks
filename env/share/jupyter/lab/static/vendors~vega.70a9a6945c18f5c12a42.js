(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[1],{HIPa:function(e){e.exports={a:"4.4.0"}},J29t:function(e,t,n){"use strict";var r=function(e,t,n){e.fields=t||[];e.fname=n;return e};function i(e){return e==null?null:e.fname}function a(e){return e==null?null:e.fields}var u=function(e){throw Error(e)};var o=function(e){var t=[],n=null,r=0,i=e.length,a="",o,f,c;e=e+"";function l(){t.push(a+e.substring(o,f));a="";o=f+1}for(o=f=0;f<i;++f){c=e[f];if(c==="\\"){a+=e.substring(o,f);o=++f}else if(c===n){l();n=null;r=-1}else if(n){continue}else if(o===r&&c==='"'){o=f+1;n=c}else if(o===r&&c==="'"){o=f+1;n=c}else if(c==="."&&!r){if(f>o){l()}else{o=f+1}}else if(c==="["){if(f>o)l();r=o=f+1}else if(c==="]"){if(!r)u("Access path missing open bracket: "+e);if(r>0)l();r=0;o=f+1}}if(r)u("Access path missing closing bracket: "+e);if(n)u("Access path missing closing quote: "+e);if(f>o){f++;l()}return t};var f=Array.isArray;var c=function(e){return e===Object(e)};var l=function(e){return typeof e==="string"};function s(e){return f(e)?"["+e.map(s)+"]":c(e)||l(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}var d=function(e,t){var n=o(e),i="return _["+n.map(s).join("][")+"];";return r(Function("_",i),[e=n.length===1?n[0]:e],t||e)};var h=[];var p=d("id");var v=r(function(e){return e},h,"identity");var g=r(function(){return 0},h,"zero");var m=r(function(){return 1},h,"one");var y=r(function(){return true},h,"true");var b=r(function(){return false},h,"false");function x(e,t,n){var r=[t].concat([].slice.call(n));console[e](...r)}var _=0;var w=1;var k=2;var O=3;var A=4;var E=function(e,t){var n=e||_;return{level:function(e){if(arguments.length){n=+e;return this}else{return n}},error:function(){if(n>=w)x(t||"error","ERROR",arguments);return this},warn:function(){if(n>=k)x(t||"warn","WARN",arguments);return this},info:function(){if(n>=O)x(t||"log","INFO",arguments);return this},debug:function(){if(n>=A)x(t||"log","DEBUG",arguments);return this}}};var M=function(e){return e[e.length-1]};var S=function(e){return e==null||e===""?null:+e};function C(e){return function(t){return e*Math.exp(t)}}function D(e){return function(t){return Math.log(e*t)}}function j(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function N(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function F(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function T(e,t,n,r){var i=n(e[0]),a=n(M(e)),u=(a-i)*t;return[r(i-u),r(a-u)]}function z(e,t){return T(e,t,S,v)}function R(e,t){var n=Math.sign(e[0]);return T(e,t,D(n),C(n))}function P(e,t,n){return T(e,t,F(n),F(1/n))}function L(e,t,n){return T(e,t,j(n),N(n))}function B(e,t,n,r,i){var a=r(e[0]),u=r(M(e)),o=t!=null?r(t):(a+u)/2;return[i(o+(a-o)*n),i(o+(u-o)*n)]}function I(e,t,n){return B(e,t,n,S,v)}function U(e,t,n){var r=Math.sign(e[0]);return B(e,t,n,D(r),C(r))}function q(e,t,n,r){return B(e,t,n,F(r),F(1/r))}function W(e,t,n,r){return B(e,t,n,j(r),N(r))}function H(e){return 1+~~(new Date(e).getMonth()/3)}function G(e){return 1+~~(new Date(e).getUTCMonth()/3)}var Y=function(e){return e!=null?f(e)?e:[e]:[]};var $=function(e,t,n){var r=e[0],i=e[1],a;if(i<r){a=i;i=r;r=a}a=i-r;return a>=n-t?[t,n]:[r=Math.min(Math.max(r,t),n-a),r+a]};var V=function(e){return typeof e==="function"};var X=function(e,t){var n=[],i=(e=Y(e)).map(function(e,t){if(e==null){return null}else{n.push(t);return V(e)?e:o(e).map(s).join("][")}}),u=n.length-1,f=Y(t),c="var u,v;return ",l,d,h,p,v,g,m,y,b;if(u<0)return null;for(d=0;d<=u;++d){l=n[d];h=i[l];if(V(h)){g="f"+l;p="(u=this."+g+"(a))";v="(v=this."+g+"(b))";(m=m||{})[g]=h}else{p="(u=a["+h+"])";v="(v=b["+h+"])"}g="((v=v instanceof Date?+v:v),(u=u instanceof Date?+u:u))";if(f[l]!=="descending"){b=1;y=-1}else{b=-1;y=1}c+="("+p+"<"+v+"||u==null)&&v!=null?"+y+":(u>v||v==null)&&u!=null?"+b+":"+g+"!==u&&v===v?"+y+":v!==v&&u===u?"+b+(l<u?":":":0")}h=Function("a","b",c+";");if(m)h=h.bind(m);e=e.reduce(function(e,t){if(V(t)){(a(t)||[]).forEach(function(t){e[t]=1})}else if(t!=null){e[t+""]=1}return e},{});return r(h,Object.keys(e))};var Z=function(e){return V(e)?e:function(){return e}};var J=function(e,t){var n,r;function i(){t(r);n=r=null}return function(t){r=t;if(n)clearTimeout(n);n=setTimeout(i,e)}};var Q=function(e){for(var t,n,r=1,i=arguments.length;r<i;++r){t=arguments[r];for(n in t){e[n]=t[n]}}return e};var K=function(e,t){var n=0,r,i,a,u;if(e&&(r=e.length)){if(t==null){for(i=e[n];i==null||i!==i;i=e[++n]);a=u=i;for(;n<r;++n){i=e[n];if(i!=null){if(i<a)a=i;if(i>u)u=i}}}else{for(i=t(e[n]);i==null||i!==i;i=t(e[++n]));a=u=i;for(;n<r;++n){i=t(e[n]);if(i!=null){if(i<a)a=i;if(i>u)u=i}}}}return[a,u]};var ee=function(e,t){var n=-1,r=e.length,i,a,u,o,f;if(t==null){while(++n<r){a=e[n];if(a!=null&&a>=a){i=u=a;break}}o=f=n;while(++n<r){a=e[n];if(a!=null){if(i>a){i=a;o=n}if(u<a){u=a;f=n}}}}else{while(++n<r){a=t(e[n],n,e);if(a!=null&&a>=a){i=u=a;break}}o=f=n;while(++n<r){a=t(e[n],n,e);if(a!=null){if(i>a){i=a;o=n}if(u<a){u=a;f=n}}}}return[o,f]};var te={};var ne=function(e){var t={},n,r;function i(e){return t.hasOwnProperty(e)&&t[e]!==te}n={size:0,empty:0,object:t,has:i,get:function(e){return i(e)?t[e]:undefined},set:function(e,r){if(!i(e)){++n.size;if(t[e]===te)--n.empty}t[e]=r;return this},delete:function(e){if(i(e)){--n.size;++n.empty;t[e]=te}return this},clear:function(){n.size=n.empty=0;n.object=t={}},test:function(e){if(arguments.length){r=e;return n}else{return r}},clean:function(){var e={},i=0,a,u;for(a in t){u=t[a];if(u!==te&&(!r||!r(u))){e[a]=u;++i}}n.size=i;n.empty=0;n.object=t=e}};if(e)Object.keys(e).forEach(function(t){n.set(t,e[t])});return n};var re=function(e,t,n,r,i,a){if(!n&&n!==0)return a;var u=e[0],o=M(e),f=+n,c,l;if(o<u){c=u;u=o;o=c}c=Math.abs(t-u);l=Math.abs(o-t);return c<l&&c<=f?r:l<=f?i:a};var ie=function(e,t){var n=e.prototype=Object.create(t.prototype);n.constructor=e;return n};var ae=function(e,t,n,r){var i=t[0],a=t[t.length-1],u;if(i>a){u=i;i=a;a=u}n=n===undefined||n;r=r===undefined||r;return(n?i<=e:i<e)&&(r?e<=a:e<a)};var ue=function(e){return typeof e==="boolean"};var oe=function(e){return Object.prototype.toString.call(e)==="[object Date]"};var fe=function(e){return typeof e==="number"};var ce=function(e){return Object.prototype.toString.call(e)==="[object RegExp]"};var le=function(e,t){if(e){e=t?Y(e).map(function(e){return e.replace(/\\(.)/g,"$1")}):Y(e)}var n=!(e&&e.length)?function(){return""}:Function("_","return ''+"+e.map(function(e){return"_["+(t?s(e):o(e).map(s).join("]["))+"]"}).join("+'|'+")+";");return r(n,e,"key")};var se=function(e,t){const n=e[0],r=M(e),i=+t;return!i?n:i===1?r:n+i*(r-n)};var de=function(e,t,n,r){var i=t.length,a=n.length;if(!a)return t;if(!i)return n;var u=r||new t.constructor(i+a),o=0,f=0,c=0;for(;o<i&&f<a;++c){u[c]=e(t[o],n[f])>0?n[f++]:t[o++]}for(;o<i;++o,++c){u[c]=t[o]}for(;f<a;++f,++c){u[c]=n[f]}return u};var he=function(e,t){var n="";while(--t>=0)n+=e;return n};var pe=function(e,t,n,r){var i=n||" ",a=e+"",u=t-a.length;return u<=0?a:r==="left"?he(i,u)+a:r==="center"?he(i,~~(u/2))+a+he(i,Math.ceil(u/2)):a+he(i,u)};var ve=function(e){return M(e)-e[0]||0};var ge=function(e){return e==null||e===""?null:!e||e==="false"||e==="0"?false:!!e};function me(e){return fe(e)?e:oe(e)?e:Date.parse(e)}var ye=function(e,t){t=t||me;return e==null||e===""?null:t(e)};var be=function(e){return e==null||e===""?null:e+""};var xe=function(e){for(var t={},n=0,r=e.length;n<r;++n)t[e[n]]=true;return t};var _e=function(e,t,n,r){var i=r!=null?r:"â€¦",a=e+"",u=a.length,o=Math.max(0,t-i.length);return u<=t?a:n==="left"?i+a.slice(u-o):n==="center"?a.slice(0,Math.ceil(o/2))+i+a.slice(u-~~(o/2)):a.slice(0,o)+i};var we=function(e,t,n){if(e){var r=0,i=e.length,a;if(t){for(;r<i;++r){if(a=t(e[r]))n(a,r,e)}}else{e.forEach(n)}}};n.d(t,"f",function(){return r});n.d(t,"h",function(){return i});n.d(t,"g",function(){return a});n.d(t,"v",function(){return p});n.d(t,"w",function(){return v});n.d(t,"gb",function(){return g});n.d(t,"L",function(){return m});n.d(t,"db",function(){return y});n.d(t,"r",function(){return b});n.d(t,"J",function(){return E});n.d(t,"d",function(){return _});n.d(t,"b",function(){return w});n.d(t,"e",function(){return k});n.d(t,"c",function(){return O});n.d(t,"a",function(){return A});n.d(t,"N",function(){return z});n.d(t,"O",function(){return R});n.d(t,"P",function(){return P});n.d(t,"Q",function(){return L});n.d(t,"hb",function(){return I});n.d(t,"ib",function(){return U});n.d(t,"jb",function(){return q});n.d(t,"kb",function(){return W});n.d(t,"S",function(){return H});n.d(t,"eb",function(){return G});n.d(t,"i",function(){return Y});n.d(t,"j",function(){return $});n.d(t,"k",function(){return X});n.d(t,"l",function(){return Z});n.d(t,"m",function(){return J});n.d(t,"n",function(){return u});n.d(t,"o",function(){return Q});n.d(t,"p",function(){return K});n.d(t,"q",function(){return ee});n.d(t,"s",function(){return ne});n.d(t,"t",function(){return d});n.d(t,"u",function(){return re});n.d(t,"x",function(){return ie});n.d(t,"y",function(){return ae});n.d(t,"z",function(){return f});n.d(t,"A",function(){return ue});n.d(t,"B",function(){return oe});n.d(t,"C",function(){return V});n.d(t,"D",function(){return fe});n.d(t,"E",function(){return c});n.d(t,"F",function(){return ce});n.d(t,"G",function(){return l});n.d(t,"H",function(){return le});n.d(t,"I",function(){return se});n.d(t,"K",function(){return de});n.d(t,"M",function(){return pe});n.d(t,"R",function(){return M});n.d(t,"T",function(){return he});n.d(t,"U",function(){return ve});n.d(t,"V",function(){return o});n.d(t,"W",function(){return s});n.d(t,"X",function(){return ge});n.d(t,"Y",function(){return ye});n.d(t,"Z",function(){return S});n.d(t,"bb",function(){return be});n.d(t,"ab",function(){return xe});n.d(t,"cb",function(){return _e});n.d(t,"fb",function(){return we})},ZYJ9:function(e,t){function n(e,t){t=t||{};var n=JSON.stringify([1],null,a(t,"indent",2)).slice(2,-3);var r=a(t,"margins",false);var u=n===""?Infinity:a(t,"maxLength",80);return function e(t,a,o){if(t&&typeof t.toJSON==="function"){t=t.toJSON()}var f=JSON.stringify(t);if(f===undefined){return f}var c=u-a.length-o;if(f.length<=c){var l=i(f,r);if(l.length<=c){return l}}if(typeof t==="object"&&t!==null){var s=a+n;var d=[];var h;var p=function(e,t){return t===e.length-1?0:1};if(Array.isArray(t)){for(var v=0;v<t.length;v++){d.push(e(t[v],s,p(t,v))||"null")}h="[]"}else{Object.keys(t).forEach(function(n,r,i){var a=JSON.stringify(n)+": ";var u=e(t[n],s,a.length+p(i,r));if(u!==undefined){d.push(a+u)}});h="{}"}if(d.length>0){return[h[0],n+d.join(",\n"+s),h[1]].join("\n"+a)}}return f}(e,"",0)}var r=/("(?:[^\\"]|\\.)*")|[:,\][}{]/g;function i(e,t){var n=t?" ":"";var i={"{":"{"+n,"[":"["+n,"}":n+"}","]":n+"]",",":", ",":":": "};return e.replace(r,function(e,t){return t?e:i[e]})}function a(e,t,n){return t in e?e[t]:n}e.exports=n},etOl:function(e,t,n){"use strict";n.r(t);var r={};n.r(r);n.d(r,"aggregate",function(){return Oc});n.d(r,"bin",function(){return Ec});n.d(r,"collect",function(){return Cc});n.d(r,"compare",function(){return jc});n.d(r,"countpattern",function(){return Fc});n.d(r,"cross",function(){return Rc});n.d(r,"density",function(){return Hc});n.d(r,"expression",function(){return Xc});n.d(r,"extent",function(){return Jc});n.d(r,"facet",function(){return tl});n.d(r,"field",function(){return rl});n.d(r,"filter",function(){return al});n.d(r,"flatten",function(){return fl});n.d(r,"fold",function(){return ll});n.d(r,"formula",function(){return dl});n.d(r,"generate",function(){return pl});n.d(r,"impute",function(){return yl});n.d(r,"joinaggregate",function(){return kl});n.d(r,"key",function(){return Al});n.d(r,"load",function(){return Ml});n.d(r,"lookup",function(){return Cl});n.d(r,"multiextent",function(){return jl});n.d(r,"multivalues",function(){return Fl});n.d(r,"params",function(){return zl});n.d(r,"pivot",function(){return Rl});n.d(r,"prefacet",function(){return Ul});n.d(r,"project",function(){return Wl});n.d(r,"proxy",function(){return Yl});n.d(r,"relay",function(){return Vl});n.d(r,"sample",function(){return Zl});n.d(r,"sequence",function(){return Ql});n.d(r,"sieve",function(){return es});n.d(r,"subflow",function(){return Kc});n.d(r,"tupleindex",function(){return ns});n.d(r,"values",function(){return is});n.d(r,"window",function(){return ds});var i={};n.r(i);n.d(i,"bound",function(){return eb});n.d(i,"identifier",function(){return ib});n.d(i,"mark",function(){return ob});n.d(i,"overlap",function(){return lb});n.d(i,"render",function(){return bb});n.d(i,"viewlayout",function(){return Tb});var a={};n.r(a);n.d(a,"interpolate",function(){return ik});n.d(a,"interpolateArray",function(){return Xw});n.d(a,"interpolateBasis",function(){return Pw});n.d(a,"interpolateBasisClosed",function(){return Lw});n.d(a,"interpolateDate",function(){return Zw});n.d(a,"interpolateDiscrete",function(){return ak});n.d(a,"interpolateHue",function(){return uk});n.d(a,"interpolateNumber",function(){return Jw});n.d(a,"interpolateObject",function(){return Qw});n.d(a,"interpolateRound",function(){return ok});n.d(a,"interpolateString",function(){return rk});n.d(a,"interpolateTransformCss",function(){return yk});n.d(a,"interpolateTransformSvg",function(){return bk});n.d(a,"interpolateZoom",function(){return Mk});n.d(a,"interpolateRgb",function(){return Gw});n.d(a,"interpolateRgbBasis",function(){return $w});n.d(a,"interpolateRgbBasisClosed",function(){return Vw});n.d(a,"interpolateHsl",function(){return Ck});n.d(a,"interpolateHslLong",function(){return Dk});n.d(a,"interpolateLab",function(){return jk});n.d(a,"interpolateHcl",function(){return Fk});n.d(a,"interpolateHclLong",function(){return Tk});n.d(a,"interpolateCubehelix",function(){return Rk});n.d(a,"interpolateCubehelixLong",function(){return Pk});n.d(a,"piecewise",function(){return Lk});n.d(a,"quantize",function(){return Bk});var u={};n.r(u);n.d(u,"schemeCategory10",function(){return GA});n.d(u,"schemeAccent",function(){return YA});n.d(u,"schemeDark2",function(){return $A});n.d(u,"schemePaired",function(){return VA});n.d(u,"schemePastel1",function(){return XA});n.d(u,"schemePastel2",function(){return ZA});n.d(u,"schemeSet1",function(){return JA});n.d(u,"schemeSet2",function(){return QA});n.d(u,"schemeSet3",function(){return KA});n.d(u,"interpolateBrBG",function(){return nE});n.d(u,"schemeBrBG",function(){return tE});n.d(u,"interpolatePRGn",function(){return iE});n.d(u,"schemePRGn",function(){return rE});n.d(u,"interpolatePiYG",function(){return uE});n.d(u,"schemePiYG",function(){return aE});n.d(u,"interpolatePuOr",function(){return fE});n.d(u,"schemePuOr",function(){return oE});n.d(u,"interpolateRdBu",function(){return lE});n.d(u,"schemeRdBu",function(){return cE});n.d(u,"interpolateRdGy",function(){return dE});n.d(u,"schemeRdGy",function(){return sE});n.d(u,"interpolateRdYlBu",function(){return pE});n.d(u,"schemeRdYlBu",function(){return hE});n.d(u,"interpolateRdYlGn",function(){return gE});n.d(u,"schemeRdYlGn",function(){return vE});n.d(u,"interpolateSpectral",function(){return yE});n.d(u,"schemeSpectral",function(){return mE});n.d(u,"interpolateBuGn",function(){return xE});n.d(u,"schemeBuGn",function(){return bE});n.d(u,"interpolateBuPu",function(){return wE});n.d(u,"schemeBuPu",function(){return _E});n.d(u,"interpolateGnBu",function(){return OE});n.d(u,"schemeGnBu",function(){return kE});n.d(u,"interpolateOrRd",function(){return EE});n.d(u,"schemeOrRd",function(){return AE});n.d(u,"interpolatePuBuGn",function(){return SE});n.d(u,"schemePuBuGn",function(){return ME});n.d(u,"interpolatePuBu",function(){return DE});n.d(u,"schemePuBu",function(){return CE});n.d(u,"interpolatePuRd",function(){return NE});n.d(u,"schemePuRd",function(){return jE});n.d(u,"interpolateRdPu",function(){return TE});n.d(u,"schemeRdPu",function(){return FE});n.d(u,"interpolateYlGnBu",function(){return RE});n.d(u,"schemeYlGnBu",function(){return zE});n.d(u,"interpolateYlGn",function(){return LE});n.d(u,"schemeYlGn",function(){return PE});n.d(u,"interpolateYlOrBr",function(){return IE});n.d(u,"schemeYlOrBr",function(){return BE});n.d(u,"interpolateYlOrRd",function(){return qE});n.d(u,"schemeYlOrRd",function(){return UE});n.d(u,"interpolateBlues",function(){return HE});n.d(u,"schemeBlues",function(){return WE});n.d(u,"interpolateGreens",function(){return YE});n.d(u,"schemeGreens",function(){return GE});n.d(u,"interpolateGreys",function(){return VE});n.d(u,"schemeGreys",function(){return $E});n.d(u,"interpolatePurples",function(){return ZE});n.d(u,"schemePurples",function(){return XE});n.d(u,"interpolateReds",function(){return QE});n.d(u,"schemeReds",function(){return JE});n.d(u,"interpolateOranges",function(){return eM});n.d(u,"schemeOranges",function(){return KE});n.d(u,"interpolateCubehelixDefault",function(){return tM});n.d(u,"interpolateRainbow",function(){return aM});n.d(u,"interpolateWarm",function(){return nM});n.d(u,"interpolateCool",function(){return rM});n.d(u,"interpolateSinebow",function(){return cM});n.d(u,"interpolateViridis",function(){return sM});n.d(u,"interpolateMagma",function(){return dM});n.d(u,"interpolateInferno",function(){return hM});n.d(u,"interpolatePlasma",function(){return pM});var o={};n.r(o);n.d(o,"axisticks",function(){return NM});n.d(o,"datajoin",function(){return TM});n.d(o,"encode",function(){return LM});n.d(o,"legendentries",function(){return tS});n.d(o,"linkpath",function(){return fS});n.d(o,"pie",function(){return wS});n.d(o,"scale",function(){return SS});n.d(o,"sortitems",function(){return IS});n.d(o,"stack",function(){return YS});n.d(o,"validTicks",function(){return AM});var f={};n.r(f);n.d(f,"contour",function(){return cD});n.d(f,"geojson",function(){return vD});n.d(f,"geopath",function(){return SR});n.d(f,"geopoint",function(){return jR});n.d(f,"geoshape",function(){return FR});n.d(f,"graticule",function(){return RR});n.d(f,"projection",function(){return LR});var c={};n.r(c);n.d(c,"force",function(){return lL});var l={};n.r(l);n.d(l,"nest",function(){return HB});n.d(l,"pack",function(){return KB});n.d(l,"partition",function(){return nI});n.d(l,"stratify",function(){return iI});n.d(l,"tree",function(){return fI});n.d(l,"treelinks",function(){return lI});n.d(l,"treemap",function(){return pI});var s={};n.r(s);n.d(s,"voronoi",function(){return uU});var d={};n.r(d);n.d(d,"wordcloud",function(){return OU});var h={};n.r(h);n.d(h,"crossfilter",function(){return PU});n.d(h,"resolvefilter",function(){return BU});var p={};n.r(p);n.d(p,"version",function(){return UU["a"]});n.d(p,"accessor",function(){return dn["f"]});n.d(p,"accessorName",function(){return dn["h"]});n.d(p,"accessorFields",function(){return dn["g"]});n.d(p,"id",function(){return dn["v"]});n.d(p,"identity",function(){return dn["w"]});n.d(p,"zero",function(){return dn["gb"]});n.d(p,"one",function(){return dn["L"]});n.d(p,"truthy",function(){return dn["db"]});n.d(p,"falsy",function(){return dn["r"]});n.d(p,"logger",function(){return dn["J"]});n.d(p,"None",function(){return dn["d"]});n.d(p,"Error",function(){return dn["b"]});n.d(p,"Warn",function(){return dn["e"]});n.d(p,"Info",function(){return dn["c"]});n.d(p,"Debug",function(){return dn["a"]});n.d(p,"panLinear",function(){return dn["N"]});n.d(p,"panLog",function(){return dn["O"]});n.d(p,"panPow",function(){return dn["P"]});n.d(p,"panSymlog",function(){return dn["Q"]});n.d(p,"zoomLinear",function(){return dn["hb"]});n.d(p,"zoomLog",function(){return dn["ib"]});n.d(p,"zoomPow",function(){return dn["jb"]});n.d(p,"zoomSymlog",function(){return dn["kb"]});n.d(p,"quarter",function(){return dn["S"]});n.d(p,"utcquarter",function(){return dn["eb"]});n.d(p,"array",function(){return dn["i"]});n.d(p,"clampRange",function(){return dn["j"]});n.d(p,"compare",function(){return dn["k"]});n.d(p,"constant",function(){return dn["l"]});n.d(p,"debounce",function(){return dn["m"]});n.d(p,"error",function(){return dn["n"]});n.d(p,"extend",function(){return dn["o"]});n.d(p,"extent",function(){return dn["p"]});n.d(p,"extentIndex",function(){return dn["q"]});n.d(p,"fastmap",function(){return dn["s"]});n.d(p,"field",function(){return dn["t"]});n.d(p,"flush",function(){return dn["u"]});n.d(p,"inherits",function(){return dn["x"]});n.d(p,"inrange",function(){return dn["y"]});n.d(p,"isArray",function(){return dn["z"]});n.d(p,"isBoolean",function(){return dn["A"]});n.d(p,"isDate",function(){return dn["B"]});n.d(p,"isFunction",function(){return dn["C"]});n.d(p,"isNumber",function(){return dn["D"]});n.d(p,"isObject",function(){return dn["E"]});n.d(p,"isRegExp",function(){return dn["F"]});n.d(p,"isString",function(){return dn["G"]});n.d(p,"key",function(){return dn["H"]});n.d(p,"lerp",function(){return dn["I"]});n.d(p,"merge",function(){return dn["K"]});n.d(p,"pad",function(){return dn["M"]});n.d(p,"peek",function(){return dn["R"]});n.d(p,"repeat",function(){return dn["T"]});n.d(p,"span",function(){return dn["U"]});n.d(p,"splitAccessPath",function(){return dn["V"]});n.d(p,"stringValue",function(){return dn["W"]});n.d(p,"toBoolean",function(){return dn["X"]});n.d(p,"toDate",function(){return dn["Y"]});n.d(p,"toNumber",function(){return dn["Z"]});n.d(p,"toString",function(){return dn["bb"]});n.d(p,"toSet",function(){return dn["ab"]});n.d(p,"truncate",function(){return dn["cb"]});n.d(p,"visitArray",function(){return dn["fb"]});n.d(p,"Dataflow",function(){return qo});n.d(p,"EventStream",function(){return In});n.d(p,"Parameters",function(){return Mn});n.d(p,"Pulse",function(){return _o});n.d(p,"MultiPulse",function(){return Eo});n.d(p,"Operator",function(){return Tn});n.d(p,"Transform",function(){return Go});n.d(p,"changeset",function(){return An});n.d(p,"ingest",function(){return xn});n.d(p,"isTuple",function(){return mn});n.d(p,"definition",function(){return Vo});n.d(p,"transform",function(){return Xo});n.d(p,"transforms",function(){return $o});n.d(p,"tupleid",function(){return yn});n.d(p,"scale",function(){return CA});n.d(p,"scheme",function(){return yM});n.d(p,"schemeDiscretized",function(){return bM});n.d(p,"interpolate",function(){return zA});n.d(p,"interpolateRange",function(){return NA});n.d(p,"timeInterval",function(){return wM});n.d(p,"utcInterval",function(){return kM});n.d(p,"projection",function(){return OR});n.d(p,"View",function(){return nK});n.d(p,"parse",function(){return rQ});n.d(p,"expressionFunction",function(){return JY});n.d(p,"formatLocale",function(){return vO});n.d(p,"timeFormatLocale",function(){return Hu});n.d(p,"runtime",function(){return CQ});n.d(p,"runtimeContext",function(){return FQ});n.d(p,"bin",function(){return of});n.d(p,"bootstrapCI",function(){return hc});n.d(p,"quartiles",function(){return pc});n.d(p,"random",function(){return lf});n.d(p,"setRandom",function(){return sf});n.d(p,"randomLCG",function(){return vc});n.d(p,"randomInteger",function(){return gc});n.d(p,"randomKDE",function(){return yc});n.d(p,"randomMixture",function(){return xc});n.d(p,"randomNormal",function(){return mc});n.d(p,"randomUniform",function(){return _c});n.d(p,"loader",function(){return Yn});n.d(p,"read",function(){return Qu});n.d(p,"inferType",function(){return rr});n.d(p,"inferTypes",function(){return ir});n.d(p,"typeParsers",function(){return er});n.d(p,"format",function(){return ri});n.d(p,"formats",function(){return ii});n.d(p,"Bounds",function(){return Qs});n.d(p,"Gradient",function(){return td});n.d(p,"GroupItem",function(){return rd});n.d(p,"ResourceLoader",function(){return ud});n.d(p,"Item",function(){return nd});n.d(p,"Scenegraph",function(){return jm});n.d(p,"Handler",function(){return Um});n.d(p,"Renderer",function(){return Hm});n.d(p,"CanvasHandler",function(){return Zm});n.d(p,"CanvasRenderer",function(){return iy});n.d(p,"SVGHandler",function(){return ly});n.d(p,"SVGRenderer",function(){return by});n.d(p,"SVGStringRenderer",function(){return Ty});n.d(p,"RenderType",function(){return Gy});n.d(p,"renderModule",function(){return $y});n.d(p,"Marks",function(){return km});n.d(p,"boundClip",function(){return Xy});n.d(p,"boundContext",function(){return Wv});n.d(p,"boundStroke",function(){return Lv});n.d(p,"boundItem",function(){return Om});n.d(p,"boundMark",function(){return Em});n.d(p,"pathCurves",function(){return zp});n.d(p,"pathSymbols",function(){return Jp});n.d(p,"pathRectangle",function(){return av});n.d(p,"pathTrail",function(){return ov});n.d(p,"pathParse",function(){return Lp});n.d(p,"pathRender",function(){return Yp});n.d(p,"point",function(){return Bm});n.d(p,"domCreate",function(){return Tm});n.d(p,"domFind",function(){return zm});n.d(p,"domChild",function(){return Rm});n.d(p,"domClear",function(){return Pm});n.d(p,"openTag",function(){return hy});n.d(p,"closeTag",function(){return py});n.d(p,"font",function(){return hm});n.d(p,"fontFamily",function(){return dm});n.d(p,"fontSize",function(){return fm});n.d(p,"textMetrics",function(){return rm});n.d(p,"resetSVGClipId",function(){return yg});n.d(p,"sceneEqual",function(){return Jy});n.d(p,"pathEqual",function(){return Qy});n.d(p,"sceneToJSON",function(){return Sm});n.d(p,"sceneFromJSON",function(){return Cm});n.d(p,"sceneZOrder",function(){return Qv});n.d(p,"sceneVisit",function(){return Kv});n.d(p,"scenePickVisit",function(){return eg});var v={};n.r(v);n.d(v,"pick",function(){return vK});n.d(v,"omit",function(){return gK});n.d(v,"stringify",function(){return mK});n.d(v,"hash",function(){return yK});n.d(v,"contains",function(){return bK});n.d(v,"without",function(){return xK});n.d(v,"union",function(){return _K});n.d(v,"some",function(){return wK});n.d(v,"every",function(){return kK});n.d(v,"flatten",function(){return OK});n.d(v,"mergeDeep",function(){return AK});n.d(v,"unique",function(){return MK});n.d(v,"differ",function(){return SK});n.d(v,"hasIntersection",function(){return CK});n.d(v,"isNumeric",function(){return DK});n.d(v,"differArray",function(){return jK});n.d(v,"keys",function(){return NK});n.d(v,"vals",function(){return FK});n.d(v,"flagKeys",function(){return TK});n.d(v,"duplicate",function(){return zK});n.d(v,"isBoolean",function(){return RK});n.d(v,"varName",function(){return PK});n.d(v,"logicalExpr",function(){return LK});n.d(v,"deleteNestedProperty",function(){return BK});n.d(v,"titlecase",function(){return IK});n.d(v,"accessPathWithDatum",function(){return UK});n.d(v,"flatAccessWithDatum",function(){return qK});n.d(v,"replacePathInField",function(){return WK});n.d(v,"removePathFromField",function(){return HK});n.d(v,"accessPathDepth",function(){return GK});var g={};n.r(g);n.d(g,"AGGREGATE_OPS",function(){return $K});n.d(g,"isAggregateOp",function(){return VK});n.d(g,"COUNTING_OPS",function(){return XK});n.d(g,"isCountingAggregateOp",function(){return ZK});n.d(g,"SUM_OPS",function(){return JK});n.d(g,"SHARED_DOMAIN_OPS",function(){return QK});n.d(g,"SHARED_DOMAIN_OP_INDEX",function(){return KK});var m={};n.r(m);n.d(m,"AXIS_PARTS",function(){return e0});n.d(m,"AXIS_PROPERTY_TYPE",function(){return t0});n.d(m,"isAxisProperty",function(){return a0});n.d(m,"VG_AXIS_PROPERTIES",function(){return u0});n.d(m,"AXIS_PROPERTIES",function(){return o0});var y={};n.r(y);n.d(y,"Channel",function(){return f0});n.d(y,"X",function(){return c0});n.d(y,"Y",function(){return l0});n.d(y,"X2",function(){return s0});n.d(y,"Y2",function(){return d0});n.d(y,"LATITUDE",function(){return h0});n.d(y,"LATITUDE2",function(){return p0});n.d(y,"LONGITUDE",function(){return v0});n.d(y,"LONGITUDE2",function(){return g0});n.d(y,"ROW",function(){return m0});n.d(y,"COLUMN",function(){return y0});n.d(y,"SHAPE",function(){return b0});n.d(y,"SIZE",function(){return x0});n.d(y,"COLOR",function(){return _0});n.d(y,"FILL",function(){return w0});n.d(y,"STROKE",function(){return k0});n.d(y,"TEXT",function(){return O0});n.d(y,"DETAIL",function(){return A0});n.d(y,"KEY",function(){return E0});n.d(y,"ORDER",function(){return M0});n.d(y,"OPACITY",function(){return S0});n.d(y,"TOOLTIP",function(){return C0});n.d(y,"HREF",function(){return D0});n.d(y,"GEOPOSITION_CHANNEL_INDEX",function(){return j0});n.d(y,"GEOPOSITION_CHANNELS",function(){return N0});n.d(y,"isColorChannel",function(){return T0});n.d(y,"CHANNELS",function(){return P0});n.d(y,"SINGLE_DEF_CHANNELS",function(){return U0});n.d(y,"isChannel",function(){return q0});n.d(y,"UNIT_CHANNELS",function(){return W0});n.d(y,"NONPOSITION_CHANNELS",function(){return K0});n.d(y,"POSITION_SCALE_CHANNELS",function(){return t1});n.d(y,"NONPOSITION_SCALE_CHANNELS",function(){return c1});n.d(y,"SCALE_CHANNELS",function(){return s1});n.d(y,"isScaleChannel",function(){return d1});n.d(y,"supportMark",function(){return h1});n.d(y,"getSupportedMark",function(){return p1});n.d(y,"rangeType",function(){return v1});var b={};n.r(b);n.d(b,"binToString",function(){return g1});n.d(b,"isBinParams",function(){return m1});n.d(b,"autoMaxBins",function(){return y1});var x={};n.r(x);n.d(x,"Mark",function(){return b1});n.d(x,"AREA",function(){return x1});n.d(x,"BAR",function(){return _1});n.d(x,"LINE",function(){return w1});n.d(x,"POINT",function(){return k1});n.d(x,"TEXT",function(){return O1});n.d(x,"TICK",function(){return A1});n.d(x,"TRAIL",function(){return E1});n.d(x,"RECT",function(){return M1});n.d(x,"RULE",function(){return S1});n.d(x,"GEOSHAPE",function(){return C1});n.d(x,"CIRCLE",function(){return D1});n.d(x,"SQUARE",function(){return j1});n.d(x,"isMark",function(){return F1});n.d(x,"isPathMark",function(){return T1});n.d(x,"PRIMITIVE_MARKS",function(){return z1});n.d(x,"isMarkDef",function(){return R1});n.d(x,"isPrimitiveMark",function(){return L1});n.d(x,"STROKE_CONFIG",function(){return B1});n.d(x,"FILL_CONFIG",function(){return I1});n.d(x,"FILL_STROKE_CONFIG",function(){return U1});n.d(x,"VL_ONLY_MARK_CONFIG_PROPERTIES",function(){return q1});n.d(x,"VL_ONLY_MARK_SPECIFIC_CONFIG_PROPERTY_INDEX",function(){return W1});n.d(x,"defaultMarkConfig",function(){return H1});n.d(x,"defaultBarConfig",function(){return G1});n.d(x,"defaultTickConfig",function(){return Y1});var _={};n.r(_);n.d(_,"isDateTime",function(){return i2});n.d(_,"MONTHS",function(){return a2});n.d(_,"SHORT_MONTHS",function(){return u2});n.d(_,"DAYS",function(){return o2});n.d(_,"SHORT_DAYS",function(){return f2});n.d(_,"dateTimeExpr",function(){return d2});var w={};n.r(w);n.d(w,"TimeUnit",function(){return h2});n.d(w,"TIMEUNIT_PARTS",function(){return v2});n.d(w,"isLocalSingleTimeUnit",function(){return g2});n.d(w,"isUtcSingleTimeUnit",function(){return y2});n.d(w,"isUTCTimeUnit",function(){return w2});n.d(w,"getLocalTimeUnit",function(){return k2});n.d(w,"TIMEUNITS",function(){return A2});n.d(w,"isTimeUnit",function(){return E2});n.d(w,"convert",function(){return S2});n.d(w,"getTimeUnitParts",function(){return D2});n.d(w,"containsTimeUnit",function(){return j2});n.d(w,"fieldExpr",function(){return N2});n.d(w,"formatExpression",function(){return F2});n.d(w,"normalizeTimeUnit",function(){return T2});var k={};n.r(k);n.d(k,"Type",function(){return z2});n.d(k,"TYPE_INDEX",function(){return R2});n.d(k,"isType",function(){return P2});n.d(k,"QUANTITATIVE",function(){return L2});n.d(k,"ORDINAL",function(){return B2});n.d(k,"TEMPORAL",function(){return I2});n.d(k,"NOMINAL",function(){return U2});n.d(k,"GEOJSON",function(){return q2});n.d(k,"getFullName",function(){return W2});var O={};n.r(O);n.d(O,"isConditionalSelection",function(){return H2});n.d(O,"isRepeatRef",function(){return G2});n.d(O,"toFieldDefBase",function(){return Y2});n.d(O,"isConditionalDef",function(){return $2});n.d(O,"hasConditionalFieldDef",function(){return V2});n.d(O,"hasConditionalValueDef",function(){return X2});n.d(O,"isFieldDef",function(){return Z2});n.d(O,"isStringFieldDef",function(){return J2});n.d(O,"isValueDef",function(){return Q2});n.d(O,"isScaleFieldDef",function(){return K2});n.d(O,"vgField",function(){return t3});n.d(O,"isDiscrete",function(){return n3});n.d(O,"isContinuous",function(){return r3});n.d(O,"isCount",function(){return i3});n.d(O,"verbalTitleFormatter",function(){return a3});n.d(O,"functionalTitleFormatter",function(){return u3});n.d(O,"defaultTitleFormatter",function(){return o3});n.d(O,"setTitleFormatter",function(){return c3});n.d(O,"resetTitleFormatter",function(){return l3});n.d(O,"title",function(){return s3});n.d(O,"defaultType",function(){return d3});n.d(O,"getFieldDef",function(){return h3});n.d(O,"normalize",function(){return p3});n.d(O,"normalizeFieldDef",function(){return v3});n.d(O,"normalizeBin",function(){return g3});n.d(O,"channelCompatibility",function(){return y3});n.d(O,"isNumberFieldDef",function(){return b3});n.d(O,"isTimeFieldDef",function(){return x3});n.d(O,"valueExpr",function(){return _3});n.d(O,"valueArray",function(){return w3});var A={};n.r(A);n.d(A,"channelHasField",function(){return k3});n.d(A,"isAggregate",function(){return O3});n.d(A,"normalizeEncoding",function(){return A3});n.d(A,"isRanged",function(){return E3});n.d(A,"fieldDefs",function(){return M3});n.d(A,"forEach",function(){return S3});n.d(A,"reduce",function(){return C3});var E={};n.r(E);n.d(E,"add",function(){return H3});n.d(E,"remove",function(){return G3});n.d(E,"COMPOSITE_MARK_STYLES",function(){return Y3});n.d(E,"VL_ONLY_COMPOSITE_MARK_SPECIFIC_CONFIG_PROPERTY_INDEX",function(){return $3});n.d(E,"normalize",function(){return V3});var M={};n.r(M);n.d(M,"defaultLegendConfig",function(){return Z3});n.d(M,"LEGEND_PROPERTIES",function(){return K3});n.d(M,"VG_LEGEND_PROPERTIES",function(){return e6});var S={};n.r(S);n.d(S,"ScaleType",function(){return t6});n.d(S,"SCALE_TYPES",function(){return r6});n.d(S,"scaleCompatible",function(){return i6});n.d(S,"scaleTypePrecedence",function(){return u6});n.d(S,"CONTINUOUS_TO_CONTINUOUS_SCALES",function(){return o6});n.d(S,"CONTINUOUS_DOMAIN_SCALES",function(){return c6});n.d(S,"DISCRETE_DOMAIN_SCALES",function(){return s6});n.d(S,"TIME_SCALE_TYPES",function(){return p6});n.d(S,"hasDiscreteDomain",function(){return v6});n.d(S,"isBinScale",function(){return g6});n.d(S,"hasContinuousDomain",function(){return m6});n.d(S,"isContinuousToContinuous",function(){return y6});n.d(S,"defaultScaleConfig",function(){return b6});n.d(S,"isExtendedScheme",function(){return x6});n.d(S,"isSelectionDomain",function(){return _6});n.d(S,"SCALE_PROPERTIES",function(){return k6});n.d(S,"NON_TYPE_DOMAIN_RANGE_VEGA_SCALE_PROPERTIES",function(){return D6});n.d(S,"SCALE_TYPE_INDEX",function(){return j6});n.d(S,"scaleTypeSupportProperty",function(){return N6});n.d(S,"channelScalePropertyIncompatability",function(){return F6});n.d(S,"scaleTypeSupportDataType",function(){return T6});n.d(S,"channelSupportScaleType",function(){return z6});n.d(S,"getSupportedScaleType",function(){return R6});var C={};n.r(C);n.d(C,"defaultViewConfig",function(){return q6});n.d(C,"defaultConfig",function(){return W6});n.d(C,"initConfig",function(){return H6});n.d(C,"stripAndRedirectConfig",function(){return V6});var D={};n.r(D);n.d(D,"isStackOffset",function(){return J6});n.d(D,"STACKABLE_MARKS",function(){return Q6});n.d(D,"STACK_BY_DEFAULT_MARKS",function(){return K6});n.d(D,"stack",function(){return t5});var j={};n.r(j);n.d(j,"isFacetSpec",function(){return n5});n.d(j,"isUnitSpec",function(){return r5});n.d(j,"isLayerSpec",function(){return i5});n.d(j,"isRepeatSpec",function(){return a5});n.d(j,"isConcatSpec",function(){return u5});n.d(j,"isVConcatSpec",function(){return o5});n.d(j,"isHConcatSpec",function(){return f5});n.d(j,"normalize",function(){return c5});n.d(j,"fieldDefs",function(){return M5});n.d(j,"isStacked",function(){return S5});var N={};n.r(N);n.d(N,"isUrlData",function(){return T5});n.d(N,"isInlineData",function(){return z5});n.d(N,"isNamedData",function(){return R5});n.d(N,"MAIN",function(){return P5});n.d(N,"RAW",function(){return L5});var F={};n.r(F);n.d(F,"HEADER_TITLE_PROPERTIES_MAP",function(){return Z5});n.d(F,"HEADER_LABEL_PROPERTIES_MAP",function(){return J5});n.d(F,"HEADER_TITLE_PROPERTIES",function(){return Q5});n.d(F,"HEADER_LABEL_PROPERTIES",function(){return K5});var T={};n.r(T);n.d(T,"isSortField",function(){return e8});n.d(T,"isSortArray",function(){return t8});var z={};n.r(z);n.d(z,"symbols",function(){return x7});n.d(z,"gradient",function(){return _7});n.d(z,"labels",function(){return w7});var R={};n.r(R);n.d(R,"isFilter",function(){return Mee});n.d(R,"isLookup",function(){return See});n.d(R,"isWindow",function(){return Cee});n.d(R,"isCalculate",function(){return Dee});n.d(R,"isBin",function(){return jee});n.d(R,"isTimeUnit",function(){return Nee});n.d(R,"isAggregate",function(){return Fee});n.d(R,"isStack",function(){return Tee});n.d(R,"normalizeTransform",function(){return zee});var P={};n.r(P);n.d(P,"DEFAULT_REQUIRED_CHANNEL_MAP",function(){return Dne});n.d(P,"DEFAULT_SUPPORTED_CHANNEL_TYPE",function(){return jne});n.d(P,"getEncodingMappingError",function(){return Nne});var L={};n.r(L);n.d(L,"compile",function(){return Ene});n.d(L,"aggregate",function(){return g});n.d(L,"axis",function(){return m});n.d(L,"bin",function(){return b});n.d(L,"channel",function(){return y});n.d(L,"compositeMark",function(){return E});n.d(L,"config",function(){return C});n.d(L,"data",function(){return N});n.d(L,"datetime",function(){return _});n.d(L,"encoding",function(){return A});n.d(L,"facet",function(){return Cne});n.d(L,"fieldDef",function(){return O});n.d(L,"header",function(){return F});n.d(L,"legend",function(){return M});n.d(L,"mark",function(){return x});n.d(L,"scale",function(){return S});n.d(L,"sort",function(){return T});n.d(L,"spec",function(){return j});n.d(L,"stack",function(){return D});n.d(L,"timeUnit",function(){return w});n.d(L,"transform",function(){return R});n.d(L,"type",function(){return k});n.d(L,"util",function(){return v});n.d(L,"validate",function(){return P});n.d(L,"version",function(){return Tne});var B={};n.r(B);n.d(B,"excel",function(){return Bne});n.d(B,"ggplot2",function(){return qne});n.d(B,"quartz",function(){return Yne});n.d(B,"vox",function(){return Xne});n.d(B,"dark",function(){return Kne});n.d(B,"fivethirtyeight",function(){return ore});n.d(B,"latimes",function(){return wre});
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var I=function(e,t){I=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n]};return I(e,t)};function U(e,t){I(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}var q=function(){q=Object.assign||function e(t){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var a in n)if(Object.prototype.hasOwnProperty.call(n,a))t[a]=n[a]}return t};return q.apply(this,arguments)};function W(e,t){var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0)n[r]=e[r];if(e!=null&&typeof Object.getOwnPropertySymbols==="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)if(t.indexOf(r[i])<0)n[r[i]]=e[r[i]];return n}function H(e,t,n,r){var i=arguments.length,a=i<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,u;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")a=Reflect.decorate(e,t,n,r);else for(var o=e.length-1;o>=0;o--)if(u=e[o])a=(i<3?u(a):i>3?u(t,n,a):u(t,n))||a;return i>3&&a&&Object.defineProperty(t,n,a),a}function G(e,t){return function(n,r){t(n,r,e)}}function Y(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)}function $(e,t,n,r){return new(n||(n=Promise))(function(i,a){function u(e){try{f(r.next(e))}catch(e){a(e)}}function o(e){try{f(r["throw"](e))}catch(e){a(e)}}function f(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(u,o)}f((r=r.apply(e,t||[])).next())})}function V(e,t){var n={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},r,i,a,u;return u={next:o(0),throw:o(1),return:o(2)},typeof Symbol==="function"&&(u[Symbol.iterator]=function(){return this}),u;function o(e){return function(t){return f([e,t])}}function f(u){if(r)throw new TypeError("Generator is already executing.");while(n)try{if(r=1,i&&(a=u[0]&2?i["return"]:u[0]?i["throw"]||((a=i["return"])&&a.call(i),0):i.next)&&!(a=a.call(i,u[1])).done)return a;if(i=0,a)u=[u[0]&2,a.value];switch(u[0]){case 0:case 1:a=u;break;case 4:n.label++;return{value:u[1],done:false};case 5:n.label++;i=u[1];u=[0];continue;case 7:u=n.ops.pop();n.trys.pop();continue;default:if(!(a=n.trys,a=a.length>0&&a[a.length-1])&&(u[0]===6||u[0]===2)){n=0;continue}if(u[0]===3&&(!a||u[1]>a[0]&&u[1]<a[3])){n.label=u[1];break}if(u[0]===6&&n.label<a[1]){n.label=a[1];a=u;break}if(a&&n.label<a[2]){n.label=a[2];n.ops.push(u);break}if(a[2])n.ops.pop();n.trys.pop();continue}u=t.call(e,n)}catch(e){u=[6,e];i=0}finally{r=a=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:true}}}function X(e,t){for(var n in e)if(!t.hasOwnProperty(n))t[n]=e[n]}function Z(e){var t=typeof Symbol==="function"&&e[Symbol.iterator],n=0;if(t)return t.call(e);return{next:function(){if(e&&n>=e.length)e=void 0;return{value:e&&e[n++],done:!e}}}}function J(e,t){var n=typeof Symbol==="function"&&e[Symbol.iterator];if(!n)return e;var r=n.call(e),i,a=[],u;try{while((t===void 0||t-- >0)&&!(i=r.next()).done)a.push(i.value)}catch(e){u={error:e}}finally{try{if(i&&!i.done&&(n=r["return"]))n.call(r)}finally{if(u)throw u.error}}return a}function Q(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(J(arguments[t]));return e}function K(e){return this instanceof K?(this.v=e,this):new K(e)}function ee(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(e,t||[]),i,a=[];return i={},u("next"),u("throw"),u("return"),i[Symbol.asyncIterator]=function(){return this},i;function u(e){if(r[e])i[e]=function(t){return new Promise(function(n,r){a.push([e,t,n,r])>1||o(e,t)})}}function o(e,t){try{f(r[e](t))}catch(e){s(a[0][3],e)}}function f(e){e.value instanceof K?Promise.resolve(e.value.v).then(c,l):s(a[0][2],e)}function c(e){o("next",e)}function l(e){o("throw",e)}function s(e,t){if(e(t),a.shift(),a.length)o(a[0][0],a[0][1])}}function te(e){var t,n;return t={},r("next"),r("throw",function(e){throw e}),r("return"),t[Symbol.iterator]=function(){return this},t;function r(r,i){t[r]=e[r]?function(t){return(n=!n)?{value:K(e[r](t)),done:r==="return"}:i?i(t):t}:i}}function ne(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],n;return t?t.call(e):(e=typeof Z==="function"?Z(e):e[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(t){n[t]=e[t]&&function(n){return new Promise(function(r,a){n=e[t](n),i(r,a,n.done,n.value)})}}function i(e,t,n,r){Promise.resolve(r).then(function(t){e({value:t,done:n})},t)}}function re(e,t){if(Object.defineProperty){Object.defineProperty(e,"raw",{value:t})}else{e.raw=t}return e}function ie(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)if(Object.hasOwnProperty.call(e,n))t[n]=e[n];t.default=e;return t}function ae(e){return e&&e.__esModule?e:{default:e}}var ue="http://www.w3.org/1999/xhtml";var oe={svg:"http://www.w3.org/2000/svg",xhtml:ue,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};var fe=function(e){var t=e+="",n=t.indexOf(":");if(n>=0&&(t=e.slice(0,n))!=="xmlns")e=e.slice(n+1);return oe.hasOwnProperty(t)?{space:oe[t],local:e}:e};function ce(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===ue&&t.documentElement.namespaceURI===ue?t.createElement(e):t.createElementNS(n,e)}}function le(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}var se=function(e){var t=fe(e);return(t.local?le:ce)(t)};function de(){}var he=function(e){return e==null?de:function(){return this.querySelector(e)}};var pe=function(e){if(typeof e!=="function")e=he(e);for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i){for(var a=t[i],u=a.length,o=r[i]=new Array(u),f,c,l=0;l<u;++l){if((f=a[l])&&(c=e.call(f,f.__data__,l,a))){if("__data__"in f)c.__data__=f.__data__;o[l]=c}}}return new Vt(r,this._parents)};function ve(){return[]}var ge=function(e){return e==null?ve:function(){return this.querySelectorAll(e)}};var me=function(e){if(typeof e!=="function")e=ge(e);for(var t=this._groups,n=t.length,r=[],i=[],a=0;a<n;++a){for(var u=t[a],o=u.length,f,c=0;c<o;++c){if(f=u[c]){r.push(e.call(f,f.__data__,c,u));i.push(f)}}}return new Vt(r,i)};var ye=function(e){return function(){return this.matches(e)}};var be=function(e){if(typeof e!=="function")e=ye(e);for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i){for(var a=t[i],u=a.length,o=r[i]=[],f,c=0;c<u;++c){if((f=a[c])&&e.call(f,f.__data__,c,a)){o.push(f)}}}return new Vt(r,this._parents)};var xe=function(e){return new Array(e.length)};var _e=function(){return new Vt(this._enter||this._groups.map(xe),this._parents)};function we(e,t){this.ownerDocument=e.ownerDocument;this.namespaceURI=e.namespaceURI;this._next=null;this._parent=e;this.__data__=t}we.prototype={constructor:we,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};var ke=function(e){return function(){return e}};var Oe="$";function Ae(e,t,n,r,i,a){var u=0,o,f=t.length,c=a.length;for(;u<c;++u){if(o=t[u]){o.__data__=a[u];r[u]=o}else{n[u]=new we(e,a[u])}}for(;u<f;++u){if(o=t[u]){i[u]=o}}}function Ee(e,t,n,r,i,a,u){var o,f,c={},l=t.length,s=a.length,d=new Array(l),h;for(o=0;o<l;++o){if(f=t[o]){d[o]=h=Oe+u.call(f,f.__data__,o,t);if(h in c){i[o]=f}else{c[h]=f}}}for(o=0;o<s;++o){h=Oe+u.call(e,a[o],o,a);if(f=c[h]){r[o]=f;f.__data__=a[o];c[h]=null}else{n[o]=new we(e,a[o])}}for(o=0;o<l;++o){if((f=t[o])&&c[d[o]]===f){i[o]=f}}}var Me=function(e,t){if(!e){h=new Array(this.size()),c=-1;this.each(function(e){h[++c]=e});return h}var n=t?Ee:Ae,r=this._parents,i=this._groups;if(typeof e!=="function")e=ke(e);for(var a=i.length,u=new Array(a),o=new Array(a),f=new Array(a),c=0;c<a;++c){var l=r[c],s=i[c],d=s.length,h=e.call(l,l&&l.__data__,c,r),p=h.length,v=o[c]=new Array(p),g=u[c]=new Array(p),m=f[c]=new Array(d);n(l,s,v,g,m,h,t);for(var y=0,b=0,x,_;y<p;++y){if(x=v[y]){if(y>=b)b=y+1;while(!(_=g[b])&&++b<p);x._next=_||null}}}u=new Vt(u,r);u._enter=o;u._exit=f;return u};var Se=function(){return new Vt(this._exit||this._groups.map(xe),this._parents)};var Ce=function(e,t,n){var r=this.enter(),i=this,a=this.exit();r=typeof e==="function"?e(r):r.append(e+"");if(t!=null)i=t(i);if(n==null)a.remove();else n(a);return r&&i?r.merge(i).order():i};var De=function(e){for(var t=this._groups,n=e._groups,r=t.length,i=n.length,a=Math.min(r,i),u=new Array(r),o=0;o<a;++o){for(var f=t[o],c=n[o],l=f.length,s=u[o]=new Array(l),d,h=0;h<l;++h){if(d=f[h]||c[h]){s[h]=d}}}for(;o<r;++o){u[o]=t[o]}return new Vt(u,this._parents)};var je=function(){for(var e=this._groups,t=-1,n=e.length;++t<n;){for(var r=e[t],i=r.length-1,a=r[i],u;--i>=0;){if(u=r[i]){if(a&&u.compareDocumentPosition(a)^4)a.parentNode.insertBefore(u,a);a=u}}}return this};var Ne=function(e){if(!e)e=Fe;function t(t,n){return t&&n?e(t.__data__,n.__data__):!t-!n}for(var n=this._groups,r=n.length,i=new Array(r),a=0;a<r;++a){for(var u=n[a],o=u.length,f=i[a]=new Array(o),c,l=0;l<o;++l){if(c=u[l]){f[l]=c}}f.sort(t)}return new Vt(i,this._parents).order()};function Fe(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}var Te=function(){var e=arguments[0];arguments[0]=this;e.apply(null,arguments);return this};var ze=function(){var e=new Array(this.size()),t=-1;this.each(function(){e[++t]=this});return e};var Re=function(){for(var e=this._groups,t=0,n=e.length;t<n;++t){for(var r=e[t],i=0,a=r.length;i<a;++i){var u=r[i];if(u)return u}}return null};var Pe=function(){var e=0;this.each(function(){++e});return e};var Le=function(){return!this.node()};var Be=function(e){for(var t=this._groups,n=0,r=t.length;n<r;++n){for(var i=t[n],a=0,u=i.length,o;a<u;++a){if(o=i[a])e.call(o,o.__data__,a,i)}}return this};function Ie(e){return function(){this.removeAttribute(e)}}function Ue(e){return function(){this.removeAttributeNS(e.space,e.local)}}function qe(e,t){return function(){this.setAttribute(e,t)}}function We(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function He(e,t){return function(){var n=t.apply(this,arguments);if(n==null)this.removeAttribute(e);else this.setAttribute(e,n)}}function Ge(e,t){return function(){var n=t.apply(this,arguments);if(n==null)this.removeAttributeNS(e.space,e.local);else this.setAttributeNS(e.space,e.local,n)}}var Ye=function(e,t){var n=fe(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?Ue:Ie:typeof t==="function"?n.local?Ge:He:n.local?We:qe)(n,t))};var $e=function(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView};function Ve(e){return function(){this.style.removeProperty(e)}}function Xe(e,t,n){return function(){this.style.setProperty(e,t,n)}}function Ze(e,t,n){return function(){var r=t.apply(this,arguments);if(r==null)this.style.removeProperty(e);else this.style.setProperty(e,r,n)}}var Je=function(e,t,n){return arguments.length>1?this.each((t==null?Ve:typeof t==="function"?Ze:Xe)(e,t,n==null?"":n)):Qe(this.node(),e)};function Qe(e,t){return e.style.getPropertyValue(t)||$e(e).getComputedStyle(e,null).getPropertyValue(t)}function Ke(e){return function(){delete this[e]}}function et(e,t){return function(){this[e]=t}}function tt(e,t){return function(){var n=t.apply(this,arguments);if(n==null)delete this[e];else this[e]=n}}var nt=function(e,t){return arguments.length>1?this.each((t==null?Ke:typeof t==="function"?tt:et)(e,t)):this.node()[e]};function rt(e){return e.trim().split(/^|\s+/)}function it(e){return e.classList||new at(e)}function at(e){this._node=e;this._names=rt(e.getAttribute("class")||"")}at.prototype={add:function(e){var t=this._names.indexOf(e);if(t<0){this._names.push(e);this._node.setAttribute("class",this._names.join(" "))}},remove:function(e){var t=this._names.indexOf(e);if(t>=0){this._names.splice(t,1);this._node.setAttribute("class",this._names.join(" "))}},contains:function(e){return this._names.indexOf(e)>=0}};function ut(e,t){var n=it(e),r=-1,i=t.length;while(++r<i)n.add(t[r])}function ot(e,t){var n=it(e),r=-1,i=t.length;while(++r<i)n.remove(t[r])}function ft(e){return function(){ut(this,e)}}function ct(e){return function(){ot(this,e)}}function lt(e,t){return function(){(t.apply(this,arguments)?ut:ot)(this,e)}}var st=function(e,t){var n=rt(e+"");if(arguments.length<2){var r=it(this.node()),i=-1,a=n.length;while(++i<a)if(!r.contains(n[i]))return false;return true}return this.each((typeof t==="function"?lt:t?ft:ct)(n,t))};function dt(){this.textContent=""}function ht(e){return function(){this.textContent=e}}function pt(e){return function(){var t=e.apply(this,arguments);this.textContent=t==null?"":t}}var vt=function(e){return arguments.length?this.each(e==null?dt:(typeof e==="function"?pt:ht)(e)):this.node().textContent};function gt(){this.innerHTML=""}function mt(e){return function(){this.innerHTML=e}}function yt(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t==null?"":t}}var bt=function(e){return arguments.length?this.each(e==null?gt:(typeof e==="function"?yt:mt)(e)):this.node().innerHTML};function xt(){if(this.nextSibling)this.parentNode.appendChild(this)}var _t=function(){return this.each(xt)};function wt(){if(this.previousSibling)this.parentNode.insertBefore(this,this.parentNode.firstChild)}var kt=function(){return this.each(wt)};var Ot=function(e){var t=typeof e==="function"?e:se(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})};function At(){return null}var Et=function(e,t){var n=typeof e==="function"?e:se(e),r=t==null?At:typeof t==="function"?t:he(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})};function Mt(){var e=this.parentNode;if(e)e.removeChild(this)}var St=function(){return this.each(Mt)};function Ct(){return this.parentNode.insertBefore(this.cloneNode(false),this.nextSibling)}function Dt(){return this.parentNode.insertBefore(this.cloneNode(true),this.nextSibling)}var jt=function(e){return this.select(e?Dt:Ct)};var Nt=function(e){return arguments.length?this.property("__data__",e):this.node().__data__};var Ft={};var Tt=null;if(typeof document!=="undefined"){var zt=document.documentElement;if(!("onmouseenter"in zt)){Ft={mouseenter:"mouseover",mouseleave:"mouseout"}}}function Rt(e,t,n){e=Pt(e,t,n);return function(t){var n=t.relatedTarget;if(!n||n!==this&&!(n.compareDocumentPosition(this)&8)){e.call(this,t)}}}function Pt(e,t,n){return function(r){var i=Tt;Tt=r;try{e.call(this,this.__data__,t,n)}finally{Tt=i}}}function Lt(e){return e.trim().split(/^|\s+/).map(function(e){var t="",n=e.indexOf(".");if(n>=0)t=e.slice(n+1),e=e.slice(0,n);return{type:e,name:t}})}function Bt(e){return function(){var t=this.__on;if(!t)return;for(var n=0,r=-1,i=t.length,a;n<i;++n){if(a=t[n],(!e.type||a.type===e.type)&&a.name===e.name){this.removeEventListener(a.type,a.listener,a.capture)}else{t[++r]=a}}if(++r)t.length=r;else delete this.__on}}function It(e,t,n){var r=Ft.hasOwnProperty(e.type)?Rt:Pt;return function(i,a,u){var o=this.__on,f,c=r(t,a,u);if(o)for(var l=0,s=o.length;l<s;++l){if((f=o[l]).type===e.type&&f.name===e.name){this.removeEventListener(f.type,f.listener,f.capture);this.addEventListener(f.type,f.listener=c,f.capture=n);f.value=t;return}}this.addEventListener(e.type,c,n);f={type:e.type,name:e.name,value:t,listener:c,capture:n};if(!o)this.__on=[f];else o.push(f)}}var Ut=function(e,t,n){var r=Lt(e+""),i,a=r.length,u;if(arguments.length<2){var o=this.node().__on;if(o)for(var f=0,c=o.length,l;f<c;++f){for(i=0,l=o[f];i<a;++i){if((u=r[i]).type===l.type&&u.name===l.name){return l.value}}}return}o=t?It:Bt;if(n==null)n=false;for(i=0;i<a;++i)this.each(o(r[i],t,n));return this};function qt(e,t,n,r){var i=Tt;e.sourceEvent=Tt;Tt=e;try{return t.apply(n,r)}finally{Tt=i}}function Wt(e,t,n){var r=$e(e),i=r.CustomEvent;if(typeof i==="function"){i=new i(t,n)}else{i=r.document.createEvent("Event");if(n)i.initEvent(t,n.bubbles,n.cancelable),i.detail=n.detail;else i.initEvent(t,false,false)}e.dispatchEvent(i)}function Ht(e,t){return function(){return Wt(this,e,t)}}function Gt(e,t){return function(){return Wt(this,e,t.apply(this,arguments))}}var Yt=function(e,t){return this.each((typeof t==="function"?Gt:Ht)(e,t))};var $t=[null];function Vt(e,t){this._groups=e;this._parents=t}function Xt(){return new Vt([[document.documentElement]],$t)}Vt.prototype=Xt.prototype={constructor:Vt,select:pe,selectAll:me,filter:be,data:Me,enter:_e,exit:Se,join:Ce,merge:De,order:je,sort:Ne,call:Te,nodes:ze,node:Re,size:Pe,empty:Le,each:Be,attr:Ye,style:Je,property:nt,classed:st,text:vt,html:bt,raise:_t,lower:kt,append:Ot,insert:Et,remove:St,clone:jt,datum:Nt,on:Ut,dispatch:Yt};var Zt=Xt;var Jt=function(e){return typeof e==="string"?new Vt([[document.querySelector(e)]],[document.documentElement]):new Vt([[e]],$t)};var Qt=function(e){return Jt(se(e).call(document.documentElement))};var Kt=0;function en(){return new tn}function tn(){this._="@"+(++Kt).toString(36)}tn.prototype=en.prototype={constructor:tn,get:function(e){var t=this._;while(!(t in e))if(!(e=e.parentNode))return;return e[t]},set:function(e,t){return e[this._]=t},remove:function(e){return this._ in e&&delete e[this._]},toString:function(){return this._}};var nn=function(){var e=Tt,t;while(t=e.sourceEvent)e=t;return e};var rn=function(e,t){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var r=n.createSVGPoint();r.x=t.clientX,r.y=t.clientY;r=r.matrixTransform(e.getScreenCTM().inverse());return[r.x,r.y]}var i=e.getBoundingClientRect();return[t.clientX-i.left-e.clientLeft,t.clientY-i.top-e.clientTop]};var an=function(e){var t=nn();if(t.changedTouches)t=t.changedTouches[0];return rn(e,t)};var un=function(e){return typeof e==="string"?new Vt([document.querySelectorAll(e)],[document.documentElement]):new Vt([e==null?[]:e],$t)};var on=function(e,t,n){if(arguments.length<3)n=t,t=nn().changedTouches;for(var r=0,i=t?t.length:0,a;r<i;++r){if((a=t[r]).identifier===n){return rn(e,a)}}return null};var fn=function(e,t){if(t==null)t=nn().touches;for(var n=0,r=t?t.length:0,i=new Array(r);n<r;++n){i[n]=rn(e,t[n])}return i};var cn=n("ZYJ9");var ln=n.n(cn);var sn=n("jWEn");var dn=n("J29t");function hn(e){var t=e||dn["w"],n=[],r={};n.add=function(e){var i=t(e);if(!r[i]){r[i]=1;n.push(e)}return n};n.remove=function(e){var i=t(e),a;if(r[i]){r[i]=0;if((a=n.indexOf(e))>=0){n.splice(a,1)}}return n};return n}var pn=Symbol("vega_id"),vn=1;function gn(){vn=1}function mn(e){return!!(e&&yn(e))}function yn(e){return e[pn]}function bn(e,t){e[pn]=t;return e}function xn(e){var t=e===Object(e)?e:{data:e};return yn(t)?t:bn(t,vn++)}function _n(e){return wn(e,xn({}))}function wn(e,t){for(var n in e)t[n]=e[n];return t}function kn(e,t){return bn(t,yn(e))}function On(e){return e&&e.constructor===An}function An(){var e=[],t=[],n=[],r=[],i=[],a=false;return{constructor:An,insert:function(t){var n=Object(dn["i"])(t),r=0,i=n.length;for(;r<i;++r)e.push(n[r]);return this},remove:function(e){var n=Object(dn["C"])(e)?r:t,i=Object(dn["i"])(e),a=0,u=i.length;for(;a<u;++a)n.push(i[a]);return this},modify:function(e,t,r){var a={field:t,value:Object(dn["l"])(r)};if(Object(dn["C"])(e)){a.filter=e;i.push(a)}else{a.tuple=e;n.push(a)}return this},encode:function(e,t){if(Object(dn["C"])(e))i.push({filter:e,field:t});else n.push({tuple:e,field:t});return this},reflow:function(){a=true;return this},pulse:function(u,o){var f={},c={},l,s,d,h,p,v;for(l=0,s=o.length;l<s;++l){f[yn(o[l])]=1}for(l=0,s=t.length;l<s;++l){p=t[l];f[yn(p)]=-1}for(l=0,s=r.length;l<s;++l){h=r[l];o.forEach(function(e){if(h(e))f[yn(e)]=-1})}for(l=0,s=e.length;l<s;++l){p=e[l];v=yn(p);if(f[v]){f[v]=1}else{u.add.push(xn(e[l]))}}for(l=0,s=o.length;l<s;++l){p=o[l];if(f[yn(p)]<0)u.rem.push(p)}function g(e,t,n){if(n){e[t]=n(e)}else{u.encode=t}if(!a)c[yn(e)]=e}for(l=0,s=n.length;l<s;++l){d=n[l];p=d.tuple;h=d.field;v=f[yn(p)];if(v>0){g(p,h,d.value);u.modifies(h)}}for(l=0,s=i.length;l<s;++l){d=i[l];h=d.filter;o.forEach(function(e){if(h(e)&&f[yn(e)]>0){g(e,d.field,d.value)}});u.modifies(d.field)}if(a){u.mod=t.length||r.length?o.filter(function(e){return f[yn(e)]>0}):o.slice()}else{for(v in c)u.mod.push(c[v])}return u}}}var En="_:mod:_";function Mn(){Object.defineProperty(this,En,{writable:true,value:{}})}var Sn=Mn.prototype;Sn.set=function(e,t,n,r){var i=this,a=i[e],u=i[En];if(t!=null&&t>=0){if(a[t]!==n||r){a[t]=n;u[t+":"+e]=-1;u[e]=-1}}else if(a!==n||r){i[e]=n;u[e]=Object(dn["z"])(n)?1+n.length:-1}return i};Sn.modified=function(e,t){var n=this[En],r;if(!arguments.length){for(r in n){if(n[r])return true}return false}else if(Object(dn["z"])(e)){for(r=0;r<e.length;++r){if(n[e[r]])return true}return false}return t!=null&&t>=0?t+1<n[e]||!!n[t+":"+e]:!!n[e]};Sn.clear=function(){this[En]={};return this};var Cn=0;var Dn="pulse";var jn=new Mn;var Nn=1,Fn=2;function Tn(e,t,n,r){this.id=++Cn;this.value=e;this.stamp=-1;this.rank=-1;this.qrank=-1;this.flags=0;if(t){this._update=t}if(n)this.parameters(n,r)}var zn=Tn.prototype;zn.targets=function(){return this._targets||(this._targets=hn(dn["v"]))};zn.set=function(e){if(this.value!==e){this.value=e;return 1}else{return 0}};function Rn(e){return function(t){var n=this.flags;if(arguments.length===0)return!!(n&e);this.flags=t?n|e:n&~e;return this}}zn.skip=Rn(Nn);zn.modified=Rn(Fn);zn.parameters=function(e,t,n){t=t!==false;var r=this,i=r._argval=r._argval||new Mn,a=r._argops=r._argops||[],u=[],o,f,c,l;function s(e,n,o){if(o instanceof Tn){if(o!==r){if(t)o.targets().add(r);u.push(o)}a.push({op:o,name:e,index:n})}else{i.set(e,n,o)}}for(o in e){f=e[o];if(o===Dn){Object(dn["i"])(f).forEach(function(e){if(!(e instanceof Tn)){Object(dn["n"])("Pulse parameters must be operator instances.")}else if(e!==r){e.targets().add(r);u.push(e)}});r.source=f}else if(Object(dn["z"])(f)){i.set(o,-1,Array(c=f.length));for(l=0;l<c;++l)s(o,l,f[l])}else{s(o,-1,f)}}this.marshall().clear();if(n)a.initonly=true;return u};zn.marshall=function(e){var t=this._argval||jn,n=this._argops,r,i,a,u,o;if(n){for(i=0,a=n.length;i<a;++i){r=n[i];u=r.op;o=u.modified()&&u.stamp===e;t.set(r.name,r.index,u.value,o)}if(n.initonly){for(i=0;i<a;++i){r=n[i];r.op.targets().remove(this)}this._argops=null;this._update=null}}return t};zn.evaluate=function(e){var t=this._update;if(t){var n=this.marshall(e.stamp),r=t.call(this,n,e);n.clear();if(r!==this.value){this.value=r}else if(!this.modified()){return e.StopPropagation}}};zn.run=function(e){if(e.stamp<=this.stamp)return e.StopPropagation;var t;if(this.skip()){this.skip(false);t=0}else{t=this.evaluate(e)}this.stamp=e.stamp;return this.pulse=t||e};var Pn=function(e,t,n,r){var i=1,a;if(e instanceof Tn){a=e}else if(e&&e.prototype instanceof Tn){a=new e}else if(Object(dn["C"])(e)){a=new Tn(null,e)}else{i=0;a=new Tn(e,t)}this.rank(a);if(i){r=n;n=t}if(n)this.connect(a,a.parameters(n,r));this.touch(a);return a};var Ln=function(e,t){var n=e.rank,r,i;for(r=0,i=t.length;r<i;++r){if(n<t[r].rank){this.rerank(e);return}}};var Bn=0;function In(e,t,n){this.id=++Bn;this.value=null;if(n)this.receive=n;if(e)this._filter=e;if(t)this._apply=t}function Un(e,t,n){return new In(e,t,n)}var qn=In.prototype;qn._filter=dn["db"];qn._apply=dn["w"];qn.targets=function(){return this._targets||(this._targets=hn(dn["v"]))};qn.consume=function(e){if(!arguments.length)return!!this._consume;this._consume=!!e;return this};qn.receive=function(e){if(this._filter(e)){var t=this.value=this._apply(e),n=this._targets,r=n?n.length:0,i=0;for(;i<r;++i)n[i].receive(t);if(this._consume){e.preventDefault();e.stopPropagation()}}};qn.filter=function(e){var t=Un(e);this.targets().add(t);return t};qn.apply=function(e){var t=Un(null,e);this.targets().add(t);return t};qn.merge=function(){var e=Un();this.targets().add(e);for(var t=0,n=arguments.length;t<n;++t){arguments[t].targets().add(e)}return e};qn.throttle=function(e){var t=-1;return this.filter(function(){var n=Date.now();if(n-t>e){t=n;return 1}else{return 0}})};qn.debounce=function(e){var t=Un();this.targets().add(Un(null,null,Object(dn["m"])(e,function(e){var n=e.dataflow;t.receive(e);if(n&&n.run)n.run()})));return t};qn.between=function(e,t){var n=false;e.targets().add(Un(null,null,function(){n=true}));t.targets().add(Un(null,null,function(){n=false}));return this.filter(function(){return n})};var Wn=function(e,t,n,r){var i=this,a=Un(n,r),u=function(e){e.dataflow=i;try{a.receive(e)}catch(e){i.error(e)}finally{i.run()}},o;if(typeof e==="string"&&typeof document!=="undefined"){o=document.querySelectorAll(e)}else{o=Object(dn["i"])(e)}for(var f=0,c=o.length;f<c;++f){o[f].addEventListener(t,u)}return a};var Hn=/^([A-Za-z]+:)?\/\//;var Gn="file://";var Yn=function(e){return{options:e||{},sanitize:Vn,load:$n,file:Zn,http:Xn}};function $n(e,t){var n=this;return n.sanitize(e,t).then(function(e){var r=e.href;return e.localFile?n.file(r):n.http(r,t)})}function Vn(e,t){t=Object(dn["o"])({},this.options,t);return new Promise(function(n,r){var i={href:null},a,u,o,f;if(e==null||typeof e!=="string"){r("Sanitize failure, invalid URI: "+Object(dn["W"])(e));return}u=Hn.test(e);if((f=t.baseURL)&&!u){if(!Kn(e,"/")&&f[f.length-1]!=="/"){e="/"+e}e=f+e}o=(a=Kn(e,Gn))||t.mode==="file"||t.mode!=="http"&&!u&&Qn();if(a){e=e.slice(Gn.length)}else if(Kn(e,"//")){if(t.defaultProtocol==="file"){e=e.slice(2);o=true}else{e=(t.defaultProtocol||"http")+":"+e}}Object.defineProperty(i,"localFile",{value:!!o});i.href=e;if(t.target){i.target=t.target+""}n(i)})}function Xn(e,t){return Jn(e,Object(dn["o"])({},this.options.http,t)).then(function(e){if(!e.ok)throw e.status+""+e.statusText;return e.text()})}function Zn(e){return new Promise(function(t,n){var r=Qn();r?r.readFile(e,function(e,r){if(e)n(e);else t(r)}):n("No file system access for "+e)})}function Jn(e,t){var r=typeof fetch==="function"?fetch:n(11);return r?r(e,t):Promise.reject("No fetch method available.")}function Qn(){var e="function"==="function"&&n(10);return e&&Object(dn["C"])(e.readFile)?e:null}function Kn(e,t){return e==null?false:e.lastIndexOf(t,0)===0}var er={boolean:dn["X"],integer:dn["Z"],number:dn["Z"],date:dn["Y"],string:dn["bb"],unknown:dn["w"]};var tr=[ur,cr,fr,or];var nr=["boolean","integer","number","date"];function rr(e,t){if(!e||!e.length)return"unknown";var n,r,i,a=0,u=e.length,o=tr.length,f=tr.map(function(e,t){return t+1});for(r=0,u=e.length;r<u;++r){n=t?e[r][t]:e[r];for(i=0;i<o;++i){if(f[i]&&ar(n)&&!tr[i](n)){f[i]=0;++a;if(a===tr.length)return"string"}}}a=f.reduce(function(e,t){return e===0?t:e},0)-1;return nr[a]}function ir(e,t){return t.reduce(function(t,n){t[n]=rr(e,n);return t},{})}function ar(e){return e!=null&&e===e}function ur(e){return e==="true"||e==="false"||e===true||e===false}function or(e){return!isNaN(Date.parse(e))}function fr(e){return!isNaN(+e)&&!(e instanceof Date)}function cr(e){return fr(e)&&(e=+e)===~~e}var lr={},sr={},dr=34,hr=10,pr=13;function vr(e){return new Function("d","return {"+e.map(function(e,t){return JSON.stringify(e)+": d["+t+"]"}).join(",")+"}")}function gr(e,t){var n=vr(e);return function(r,i){return t(n(r),i,e)}}function mr(e){var t=Object.create(null),n=[];e.forEach(function(e){for(var r in e){if(!(r in t)){n.push(t[r]=r)}}});return n}function yr(e,t){var n=e+"",r=n.length;return r<t?new Array(t-r+1).join(0)+n:n}function br(e){return e<0?"-"+yr(-e,6):e>9999?"+"+yr(e,6):yr(e,4)}function xr(e){var t=e.getUTCHours(),n=e.getUTCMinutes(),r=e.getUTCSeconds(),i=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":br(e.getUTCFullYear(),4)+"-"+yr(e.getUTCMonth()+1,2)+"-"+yr(e.getUTCDate(),2)+(i?"T"+yr(t,2)+":"+yr(n,2)+":"+yr(r,2)+"."+yr(i,3)+"Z":r?"T"+yr(t,2)+":"+yr(n,2)+":"+yr(r,2)+"Z":n||t?"T"+yr(t,2)+":"+yr(n,2)+"Z":"")}var _r=function(e){var t=new RegExp('["'+e+"\n\r]"),n=e.charCodeAt(0);function r(e,t){var n,r,a=i(e,function(e,i){if(n)return n(e,i-1);r=e,n=t?gr(e,t):vr(e)});a.columns=r||[];return a}function i(e,t){var r=[],i=e.length,a=0,u=0,o,f=i<=0,c=false;if(e.charCodeAt(i-1)===hr)--i;if(e.charCodeAt(i-1)===pr)--i;function l(){if(f)return sr;if(c)return c=false,lr;var t,r=a,u;if(e.charCodeAt(r)===dr){while(a++<i&&e.charCodeAt(a)!==dr||e.charCodeAt(++a)===dr);if((t=a)>=i)f=true;else if((u=e.charCodeAt(a++))===hr)c=true;else if(u===pr){c=true;if(e.charCodeAt(a)===hr)++a}return e.slice(r+1,t-1).replace(/""/g,'"')}while(a<i){if((u=e.charCodeAt(t=a++))===hr)c=true;else if(u===pr){c=true;if(e.charCodeAt(a)===hr)++a}else if(u!==n)continue;return e.slice(r,t)}return f=true,e.slice(r,i)}while((o=l())!==sr){var s=[];while(o!==lr&&o!==sr)s.push(o),o=l();if(t&&(s=t(s,u++))==null)continue;r.push(s)}return r}function a(t,n){return t.map(function(t){return n.map(function(e){return l(t[e])}).join(e)})}function u(t,n){if(n==null)n=mr(t);return[n.map(l).join(e)].concat(a(t,n)).join("\n")}function o(e,t){if(t==null)t=mr(e);return a(e,t).join("\n")}function f(e){return e.map(c).join("\n")}function c(t){return t.map(l).join(e)}function l(e){return e==null?"":e instanceof Date?xr(e):t.test(e+="")?'"'+e.replace(/"/g,'""')+'"':e}return{parse:r,parseRows:i,format:u,formatBody:o,formatRows:f}};var wr=_r(",");var kr=wr.parse;var Or=wr.parseRows;var Ar=wr.format;var Er=wr.formatBody;var Mr=wr.formatRows;var Sr=_r("\t");var Cr=Sr.parse;var Dr=Sr.parseRows;var jr=Sr.format;var Nr=Sr.formatBody;var Fr=Sr.formatRows;function Tr(e){for(var t in e){var n=e[t].trim(),r;if(!n)n=null;else if(n==="true")n=true;else if(n==="false")n=false;else if(n==="NaN")n=NaN;else if(!isNaN(r=+n))n=r;else if(/^([-+]\d{2})?\d{4}(-\d{2}(-\d{2})?)?(T\d{2}:\d{2}(:\d{2}(\.\d{3})?)?(Z|[-+]\d{2}:\d{2})?)?$/.test(n))n=new Date(n);else continue;e[t]=n}return e}function zr(e){return function(t,n){var r={delimiter:e};return Rr(t,n?Object(dn["o"])(n,r):r)}}function Rr(e,t){if(t.header){e=t.header.map(dn["W"]).join(t.delimiter)+"\n"+e}return _r(t.delimiter).parse(e+"")}var Pr=n("mw3f");var Lr=function(e){return e};var Br=function(e){if(e==null)return Lr;var t,n,r=e.scale[0],i=e.scale[1],a=e.translate[0],u=e.translate[1];return function(e,o){if(!o)t=n=0;var f=2,c=e.length,l=new Array(c);l[0]=(t+=e[0])*r+a;l[1]=(n+=e[1])*i+u;while(f<c)l[f]=e[f],++f;return l}};var Ir=function(e){var t=Br(e.transform),n,r=Infinity,i=r,a=-r,u=-r;function o(e){e=t(e);if(e[0]<r)r=e[0];if(e[0]>a)a=e[0];if(e[1]<i)i=e[1];if(e[1]>u)u=e[1]}function f(e){switch(e.type){case"GeometryCollection":e.geometries.forEach(f);break;case"Point":o(e.coordinates);break;case"MultiPoint":e.coordinates.forEach(o);break}}e.arcs.forEach(function(e){var n=-1,o=e.length,f;while(++n<o){f=t(e[n],n);if(f[0]<r)r=f[0];if(f[0]>a)a=f[0];if(f[1]<i)i=f[1];if(f[1]>u)u=f[1]}});for(n in e.objects){f(e.objects[n])}return[r,i,a,u]};var Ur=function(e,t){var n,r=e.length,i=r-t;while(i<--r)n=e[i],e[i++]=e[r],e[r]=n};var qr=function(e,t){return t.type==="GeometryCollection"?{type:"FeatureCollection",features:t.geometries.map(function(t){return Wr(e,t)})}:Wr(e,t)};function Wr(e,t){var n=t.id,r=t.bbox,i=t.properties==null?{}:t.properties,a=Hr(e,t);return n==null&&r==null?{type:"Feature",properties:i,geometry:a}:r==null?{type:"Feature",id:n,properties:i,geometry:a}:{type:"Feature",id:n,bbox:r,properties:i,geometry:a}}function Hr(e,t){var n=Br(e.transform),r=e.arcs;function i(e,t){if(t.length)t.pop();for(var i=r[e<0?~e:e],a=0,u=i.length;a<u;++a){t.push(n(i[a],a))}if(e<0)Ur(t,u)}function a(e){return n(e)}function u(e){var t=[];for(var n=0,r=e.length;n<r;++n)i(e[n],t);if(t.length<2)t.push(t[0]);return t}function o(e){var t=u(e);while(t.length<4)t.push(t[0]);return t}function f(e){return e.map(o)}function c(e){var t=e.type,n;switch(t){case"GeometryCollection":return{type:t,geometries:e.geometries.map(c)};case"Point":n=a(e.coordinates);break;case"MultiPoint":n=e.coordinates.map(a);break;case"LineString":n=u(e.arcs);break;case"MultiLineString":n=e.arcs.map(u);break;case"Polygon":n=f(e.arcs);break;case"MultiPolygon":n=e.arcs.map(f);break;default:return null}return{type:t,coordinates:n}}return c(t)}var Gr=function(e,t){var n={},r={},i={},a=[],u=-1;t.forEach(function(n,r){var i=e.arcs[n<0?~n:n],a;if(i.length<3&&!i[1][0]&&!i[1][1]){a=t[++u],t[u]=n,t[r]=a}});t.forEach(function(e){var t=o(e),n=t[0],a=t[1],u,f;if(u=i[n]){delete i[u.end];u.push(e);u.end=a;if(f=r[a]){delete r[f.start];var c=f===u?u:u.concat(f);r[c.start=u.start]=i[c.end=f.end]=c}else{r[u.start]=i[u.end]=u}}else if(u=r[a]){delete r[u.start];u.unshift(e);u.start=n;if(f=i[n]){delete i[f.end];var l=f===u?u:f.concat(u);r[l.start=f.start]=i[l.end=u.end]=l}else{r[u.start]=i[u.end]=u}}else{u=[e];r[u.start=n]=i[u.end=a]=u}});function o(t){var n=e.arcs[t<0?~t:t],r=n[0],i;if(e.transform)i=[0,0],n.forEach(function(e){i[0]+=e[0],i[1]+=e[1]});else i=n[n.length-1];return t<0?[i,r]:[r,i]}function f(e,t){for(var r in e){var i=e[r];delete t[i.start];delete i.start;delete i.end;i.forEach(function(e){n[e<0?~e:e]=1});a.push(i)}}f(i,r);f(r,i);t.forEach(function(e){if(!n[e<0?~e:e])a.push([e])});return a};var Yr=function(e){return Hr(e,$r.apply(this,arguments))};function $r(e,t,n){var r,i,a;if(arguments.length>1)r=Vr(e,t,n);else for(i=0,r=new Array(a=e.arcs.length);i<a;++i)r[i]=i;return{type:"MultiLineString",arcs:Gr(e,r)}}function Vr(e,t,n){var r=[],i=[],a;function u(e){var t=e<0?~e:e;(i[t]||(i[t]=[])).push({i:e,g:a})}function o(e){e.forEach(u)}function f(e){e.forEach(o)}function c(e){e.forEach(f)}function l(e){switch(a=e,e.type){case"GeometryCollection":e.geometries.forEach(l);break;case"LineString":o(e.arcs);break;case"MultiLineString":case"Polygon":f(e.arcs);break;case"MultiPolygon":c(e.arcs);break}}l(t);i.forEach(n==null?function(e){r.push(e[0].i)}:function(e){if(n(e[0].g,e[e.length-1].g))r.push(e[0].i)});return r}function Xr(e){var t=-1,n=e.length,r,i=e[n-1],a=0;while(++t<n)r=i,i=e[t],a+=r[0]*i[1]-r[1]*i[0];return Math.abs(a)}var Zr=function(e){return Hr(e,Jr.apply(this,arguments))};function Jr(e,t){var n={},r=[],i=[];t.forEach(a);function a(e){switch(e.type){case"GeometryCollection":e.geometries.forEach(a);break;case"Polygon":u(e.arcs);break;case"MultiPolygon":e.arcs.forEach(u);break}}function u(e){e.forEach(function(t){t.forEach(function(t){(n[t=t<0?~t:t]||(n[t]=[])).push(e)})});r.push(e)}function o(t){return Xr(Hr(e,{type:"Polygon",arcs:[t]}).coordinates[0])}r.forEach(function(e){if(!e._){var t=[],r=[e];e._=1;i.push(t);while(e=r.pop()){t.push(e);e.forEach(function(e){e.forEach(function(e){n[e<0?~e:e].forEach(function(e){if(!e._){e._=1;r.push(e)}})})})}}});r.forEach(function(e){delete e._});return{type:"MultiPolygon",arcs:i.map(function(t){var r=[],i;t.forEach(function(e){e.forEach(function(e){e.forEach(function(e){if(n[e<0?~e:e].length<2){r.push(e)}})})});r=Gr(e,r);if((i=r.length)>1){for(var a=1,u=o(r[0]),f,c;a<i;++a){if((f=o(r[a]))>u){c=r[0],r[0]=r[a],r[a]=c,u=f}}}return r})}}var Qr=function(e,t){var n=0,r=e.length;while(n<r){var i=n+r>>>1;if(e[i]<t)n=i+1;else r=i}return n};var Kr=function(e){var t={},n=e.map(function(){return[]});function r(e,n){e.forEach(function(e){if(e<0)e=~e;var r=t[e];if(r)r.push(n);else t[e]=[n]})}function i(e,t){e.forEach(function(e){r(e,t)})}function a(e,t){if(e.type==="GeometryCollection")e.geometries.forEach(function(e){a(e,t)});else if(e.type in u)u[e.type](e.arcs,t)}var u={LineString:r,MultiLineString:i,Polygon:i,MultiPolygon:function(e,t){e.forEach(function(e){i(e,t)})}};e.forEach(a);for(var o in t){for(var f=t[o],c=f.length,l=0;l<c;++l){for(var s=l+1;s<c;++s){var d=f[l],h=f[s],p;if((p=n[d])[o=Qr(p,h)]!==h)p.splice(o,0,h);if((p=n[h])[o=Qr(p,d)]!==d)p.splice(o,0,d)}}}return n};var ei=function(e){if(e==null)return Lr;var t,n,r=e.scale[0],i=e.scale[1],a=e.translate[0],u=e.translate[1];return function(e,o){if(!o)t=n=0;var f=2,c=e.length,l=new Array(c),s=Math.round((e[0]-a)/r),d=Math.round((e[1]-u)/i);l[0]=s-t,t=s;l[1]=d-n,n=d;while(f<c)l[f]=e[f],++f;return l}};var ti=function(e,t){if(e.transform)throw new Error("already quantized");if(!t||!t.scale){if(!((u=Math.floor(t))>=2))throw new Error("n must be â‰¥2");f=e.bbox||Ir(e);var n=f[0],r=f[1],i=f[2],a=f[3],u;t={scale:[i-n?(i-n)/(u-1):1,a-r?(a-r)/(u-1):1],translate:[n,r]}}else{f=e.bbox}var o=ei(t),f,c,l=e.objects,s={};function d(e){return o(e)}function h(e){var t;switch(e.type){case"GeometryCollection":t={type:"GeometryCollection",geometries:e.geometries.map(h)};break;case"Point":t={type:"Point",coordinates:d(e.coordinates)};break;case"MultiPoint":t={type:"MultiPoint",coordinates:e.coordinates.map(d)};break;default:return e}if(e.id!=null)t.id=e.id;if(e.bbox!=null)t.bbox=e.bbox;if(e.properties!=null)t.properties=e.properties;return t}function p(e){var t=0,n=1,r=e.length,i,a=new Array(r);a[0]=o(e[0],0);while(++t<r)if((i=o(e[t],t))[0]||i[1])a[n++]=i;if(n===1)a[n++]=[0,0];a.length=n;return a}for(c in l)s[c]=h(l[c]);return{type:"Topology",bbox:f,transform:t,objects:s,arcs:e.arcs.map(p)}};var ni=function(e,t){var n,r,i;e=Object(Pr["a"])(e,t);n=t&&(i=t.feature)?qr:t&&(i=t.mesh)?Yr:Object(dn["n"])("Missing TopoJSON feature or mesh parameter.");r=(r=e.objects[i])?n(e,r):Object(dn["n"])("Invalid TopoJSON object: "+i);return r&&r.features||[r]};var ri={dsv:Rr,csv:zr(","),tsv:zr("\t"),json:Pr["a"],topojson:ni};function ii(e,t){if(arguments.length>1){ri[e]=t;return this}else{return ri.hasOwnProperty(e)?ri[e]:null}}var ai=new Date,ui=new Date;function oi(e,t,n,r){function i(t){return e(t=new Date(+t)),t}i.floor=i;i.ceil=function(n){return e(n=new Date(n-1)),t(n,1),e(n),n};i.round=function(e){var t=i(e),n=i.ceil(e);return e-t<n-e?t:n};i.offset=function(e,n){return t(e=new Date(+e),n==null?1:Math.floor(n)),e};i.range=function(n,r,a){var u=[],o;n=i.ceil(n);a=a==null?1:Math.floor(a);if(!(n<r)||!(a>0))return u;do{u.push(o=new Date(+n)),t(n,a),e(n)}while(o<n&&n<r);return u};i.filter=function(n){return oi(function(t){if(t>=t)while(e(t),!n(t))t.setTime(t-1)},function(e,r){if(e>=e){if(r<0)while(++r<=0){while(t(e,-1),!n(e)){}}else while(--r>=0){while(t(e,+1),!n(e)){}}}})};if(n){i.count=function(t,r){ai.setTime(+t),ui.setTime(+r);e(ai),e(ui);return Math.floor(n(ai,ui))};i.every=function(e){e=Math.floor(e);return!isFinite(e)||!(e>0)?null:!(e>1)?i:i.filter(r?function(t){return r(t)%e===0}:function(t){return i.count(0,t)%e===0})}}return i}var fi=oi(function(){},function(e,t){e.setTime(+e+t)},function(e,t){return t-e});fi.every=function(e){e=Math.floor(e);if(!isFinite(e)||!(e>0))return null;if(!(e>1))return fi;return oi(function(t){t.setTime(Math.floor(t/e)*e)},function(t,n){t.setTime(+t+n*e)},function(t,n){return(n-t)/e})};var ci=fi;var li=fi.range;var si=1e3;var di=6e4;var hi=36e5;var pi=864e5;var vi=6048e5;var gi=oi(function(e){e.setTime(e-e.getMilliseconds())},function(e,t){e.setTime(+e+t*si)},function(e,t){return(t-e)/si},function(e){return e.getUTCSeconds()});var mi=gi;var yi=gi.range;var bi=oi(function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*si)},function(e,t){e.setTime(+e+t*di)},function(e,t){return(t-e)/di},function(e){return e.getMinutes()});var xi=bi;var _i=bi.range;var wi=oi(function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*si-e.getMinutes()*di)},function(e,t){e.setTime(+e+t*hi)},function(e,t){return(t-e)/hi},function(e){return e.getHours()});var ki=wi;var Oi=wi.range;var Ai=oi(function(e){e.setHours(0,0,0,0)},function(e,t){e.setDate(e.getDate()+t)},function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*di)/pi},function(e){return e.getDate()-1});var Ei=Ai;var Mi=Ai.range;function Si(e){return oi(function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7);t.setHours(0,0,0,0)},function(e,t){e.setDate(e.getDate()+t*7)},function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*di)/vi})}var Ci=Si(0);var Di=Si(1);var ji=Si(2);var Ni=Si(3);var Fi=Si(4);var Ti=Si(5);var zi=Si(6);var Ri=Ci.range;var Pi=Di.range;var Li=ji.range;var Bi=Ni.range;var Ii=Fi.range;var Ui=Ti.range;var qi=zi.range;var Wi=oi(function(e){e.setDate(1);e.setHours(0,0,0,0)},function(e,t){e.setMonth(e.getMonth()+t)},function(e,t){return t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12},function(e){return e.getMonth()});var Hi=Wi;var Gi=Wi.range;var Yi=oi(function(e){e.setMonth(0,1);e.setHours(0,0,0,0)},function(e,t){e.setFullYear(e.getFullYear()+t)},function(e,t){return t.getFullYear()-e.getFullYear()},function(e){return e.getFullYear()});Yi.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:oi(function(t){t.setFullYear(Math.floor(t.getFullYear()/e)*e);t.setMonth(0,1);t.setHours(0,0,0,0)},function(t,n){t.setFullYear(t.getFullYear()+n*e)})};var $i=Yi;var Vi=Yi.range;var Xi=oi(function(e){e.setUTCSeconds(0,0)},function(e,t){e.setTime(+e+t*di)},function(e,t){return(t-e)/di},function(e){return e.getUTCMinutes()});var Zi=Xi;var Ji=Xi.range;var Qi=oi(function(e){e.setUTCMinutes(0,0,0)},function(e,t){e.setTime(+e+t*hi)},function(e,t){return(t-e)/hi},function(e){return e.getUTCHours()});var Ki=Qi;var ea=Qi.range;var ta=oi(function(e){e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+t)},function(e,t){return(t-e)/pi},function(e){return e.getUTCDate()-1});var na=ta;var ra=ta.range;function ia(e){return oi(function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7);t.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+t*7)},function(e,t){return(t-e)/vi})}var aa=ia(0);var ua=ia(1);var oa=ia(2);var fa=ia(3);var ca=ia(4);var la=ia(5);var sa=ia(6);var da=aa.range;var ha=ua.range;var pa=oa.range;var va=fa.range;var ga=ca.range;var ma=la.range;var ya=sa.range;var ba=oi(function(e){e.setUTCDate(1);e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCMonth(e.getUTCMonth()+t)},function(e,t){return t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12},function(e){return e.getUTCMonth()});var xa=ba;var _a=ba.range;var wa=oi(function(e){e.setUTCMonth(0,1);e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)},function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()},function(e){return e.getUTCFullYear()});wa.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:oi(function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e);t.setUTCMonth(0,1);t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCFullYear(t.getUTCFullYear()+n*e)})};var ka=wa;var Oa=wa.range;function Aa(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);t.setFullYear(e.y);return t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function Ea(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));t.setUTCFullYear(e.y);return t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Ma(e){return{y:e,m:0,d:1,H:0,M:0,S:0,L:0}}function Sa(e){var t=e.dateTime,n=e.date,r=e.time,i=e.periods,a=e.days,u=e.shortDays,o=e.months,f=e.shortMonths;var c=za(i),l=Ra(i),s=za(a),d=Ra(a),h=za(u),p=Ra(u),v=za(o),g=Ra(o),m=za(f),y=Ra(f);var b={a:F,A:T,b:z,B:R,c:null,d:nu,e:nu,f:ou,H:ru,I:iu,j:au,L:uu,m:fu,M:cu,p:P,Q:Pu,s:Lu,S:lu,u:su,U:du,V:hu,w:pu,W:vu,x:null,X:null,y:gu,Y:mu,Z:yu,"%":Ru};var x={a:L,A:B,b:I,B:U,c:null,d:bu,e:bu,f:Ou,H:xu,I:_u,j:wu,L:ku,m:Au,M:Eu,p:q,Q:Pu,s:Lu,S:Mu,u:Su,U:Cu,V:Du,w:ju,W:Nu,x:null,X:null,y:Fu,Y:Tu,Z:zu,"%":Ru};var _={a:E,A:M,b:S,B:C,c:D,d:Ya,e:Ya,f:Qa,H:Va,I:Va,j:$a,L:Ja,m:Ga,M:Xa,p:A,Q:eu,s:tu,S:Za,u:La,U:Ba,V:Ia,w:Pa,W:Ua,x:j,X:N,y:Wa,Y:qa,Z:Ha,"%":Ka};b.x=w(n,b);b.X=w(r,b);b.c=w(t,b);x.x=w(n,x);x.X=w(r,x);x.c=w(t,x);function w(e,t){return function(n){var r=[],i=-1,a=0,u=e.length,o,f,c;if(!(n instanceof Date))n=new Date(+n);while(++i<u){if(e.charCodeAt(i)===37){r.push(e.slice(a,i));if((f=Ca[o=e.charAt(++i)])!=null)o=e.charAt(++i);else f=o==="e"?" ":"0";if(c=t[o])o=c(n,f);r.push(o);a=i+1}}r.push(e.slice(a,i));return r.join("")}}function k(e,t){return function(n){var r=Ma(1900),i=O(r,e,n+="",0),a,u;if(i!=n.length)return null;if("Q"in r)return new Date(r.Q);if("p"in r)r.H=r.H%12+r.p*12;if("V"in r){if(r.V<1||r.V>53)return null;if(!("w"in r))r.w=1;if("Z"in r){a=Ea(Ma(r.y)),u=a.getUTCDay();a=u>4||u===0?ua.ceil(a):ua(a);a=na.offset(a,(r.V-1)*7);r.y=a.getUTCFullYear();r.m=a.getUTCMonth();r.d=a.getUTCDate()+(r.w+6)%7}else{a=t(Ma(r.y)),u=a.getDay();a=u>4||u===0?Di.ceil(a):Di(a);a=Ei.offset(a,(r.V-1)*7);r.y=a.getFullYear();r.m=a.getMonth();r.d=a.getDate()+(r.w+6)%7}}else if("W"in r||"U"in r){if(!("w"in r))r.w="u"in r?r.u%7:"W"in r?1:0;u="Z"in r?Ea(Ma(r.y)).getUTCDay():t(Ma(r.y)).getDay();r.m=0;r.d="W"in r?(r.w+6)%7+r.W*7-(u+5)%7:r.w+r.U*7-(u+6)%7}if("Z"in r){r.H+=r.Z/100|0;r.M+=r.Z%100;return Ea(r)}return t(r)}}function O(e,t,n,r){var i=0,a=t.length,u=n.length,o,f;while(i<a){if(r>=u)return-1;o=t.charCodeAt(i++);if(o===37){o=t.charAt(i++);f=_[o in Ca?t.charAt(i++):o];if(!f||(r=f(e,n,r))<0)return-1}else if(o!=n.charCodeAt(r++)){return-1}}return r}function A(e,t,n){var r=c.exec(t.slice(n));return r?(e.p=l[r[0].toLowerCase()],n+r[0].length):-1}function E(e,t,n){var r=h.exec(t.slice(n));return r?(e.w=p[r[0].toLowerCase()],n+r[0].length):-1}function M(e,t,n){var r=s.exec(t.slice(n));return r?(e.w=d[r[0].toLowerCase()],n+r[0].length):-1}function S(e,t,n){var r=m.exec(t.slice(n));return r?(e.m=y[r[0].toLowerCase()],n+r[0].length):-1}function C(e,t,n){var r=v.exec(t.slice(n));return r?(e.m=g[r[0].toLowerCase()],n+r[0].length):-1}function D(e,n,r){return O(e,t,n,r)}function j(e,t,r){return O(e,n,t,r)}function N(e,t,n){return O(e,r,t,n)}function F(e){return u[e.getDay()]}function T(e){return a[e.getDay()]}function z(e){return f[e.getMonth()]}function R(e){return o[e.getMonth()]}function P(e){return i[+(e.getHours()>=12)]}function L(e){return u[e.getUTCDay()]}function B(e){return a[e.getUTCDay()]}function I(e){return f[e.getUTCMonth()]}function U(e){return o[e.getUTCMonth()]}function q(e){return i[+(e.getUTCHours()>=12)]}return{format:function(e){var t=w(e+="",b);t.toString=function(){return e};return t},parse:function(e){var t=k(e+="",Aa);t.toString=function(){return e};return t},utcFormat:function(e){var t=w(e+="",x);t.toString=function(){return e};return t},utcParse:function(e){var t=k(e,Ea);t.toString=function(){return e};return t}}}var Ca={"-":"",_:" ",0:"0"},Da=/^\s*\d+/,ja=/^%/,Na=/[\\^$*+?|[\]().{}]/g;function Fa(e,t,n){var r=e<0?"-":"",i=(r?-e:e)+"",a=i.length;return r+(a<n?new Array(n-a+1).join(t)+i:i)}function Ta(e){return e.replace(Na,"\\$&")}function za(e){return new RegExp("^(?:"+e.map(Ta).join("|")+")","i")}function Ra(e){var t={},n=-1,r=e.length;while(++n<r)t[e[n].toLowerCase()]=n;return t}function Pa(e,t,n){var r=Da.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function La(e,t,n){var r=Da.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function Ba(e,t,n){var r=Da.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function Ia(e,t,n){var r=Da.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function Ua(e,t,n){var r=Da.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function qa(e,t,n){var r=Da.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function Wa(e,t,n){var r=Da.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function Ha(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function Ga(e,t,n){var r=Da.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function Ya(e,t,n){var r=Da.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function $a(e,t,n){var r=Da.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function Va(e,t,n){var r=Da.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function Xa(e,t,n){var r=Da.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function Za(e,t,n){var r=Da.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function Ja(e,t,n){var r=Da.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function Qa(e,t,n){var r=Da.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function Ka(e,t,n){var r=ja.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function eu(e,t,n){var r=Da.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function tu(e,t,n){var r=Da.exec(t.slice(n));return r?(e.Q=+r[0]*1e3,n+r[0].length):-1}function nu(e,t){return Fa(e.getDate(),t,2)}function ru(e,t){return Fa(e.getHours(),t,2)}function iu(e,t){return Fa(e.getHours()%12||12,t,2)}function au(e,t){return Fa(1+Ei.count($i(e),e),t,3)}function uu(e,t){return Fa(e.getMilliseconds(),t,3)}function ou(e,t){return uu(e,t)+"000"}function fu(e,t){return Fa(e.getMonth()+1,t,2)}function cu(e,t){return Fa(e.getMinutes(),t,2)}function lu(e,t){return Fa(e.getSeconds(),t,2)}function su(e){var t=e.getDay();return t===0?7:t}function du(e,t){return Fa(Ci.count($i(e),e),t,2)}function hu(e,t){var n=e.getDay();e=n>=4||n===0?Fi(e):Fi.ceil(e);return Fa(Fi.count($i(e),e)+($i(e).getDay()===4),t,2)}function pu(e){return e.getDay()}function vu(e,t){return Fa(Di.count($i(e),e),t,2)}function gu(e,t){return Fa(e.getFullYear()%100,t,2)}function mu(e,t){return Fa(e.getFullYear()%1e4,t,4)}function yu(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Fa(t/60|0,"0",2)+Fa(t%60,"0",2)}function bu(e,t){return Fa(e.getUTCDate(),t,2)}function xu(e,t){return Fa(e.getUTCHours(),t,2)}function _u(e,t){return Fa(e.getUTCHours()%12||12,t,2)}function wu(e,t){return Fa(1+na.count(ka(e),e),t,3)}function ku(e,t){return Fa(e.getUTCMilliseconds(),t,3)}function Ou(e,t){return ku(e,t)+"000"}function Au(e,t){return Fa(e.getUTCMonth()+1,t,2)}function Eu(e,t){return Fa(e.getUTCMinutes(),t,2)}function Mu(e,t){return Fa(e.getUTCSeconds(),t,2)}function Su(e){var t=e.getUTCDay();return t===0?7:t}function Cu(e,t){return Fa(aa.count(ka(e),e),t,2)}function Du(e,t){var n=e.getUTCDay();e=n>=4||n===0?ca(e):ca.ceil(e);return Fa(ca.count(ka(e),e)+(ka(e).getUTCDay()===4),t,2)}function ju(e){return e.getUTCDay()}function Nu(e,t){return Fa(ua.count(ka(e),e),t,2)}function Fu(e,t){return Fa(e.getUTCFullYear()%100,t,2)}function Tu(e,t){return Fa(e.getUTCFullYear()%1e4,t,4)}function zu(){return"+0000"}function Ru(){return"%"}function Pu(e){return+e}function Lu(e){return Math.floor(+e/1e3)}var Bu;var Iu;var Uu;var qu;var Wu;Hu({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function Hu(e){Bu=Sa(e);Iu=Bu.format;Uu=Bu.parse;qu=Bu.utcFormat;Wu=Bu.utcParse;return Bu}var Gu="%Y-%m-%dT%H:%M:%S.%LZ";function Yu(e){return e.toISOString()}var $u=Date.prototype.toISOString?Yu:qu(Gu);var Vu=$u;function Xu(e){var t=new Date(e);return isNaN(t)?null:t}var Zu=+new Date("2000-01-01T00:00:00.000Z")?Xu:Wu(Gu);var Ju=Zu;var Qu=function(e,t,n){t=t||{};var r=ii(t.type||"json");if(!r)Object(dn["n"])("Unknown data format type: "+t.type);e=r(e,t);if(t.parse)Ku(e,t.parse,n);if(e.hasOwnProperty("columns"))delete e.columns;return e};function Ku(e,t,n){if(!e.length)return;n=n||Uu;var r=e.columns||Object.keys(e[0]),i,a,u,o,f,c,l;if(t==="auto")t=ir(e,r);r=Object.keys(t);i=r.map(function(e){var r=t[e],i,a;if(r&&(r.indexOf("date:")===0||r.indexOf("utc:")===0)){i=r.split(/:(.+)?/,2);a=i[1];if(a[0]==="'"&&a[a.length-1]==="'"||a[0]==='"'&&a[a.length-1]==='"'){a=a.slice(1,-1)}return i[0]==="utc"?Wu(a):n(a)}if(!er[r]){throw Error("Illegal format pattern: "+e+":"+r)}return er[r]});for(o=0,c=e.length,l=r.length;o<c;++o){a=e[o];for(f=0;f<l;++f){u=r[f];a[u]=i[f](a[u])}}}function eo(e,t,n){return this.pulse(e,this.changeset().insert(Qu(t,n)))}function to(e){var t,n,r=new Promise(function(r,i){t=function(){r(e)};n=i});r.requests=0;r.done=function(){if(--r.requests===0){e.runAfter(function(){e._pending=null;try{e.run();if(e._pending){e._pending.then(t)}else{t()}}catch(e){n(e)}})}};return e._pending=r}function no(e,t,n){var r=this,i=0,a=r._pending||to(r);a.requests+=1;return r.loader().load(t,{context:"dataflow"}).then(function(e){return Qu(e,n)},function(e){i=-1;r.error("Loading failed",t,e)}).catch(function(e){i=-2;r.error("Data ingestion failed",t,e)}).then(function(t){r.pulse(e,r.changeset().remove(dn["db"]).insert(t||[]));a.done();return i})}var ro={skip:true};var io=function(e,t,n,r,i){var a=e instanceof Tn?uo:ao;a(this,e,t,n,r,i);return this};function ao(e,t,n,r,i,a){var u=Object(dn["o"])({},a,ro),o,f;if(!Object(dn["C"])(n))n=Object(dn["l"])(n);if(r===undefined){o=function(t){e.touch(n(t))}}else if(Object(dn["C"])(r)){f=new Tn(null,r,i,false);o=function(t){var r,i=n(t);f.evaluate(t);On(r=f.value)?e.pulse(i,r,a):e.update(i,r,u)}}else{o=function(t){e.update(n(t),r,u)}}t.apply(o)}function uo(e,t,n,r,i,a){var u,o;if(r===undefined){o=n}else{u=Object(dn["C"])(r)?r:Object(dn["l"])(r);r=!n?u:function(e,t){var r=u(e,t);if(!n.skip()){n.skip(r!==this.value).value=r}return r};o=new Tn(null,r,i,false);o.modified(a&&a.force);o.rank=0;if(n){o.skip(true);o.value=n.value;o.targets().add(n)}}t.targets().add(o)}function oo(e){e.rank=++this._rank}function fo(e){var t=[e],n,r,i;while(t.length){this.rank(n=t.pop());if(r=n._targets){for(i=r.length;--i>=0;){t.push(n=r[i]);if(n===e)Object(dn["n"])("Cycle detected in dataflow graph.")}}}}var co={};var lo=1<<0,so=1<<1,ho=1<<2,po=lo|so,vo=lo|ho,go=lo|so|ho,mo=1<<3,yo=1<<4,bo=1<<5,xo=1<<6;function _o(e,t,n){this.dataflow=e;this.stamp=t==null?-1:t;this.add=[];this.rem=[];this.mod=[];this.fields=null;this.encode=n||null}var wo=_o.prototype;wo.StopPropagation=co;wo.ADD=lo;wo.REM=so;wo.MOD=ho;wo.ADD_REM=po;wo.ADD_MOD=vo;wo.ALL=go;wo.REFLOW=mo;wo.SOURCE=yo;wo.NO_SOURCE=bo;wo.NO_FIELDS=xo;wo.fork=function(e){return new _o(this.dataflow).init(this,e)};wo.clone=function(){var e=this.fork(go);e.add=e.add.slice();e.rem=e.rem.slice();e.mod=e.mod.slice();if(e.source)e.source=e.source.slice();return e.materialize(go|yo)};wo.addAll=function(){var e=this;if(!this.source||this.source.length===this.add.length){return e}else{e=new _o(this.dataflow).init(this);e.add=e.source;return e}};wo.init=function(e,t){var n=this;n.stamp=e.stamp;n.encode=e.encode;if(e.fields&&!(t&xo)){n.fields=e.fields}if(t&lo){n.addF=e.addF;n.add=e.add}else{n.addF=null;n.add=[]}if(t&so){n.remF=e.remF;n.rem=e.rem}else{n.remF=null;n.rem=[]}if(t&ho){n.modF=e.modF;n.mod=e.mod}else{n.modF=null;n.mod=[]}if(t&bo){n.srcF=null;n.source=null}else{n.srcF=e.srcF;n.source=e.source}return n};wo.runAfter=function(e){this.dataflow.runAfter(e)};wo.changed=function(e){var t=e||go;return t&lo&&this.add.length||t&so&&this.rem.length||t&ho&&this.mod.length};wo.reflow=function(e){if(e)return this.fork(go).reflow();var t=this.add.length,n=this.source&&this.source.length;if(n&&n!==t){this.mod=this.source;if(t)this.filter(ho,Ao(this,lo))}return this};wo.modifies=function(e){var t=Object(dn["i"])(e),n=this.fields||(this.fields={});t.forEach(function(e){n[e]=true});return this};wo.modified=function(e){var t=this.fields;return!(this.mod.length&&t)?false:!arguments.length?!!t:Object(dn["z"])(e)?e.some(function(e){return t[e]}):t[e]};wo.filter=function(e,t){var n=this;if(e&lo)n.addF=ko(n.addF,t);if(e&so)n.remF=ko(n.remF,t);if(e&ho)n.modF=ko(n.modF,t);if(e&yo)n.srcF=ko(n.srcF,t);return n};function ko(e,t){return e?function(n,r){return e(n,r)&&t(n,r)}:t}wo.materialize=function(e){e=e||go;var t=this;if(e&lo&&t.addF){t.add=Oo(t.add,t.addF);t.addF=null}if(e&so&&t.remF){t.rem=Oo(t.rem,t.remF);t.remF=null}if(e&ho&&t.modF){t.mod=Oo(t.mod,t.modF);t.modF=null}if(e&yo&&t.srcF){t.source=t.source.filter(t.srcF);t.srcF=null}return t};function Oo(e,t){var n=[];Object(dn["fb"])(e,t,function(e){n.push(e)});return n}function Ao(e,t){var n={};e.visit(t,function(e){n[yn(e)]=1});return function(e){return n[yn(e)]?null:e}}wo.visit=function(e,t){var n=this,r=t,i,a;if(e&yo){Object(dn["fb"])(n.source,n.srcF,r);return n}if(e&lo)Object(dn["fb"])(n.add,n.addF,r);if(e&so)Object(dn["fb"])(n.rem,n.remF,r);if(e&ho)Object(dn["fb"])(n.mod,n.modF,r);if(e&mo&&(i=n.source)){a=n.add.length+n.mod.length;if(a===i.length){}else if(a){Object(dn["fb"])(i,Ao(n,vo),r)}else{Object(dn["fb"])(i,n.srcF,r)}}return n};function Eo(e,t,n,r){var i=this,a=0,u,o,f,c,l;this.dataflow=e;this.stamp=t;this.fields=null;this.encode=r||null;this.pulses=n;for(f=0,c=n.length;f<c;++f){u=n[f];if(u.stamp!==t)continue;if(u.fields){o=i.fields||(i.fields={});for(l in u.fields){o[l]=1}}if(u.changed(i.ADD))a|=i.ADD;if(u.changed(i.REM))a|=i.REM;if(u.changed(i.MOD))a|=i.MOD}this.changes=a}var Mo=Object(dn["x"])(Eo,_o);Mo.fork=function(e){var t=new _o(this.dataflow).init(this,e&this.NO_FIELDS);if(e!==undefined){if(e&t.ADD){this.visit(t.ADD,function(e){return t.add.push(e)})}if(e&t.REM){this.visit(t.REM,function(e){return t.rem.push(e)})}if(e&t.MOD){this.visit(t.MOD,function(e){return t.mod.push(e)})}}return t};Mo.changed=function(e){return this.changes&e};Mo.modified=function(e){var t=this,n=t.fields;return!(n&&t.changes&t.MOD)?0:Object(dn["z"])(e)?e.some(function(e){return n[e]}):n[e]};Mo.filter=function(){Object(dn["n"])("MultiPulse does not support filtering.")};Mo.materialize=function(){Object(dn["n"])("MultiPulse does not support materialization.")};Mo.visit=function(e,t){var n=this,r=n.pulses,i=r.length,a=0;if(e&n.SOURCE){for(;a<i;++a){r[a].visit(e,t)}}else{for(;a<i;++a){if(r[a].stamp===n.stamp){r[a].visit(e,t)}}}return n};function So(e){var t=this,n=0,r=t.logLevel(),i,a,u,o;if(t._pending){t.info("Awaiting requests, delaying dataflow run.");return 0}if(t._pulse){t.error("Dataflow invoked recursively. Use the runAfter method to queue invocation.");return 0}if(!t._touched.length){t.info("Dataflow invoked, but nothing to do.");return 0}t._pulse=new _o(t,++t._clock,e);if(r>=dn["c"]){u=Date.now();t.debug("-- START PROPAGATION ("+t._clock+") -----")}t._touched.forEach(function(e){t._enqueue(e,true)});t._touched=hn(dn["v"]);try{while(t._heap.size()>0){i=t._heap.pop();if(i.rank!==i.qrank){t._enqueue(i,true);continue}a=i.run(t._getPulse(i,e));if(r>=dn["a"]){t.debug(i.id,a===co?"STOP":a,i)}if(a!==co){t._pulse=a;if(i._targets)i._targets.forEach(function(e){t._enqueue(e)})}++n}}catch(e){o=e}t._pulses={};t._pulse=null;if(r>=dn["c"]){u=Date.now()-u;t.info("> Pulse "+t._clock+": "+n+" operators; "+u+"ms")}if(o){t._postrun=[];t.error(o)}if(t._onrun){try{t._onrun(t,n,o)}catch(e){t.error(e)}}if(t._postrun.length){var f=t._postrun;t._postrun=[];f.sort(function(e,t){return t.priority-e.priority}).forEach(function(e){Co(t,e.callback)})}return this}function Co(e,t){try{t(e)}catch(t){e.error(t)}}function Do(){return this._pending||this.run()&&this._pending||Promise.resolve(this)}function jo(e,t,n){if(this._pulse||t){this._postrun.push({priority:n||0,callback:e})}else{Co(this,e)}}function No(e,t){var n=!this._pulses[e.id];if(n)this._pulses[e.id]=this._pulse;if(n||t){e.qrank=e.rank;this._heap.push(e)}}function Fo(e,t){var n=e.source,r=this._clock,i;if(n&&Object(dn["z"])(n)){i=n.map(function(e){return e.pulse});return new Eo(this,r,i,t)}i=this._pulses[e.id];if(n){n=n.pulse;if(!n||n===co){i.source=[]}else if(n.stamp===r&&i.target!==e){i=n}else{i.source=n.source}}return i}var To={skip:false,force:false};function zo(e,t){var n=t||To;if(this._pulse){this._enqueue(e)}else{this._touched.add(e)}if(n.skip)e.skip(true);return this}function Ro(e,t,n){var r=n||To;if(e.set(t)||r.force){this.touch(e,r)}return this}function Po(e,t,n){this.touch(e,n||To);var r=new _o(this,this._clock+(this._pulse?0:1)),i=e.pulse&&e.pulse.source||[];r.target=e;this._pulses[e.id]=t.pulse(r,i);return this}function Lo(e){this.cmp=e;this.nodes=[]}var Bo=Lo.prototype;Bo.size=function(){return this.nodes.length};Bo.clear=function(){this.nodes=[];return this};Bo.peek=function(){return this.nodes[0]};Bo.push=function(e){var t=this.nodes;t.push(e);return Io(t,0,t.length-1,this.cmp)};Bo.pop=function(){var e=this.nodes,t=e.pop(),n;if(e.length){n=e[0];e[0]=t;Uo(e,0,this.cmp)}else{n=t}return n};Bo.replace=function(e){var t=this.nodes,n=t[0];t[0]=e;Uo(t,0,this.cmp);return n};Bo.pushpop=function(e){var t=this.nodes,n=t[0];if(t.length&&this.cmp(n,e)<0){t[0]=e;e=n;Uo(t,0,this.cmp)}return e};function Io(e,t,n,r){var i,a,u;i=e[n];while(n>t){u=n-1>>1;a=e[u];if(r(i,a)<0){e[n]=a;n=u;continue}break}return e[n]=i}function Uo(e,t,n){var r=t,i=e.length,a=e[t],u=2*t+1,o;while(u<i){o=u+1;if(o<i&&n(e[u],e[o])>=0){u=o}e[t]=e[u];t=u;u=2*t+1}e[t]=a;return Io(e,r,t,n)}function qo(){this._log=Object(dn["J"])();this.logLevel(dn["b"]);this._clock=0;this._rank=0;try{this._loader=Yn()}catch(e){}this._touched=hn(dn["v"]);this._pulses={};this._pulse=null;this._heap=new Lo(function(e,t){return e.qrank-t.qrank});this._postrun=[]}var Wo=qo.prototype;Wo.stamp=function(){return this._clock};Wo.loader=function(e){if(arguments.length){this._loader=e;return this}else{return this._loader}};Wo.cleanThreshold=1e4;Wo.add=Pn;Wo.connect=Ln;Wo.rank=oo;Wo.rerank=fo;Wo.pulse=Po;Wo.touch=zo;Wo.update=Ro;Wo.changeset=An;Wo.ingest=eo;Wo.request=no;Wo.events=Wn;Wo.on=io;Wo.run=So;Wo.runAsync=Do;Wo.runAfter=jo;Wo._enqueue=No;Wo._getPulse=Fo;function Ho(e){return function(){return this._log[e].apply(this,arguments)}}Wo.error=Ho("error");Wo.warn=Ho("warn");Wo.info=Ho("info");Wo.debug=Ho("debug");Wo.logLevel=Ho("level");function Go(e,t){Tn.call(this,e,null,t)}var Yo=Object(dn["x"])(Go,Tn);Yo.run=function(e){if(e.stamp<=this.stamp)return e.StopPropagation;var t;if(this.skip()){this.skip(false)}else{t=this.evaluate(e)}t=t||e;if(t!==e.StopPropagation)this.pulse=t;this.stamp=e.stamp;return t};Yo.evaluate=function(e){var t=this.marshall(e.stamp),n=this.transform(t,e);t.clear();return n};Yo.transform=function(){};var $o={};function Vo(e){var t=Xo(e);return t&&t.Definition||null}function Xo(e){e=e&&e.toLowerCase();return $o.hasOwnProperty(e)?$o[e]:null}function Zo(e){return function(t){var n=e.length,r=1,i=String(e[0](t));for(;r<n;++r){i+="|"+e[r](t)}return i}}function Jo(e){return!e||!e.length?function(){return""}:e.length===1?e[0]:Zo(e)}function Qo(e,t,n){return n||e+(!t?"":"_"+t)}var Ko={values:nf({name:"values",init:"cell.store = true;",set:"cell.data.values()",idx:-1}),count:nf({name:"count",set:"cell.num"}),__count__:nf({name:"count",set:"this.missing + this.valid"}),missing:nf({name:"missing",set:"this.missing"}),valid:nf({name:"valid",set:"this.valid"}),sum:nf({name:"sum",init:"this.sum = 0;",add:"this.sum += +v;",rem:"this.sum -= v;",set:"this.sum"}),mean:nf({name:"mean",init:"this.mean = 0;",add:"var d = v - this.mean; this.mean += d / this.valid;",rem:"var d = v - this.mean; this.mean -= this.valid ? d / this.valid : this.mean;",set:"this.valid ? this.mean : undefined"}),average:nf({name:"average",set:"this.valid ? this.mean : undefined",req:["mean"],idx:1}),variance:nf({name:"variance",init:"this.dev = 0;",add:"this.dev += d * (v - this.mean);",rem:"this.dev -= d * (v - this.mean);",set:"this.valid > 1 ? this.dev / (this.valid-1) : undefined",req:["mean"],idx:1}),variancep:nf({name:"variancep",set:"this.valid > 1 ? this.dev / this.valid : undefined",req:["variance"],idx:2}),stdev:nf({name:"stdev",set:"this.valid > 1 ? Math.sqrt(this.dev / (this.valid-1)) : undefined",req:["variance"],idx:2}),stdevp:nf({name:"stdevp",set:"this.valid > 1 ? Math.sqrt(this.dev / this.valid) : undefined",req:["variance"],idx:2}),stderr:nf({name:"stderr",set:"this.valid > 1 ? Math.sqrt(this.dev / (this.valid * (this.valid-1))) : undefined",req:["variance"],idx:2}),distinct:nf({name:"distinct",set:"cell.data.distinct(this.get)",req:["values"],idx:3}),ci0:nf({name:"ci0",set:"cell.data.ci0(this.get)",req:["values"],idx:3}),ci1:nf({name:"ci1",set:"cell.data.ci1(this.get)",req:["values"],idx:3}),median:nf({name:"median",set:"cell.data.q2(this.get)",req:["values"],idx:3}),q1:nf({name:"q1",set:"cell.data.q1(this.get)",req:["values"],idx:3}),q3:nf({name:"q3",set:"cell.data.q3(this.get)",req:["values"],idx:3}),argmin:nf({name:"argmin",init:"this.argmin = undefined;",add:"if (v < this.min) this.argmin = t;",rem:"if (v <= this.min) this.argmin = undefined;",set:"this.argmin || cell.data.argmin(this.get)",req:["min"],str:["values"],idx:3}),argmax:nf({name:"argmax",init:"this.argmax = undefined;",add:"if (v > this.max) this.argmax = t;",rem:"if (v >= this.max) this.argmax = undefined;",set:"this.argmax || cell.data.argmax(this.get)",req:["max"],str:["values"],idx:3}),min:nf({name:"min",init:"this.min = undefined;",add:"if (v < this.min || this.min === undefined) this.min = v;",rem:"if (v <= this.min) this.min = NaN;",set:"this.min = (isNaN(this.min) ? cell.data.min(this.get) : this.min)",str:["values"],idx:4}),max:nf({name:"max",init:"this.max = undefined;",add:"if (v > this.max || this.max === undefined) this.max = v;",rem:"if (v >= this.max) this.max = NaN;",set:"this.max = (isNaN(this.max) ? cell.data.max(this.get) : this.max)",str:["values"],idx:4})};var ef=Object.keys(Ko);function tf(e,t){return Ko[e](t)}function nf(e){return function(t){var n=Object(dn["o"])({init:"",add:"",rem:"",idx:0},e);n.out=t||e.name;return n}}function rf(e,t){return e.idx-t.idx}function af(e,t){function n(e,r){function i(t){if(!e[t])n(e,e[t]=Ko[t]())}if(r.req)r.req.forEach(i);if(t&&r.str)r.str.forEach(i);return e}var r=e.reduce(n,e.reduce(function(e,t){e[t.name]=t;return e},{}));var i=[],a;for(a in r)i.push(r[a]);return i.sort(rf)}function uf(e,t){var n=t||dn["w"],r=af(e,true),i="var cell = this.cell; this.valid = 0; this.missing = 0;",a="this.cell = cell; this.init();",u="if(v==null){++this.missing; return;} if(v!==v) return; ++this.valid;",o="if(v==null){--this.missing; return;} if(v!==v) return; --this.valid;",f="var cell = this.cell;";r.forEach(function(e){i+=e.init;u+=e.add;o+=e.rem});e.slice().sort(rf).forEach(function(e){f+="t['"+e.out+"']="+e.set+";"});f+="return t;";a=Function("cell",a);a.prototype.init=Function(i);a.prototype.add=Function("v","t",u);a.prototype.rem=Function("v","t",o);a.prototype.set=Function("t",f);a.prototype.get=n;a.fields=e.map(function(e){return e.out});return a}var of=function(e){var t=e.maxbins||20,n=e.base||10,r=Math.log(n),i=e.divide||[5,2],a=e.extent[0],u=e.extent[1],o=u-a||Math.abs(a)||1,f,c,l,s,d,h,p,v;if(e.step){f=e.step}else if(e.steps){d=o/t;for(h=0,p=e.steps.length;h<p&&e.steps[h]<d;++h);f=e.steps[Math.max(0,h-1)]}else{c=Math.ceil(Math.log(t)/r);l=e.minstep||0;f=Math.max(l,Math.pow(n,Math.round(Math.log(o)/r)-c));while(Math.ceil(o/f)>t){f*=n}for(h=0,p=i.length;h<p;++h){d=f/i[h];if(d>=l&&o/d<=t)f=d}}d=Math.log(f);s=d>=0?0:~~(-d/r)+1;v=Math.pow(n,-s-1);if(e.nice||e.nice===undefined){d=Math.floor(a/f+v)*f;a=a<d?d-f:d;u=Math.ceil(u/f)*f}return{start:a,stop:u===a?a+f:u,step:f}};var ff=function(e,t){var n=[],r=e.length,i=-1,a;if(t==null){while(++i<r)if(!isNaN(a=cf(e[i])))n.push(a)}else{while(++i<r)if(!isNaN(a=cf(t(e[i],i,e))))n.push(a)}return n};function cf(e){return e===null?NaN:+e}var lf=Math.random;function sf(e){lf=e}var df=function(e,t){return e<t?-1:e>t?1:e>=t?0:NaN};var hf=function(e){if(e.length===1)e=pf(e);return{left:function(t,n,r,i){if(r==null)r=0;if(i==null)i=t.length;while(r<i){var a=r+i>>>1;if(e(t[a],n)<0)r=a+1;else i=a}return r},right:function(t,n,r,i){if(r==null)r=0;if(i==null)i=t.length;while(r<i){var a=r+i>>>1;if(e(t[a],n)>0)i=a;else r=a+1}return r}}};function pf(e){return function(t,n){return df(e(t),n)}}var vf=hf(df);var gf=vf.right;var mf=vf.left;var yf=gf;function bf(e){return e.length|0}function xf(e){return!(e>0)}function _f(e){return typeof e!=="object"||"length"in e?e:Array.from(e)}function wf(e){return t=>e(...t)}function kf(...e){const t=typeof e[e.length-1]==="function"&&wf(e.pop());e=e.map(_f);const n=e.map(bf);const r=e.length-1;const i=new Array(r+1).fill(0);const a=[];if(r<0||n.some(xf))return a;while(true){a.push(i.map((t,n)=>e[n][t]));let u=r;while(++i[u]===n[u]){if(u===0)return t?a.map(t):a;i[u--]=0}}}var Of=function(e,t){return t<e?-1:t>e?1:t>=e?0:NaN};function Af(e,t){let n=0;let r;let i=0;let a=0;if(t===undefined){for(let t of e){if(t!=null&&(t=+t)>=t){r=t-i;i+=r/++n;a+=r*(t-i)}}}else{let u=-1;for(let o of e){if((o=t(o,++u,e))!=null&&(o=+o)>=o){r=o-i;i+=r/++n;a+=r*(o-i)}}}if(n>1)return a/(n-1)}function Ef(e,t){const n=Af(e,t);return n?Math.sqrt(n):n}var Mf=function(e,t){let n;let r;if(t===undefined){for(let t of e){if(t!=null&&t>=t){if(n===undefined){n=r=t}else{if(n>t)n=t;if(r<t)r=t}}}}else{let i=-1;for(let a of e){if((a=t(a,++i,e))!=null&&a>=a){if(n===undefined){n=r=a}else{if(n>a)n=a;if(r<a)r=a}}}}return[n,r]};var Sf=function(e){return e};function Cf(e,t){const n=new Map;let r=-1;for(const i of e){const a=t(i,++r,e);const u=n.get(a);if(u)u.push(i);else n.set(a,[i])}return n}function Df(e,t,...n){return function e(r,i){if(i>=n.length)return t(r);const a=Cf(r,n[i]);return new Map(Array.from(a,([t,n])=>[t,e(n,i+1)]))}(e,0)}function jf(e,...t){return Df(e,Sf,...t)}var Nf=Array.prototype;var Ff=Nf.slice;var Tf=Nf.map;var zf=function(e){return function(){return e}};var Rf=function(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;var r=-1,i=Math.max(0,Math.ceil((t-e)/n))|0,a=new Array(i);while(++r<i){a[r]=e+r*n}return a};var Pf=Math.sqrt(50),Lf=Math.sqrt(10),Bf=Math.sqrt(2);var If=function(e,t,n){var r,i=-1,a,u,o;t=+t,e=+e,n=+n;if(e===t&&n>0)return[e];if(r=t<e)a=e,e=t,t=a;if((o=Uf(e,t,n))===0||!isFinite(o))return[];if(o>0){e=Math.ceil(e/o);t=Math.floor(t/o);u=new Array(a=Math.ceil(t-e+1));while(++i<a)u[i]=(e+i)*o}else{e=Math.floor(e*o);t=Math.ceil(t*o);u=new Array(a=Math.ceil(e-t+1));while(++i<a)u[i]=(e-i)/o}if(r)u.reverse();return u};function Uf(e,t,n){var r=(t-e)/Math.max(0,n),i=Math.floor(Math.log(r)/Math.LN10),a=r/Math.pow(10,i);return i>=0?(a>=Pf?10:a>=Lf?5:a>=Bf?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(a>=Pf?10:a>=Lf?5:a>=Bf?2:1)}function qf(e,t,n){var r=Math.abs(t-e)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),a=r/i;if(a>=Pf)i*=10;else if(a>=Lf)i*=5;else if(a>=Bf)i*=2;return t<e?-i:i}var Wf=function(e){return Math.ceil(Math.log(e.length)/Math.LN2)+1};var Hf=function(){var e=Sf,t=Mf,n=Wf;function r(r){if(!Array.isArray(r))r=Array.from(r);var i,a=r.length,u,o=new Array(a);for(i=0;i<a;++i){o[i]=e(r[i],i,r)}var f=t(o),c=f[0],l=f[1],s=n(o,c,l);if(!Array.isArray(s)){s=qf(c,l,s);s=Rf(Math.ceil(c/s)*s,l,s)}var d=s.length;while(s[0]<=c)s.shift(),--d;while(s[d-1]>l)s.pop(),--d;var h=new Array(d+1),p;for(i=0;i<=d;++i){p=h[i]=[];p.x0=i>0?s[i-1]:c;p.x1=i<d?s[i]:l}for(i=0;i<a;++i){u=o[i];if(c<=u&&u<=l){h[yf(s,u,0,d)].push(r[i])}}return h}r.value=function(t){return arguments.length?(e=typeof t==="function"?t:zf(t),r):e};r.domain=function(e){return arguments.length?(t=typeof e==="function"?e:zf([e[0],e[1]]),r):t};r.thresholds=function(e){return arguments.length?(n=typeof e==="function"?e:Array.isArray(e)?zf(Ff.call(e)):zf(e),r):n};return r};var Gf=function(e){return e===null?NaN:+e};function Yf(e,t,n=Gf){if(!(r=e.length))return;if((t=+t)<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,i=(r-1)*t,a=Math.floor(i),u=+n(e[a],a,e),o=+n(e[a+1],a+1,e);return u+(o-u)*(i-a)}var $f=function(e,t,n){e=Tf.call(e,Gf).sort(df);return Math.ceil((n-t)/(2*(Yf(e,.75)-Yf(e,.25))*Math.pow(e.length,-1/3)))};var Vf=function(e,t,n){return Math.ceil((n-t)/(3.5*Ef(e)*Math.pow(e.length,-1/3)))};function Xf(e,t){let n;if(t===undefined){for(let t of e){if(t!=null&&t>=t&&(n===undefined||n<t)){n=t}}}else{let r=-1;for(let i of e){if((i=t(i,++r,e))!=null&&i>=i&&(n===undefined||n<i)){n=i}}}return n}function Zf(e,t){let n=0;let r=0;if(t===undefined){for(let t of e){if(t!=null&&(t=+t)>=t){++n,r+=t}}}else{let i=-1;for(let a of e){if((a=t(a,++i,e))!=null&&(a=+a)>=a){++n,r+=a}}}if(n)return r/n}function Jf(e,t,n=0,r=e.length-1,i=df){while(r>n){if(r-n>600){const a=r-n+1;const u=t-n+1;const o=Math.log(a);const f=.5*Math.exp(2*o/3);const c=.5*Math.sqrt(o*f*(a-f)/a)*(u-a/2<0?-1:1);const l=Math.max(n,Math.floor(t-u*f/a+c));const s=Math.min(r,Math.floor(t+(a-u)*f/a+c));Jf(e,t,l,s,i)}const a=e[t];let u=n;let o=r;Qf(e,n,t);if(i(e[r],a)>0)Qf(e,n,r);while(u<o){Qf(e,u,o),++u,--o;while(i(e[u],a)<0)++u;while(i(e[o],a)>0)--o}if(i(e[n],a)===0)Qf(e,n,o);else++o,Qf(e,o,r);if(o<=t)n=o+1;if(t<=o)r=o-1}return e}function Qf(e,t,n){const r=e[t];e[t]=e[n];e[n]=r}function*Kf(e,t){if(t===undefined){for(let t of e){if(t!=null&&(t=+t)>=t){yield t}}}else{let n=-1;for(let r of e){if((r=t(r,++n,e))!=null&&(r=+r)>=r){yield r}}}}var ec=function(e,t){e=Float64Array.from(Kf(e,t));if(!e.length)return;const n=e.length;const r=n>>1;Jf(e,r-1,0);if((n&1)===0)Jf(e,r,r);return Yf(e,.5)};function*tc(e){for(const t of e){yield*t}}function nc(e){return Array.from(tc(e))}function rc(e,t){let n;if(t===undefined){for(let t of e){if(t!=null&&t>=t&&(n===undefined||n>t)){n=t}}}else{let r=-1;for(let i of e){if((i=t(i,++r,e))!=null&&i>=i&&(n===undefined||n>i)){n=i}}}return n}function ic(e,t=ac){const n=[];let r;let i=false;for(const a of e){if(i)n.push(t(r,a));r=a;i=true}return n}function ac(e,t){return[e,t]}var uc=function(e,t){var n=t.length,r=new Array(n);while(n--)r[n]=e[t[n]];return r};function oc(e,t=df){let n;let r;let i=-1;for(const a of e){++i;if(r===undefined?t(a,a)===0:t(a,n)<0){n=a;r=i}}return r}function fc(e,t=0,n=e.length){var r=n-(t=+t),i,a;while(r){a=Math.random()*r--|0;i=e[r+t];e[r+t]=e[a+t];e[a+t]=i}return e}function cc(e,t){let n=0;if(t===undefined){for(let t of e){if(t=+t){n+=t}}}else{let r=-1;for(let i of e){if(i=+t(i,++r,e)){n+=i}}}return n}var lc=function(e){if(!(a=e.length))return[];for(var t=-1,n=rc(e,sc),r=new Array(n);++t<n;){for(var i=-1,a,u=r[t]=new Array(a);++i<a;){u[i]=e[i][t]}}return r};function sc(e){return e.length}var dc=function(){return lc(arguments)};var hc=function(e,t,n,r){if(!e.length)return[undefined,undefined];var i=ff(e,r),a=i.length,u=t,o,f,c,l;for(c=0,l=Array(u);c<u;++c){for(o=0,f=0;f<a;++f){o+=i[~~(lf()*a)]}l[c]=o/a}return[Yf(l.sort(df),n/2),Yf(l,1-n/2)]};var pc=function(e,t){var n=ff(e,t);return[Yf(n.sort(df),.25),Yf(n,.5),Yf(n,.75)]};var vc=function(e){return function(){e=(1103515245*e+12345)%2147483647;return e/2147483647}};var gc=function(e,t){if(t==null){t=e;e=0}var n={},r,i,a;n.min=function(e){if(arguments.length){r=e||0;a=i-r;return n}else{return r}};n.max=function(e){if(arguments.length){i=e||0;a=i-r;return n}else{return i}};n.sample=function(){return r+Math.floor(a*lf())};n.pdf=function(e){return e===Math.floor(e)&&e>=r&&e<i?1/a:0};n.cdf=function(e){var t=Math.floor(e);return t<r?0:t>=i?1:(t-r+1)/a};n.icdf=function(e){return e>=0&&e<=1?r-1+Math.floor(e*a):NaN};return n.min(e).max(t)};var mc=function(e,t){var n,r,i=NaN,a={};a.mean=function(e){if(arguments.length){n=e||0;i=NaN;return a}else{return n}};a.stdev=function(e){if(arguments.length){r=e==null?1:e;i=NaN;return a}else{return r}};a.sample=function(){var e=0,t=0,a,u;if(i===i){e=i;i=NaN;return e}do{e=lf()*2-1;t=lf()*2-1;a=e*e+t*t}while(a===0||a>1);u=Math.sqrt(-2*Math.log(a)/a);i=n+t*u*r;return n+e*u*r};a.pdf=function(e){var t=Math.exp(Math.pow(e-n,2)/(-2*Math.pow(r,2)));return 1/(r*Math.sqrt(2*Math.PI))*t};a.cdf=function(e){var t,i=(e-n)/r,a=Math.abs(i);if(a>37){t=0}else{var u,o=Math.exp(-a*a/2);if(a<7.07106781186547){u=.0352624965998911*a+.700383064443688;u=u*a+6.37396220353165;u=u*a+33.912866078383;u=u*a+112.079291497871;u=u*a+221.213596169931;u=u*a+220.206867912376;t=o*u;u=.0883883476483184*a+1.75566716318264;u=u*a+16.064177579207;u=u*a+86.7807322029461;u=u*a+296.564248779674;u=u*a+637.333633378831;u=u*a+793.826512519948;u=u*a+440.413735824752;t=t/u}else{u=a+.65;u=a+4/u;u=a+3/u;u=a+2/u;u=a+1/u;t=o/u/2.506628274631}}return i>0?1-t:t};a.icdf=function(e){if(e<=0||e>=1)return NaN;var t=2*e-1,i=8*(Math.PI-3)/(3*Math.PI*(4-Math.PI)),a=2/(Math.PI*i)+Math.log(1-Math.pow(t,2))/2,u=Math.log(1-t*t)/i,o=(t>0?1:-1)*Math.sqrt(Math.sqrt(a*a-u)-a);return n+r*Math.SQRT2*o};return a.mean(e).stdev(t)};var yc=function(e,t){var n=mc(),r={},i=0;r.data=function(n){if(arguments.length){e=n;i=n?n.length:0;return r.bandwidth(t)}else{return e}};r.bandwidth=function(n){if(!arguments.length)return t;t=n;if(!t&&e)t=bc(e);return r};r.sample=function(){return e[~~(lf()*i)]+t*n.sample()};r.pdf=function(r){for(var a=0,u=0;u<i;++u){a+=n.pdf((r-e[u])/t)}return a/t/i};r.cdf=function(r){for(var a=0,u=0;u<i;++u){a+=n.cdf((r-e[u])/t)}return a/i};r.icdf=function(){throw Error("KDE icdf not supported.")};return r.data(e)};function bc(e){var t=e.length,n=pc(e),r=(n[2]-n[0])/1.34;return 1.06*Math.min(Math.sqrt(Af(e)),r)*Math.pow(t,-.2)}var xc=function(e,t){var n={},r=0,i;function a(e){var t=[],n=0,i;for(i=0;i<r;++i){n+=t[i]=e[i]==null?1:+e[i]}for(i=0;i<r;++i){t[i]/=n}return t}n.weights=function(e){if(arguments.length){i=a(t=e||[]);return n}return t};n.distributions=function(i){if(arguments.length){if(i){r=i.length;e=i}else{r=0;e=[]}return n.weights(t)}return e};n.sample=function(){var t=lf(),n=e[r-1],a=i[0],u=0;for(;u<r-1;a+=i[++u]){if(t<a){n=e[u];break}}return n.sample()};n.pdf=function(t){for(var n=0,a=0;a<r;++a){n+=i[a]*e[a].pdf(t)}return n};n.cdf=function(t){for(var n=0,a=0;a<r;++a){n+=i[a]*e[a].cdf(t)}return n};n.icdf=function(){throw Error("Mixture icdf not supported.")};return n.distributions(e).weights(t)};var _c=function(e,t){if(t==null){t=e==null?1:e;e=0}var n={},r,i,a;n.min=function(e){if(arguments.length){r=e||0;a=i-r;return n}else{return r}};n.max=function(e){if(arguments.length){i=e||0;a=i-r;return n}else{return i}};n.sample=function(){return r+a*lf()};n.pdf=function(e){return e>=r&&e<=i?1/a:0};n.cdf=function(e){return e<r?0:e>i?1:(e-r)/a};n.icdf=function(e){return e>=0&&e<=1?r+e*a:NaN};return n.min(e).max(t)};function wc(e){this._key=e?Object(dn["t"])(e):yn;this.reset()}var kc=wc.prototype;kc.reset=function(){this._add=[];this._rem=[];this._ext=null;this._get=null;this._q=null};kc.add=function(e){this._add.push(e)};kc.rem=function(e){this._rem.push(e)};kc.values=function(){this._get=null;if(this._rem.length===0)return this._add;var e=this._add,t=this._rem,n=this._key,r=e.length,i=t.length,a=Array(r-i),u={},o,f,c;for(o=0;o<i;++o){u[n(t[o])]=1}for(o=0,f=0;o<r;++o){if(u[n(c=e[o])]){u[n(c)]=0}else{a[f++]=c}}this._rem=[];return this._add=a};kc.distinct=function(e){var t=this.values(),n=t.length,r={},i=0,a;while(--n>=0){a=e(t[n])+"";if(!r.hasOwnProperty(a)){r[a]=1;++i}}return i};kc.extent=function(e){if(this._get!==e||!this._ext){var t=this.values(),n=Object(dn["q"])(t,e);this._ext=[t[n[0]],t[n[1]]];this._get=e}return this._ext};kc.argmin=function(e){return this.extent(e)[0]||{}};kc.argmax=function(e){return this.extent(e)[1]||{}};kc.min=function(e){var t=this.extent(e)[0];return t!=null?e(t):undefined};kc.max=function(e){var t=this.extent(e)[1];return t!=null?e(t):undefined};kc.quartile=function(e){if(this._get!==e||!this._q){this._q=pc(this.values(),e);this._get=e}return this._q};kc.q1=function(e){return this.quartile(e)[0]};kc.q2=function(e){return this.quartile(e)[1]};kc.q3=function(e){return this.quartile(e)[2]};kc.ci=function(e){if(this._get!==e||!this._ci){this._ci=hc(this.values(),1e3,.05,e);this._get=e}return this._ci};kc.ci0=function(e){return this.ci(e)[0]};kc.ci1=function(e){return this.ci(e)[1]};function Oc(e){Go.call(this,null,e);this._adds=[];this._mods=[];this._alen=0;this._mlen=0;this._drop=true;this._cross=false;this._dims=[];this._dnames=[];this._measures=[];this._countOnly=false;this._counts=null;this._prev=null;this._inputs=null;this._outputs=null}Oc.Definition={type:"Aggregate",metadata:{generates:true,changes:true},params:[{name:"groupby",type:"field",array:true},{name:"ops",type:"enum",array:true,values:ef},{name:"fields",type:"field",null:true,array:true},{name:"as",type:"string",null:true,array:true},{name:"drop",type:"boolean",default:true},{name:"cross",type:"boolean",default:false},{name:"key",type:"field"}]};var Ac=Object(dn["x"])(Oc,Go);Ac.transform=function(e,t){var n=this,r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i;this.stamp=r.stamp;if(this.value&&((i=e.modified())||t.modified(this._inputs))){this._prev=this.value;this.value=i?this.init(e):{};t.visit(t.SOURCE,function(e){n.add(e)})}else{this.value=this.value||this.init(e);t.visit(t.REM,function(e){n.rem(e)});t.visit(t.ADD,function(e){n.add(e)})}r.modifies(this._outputs);n._drop=e.drop!==false;if(e.cross&&n._dims.length>1){n._drop=false;this.cross()}return n.changes(r)};Ac.cross=function(){var e=this,t=e.value,n=e._dnames,r=n.map(function(){return{}}),i=n.length;function a(e){var t,a,u,o;for(t in e){u=e[t].tuple;for(a=0;a<i;++a){r[a][o=u[n[a]]]=o}}}a(e._prev);a(t);function u(a,o,f){var c=n[f],l=r[f++],s,d;for(s in l){o[c]=l[s];d=a?a+"|"+s:s;if(f<i)u(d,o,f);else if(!t[d])e.cell(d,o)}}u("",{},0)};Ac.init=function(e){var t=this._inputs=[],n=this._outputs=[],r={};function i(e){var n=Object(dn["i"])(Object(dn["g"])(e)),i=0,a=n.length,u;for(;i<a;++i){if(!r[u=n[i]]){r[u]=1;t.push(u)}}}this._dims=Object(dn["i"])(e.groupby);this._dnames=this._dims.map(function(e){var t=Object(dn["h"])(e);i(e);n.push(t);return t});this.cellkey=e.key?e.key:Jo(this._dims);this._countOnly=true;this._counts=[];this._measures=[];var a=e.fields||[null],u=e.ops||["count"],o=e.as||[],f=a.length,c={},l,s,d,h,p,v;if(f!==u.length){Object(dn["n"])("Unmatched number of fields and aggregate ops.")}for(v=0;v<f;++v){l=a[v];s=u[v];if(l==null&&s!=="count"){Object(dn["n"])("Null aggregate field specified.")}h=Object(dn["h"])(l);p=Qo(s,h,o[v]);n.push(p);if(s==="count"){this._counts.push(p);continue}d=c[h];if(!d){i(l);d=c[h]=[];d.field=l;this._measures.push(d)}if(s!=="count")this._countOnly=false;d.push(tf(s,p))}this._measures=this._measures.map(function(e){return uf(e,e.field)});return{}};Ac.cellkey=Jo();Ac.cell=function(e,t){var n=this.value[e];if(!n){n=this.value[e]=this.newcell(e,t);this._adds[this._alen++]=n}else if(n.num===0&&this._drop&&n.stamp<this.stamp){n.stamp=this.stamp;this._adds[this._alen++]=n}else if(n.stamp<this.stamp){n.stamp=this.stamp;this._mods[this._mlen++]=n}return n};Ac.newcell=function(e,t){var n={key:e,num:0,agg:null,tuple:this.newtuple(t,this._prev&&this._prev[e]),stamp:this.stamp,store:false};if(!this._countOnly){var r=this._measures,i=r.length,a;n.agg=Array(i);for(a=0;a<i;++a){n.agg[a]=new r[a](n)}}if(n.store){n.data=new wc}return n};Ac.newtuple=function(e,t){var n=this._dnames,r=this._dims,i={},a,u;for(a=0,u=r.length;a<u;++a){i[n[a]]=r[a](e)}return t?kn(t.tuple,i):xn(i)};Ac.add=function(e){var t=this.cellkey(e),n=this.cell(t,e),r,i,a;n.num+=1;if(this._countOnly)return;if(n.store)n.data.add(e);r=n.agg;for(i=0,a=r.length;i<a;++i){r[i].add(r[i].get(e),e)}};Ac.rem=function(e){var t=this.cellkey(e),n=this.cell(t,e),r,i,a;n.num-=1;if(this._countOnly)return;if(n.store)n.data.rem(e);r=n.agg;for(i=0,a=r.length;i<a;++i){r[i].rem(r[i].get(e),e)}};Ac.celltuple=function(e){var t=e.tuple,n=this._counts,r,i,a;if(e.store){e.data.values()}for(i=0,a=n.length;i<a;++i){t[n[i]]=e.num}if(!this._countOnly){r=e.agg;for(i=0,a=r.length;i<a;++i){r[i].set(t)}}return t};Ac.changes=function(e){var t=this._adds,n=this._mods,r=this._prev,i=this._drop,a=e.add,u=e.rem,o=e.mod,f,c,l,s;if(r)for(c in r){f=r[c];if(!i||f.num)u.push(f.tuple)}for(l=0,s=this._alen;l<s;++l){a.push(this.celltuple(t[l]));t[l]=null}for(l=0,s=this._mlen;l<s;++l){f=n[l];(f.num===0&&i?u:o).push(this.celltuple(f));n[l]=null}this._alen=this._mlen=0;this._prev=null;return e};function Ec(e){Go.call(this,null,e)}Ec.Definition={type:"Bin",metadata:{modifies:true},params:[{name:"field",type:"field",required:true},{name:"anchor",type:"number"},{name:"maxbins",type:"number",default:20},{name:"base",type:"number",default:10},{name:"divide",type:"number",array:true,default:[5,2]},{name:"extent",type:"number",array:true,length:2,required:true},{name:"step",type:"number"},{name:"steps",type:"number",array:true},{name:"minstep",type:"number",default:0},{name:"nice",type:"boolean",default:true},{name:"name",type:"string"},{name:"as",type:"string",array:true,length:2,default:["bin0","bin1"]}]};var Mc=Object(dn["x"])(Ec,Go);Mc.transform=function(e,t){var n=this._bins(e),r=n.start,i=n.step,a=e.as||["bin0","bin1"],u=a[0],o=a[1],f;if(e.modified()){t=t.reflow(true);f=t.SOURCE}else{f=t.modified(Object(dn["g"])(e.field))?t.ADD_MOD:t.ADD}t.visit(f,function(e){var t=n(e);e[u]=t;e[o]=t==null?null:r+i*(1+(t-r)/i)});return t.modifies(a)};Mc._bins=function(e){if(this.value&&!e.modified()){return this.value}var t=e.field,n=of(e),r=n.start,i=n.stop,a=n.step,u,o;if((u=e.anchor)!=null){o=u-(r+a*Math.floor((u-r)/a));r+=o;i+=o}var f=function(e){var n=t(e);if(n==null){return null}else{n=Math.max(r,Math.min(+n,i-a));return r+a*Math.floor((n-r)/a)}};f.start=r;f.stop=i;f.step=a;return this.value=Object(dn["f"])(f,Object(dn["g"])(t),e.name||"bin_"+Object(dn["h"])(t))};var Sc=function(e,t,n){var r=e,i=t||[],a=n||[],u={},o=0;return{add:function(e){a.push(e)},remove:function(e){u[r(e)]=++o},size:function(){return i.length},data:function(e,t){if(o){i=i.filter(function(e){return!u[r(e)]});u={};o=0}if(t&&e){i.sort(e)}if(a.length){i=e?Object(dn["K"])(e,i,a.sort(e)):i.concat(a);a=[]}return i}}};function Cc(e){Go.call(this,[],e)}Cc.Definition={type:"Collect",metadata:{source:true},params:[{name:"sort",type:"compare"}]};var Dc=Object(dn["x"])(Cc,Go);Dc.transform=function(e,t){var n=t.fork(t.ALL),r=Sc(yn,this.value,n.materialize(n.ADD).add),i=e.sort,a=t.changed()||i&&(e.modified("sort")||t.modified(i.fields));n.visit(n.REM,r.remove);this.modified(a);this.value=n.source=r.data(i,a);if(t.source&&t.source.root){this.value.root=t.source.root}return n};function jc(e){Tn.call(this,null,Nc,e)}Object(dn["x"])(jc,Tn);function Nc(e){return this.value&&!e.modified()?this.value:Object(dn["k"])(e.fields,e.orders)}function Fc(e){Go.call(this,null,e)}Fc.Definition={type:"CountPattern",metadata:{generates:true,changes:true},params:[{name:"field",type:"field",required:true},{name:"case",type:"enum",values:["upper","lower","mixed"],default:"mixed"},{name:"pattern",type:"string",default:'[\\w"]+'},{name:"stopwords",type:"string",default:""},{name:"as",type:"string",array:true,length:2,default:["text","count"]}]};function Tc(e,t,n){switch(t){case"upper":e=e.toUpperCase();break;case"lower":e=e.toLowerCase();break}return e.match(n)}var zc=Object(dn["x"])(Fc,Go);zc.transform=function(e,t){function n(t){return function(n){var r=Tc(o(n),e.case,a)||[],i;for(var f=0,c=r.length;f<c;++f){if(!u.test(i=r[f]))t(i)}}}var r=this._parameterCheck(e,t),i=this._counts,a=this._match,u=this._stop,o=e.field,f=e.as||["text","count"],c=n(function(e){i[e]=1+(i[e]||0)}),l=n(function(e){i[e]-=1});if(r){t.visit(t.SOURCE,c)}else{t.visit(t.ADD,c);t.visit(t.REM,l)}return this._finish(t,f)};zc._parameterCheck=function(e,t){var n=false;if(e.modified("stopwords")||!this._stop){this._stop=new RegExp("^"+(e.stopwords||"")+"$","i");n=true}if(e.modified("pattern")||!this._match){this._match=new RegExp(e.pattern||"[\\w']+","g");n=true}if(e.modified("field")||t.modified(e.field.fields)){n=true}if(n)this._counts={};return n};zc._finish=function(e,t){var n=this._counts,r=this._tuples||(this._tuples={}),i=t[0],a=t[1],u=e.fork(e.NO_SOURCE|e.NO_FIELDS),o,f,c;for(o in n){f=r[o];c=n[o]||0;if(!f&&c){r[o]=f=xn({});f[i]=o;f[a]=c;u.add.push(f)}else if(c===0){if(f)u.rem.push(f);n[o]=null;r[o]=null}else if(f[a]!==c){f[a]=c;u.mod.push(f)}}return u.modifies(t)};function Rc(e){Go.call(this,null,e)}Rc.Definition={type:"Cross",metadata:{generates:true},params:[{name:"filter",type:"expr"},{name:"as",type:"string",array:true,length:2,default:["a","b"]}]};var Pc=Object(dn["x"])(Rc,Go);Pc.transform=function(e,t){var n=t.fork(t.NO_SOURCE),r=this.value,i=e.as||["a","b"],a=i[0],u=i[1],o=!r||t.changed(t.ADD_REM)||e.modified("as")||e.modified("filter");if(o){if(r)n.rem=r;r=t.materialize(t.SOURCE).source;n.add=this.value=Lc(r,a,u,e.filter||dn["db"])}else{n.mod=r}n.source=this.value;return n.modifies(i)};function Lc(e,t,n,r){var i=[],a={},u=e.length,o=0,f,c;for(;o<u;++o){a[t]=c=e[o];for(f=0;f<u;++f){a[n]=e[f];if(r(a)){i.push(xn(a));a={};a[t]=c}}}return i}var Bc={kde:yc,mixture:xc,normal:mc,uniform:_c};var Ic="distributions",Uc="function",qc="field";function Wc(e,t){var n=e[Uc];if(!Bc.hasOwnProperty(n)){Object(dn["n"])("Unknown distribution function: "+n)}var r=Bc[n]();for(var i in e){if(i===qc){r.data((e.from||t()).map(e[i]))}else if(i===Ic){r[i](e[i].map(function(e){return Wc(e,t)}))}else if(typeof r[i]===Uc){r[i](e[i])}}return r}function Hc(e){Go.call(this,null,e)}var Gc=[{key:{function:"normal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"uniform"},params:[{name:"min",type:"number",default:0},{name:"max",type:"number",default:1}]},{key:{function:"kde"},params:[{name:"field",type:"field",required:true},{name:"from",type:"data"},{name:"bandwidth",type:"number",default:0}]}];var Yc={key:{function:"mixture"},params:[{name:"distributions",type:"param",array:true,params:Gc},{name:"weights",type:"number",array:true}]};Hc.Definition={type:"Density",metadata:{generates:true},params:[{name:"extent",type:"number",array:true,length:2},{name:"steps",type:"number",default:100},{name:"method",type:"string",default:"pdf",values:["pdf","cdf"]},{name:"distribution",type:"param",params:Gc.concat(Yc)},{name:"as",type:"string",array:true,default:["value","density"]}]};var $c=Object(dn["x"])(Hc,Go);$c.transform=function(e,t){var n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){var r=Wc(e.distribution,Vc(t)),i=e.method||"pdf";if(i!=="pdf"&&i!=="cdf"){Object(dn["n"])("Invalid density method: "+i)}if(!e.extent&&!r.data){Object(dn["n"])("Missing density extent parameter.")}i=r[i];var a=e.as||["value","density"],u=e.extent||Mf(r.data()),o=(u[1]-u[0])/(e.steps||100),f=Rf(u[0],u[1]+o/2,o).map(function(e){var t={};t[a[0]]=e;t[a[1]]=i(e);return xn(t)});if(this.value)n.rem=this.value;this.value=n.add=n.source=f}return n};function Vc(e){return function(){return e.materialize(e.SOURCE).source}}function Xc(e){Tn.call(this,null,Zc,e);this.modified(true)}Object(dn["x"])(Xc,Tn);function Zc(e){var t=e.expr;return this.value&&!e.modified("expr")?this.value:Object(dn["f"])(function(n){return t(n,e)},Object(dn["g"])(t),Object(dn["h"])(t))}function Jc(e){Go.call(this,[undefined,undefined],e)}Jc.Definition={type:"Extent",metadata:{},params:[{name:"field",type:"field",required:true}]};var Qc=Object(dn["x"])(Jc,Go);Qc.transform=function(e,t){var n=this.value,r=e.field,i=n[0],a=n[1],u;u=t.changed()||t.modified(r.fields)||e.modified("field");if(u||i==null){i=+Infinity;a=-Infinity}t.visit(u?t.SOURCE:t.ADD,function(e){var t=r(e);if(t!=null){t=+t;if(t<i)i=t;if(t>a)a=t}});if(!isFinite(i)||!isFinite(a)){i=a=undefined}this.value=[i,a]};function Kc(e,t){Tn.call(this,e);this.parent=t}var el=Object(dn["x"])(Kc,Tn);el.connect=function(e){this.targets().add(e);return e.source=this};el.add=function(e){this.value.add.push(e)};el.rem=function(e){this.value.rem.push(e)};el.mod=function(e){this.value.mod.push(e)};el.init=function(e){this.value.init(e,e.NO_SOURCE)};el.evaluate=function(){return this.value};function tl(e){Go.call(this,{},e);this._keys=Object(dn["s"])();var t=this._targets=[];t.active=0;t.forEach=function(e){for(var n=0,r=t.active;n<r;++n)e(t[n],n,t)}}var nl=Object(dn["x"])(tl,Go);nl.activate=function(e){this._targets[this._targets.active++]=e};nl.subflow=function(e,t,n,r){var i=this.value,a=i.hasOwnProperty(e)&&i[e],u,o;if(!a){o=r||(o=this._group[e])&&o.tuple;u=n.dataflow;a=u.add(new Kc(n.fork(n.NO_SOURCE),this)).connect(t(u,e,o));i[e]=a;this.activate(a)}else if(a.value.stamp<n.stamp){a.init(n);this.activate(a)}return a};nl.transform=function(e,t){var n=t.dataflow,r=this,i=e.key,a=e.subflow,u=this._keys,o=e.modified("key");function f(e){return r.subflow(e,a,t)}this._group=e.group||{};this._targets.active=0;t.visit(t.REM,function(e){var t=yn(e),n=u.get(t);if(n!==undefined){u.delete(t);f(n).rem(e)}});t.visit(t.ADD,function(e){var t=i(e);u.set(yn(e),t);f(t).add(e)});if(o||t.modified(i.fields)){t.visit(t.MOD,function(e){var t=yn(e),n=u.get(t),r=i(e);if(n===r){f(r).mod(e)}else{u.set(t,r);f(n).rem(e);f(r).add(e)}})}else if(t.changed(t.MOD)){t.visit(t.MOD,function(e){f(u.get(yn(e))).mod(e)})}if(o){t.visit(t.REFLOW,function(e){var t=yn(e),n=u.get(t),r=i(e);if(n!==r){u.set(t,r);f(n).rem(e);f(r).add(e)}})}if(u.empty>n.cleanThreshold)n.runAfter(u.clean);return t};function rl(e){Tn.call(this,null,il,e)}Object(dn["x"])(rl,Tn);function il(e){return this.value&&!e.modified()?this.value:Object(dn["z"])(e.name)?Object(dn["i"])(e.name).map(function(e){return Object(dn["t"])(e)}):Object(dn["t"])(e.name,e.as)}function al(e){Go.call(this,Object(dn["s"])(),e)}al.Definition={type:"Filter",metadata:{changes:true},params:[{name:"expr",type:"expr",required:true}]};var ul=Object(dn["x"])(al,Go);ul.transform=function(e,t){var n=t.dataflow,r=this.value,i=t.fork(),a=i.add,u=i.rem,o=i.mod,f=e.expr,c=true;t.visit(t.REM,function(e){var t=yn(e);if(!r.has(t))u.push(e);else r.delete(t)});t.visit(t.ADD,function(t){if(f(t,e))a.push(t);else r.set(yn(t),1)});function l(t){var n=yn(t),i=f(t,e),l=r.get(n);if(i&&l){r.delete(n);a.push(t)}else if(!i&&!l){r.set(n,1);u.push(t)}else if(c&&i&&!l){o.push(t)}}t.visit(t.MOD,l);if(e.modified()){c=false;t.visit(t.REFLOW,l)}if(r.empty>n.cleanThreshold)n.runAfter(r.clean);return i};function ol(e,t){if(!e)return null;return e.map(function(e,n){return t[n]||Object(dn["h"])(e)})}function fl(e){Go.call(this,[],e)}fl.Definition={type:"Flatten",metadata:{generates:true},params:[{name:"fields",type:"field",array:true,required:true},{name:"as",type:"string",array:true}]};var cl=Object(dn["x"])(fl,Go);cl.transform=function(e,t){var n=t.fork(t.NO_SOURCE),r=e.fields,i=ol(r,e.as||[]),a=i.length;n.rem=this.value;t.visit(t.SOURCE,function(e){var t=r.map(function(t){return t(e)}),u=t.reduce(function(e,t){return Math.max(e,t.length)},0),o=0,f,c,l;for(;o<u;++o){c=_n(e);for(f=0;f<a;++f){c[i[f]]=(l=t[f][o])==null?null:l}n.add.push(c)}});this.value=n.source=n.add;return n.modifies(i)};function ll(e){Go.call(this,[],e)}ll.Definition={type:"Fold",metadata:{generates:true},params:[{name:"fields",type:"field",array:true,required:true},{name:"as",type:"string",array:true,length:2,default:["key","value"]}]};var sl=Object(dn["x"])(ll,Go);sl.transform=function(e,t){var n=t.fork(t.NO_SOURCE),r=e.fields,i=r.map(dn["h"]),a=e.as||["key","value"],u=a[0],o=a[1],f=r.length;n.rem=this.value;t.visit(t.SOURCE,function(e){for(var t=0,a;t<f;++t){a=_n(e);a[u]=i[t];a[o]=r[t](e);n.add.push(a)}});this.value=n.source=n.add;return n.modifies(a)};function dl(e){Go.call(this,null,e)}dl.Definition={type:"Formula",metadata:{modifies:true},params:[{name:"expr",type:"expr",required:true},{name:"as",type:"string",required:true},{name:"initonly",type:"boolean"}]};var hl=Object(dn["x"])(dl,Go);hl.transform=function(e,t){var n=e.expr,r=e.as,i=e.modified(),a=e.initonly?t.ADD:i?t.SOURCE:t.modified(n.fields)?t.ADD_MOD:t.ADD;function u(t){t[r]=n(t,e)}if(i){t=t.materialize().reflow(true)}if(!e.initonly){t.modifies(r)}return t.visit(a,u)};function pl(e){Go.call(this,[],e)}var vl=Object(dn["x"])(pl,Go);vl.transform=function(e,t){var n=this.value,r=t.fork(t.ALL),i=e.size-n.length,a=e.generator,u,o,f;if(i>0){for(u=[];--i>=0;){u.push(f=xn(a(e)));n.push(f)}r.add=r.add.length?r.materialize(r.ADD).add.concat(u):u}else{o=n.slice(0,-i);r.rem=r.rem.length?r.materialize(r.REM).rem.concat(o):o;n=n.slice(-i)}r.source=this.value=n;return r};var gl={value:"value",median:ec,mean:Zf,min:rc,max:Xf};var ml=[];function yl(e){Go.call(this,[],e)}yl.Definition={type:"Impute",metadata:{changes:true},params:[{name:"field",type:"field",required:true},{name:"key",type:"field",required:true},{name:"keyvals",array:true},{name:"groupby",type:"field",array:true},{name:"method",type:"enum",default:"value",values:["value","mean","median","max","min"]},{name:"value",default:0}]};var bl=Object(dn["x"])(yl,Go);function xl(e){var t=e.method||gl.value,n;if(gl[t]==null){Object(dn["n"])("Unrecognized imputation method: "+t)}else if(t===gl.value){n=e.value!==undefined?e.value:0;return function(){return n}}else{return gl[t]}}function _l(e){var t=e.field;return function(e){return e?t(e):NaN}}bl.transform=function(e,t){var n=t.fork(t.ALL),r=xl(e),i=_l(e),a=Object(dn["h"])(e.field),u=Object(dn["h"])(e.key),o=(e.groupby||[]).map(dn["h"]),f=wl(t.source,e.groupby,e.key,e.keyvals),c=[],l=this.value,s=f.domain.length,d,h,p,v,g,m,y,b,x,_;for(g=0,b=f.length;g<b;++g){d=f[g];p=d.values;h=NaN;for(y=0;y<s;++y){if(d[y]!=null)continue;v=f.domain[y];_={_impute:true};for(m=0,x=p.length;m<x;++m)_[o[m]]=p[m];_[u]=v;_[a]=isNaN(h)?h=r(d,i):h;c.push(xn(_))}}if(c.length)n.add=n.materialize(n.ADD).add.concat(c);if(l.length)n.rem=n.materialize(n.REM).rem.concat(l);this.value=c;return n};function wl(e,t,n,r){var i=function(e){return e(g)},a=[],u=r?r.slice():[],o={},f={},c,l,s,d,h,p,v,g;u.forEach(function(e,t){o[e]=t+1});for(d=0,v=e.length;d<v;++d){g=e[d];p=n(g);h=o[p]||(o[p]=u.push(p));l=(c=t?t.map(i):ml)+"";if(!(s=f[l])){s=f[l]=[];a.push(s);s.values=c}s[h-1]=g}a.domain=u;return a}function kl(e){Oc.call(this,e)}kl.Definition={type:"JoinAggregate",metadata:{modifies:true},params:[{name:"groupby",type:"field",array:true},{name:"fields",type:"field",null:true,array:true},{name:"ops",type:"enum",array:true,values:ef},{name:"as",type:"string",null:true,array:true},{name:"key",type:"field"}]};var Ol=Object(dn["x"])(kl,Oc);Ol.transform=function(e,t){var n=this,r=e.modified(),i;if(n.value&&(r||t.modified(n._inputs))){i=n.value=r?n.init(e):{};t.visit(t.SOURCE,function(e){n.add(e)})}else{i=n.value=n.value||this.init(e);t.visit(t.REM,function(e){n.rem(e)});t.visit(t.ADD,function(e){n.add(e)})}n.changes();t.visit(t.SOURCE,function(e){Object(dn["o"])(e,i[n.cellkey(e)].tuple)});return t.reflow(r).modifies(this._outputs)};Ol.changes=function(){var e=this._adds,t=this._mods,n,r;for(n=0,r=this._alen;n<r;++n){this.celltuple(e[n]);e[n]=null}for(n=0,r=this._mlen;n<r;++n){this.celltuple(t[n]);t[n]=null}this._alen=this._mlen=0};function Al(e){Tn.call(this,null,El,e)}Object(dn["x"])(Al,Tn);function El(e){return this.value&&!e.modified()?this.value:Object(dn["H"])(e.fields,e.flat)}function Ml(e){Go.call(this,null,e)}var Sl=Object(dn["x"])(Ml,Go);Sl.transform=function(e,t){t.dataflow.request(this.target,e.url,e.format)};function Cl(e){Go.call(this,{},e)}Cl.Definition={type:"Lookup",metadata:{modifies:true},params:[{name:"index",type:"index",params:[{name:"from",type:"data",required:true},{name:"key",type:"field",required:true}]},{name:"values",type:"field",array:true},{name:"fields",type:"field",array:true,required:true},{name:"as",type:"string",array:true},{name:"default",default:null}]};var Dl=Object(dn["x"])(Cl,Go);Dl.transform=function(e,t){var n=t,r=e.as,i=e.fields,a=e.index,u=e.values,o=e.default==null?null:e.default,f=e.modified(),c=f?t.SOURCE:t.ADD,l=i.length,s,d,h;if(u){d=u.length;if(l>1&&!r){Object(dn["n"])('Multi-field lookup requires explicit "as" parameter.')}if(r&&r.length!==l*d){Object(dn["n"])('The "as" parameter has too few output field names.')}r=r||u.map(dn["h"]);s=function(e){for(var t=0,n=0,f,c;t<l;++t){c=a.get(i[t](e));if(c==null)for(f=0;f<d;++f,++n)e[r[n]]=o;else for(f=0;f<d;++f,++n)e[r[n]]=u[f](c)}}}else{if(!r){Object(dn["n"])("Missing output field names.")}s=function(e){for(var t=0,n;t<l;++t){n=a.get(i[t](e));e[r[t]]=n==null?o:n}}}if(f){n=t.reflow(true)}else{h=i.some(function(e){return t.modified(e.fields)});c|=h?t.MOD:0}t.visit(c,s);return n.modifies(r)};function jl(e){Tn.call(this,null,Nl,e)}Object(dn["x"])(jl,Tn);function Nl(e){if(this.value&&!e.modified()){return this.value}var t=+Infinity,n=-Infinity,r=e.extents,i,a,u;for(i=0,a=r.length;i<a;++i){u=r[i];if(u[0]<t)t=u[0];if(u[1]>n)n=u[1]}return[t,n]}function Fl(e){Tn.call(this,null,Tl,e)}Object(dn["x"])(Fl,Tn);function Tl(e){return this.value&&!e.modified()?this.value:e.values.reduce(function(e,t){return e.concat(t)},[])}function zl(e){Go.call(this,null,e)}Object(dn["x"])(zl,Go);zl.prototype.transform=function(e,t){this.modified(e.modified());this.value=e;return t.fork(t.NO_SOURCE|t.NO_FIELDS)};function Rl(e){Oc.call(this,e)}Rl.Definition={type:"Pivot",metadata:{generates:true,changes:true},params:[{name:"groupby",type:"field",array:true},{name:"field",type:"field",required:true},{name:"value",type:"field",required:true},{name:"op",type:"enum",values:ef,default:"sum"},{name:"limit",type:"number",default:0},{name:"key",type:"field"}]};var Pl=Object(dn["x"])(Rl,Oc);Pl._transform=Pl.transform;Pl.transform=function(e,t){return this._transform(Ll(e,t),t)};function Ll(e,t){var n=e.field,r=e.value,i=(e.op==="count"?"__count__":e.op)||"sum",a=Object(dn["g"])(n).concat(Object(dn["g"])(r)),u=Il(n,e.limit||0,t);return{key:e.key,groupby:e.groupby,ops:u.map(function(){return i}),fields:u.map(function(e){return Bl(e,n,r,a)}),as:u.map(function(e){return e+""}),modified:e.modified.bind(e)}}function Bl(e,t,n,r){return Object(dn["f"])(function(r){return t(r)===e?n(r):NaN},r,e+"")}function Il(e,t,n){var r={},i=[];n.visit(n.SOURCE,function(t){var n=e(t);if(!r[n]){r[n]=1;i.push(n)}});i.sort(function(e,t){return(e<t||e==null)&&t!=null?-1:(e>t||t==null)&&e!=null?1:(t=t instanceof Date?+t:t,e=e instanceof Date?+e:e)!==e&&t===t?-1:t!==t&&e===e?1:0});return t?i.slice(0,t):i}function Ul(e){tl.call(this,e)}var ql=Object(dn["x"])(Ul,tl);ql.transform=function(e,t){var n=this,r=e.subflow,i=e.field;if(e.modified("field")||i&&t.modified(Object(dn["g"])(i))){Object(dn["n"])("PreFacet does not support field modification.")}this._targets.active=0;t.visit(t.MOD,function(e){var a=n.subflow(yn(e),r,t,e);i?i(e).forEach(function(e){a.mod(e)}):a.mod(e)});t.visit(t.ADD,function(e){var a=n.subflow(yn(e),r,t,e);i?i(e).forEach(function(e){a.add(xn(e))}):a.add(e)});t.visit(t.REM,function(e){var a=n.subflow(yn(e),r,t,e);i?i(e).forEach(function(e){a.rem(e)}):a.rem(e)});return t};function Wl(e){Go.call(this,null,e)}Wl.Definition={type:"Project",metadata:{generates:true,changes:true},params:[{name:"fields",type:"field",array:true},{name:"as",type:"string",null:true,array:true}]};var Hl=Object(dn["x"])(Wl,Go);Hl.transform=function(e,t){var n=e.fields,r=ol(e.fields,e.as||[]),i=n?function(e,t){return Gl(e,t,n,r)}:wn,a,u;if(this.value){u=this.value}else{t=t.addAll();u=this.value={}}a=t.fork(t.NO_SOURCE);t.visit(t.REM,function(e){var t=yn(e);a.rem.push(u[t]);u[t]=null});t.visit(t.ADD,function(e){var t=i(e,xn({}));u[yn(e)]=t;a.add.push(t)});t.visit(t.MOD,function(e){a.mod.push(i(e,u[yn(e)]))});return a};function Gl(e,t,n,r){for(var i=0,a=n.length;i<a;++i){t[r[i]]=n[i](e)}return t}function Yl(e){Go.call(this,null,e)}var $l=Object(dn["x"])(Yl,Go);$l.transform=function(e,t){this.value=e.value;return e.modified("value")?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation};function Vl(e){Go.call(this,null,e)}var Xl=Object(dn["x"])(Vl,Go);Xl.transform=function(e,t){var n,r;if(this.value){r=this.value}else{n=t=t.addAll();r=this.value={}}if(e.derive){n=t.fork(t.NO_SOURCE);t.visit(t.REM,function(e){var t=yn(e);n.rem.push(r[t]);r[t]=null});t.visit(t.ADD,function(e){var t=_n(e);r[yn(e)]=t;n.add.push(t)});t.visit(t.MOD,function(e){n.mod.push(wn(e,r[yn(e)]))})}return n};function Zl(e){Go.call(this,[],e);this.count=0}Zl.Definition={type:"Sample",metadata:{},params:[{name:"size",type:"number",default:1e3}]};var Jl=Object(dn["x"])(Zl,Go);Jl.transform=function(e,t){var n=t.fork(t.NO_SOURCE),r=e.modified("size"),i=e.size,a=this.value,u=this.count,o=0,f=a.reduce(function(e,t){e[yn(t)]=1;return e},{});function c(e){var t,r;if(a.length<i){a.push(e)}else{r=~~((u+1)*lf());if(r<a.length&&r>=o){t=a[r];if(f[yn(t)])n.rem.push(t);a[r]=e}}++u}if(t.rem.length){t.visit(t.REM,function(e){var t=yn(e);if(f[t]){f[t]=-1;n.rem.push(e)}--u});a=a.filter(function(e){return f[yn(e)]!==-1})}if((t.rem.length||r)&&a.length<i&&t.source){o=u=a.length;t.visit(t.SOURCE,function(e){if(!f[yn(e)])c(e)});o=-1}if(r&&a.length>i){for(var l=0,s=a.length-i;l<s;++l){f[yn(a[l])]=-1;n.rem.push(a[l])}a=a.slice(s)}if(t.mod.length){t.visit(t.MOD,function(e){if(f[yn(e)])n.mod.push(e)})}if(t.add.length){t.visit(t.ADD,c)}if(t.add.length||o<0){n.add=a.filter(function(e){return!f[yn(e)]})}this.count=u;this.value=n.source=a;return n};function Ql(e){Go.call(this,null,e)}Ql.Definition={type:"Sequence",metadata:{changes:true},params:[{name:"start",type:"number",required:true},{name:"stop",type:"number",required:true},{name:"step",type:"number",default:1},{name:"as",type:"string",default:"data"}]};var Kl=Object(dn["x"])(Ql,Go);Kl.transform=function(e,t){if(this.value&&!e.modified())return;var n=t.materialize().fork(t.MOD),r=e.as||"data";n.rem=this.value?t.rem.concat(this.value):t.rem;this.value=Rf(e.start,e.stop,e.step||1).map(function(e){var t={};t[r]=e;return xn(t)});n.add=t.add.concat(this.value);return n};function es(e){Go.call(this,null,e);this.modified(true)}var ts=Object(dn["x"])(es,Go);ts.transform=function(e,t){this.value=t.source;return t.changed()?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation};function ns(e){Go.call(this,Object(dn["s"])(),e)}var rs=Object(dn["x"])(ns,Go);rs.transform=function(e,t){var n=t.dataflow,r=e.field,i=this.value,a=true;function u(e){i.set(r(e),e)}if(e.modified("field")||t.modified(r.fields)){i.clear();t.visit(t.SOURCE,u)}else if(t.changed()){t.visit(t.REM,function(e){i.delete(r(e))});t.visit(t.ADD,u)}else{a=false}this.modified(a);if(i.empty>n.cleanThreshold)n.runAfter(i.clean);return t.fork()};function is(e){Go.call(this,null,e)}var as=Object(dn["x"])(is,Go);as.transform=function(e,t){var n=!this.value||e.modified("field")||e.modified("sort")||t.changed()||e.sort&&t.modified(e.sort.fields);if(n){this.value=(e.sort?t.source.slice().sort(e.sort):t.source).map(e.field)}};function us(e,t,n,r){var i=os[e](t,n);return{init:i.init||dn["gb"],update:function(e,t){t[r]=i.next(e)}}}var os={row_number:function(){return{next:function(e){return e.index+1}}},rank:function(){var e;return{init:function(){e=1},next:function(t){var n=t.index,r=t.data;return n&&t.compare(r[n-1],r[n])?e=n+1:e}}},dense_rank:function(){var e;return{init:function(){e=1},next:function(t){var n=t.index,r=t.data;return n&&t.compare(r[n-1],r[n])?++e:e}}},percent_rank:function(){var e=os.rank(),t=e.next;return{init:e.init,next:function(e){return(t(e)-1)/(e.data.length-1)}}},cume_dist:function(){var e;return{init:function(){e=0},next:function(t){var n=t.index,r=t.data,i=t.compare;if(e<n){while(n+1<r.length&&!i(r[n],r[n+1]))++n;e=n}return(1+e)/r.length}}},ntile:function(e,t){t=+t;if(!(t>0))Object(dn["n"])("ntile num must be greater than zero.");var n=os.cume_dist(),r=n.next;return{init:n.init,next:function(e){return Math.ceil(t*r(e))}}},lag:function(e,t){t=+t||1;return{next:function(n){var r=n.index-t;return r>=0?e(n.data[r]):null}}},lead:function(e,t){t=+t||1;return{next:function(n){var r=n.index+t,i=n.data;return r<i.length?e(i[r]):null}}},first_value:function(e){return{next:function(t){return e(t.data[t.i0])}}},last_value:function(e){return{next:function(t){return e(t.data[t.i1-1])}}},nth_value:function(e,t){t=+t;if(!(t>0))Object(dn["n"])("nth_value nth must be greater than zero.");return{next:function(n){var r=n.i0+(t-1);return r<n.i1?e(n.data[r]):null}}}};var fs=Object.keys(os);function cs(e){var t=this,n=Object(dn["i"])(e.ops),r=Object(dn["i"])(e.fields),i=Object(dn["i"])(e.params),a=Object(dn["i"])(e.as),u=t.outputs=[],o=t.windows=[],f={},c={},l=true,s=[],d=[];function h(e){Object(dn["i"])(Object(dn["g"])(e)).forEach(function(e){f[e]=1})}h(e.sort);n.forEach(function(e,t){var n=r[t],f=Object(dn["h"])(n),p=Qo(e,f,a[t]);h(n);u.push(p);if(os.hasOwnProperty(e)){o.push(us(e,r[t],i[t],p))}else{if(n==null&&e!=="count"){Object(dn["n"])("Null aggregate field specified.")}if(e==="count"){s.push(p);return}l=false;var v=c[f];if(!v){v=c[f]=[];v.field=n;d.push(v)}v.push(tf(e,p))}});if(s.length||d.length){t.cell=ss(d,s,l)}t.inputs=Object.keys(f)}var ls=cs.prototype;ls.init=function(){this.windows.forEach(function(e){e.init()});if(this.cell)this.cell.init()};ls.update=function(e,t){var n=this,r=n.cell,i=n.windows,a=e.data,u=i&&i.length,o;if(r){for(o=e.p0;o<e.i0;++o)r.rem(a[o]);for(o=e.p1;o<e.i1;++o)r.add(a[o]);r.set(t)}for(o=0;o<u;++o)i[o].update(e,t)};function ss(e,t,n){e=e.map(function(e){return uf(e,e.field)});var r={num:0,agg:null,store:false,count:t};if(!n){var i=e.length,a=r.agg=Array(i),u=0;for(;u<i;++u)a[u]=new e[u](r)}if(r.store){var o=r.data=new wc}r.add=function(e){r.num+=1;if(n)return;if(o)o.add(e);for(var t=0;t<i;++t){a[t].add(a[t].get(e),e)}};r.rem=function(e){r.num-=1;if(n)return;if(o)o.rem(e);for(var t=0;t<i;++t){a[t].rem(a[t].get(e),e)}};r.set=function(e){var i,u;if(o)o.values();for(i=0,u=t.length;i<u;++i)e[t[i]]=r.num;if(!n)for(i=0,u=a.length;i<u;++i)a[i].set(e)};r.init=function(){r.num=0;if(o)o.reset();for(var e=0;e<i;++e)a[e].init()};return r}function ds(e){Go.call(this,{},e);this._mlen=0;this._mods=[]}ds.Definition={type:"Window",metadata:{modifies:true},params:[{name:"sort",type:"compare"},{name:"groupby",type:"field",array:true},{name:"ops",type:"enum",array:true,values:fs.concat(ef)},{name:"params",type:"number",null:true,array:true},{name:"fields",type:"field",null:true,array:true},{name:"as",type:"string",null:true,array:true},{name:"frame",type:"number",null:true,array:true,length:2,default:[null,0]},{name:"ignorePeers",type:"boolean",default:false}]};var hs=Object(dn["x"])(ds,Go);hs.transform=function(e,t){var n=this,r=n.state,i=e.modified(),a,u;this.stamp=t.stamp;if(!r||i){r=n.state=new cs(e)}var o=Jo(e.groupby);function f(e){return n.group(o(e))}if(i||t.modified(r.inputs)){n.value={};t.visit(t.SOURCE,function(e){f(e).add(e)})}else{t.visit(t.REM,function(e){f(e).remove(e)});t.visit(t.ADD,function(e){f(e).add(e)})}for(a=0,u=n._mlen;a<u;++a){ps(n._mods[a],r,e)}n._mlen=0;n._mods=[];return t.reflow(i).modifies(r.outputs)};hs.group=function(e){var t=this,n=t.value[e];if(!n){n=t.value[e]=Sc(yn);n.stamp=-1}if(n.stamp<t.stamp){n.stamp=t.stamp;t._mods[t._mlen++]=n}return n};function ps(e,t,n){var r=n.sort,i=r&&!n.ignorePeers,a=n.frame||[null,0],u=e.data(r),o=u.length,f=0,c=i?hf(r):null,l={i0:0,i1:0,p0:0,p1:0,index:0,data:u,compare:r||Object(dn["l"])(-1)};for(t.init();f<o;++f){vs(l,a,f,o);if(i)gs(l,c);t.update(l,u[f])}}function vs(e,t,n,r){e.p0=e.i0;e.p1=e.i1;e.i0=t[0]==null?0:Math.max(0,n-Math.abs(t[0]));e.i1=t[1]==null?r:Math.min(r,n+Math.abs(t[1])+1);e.index=n}function gs(e,t){var n=e.i0,r=e.i1-1,i=e.compare,a=e.data,u=a.length-1;if(n>0&&!i(a[n],a[n-1]))e.i0=t.left(a,a[n]);if(r<u&&!i(a[r],a[r+1]))e.i1=t.right(a,a[r])}var ms="top";var ys="left";var bs="right";var xs="bottom";var _s="top-left";var ws="top-right";var ks="bottom-left";var Os="bottom-right";var As="start";var Es="middle";var Ms="end";var Ss="group";var Cs="axis";var Ds="title";var js="frame";var Ns="scope";var Fs="legend";var Ts="row-header";var zs="row-footer";var Rs="row-title";var Ps="column-header";var Ls="column-footer";var Bs="column-title";var Is="padding";var Us="symbol";var qs="fit";var Ws="fit-x";var Hs="fit-y";var Gs="pad";var Ys="none";var $s="all";var Vs="each";var Xs="flush";var Zs="column";var Js="row";function Qs(e){this.clear();if(e)this.union(e)}var Ks=Qs.prototype;Ks.clone=function(){return new Qs(this)};Ks.clear=function(){this.x1=+Number.MAX_VALUE;this.y1=+Number.MAX_VALUE;this.x2=-Number.MAX_VALUE;this.y2=-Number.MAX_VALUE;return this};Ks.empty=function(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE};Ks.set=function(e,t,n,r){if(n<e){this.x2=e;this.x1=n}else{this.x1=e;this.x2=n}if(r<t){this.y2=t;this.y1=r}else{this.y1=t;this.y2=r}return this};Ks.add=function(e,t){if(e<this.x1)this.x1=e;if(t<this.y1)this.y1=t;if(e>this.x2)this.x2=e;if(t>this.y2)this.y2=t;return this};Ks.expand=function(e){this.x1-=e;this.y1-=e;this.x2+=e;this.y2+=e;return this};Ks.round=function(){this.x1=Math.floor(this.x1);this.y1=Math.floor(this.y1);this.x2=Math.ceil(this.x2);this.y2=Math.ceil(this.y2);return this};Ks.translate=function(e,t){this.x1+=e;this.x2+=e;this.y1+=t;this.y2+=t;return this};Ks.rotate=function(e,t,n){var r=Math.cos(e),i=Math.sin(e),a=t-t*r+n*i,u=n-t*i-n*r,o=this.x1,f=this.x2,c=this.y1,l=this.y2;return this.clear().add(r*o-i*c+a,i*o+r*c+u).add(r*o-i*l+a,i*o+r*l+u).add(r*f-i*c+a,i*f+r*c+u).add(r*f-i*l+a,i*f+r*l+u)};Ks.union=function(e){if(e.x1<this.x1)this.x1=e.x1;if(e.y1<this.y1)this.y1=e.y1;if(e.x2>this.x2)this.x2=e.x2;if(e.y2>this.y2)this.y2=e.y2;return this};Ks.intersect=function(e){if(e.x1>this.x1)this.x1=e.x1;if(e.y1>this.y1)this.y1=e.y1;if(e.x2<this.x2)this.x2=e.x2;if(e.y2<this.y2)this.y2=e.y2;return this};Ks.encloses=function(e){return e&&(this.x1<=e.x1&&this.x2>=e.x2&&this.y1<=e.y1&&this.y2>=e.y2)};Ks.alignsWith=function(e){return e&&(this.x1==e.x1||this.x2==e.x2||this.y1==e.y1||this.y2==e.y2)};Ks.intersects=function(e){return e&&!(this.x2<e.x1||this.x1>e.x2||this.y2<e.y1||this.y1>e.y2)};Ks.contains=function(e,t){return!(e<this.x1||e>this.x2||t<this.y1||t>this.y2)};Ks.width=function(){return this.x2-this.x1};Ks.height=function(){return this.y2-this.y1};var ed=0;var td=function(e,t){var n=[],r;return r={id:"gradient_"+ed++,x1:e?e[0]:0,y1:e?e[1]:0,x2:t?t[0]:1,y2:t?t[1]:0,stops:n,stop:function(e,t){n.push({offset:e,color:t});return r}}};function nd(e){this.mark=e;this.bounds=this.bounds||new Qs}function rd(e){nd.call(this,e);this.items=this.items||[]}Object(dn["x"])(rd,nd);function id(e,t){if(typeof document!=="undefined"&&document.createElement){var n=document.createElement("canvas");if(n&&n.getContext){n.width=e;n.height=t;return n}}return null}function ad(){return typeof Image!=="undefined"?Image:null}function ud(e){this._pending=0;this._loader=e||Yn()}var od=ud.prototype;od.pending=function(){return this._pending};function fd(e){e._pending+=1}function cd(e){e._pending-=1}od.sanitizeURL=function(e){var t=this;fd(t);return t._loader.sanitize(e,{context:"href"}).then(function(e){cd(t);return e}).catch(function(){cd(t);return null})};od.loadImage=function(e){var t=this,n=ad();fd(t);return t._loader.sanitize(e,{context:"image"}).then(function(e){var r=e.href;if(!r||!n)throw{url:r};var i=new n;i.onload=function(){cd(t);i.loaded=true};i.onerror=function(){cd(t);i.loaded=false};i.src=r;return i}).catch(function(e){cd(t);return{loaded:false,width:0,height:0,src:e&&e.url||""}})};od.ready=function(){var e=this;return new Promise(function(t){function n(r){if(!e.pending())t(r);else setTimeout(function(){n(true)},10)}n(false)})};var ld=Math.PI,sd=2*ld,dd=1e-6,hd=sd-dd;function pd(){this._x0=this._y0=this._x1=this._y1=null;this._=""}function vd(){return new pd}pd.prototype=vd.prototype={constructor:pd,moveTo:function(e,t){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)},closePath:function(){if(this._x1!==null){this._x1=this._x0,this._y1=this._y0;this._+="Z"}},lineTo:function(e,t){this._+="L"+(this._x1=+e)+","+(this._y1=+t)},quadraticCurveTo:function(e,t,n,r){this._+="Q"+ +e+","+ +t+","+(this._x1=+n)+","+(this._y1=+r)},bezierCurveTo:function(e,t,n,r,i,a){this._+="C"+ +e+","+ +t+","+ +n+","+ +r+","+(this._x1=+i)+","+(this._y1=+a)},arcTo:function(e,t,n,r,i){e=+e,t=+t,n=+n,r=+r,i=+i;var a=this._x1,u=this._y1,o=n-e,f=r-t,c=a-e,l=u-t,s=c*c+l*l;if(i<0)throw new Error("negative radius: "+i);if(this._x1===null){this._+="M"+(this._x1=e)+","+(this._y1=t)}else if(!(s>dd));else if(!(Math.abs(l*o-f*c)>dd)||!i){this._+="L"+(this._x1=e)+","+(this._y1=t)}else{var d=n-a,h=r-u,p=o*o+f*f,v=d*d+h*h,g=Math.sqrt(p),m=Math.sqrt(s),y=i*Math.tan((ld-Math.acos((p+s-v)/(2*g*m)))/2),b=y/m,x=y/g;if(Math.abs(b-1)>dd){this._+="L"+(e+b*c)+","+(t+b*l)}this._+="A"+i+","+i+",0,0,"+ +(l*d>c*h)+","+(this._x1=e+x*o)+","+(this._y1=t+x*f)}},arc:function(e,t,n,r,i,a){e=+e,t=+t,n=+n;var u=n*Math.cos(r),o=n*Math.sin(r),f=e+u,c=t+o,l=1^a,s=a?r-i:i-r;if(n<0)throw new Error("negative radius: "+n);if(this._x1===null){this._+="M"+f+","+c}else if(Math.abs(this._x1-f)>dd||Math.abs(this._y1-c)>dd){this._+="L"+f+","+c}if(!n)return;if(s<0)s=s%sd+sd;if(s>hd){this._+="A"+n+","+n+",0,1,"+l+","+(e-u)+","+(t-o)+"A"+n+","+n+",0,1,"+l+","+(this._x1=f)+","+(this._y1=c)}else if(s>dd){this._+="A"+n+","+n+",0,"+ +(s>=ld)+","+l+","+(this._x1=e+n*Math.cos(i))+","+(this._y1=t+n*Math.sin(i))}},rect:function(e,t,n,r){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)+"h"+ +n+"v"+ +r+"h"+-n+"Z"},toString:function(){return this._}};var gd=vd;var md=function(e){return function t(){return e}};var yd=Math.abs;var bd=Math.atan2;var xd=Math.cos;var _d=Math.max;var wd=Math.min;var kd=Math.sin;var Od=Math.sqrt;var Ad=1e-12;var Ed=Math.PI;var Md=Ed/2;var Sd=2*Ed;function Cd(e){return e>1?0:e<-1?Ed:Math.acos(e)}function Dd(e){return e>=1?Md:e<=-1?-Md:Math.asin(e)}function jd(e){return e.innerRadius}function Nd(e){return e.outerRadius}function Fd(e){return e.startAngle}function Td(e){return e.endAngle}function zd(e){return e&&e.padAngle}function Rd(e,t,n,r,i,a,u,o){var f=n-e,c=r-t,l=u-i,s=o-a,d=s*f-l*c;if(d*d<Ad)return;d=(l*(t-a)-s*(e-i))/d;return[e+d*f,t+d*c]}function Pd(e,t,n,r,i,a,u){var o=e-n,f=t-r,c=(u?a:-a)/Od(o*o+f*f),l=c*f,s=-c*o,d=e+l,h=t+s,p=n+l,v=r+s,g=(d+p)/2,m=(h+v)/2,y=p-d,b=v-h,x=y*y+b*b,_=i-a,w=d*v-p*h,k=(b<0?-1:1)*Od(_d(0,_*_*x-w*w)),O=(w*b-y*k)/x,A=(-w*y-b*k)/x,E=(w*b+y*k)/x,M=(-w*y+b*k)/x,S=O-g,C=A-m,D=E-g,j=M-m;if(S*S+C*C>D*D+j*j)O=E,A=M;return{cx:O,cy:A,x01:-l,y01:-s,x11:O*(i/_-1),y11:A*(i/_-1)}}var Ld=function(){var e=jd,t=Nd,n=md(0),r=null,i=Fd,a=Td,u=zd,o=null;function f(){var f,c,l=+e.apply(this,arguments),s=+t.apply(this,arguments),d=i.apply(this,arguments)-Md,h=a.apply(this,arguments)-Md,p=yd(h-d),v=h>d;if(!o)o=f=gd();if(s<l)c=s,s=l,l=c;if(!(s>Ad))o.moveTo(0,0);else if(p>Sd-Ad){o.moveTo(s*xd(d),s*kd(d));o.arc(0,0,s,d,h,!v);if(l>Ad){o.moveTo(l*xd(h),l*kd(h));o.arc(0,0,l,h,d,v)}}else{var g=d,m=h,y=d,b=h,x=p,_=p,w=u.apply(this,arguments)/2,k=w>Ad&&(r?+r.apply(this,arguments):Od(l*l+s*s)),O=wd(yd(s-l)/2,+n.apply(this,arguments)),A=O,E=O,M,S;if(k>Ad){var C=Dd(k/l*kd(w)),D=Dd(k/s*kd(w));if((x-=C*2)>Ad)C*=v?1:-1,y+=C,b-=C;else x=0,y=b=(d+h)/2;if((_-=D*2)>Ad)D*=v?1:-1,g+=D,m-=D;else _=0,g=m=(d+h)/2}var j=s*xd(g),N=s*kd(g),F=l*xd(b),T=l*kd(b);if(O>Ad){var z=s*xd(m),R=s*kd(m),P=l*xd(y),L=l*kd(y),B;if(p<Ed&&(B=Rd(j,N,P,L,z,R,F,T))){var I=j-B[0],U=N-B[1],q=z-B[0],W=R-B[1],H=1/kd(Cd((I*q+U*W)/(Od(I*I+U*U)*Od(q*q+W*W)))/2),G=Od(B[0]*B[0]+B[1]*B[1]);A=wd(O,(l-G)/(H-1));E=wd(O,(s-G)/(H+1))}}if(!(_>Ad))o.moveTo(j,N);else if(E>Ad){M=Pd(P,L,j,N,s,E,v);S=Pd(z,R,F,T,s,E,v);o.moveTo(M.cx+M.x01,M.cy+M.y01);if(E<O)o.arc(M.cx,M.cy,E,bd(M.y01,M.x01),bd(S.y01,S.x01),!v);else{o.arc(M.cx,M.cy,E,bd(M.y01,M.x01),bd(M.y11,M.x11),!v);o.arc(0,0,s,bd(M.cy+M.y11,M.cx+M.x11),bd(S.cy+S.y11,S.cx+S.x11),!v);o.arc(S.cx,S.cy,E,bd(S.y11,S.x11),bd(S.y01,S.x01),!v)}}else o.moveTo(j,N),o.arc(0,0,s,g,m,!v);if(!(l>Ad)||!(x>Ad))o.lineTo(F,T);else if(A>Ad){M=Pd(F,T,z,R,l,-A,v);S=Pd(j,N,P,L,l,-A,v);o.lineTo(M.cx+M.x01,M.cy+M.y01);if(A<O)o.arc(M.cx,M.cy,A,bd(M.y01,M.x01),bd(S.y01,S.x01),!v);else{o.arc(M.cx,M.cy,A,bd(M.y01,M.x01),bd(M.y11,M.x11),!v);o.arc(0,0,l,bd(M.cy+M.y11,M.cx+M.x11),bd(S.cy+S.y11,S.cx+S.x11),v);o.arc(S.cx,S.cy,A,bd(S.y11,S.x11),bd(S.y01,S.x01),!v)}}else o.arc(0,0,l,b,y,v)}o.closePath();if(f)return o=null,f+""||null}f.centroid=function(){var n=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,r=(+i.apply(this,arguments)+ +a.apply(this,arguments))/2-Ed/2;return[xd(r)*n,kd(r)*n]};f.innerRadius=function(t){return arguments.length?(e=typeof t==="function"?t:md(+t),f):e};f.outerRadius=function(e){return arguments.length?(t=typeof e==="function"?e:md(+e),f):t};f.cornerRadius=function(e){return arguments.length?(n=typeof e==="function"?e:md(+e),f):n};f.padRadius=function(e){return arguments.length?(r=e==null?null:typeof e==="function"?e:md(+e),f):r};f.startAngle=function(e){return arguments.length?(i=typeof e==="function"?e:md(+e),f):i};f.endAngle=function(e){return arguments.length?(a=typeof e==="function"?e:md(+e),f):a};f.padAngle=function(e){return arguments.length?(u=typeof e==="function"?e:md(+e),f):u};f.context=function(e){return arguments.length?(o=e==null?null:e,f):o};return f};function Bd(e){this._context=e}Bd.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){if(this._line||this._line!==0&&this._point===1)this._context.closePath();this._line=1-this._line},point:function(e,t){e=+e,t=+t;switch(this._point){case 0:this._point=1;this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};var Id=function(e){return new Bd(e)};function Ud(e){return e[0]}function qd(e){return e[1]}var Wd=function(){var e=Ud,t=qd,n=md(true),r=null,i=Id,a=null;function u(u){var o,f=u.length,c,l=false,s;if(r==null)a=i(s=gd());for(o=0;o<=f;++o){if(!(o<f&&n(c=u[o],o,u))===l){if(l=!l)a.lineStart();else a.lineEnd()}if(l)a.point(+e(c,o,u),+t(c,o,u))}if(s)return a=null,s+""||null}u.x=function(t){return arguments.length?(e=typeof t==="function"?t:md(+t),u):e};u.y=function(e){return arguments.length?(t=typeof e==="function"?e:md(+e),u):t};u.defined=function(e){return arguments.length?(n=typeof e==="function"?e:md(!!e),u):n};u.curve=function(e){return arguments.length?(i=e,r!=null&&(a=i(r)),u):i};u.context=function(e){return arguments.length?(e==null?r=a=null:a=i(r=e),u):r};return u};var Hd=function(){var e=Ud,t=null,n=md(0),r=qd,i=md(true),a=null,u=Id,o=null;function f(f){var c,l,s,d=f.length,h,p=false,v,g=new Array(d),m=new Array(d);if(a==null)o=u(v=gd());for(c=0;c<=d;++c){if(!(c<d&&i(h=f[c],c,f))===p){if(p=!p){l=c;o.areaStart();o.lineStart()}else{o.lineEnd();o.lineStart();for(s=c-1;s>=l;--s){o.point(g[s],m[s])}o.lineEnd();o.areaEnd()}}if(p){g[c]=+e(h,c,f),m[c]=+n(h,c,f);o.point(t?+t(h,c,f):g[c],r?+r(h,c,f):m[c])}}if(v)return o=null,v+""||null}function c(){return Wd().defined(i).curve(u).context(a)}f.x=function(n){return arguments.length?(e=typeof n==="function"?n:md(+n),t=null,f):e};f.x0=function(t){return arguments.length?(e=typeof t==="function"?t:md(+t),f):e};f.x1=function(e){return arguments.length?(t=e==null?null:typeof e==="function"?e:md(+e),f):t};f.y=function(e){return arguments.length?(n=typeof e==="function"?e:md(+e),r=null,f):n};f.y0=function(e){return arguments.length?(n=typeof e==="function"?e:md(+e),f):n};f.y1=function(e){return arguments.length?(r=e==null?null:typeof e==="function"?e:md(+e),f):r};f.lineX0=f.lineY0=function(){return c().x(e).y(n)};f.lineY1=function(){return c().x(e).y(r)};f.lineX1=function(){return c().x(t).y(n)};f.defined=function(e){return arguments.length?(i=typeof e==="function"?e:md(!!e),f):i};f.curve=function(e){return arguments.length?(u=e,a!=null&&(o=u(a)),f):u};f.context=function(e){return arguments.length?(e==null?a=o=null:o=u(a=e),f):a};return f};var Gd=function(e,t){return t<e?-1:t>e?1:t>=e?0:NaN};var Yd=function(e){return e};var $d=function(){var e=Yd,t=Gd,n=null,r=md(0),i=md(Sd),a=md(0);function u(u){var o,f=u.length,c,l,s=0,d=new Array(f),h=new Array(f),p=+r.apply(this,arguments),v=Math.min(Sd,Math.max(-Sd,i.apply(this,arguments)-p)),g,m=Math.min(Math.abs(v)/f,a.apply(this,arguments)),y=m*(v<0?-1:1),b;for(o=0;o<f;++o){if((b=h[d[o]=o]=+e(u[o],o,u))>0){s+=b}}if(t!=null)d.sort(function(e,n){return t(h[e],h[n])});else if(n!=null)d.sort(function(e,t){return n(u[e],u[t])});for(o=0,l=s?(v-f*y)/s:0;o<f;++o,p=g){c=d[o],b=h[c],g=p+(b>0?b*l:0)+y,h[c]={data:u[c],index:o,value:b,startAngle:p,endAngle:g,padAngle:m}}return h}u.value=function(t){return arguments.length?(e=typeof t==="function"?t:md(+t),u):e};u.sortValues=function(e){return arguments.length?(t=e,n=null,u):t};u.sort=function(e){return arguments.length?(n=e,t=null,u):n};u.startAngle=function(e){return arguments.length?(r=typeof e==="function"?e:md(+e),u):r};u.endAngle=function(e){return arguments.length?(i=typeof e==="function"?e:md(+e),u):i};u.padAngle=function(e){return arguments.length?(a=typeof e==="function"?e:md(+e),u):a};return u};var Vd=Zd(Id);function Xd(e){this._curve=e}Xd.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(e,t){this._curve.point(t*Math.sin(e),t*-Math.cos(e))}};function Zd(e){function t(t){return new Xd(e(t))}t._curve=e;return t}function Jd(e){var t=e.curve;e.angle=e.x,delete e.x;e.radius=e.y,delete e.y;e.curve=function(e){return arguments.length?t(Zd(e)):t()._curve};return e}var Qd=function(){return Jd(Wd().curve(Vd))};var Kd=function(){var e=Hd().curve(Vd),t=e.curve,n=e.lineX0,r=e.lineX1,i=e.lineY0,a=e.lineY1;e.angle=e.x,delete e.x;e.startAngle=e.x0,delete e.x0;e.endAngle=e.x1,delete e.x1;e.radius=e.y,delete e.y;e.innerRadius=e.y0,delete e.y0;e.outerRadius=e.y1,delete e.y1;e.lineStartAngle=function(){return Jd(n())},delete e.lineX0;e.lineEndAngle=function(){return Jd(r())},delete e.lineX1;e.lineInnerRadius=function(){return Jd(i())},delete e.lineY0;e.lineOuterRadius=function(){return Jd(a())},delete e.lineY1;e.curve=function(e){return arguments.length?t(Zd(e)):t()._curve};return e};var eh=function(e,t){return[(t=+t)*Math.cos(e-=Math.PI/2),t*Math.sin(e)]};var th=Array.prototype.slice;function nh(e){return e.source}function rh(e){return e.target}function ih(e){var t=nh,n=rh,r=Ud,i=qd,a=null;function u(){var u,o=th.call(arguments),f=t.apply(this,o),c=n.apply(this,o);if(!a)a=u=gd();e(a,+r.apply(this,(o[0]=f,o)),+i.apply(this,o),+r.apply(this,(o[0]=c,o)),+i.apply(this,o));if(u)return a=null,u+""||null}u.source=function(e){return arguments.length?(t=e,u):t};u.target=function(e){return arguments.length?(n=e,u):n};u.x=function(e){return arguments.length?(r=typeof e==="function"?e:md(+e),u):r};u.y=function(e){return arguments.length?(i=typeof e==="function"?e:md(+e),u):i};u.context=function(e){return arguments.length?(a=e==null?null:e,u):a};return u}function ah(e,t,n,r,i){e.moveTo(t,n);e.bezierCurveTo(t=(t+r)/2,n,t,i,r,i)}function uh(e,t,n,r,i){e.moveTo(t,n);e.bezierCurveTo(t,n=(n+i)/2,r,n,r,i)}function oh(e,t,n,r,i){var a=eh(t,n),u=eh(t,n=(n+i)/2),o=eh(r,n),f=eh(r,i);e.moveTo(a[0],a[1]);e.bezierCurveTo(u[0],u[1],o[0],o[1],f[0],f[1])}function fh(){return ih(ah)}function ch(){return ih(uh)}function lh(){var e=ih(oh);e.angle=e.x,delete e.x;e.radius=e.y,delete e.y;return e}var sh={draw:function(e,t){var n=Math.sqrt(t/Ed);e.moveTo(n,0);e.arc(0,0,n,0,Sd)}};var dh={draw:function(e,t){var n=Math.sqrt(t/5)/2;e.moveTo(-3*n,-n);e.lineTo(-n,-n);e.lineTo(-n,-3*n);e.lineTo(n,-3*n);e.lineTo(n,-n);e.lineTo(3*n,-n);e.lineTo(3*n,n);e.lineTo(n,n);e.lineTo(n,3*n);e.lineTo(-n,3*n);e.lineTo(-n,n);e.lineTo(-3*n,n);e.closePath()}};var hh=Math.sqrt(1/3),ph=hh*2;var vh={draw:function(e,t){var n=Math.sqrt(t/ph),r=n*hh;e.moveTo(0,-n);e.lineTo(r,0);e.lineTo(0,n);e.lineTo(-r,0);e.closePath()}};var gh=.8908130915292852,mh=Math.sin(Ed/10)/Math.sin(7*Ed/10),yh=Math.sin(Sd/10)*mh,bh=-Math.cos(Sd/10)*mh;var xh={draw:function(e,t){var n=Math.sqrt(t*gh),r=yh*n,i=bh*n;e.moveTo(0,-n);e.lineTo(r,i);for(var a=1;a<5;++a){var u=Sd*a/5,o=Math.cos(u),f=Math.sin(u);e.lineTo(f*n,-o*n);e.lineTo(o*r-f*i,f*r+o*i)}e.closePath()}};var _h={draw:function(e,t){var n=Math.sqrt(t),r=-n/2;e.rect(r,r,n,n)}};var wh=Math.sqrt(3);var kh={draw:function(e,t){var n=-Math.sqrt(t/(wh*3));e.moveTo(0,n*2);e.lineTo(-wh*n,-n);e.lineTo(wh*n,-n);e.closePath()}};var Oh=-.5,Ah=Math.sqrt(3)/2,Eh=1/Math.sqrt(12),Mh=(Eh/2+1)*3;var Sh={draw:function(e,t){var n=Math.sqrt(t/Mh),r=n/2,i=n*Eh,a=r,u=n*Eh+n,o=-a,f=u;e.moveTo(r,i);e.lineTo(a,u);e.lineTo(o,f);e.lineTo(Oh*r-Ah*i,Ah*r+Oh*i);e.lineTo(Oh*a-Ah*u,Ah*a+Oh*u);e.lineTo(Oh*o-Ah*f,Ah*o+Oh*f);e.lineTo(Oh*r+Ah*i,Oh*i-Ah*r);e.lineTo(Oh*a+Ah*u,Oh*u-Ah*a);e.lineTo(Oh*o+Ah*f,Oh*f-Ah*o);e.closePath()}};var Ch=[sh,dh,vh,_h,xh,kh,Sh];var Dh=function(){var e=md(sh),t=md(64),n=null;function r(){var r;if(!n)n=r=gd();e.apply(this,arguments).draw(n,+t.apply(this,arguments));if(r)return n=null,r+""||null}r.type=function(t){return arguments.length?(e=typeof t==="function"?t:md(t),r):e};r.size=function(e){return arguments.length?(t=typeof e==="function"?e:md(+e),r):t};r.context=function(e){return arguments.length?(n=e==null?null:e,r):n};return r};var jh=function(){};function Nh(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function Fh(e){this._context=e}Fh.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN;this._point=0},lineEnd:function(){switch(this._point){case 3:Nh(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}if(this._line||this._line!==0&&this._point===1)this._context.closePath();this._line=1-this._line},point:function(e,t){e=+e,t=+t;switch(this._point){case 0:this._point=1;this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Nh(this,e,t);break}this._x0=this._x1,this._x1=e;this._y0=this._y1,this._y1=t}};var Th=function(e){return new Fh(e)};function zh(e){this._context=e}zh.prototype={areaStart:jh,areaEnd:jh,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN;this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2);this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3);this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3);this._context.closePath();break}case 3:{this.point(this._x2,this._y2);this.point(this._x3,this._y3);this.point(this._x4,this._y4);break}}},point:function(e,t){e=+e,t=+t;switch(this._point){case 0:this._point=1;this._x2=e,this._y2=t;break;case 1:this._point=2;this._x3=e,this._y3=t;break;case 2:this._point=3;this._x4=e,this._y4=t;this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:Nh(this,e,t);break}this._x0=this._x1,this._x1=e;this._y0=this._y1,this._y1=t}};var Rh=function(e){return new zh(e)};function Ph(e){this._context=e}Ph.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN;this._point=0},lineEnd:function(){if(this._line||this._line!==0&&this._point===3)this._context.closePath();this._line=1-this._line},point:function(e,t){e=+e,t=+t;switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:Nh(this,e,t);break}this._x0=this._x1,this._x1=e;this._y0=this._y1,this._y1=t}};var Lh=function(e){return new Ph(e)};function Bh(e,t){this._basis=new Fh(e);this._beta=t}Bh.prototype={lineStart:function(){this._x=[];this._y=[];this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,n=e.length-1;if(n>0){var r=e[0],i=t[0],a=e[n]-r,u=t[n]-i,o=-1,f;while(++o<=n){f=o/n;this._basis.point(this._beta*e[o]+(1-this._beta)*(r+f*a),this._beta*t[o]+(1-this._beta)*(i+f*u))}}this._x=this._y=null;this._basis.lineEnd()},point:function(e,t){this._x.push(+e);this._y.push(+t)}};var Ih=function e(t){function n(e){return t===1?new Fh(e):new Bh(e,t)}n.beta=function(t){return e(+t)};return n}(.85);function Uh(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function qh(e,t){this._context=e;this._k=(1-t)/6}qh.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN;this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:Uh(this,this._x1,this._y1);break}if(this._line||this._line!==0&&this._point===1)this._context.closePath();this._line=1-this._line},point:function(e,t){e=+e,t=+t;switch(this._point){case 0:this._point=1;this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;this._x1=e,this._y1=t;break;case 2:this._point=3;default:Uh(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e;this._y0=this._y1,this._y1=this._y2,this._y2=t}};var Wh=function e(t){function n(e){return new qh(e,t)}n.tension=function(t){return e(+t)};return n}(0);function Hh(e,t){this._context=e;this._k=(1-t)/6}Hh.prototype={areaStart:jh,areaEnd:jh,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN;this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3);this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3);this._context.closePath();break}case 3:{this.point(this._x3,this._y3);this.point(this._x4,this._y4);this.point(this._x5,this._y5);break}}},point:function(e,t){e=+e,t=+t;switch(this._point){case 0:this._point=1;this._x3=e,this._y3=t;break;case 1:this._point=2;this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3;this._x5=e,this._y5=t;break;default:Uh(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e;this._y0=this._y1,this._y1=this._y2,this._y2=t}};var Gh=function e(t){function n(e){return new Hh(e,t)}n.tension=function(t){return e(+t)};return n}(0);function Yh(e,t){this._context=e;this._k=(1-t)/6}Yh.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN;this._point=0},lineEnd:function(){if(this._line||this._line!==0&&this._point===3)this._context.closePath();this._line=1-this._line},point:function(e,t){e=+e,t=+t;switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Uh(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e;this._y0=this._y1,this._y1=this._y2,this._y2=t}};var $h=function e(t){function n(e){return new Yh(e,t)}n.tension=function(t){return e(+t)};return n}(0);function Vh(e,t,n){var r=e._x1,i=e._y1,a=e._x2,u=e._y2;if(e._l01_a>Ad){var o=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,f=3*e._l01_a*(e._l01_a+e._l12_a);r=(r*o-e._x0*e._l12_2a+e._x2*e._l01_2a)/f;i=(i*o-e._y0*e._l12_2a+e._y2*e._l01_2a)/f}if(e._l23_a>Ad){var c=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,l=3*e._l23_a*(e._l23_a+e._l12_a);a=(a*c+e._x1*e._l23_2a-t*e._l12_2a)/l;u=(u*c+e._y1*e._l23_2a-n*e._l12_2a)/l}e._context.bezierCurveTo(r,i,a,u,e._x2,e._y2)}function Xh(e,t){this._context=e;this._alpha=t}Xh.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN;this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}if(this._line||this._line!==0&&this._point===1)this._context.closePath();this._line=1-this._line},point:function(e,t){e=+e,t=+t;if(this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:Vh(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a;this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a;this._x0=this._x1,this._x1=this._x2,this._x2=e;this._y0=this._y1,this._y1=this._y2,this._y2=t}};var Zh=function e(t){function n(e){return t?new Xh(e,t):new qh(e,0)}n.alpha=function(t){return e(+t)};return n}(.5);function Jh(e,t){this._context=e;this._alpha=t}Jh.prototype={areaStart:jh,areaEnd:jh,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN;this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3);this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3);this._context.closePath();break}case 3:{this.point(this._x3,this._y3);this.point(this._x4,this._y4);this.point(this._x5,this._y5);break}}},point:function(e,t){e=+e,t=+t;if(this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;this._x3=e,this._y3=t;break;case 1:this._point=2;this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3;this._x5=e,this._y5=t;break;default:Vh(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a;this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a;this._x0=this._x1,this._x1=this._x2,this._x2=e;this._y0=this._y1,this._y1=this._y2,this._y2=t}};var Qh=function e(t){function n(e){return t?new Jh(e,t):new Hh(e,0)}n.alpha=function(t){return e(+t)};return n}(.5);function Kh(e,t){this._context=e;this._alpha=t}Kh.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN;this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){if(this._line||this._line!==0&&this._point===3)this._context.closePath();this._line=1-this._line},point:function(e,t){e=+e,t=+t;if(this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Vh(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a;this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a;this._x0=this._x1,this._x1=this._x2,this._x2=e;this._y0=this._y1,this._y1=this._y2,this._y2=t}};var ep=function e(t){function n(e){return t?new Kh(e,t):new Yh(e,0)}n.alpha=function(t){return e(+t)};return n}(.5);function tp(e){this._context=e}tp.prototype={areaStart:jh,areaEnd:jh,lineStart:function(){this._point=0},lineEnd:function(){if(this._point)this._context.closePath()},point:function(e,t){e=+e,t=+t;if(this._point)this._context.lineTo(e,t);else this._point=1,this._context.moveTo(e,t)}};var np=function(e){return new tp(e)};function rp(e){return e<0?-1:1}function ip(e,t,n){var r=e._x1-e._x0,i=t-e._x1,a=(e._y1-e._y0)/(r||i<0&&-0),u=(n-e._y1)/(i||r<0&&-0),o=(a*i+u*r)/(r+i);return(rp(a)+rp(u))*Math.min(Math.abs(a),Math.abs(u),.5*Math.abs(o))||0}function ap(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function up(e,t,n){var r=e._x0,i=e._y0,a=e._x1,u=e._y1,o=(a-r)/3;e._context.bezierCurveTo(r+o,i+o*t,a-o,u-o*n,a,u)}function op(e){this._context=e}op.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN;this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:up(this,this._t0,ap(this,this._t0));break}if(this._line||this._line!==0&&this._point===1)this._context.closePath();this._line=1-this._line},point:function(e,t){var n=NaN;e=+e,t=+t;if(e===this._x1&&t===this._y1)return;switch(this._point){case 0:this._point=1;this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;up(this,ap(this,n=ip(this,e,t)),n);break;default:up(this,this._t0,n=ip(this,e,t));break}this._x0=this._x1,this._x1=e;this._y0=this._y1,this._y1=t;this._t0=n}};function fp(e){this._context=new cp(e)}(fp.prototype=Object.create(op.prototype)).point=function(e,t){op.prototype.point.call(this,t,e)};function cp(e){this._context=e}cp.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,i,a){this._context.bezierCurveTo(t,e,r,n,a,i)}};function lp(e){return new op(e)}function sp(e){return new fp(e)}function dp(e){this._context=e}dp.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[];this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n){this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]);if(n===2){this._context.lineTo(e[1],t[1])}else{var r=hp(e),i=hp(t);for(var a=0,u=1;u<n;++a,++u){this._context.bezierCurveTo(r[0][a],i[0][a],r[1][a],i[1][a],e[u],t[u])}}}if(this._line||this._line!==0&&n===1)this._context.closePath();this._line=1-this._line;this._x=this._y=null},point:function(e,t){this._x.push(+e);this._y.push(+t)}};function hp(e){var t,n=e.length-1,r,i=new Array(n),a=new Array(n),u=new Array(n);i[0]=0,a[0]=2,u[0]=e[0]+2*e[1];for(t=1;t<n-1;++t)i[t]=1,a[t]=4,u[t]=4*e[t]+2*e[t+1];i[n-1]=2,a[n-1]=7,u[n-1]=8*e[n-1]+e[n];for(t=1;t<n;++t)r=i[t]/a[t-1],a[t]-=r,u[t]-=r*u[t-1];i[n-1]=u[n-1]/a[n-1];for(t=n-2;t>=0;--t)i[t]=(u[t]-i[t+1])/a[t];a[n-1]=(e[n]+i[n-1])/2;for(t=0;t<n-1;++t)a[t]=2*e[t+1]-i[t+1];return[i,a]}var pp=function(e){return new dp(e)};function vp(e,t){this._context=e;this._t=t}vp.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN;this._point=0},lineEnd:function(){if(0<this._t&&this._t<1&&this._point===2)this._context.lineTo(this._x,this._y);if(this._line||this._line!==0&&this._point===1)this._context.closePath();if(this._line>=0)this._t=1-this._t,this._line=1-this._line},point:function(e,t){e=+e,t=+t;switch(this._point){case 0:this._point=1;this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0){this._context.lineTo(this._x,t);this._context.lineTo(e,t)}else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y);this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};var gp=function(e){return new vp(e,.5)};function mp(e){return new vp(e,0)}function yp(e){return new vp(e,1)}var bp=function(e,t){if(!((u=e.length)>1))return;for(var n=1,r,i,a=e[t[0]],u,o=a.length;n<u;++n){i=a,a=e[t[n]];for(r=0;r<o;++r){a[r][1]+=a[r][0]=isNaN(i[r][1])?i[r][0]:i[r][1]}}};var xp=function(e){var t=e.length,n=new Array(t);while(--t>=0)n[t]=t;return n};function _p(e,t){return e[t]}var wp=function(){var e=md([]),t=xp,n=bp,r=_p;function i(i){var a=e.apply(this,arguments),u,o=i.length,f=a.length,c=new Array(f),l;for(u=0;u<f;++u){for(var s=a[u],d=c[u]=new Array(o),h=0,p;h<o;++h){d[h]=p=[0,+r(i[h],s,h,i)];p.data=i[h]}d.key=s}for(u=0,l=t(c);u<f;++u){c[l[u]].index=u}n(c,l);return c}i.keys=function(t){return arguments.length?(e=typeof t==="function"?t:md(th.call(t)),i):e};i.value=function(e){return arguments.length?(r=typeof e==="function"?e:md(+e),i):r};i.order=function(e){return arguments.length?(t=e==null?xp:typeof e==="function"?e:md(th.call(e)),i):t};i.offset=function(e){return arguments.length?(n=e==null?bp:e,i):n};return i};var kp=function(e,t){if(!((r=e.length)>0))return;for(var n,r,i=0,a=e[0].length,u;i<a;++i){for(u=n=0;n<r;++n)u+=e[n][i][1]||0;if(u)for(n=0;n<r;++n)e[n][i][1]/=u}bp(e,t)};var Op=function(e,t){if(!((f=e.length)>0))return;for(var n,r=0,i,a,u,o,f,c=e[t[0]].length;r<c;++r){for(u=o=0,n=0;n<f;++n){if((a=(i=e[t[n]][r])[1]-i[0])>=0){i[0]=u,i[1]=u+=a}else if(a<0){i[1]=o,i[0]=o+=a}else{i[0]=u}}}};var Ap=function(e,t){if(!((i=e.length)>0))return;for(var n=0,r=e[t[0]],i,a=r.length;n<a;++n){for(var u=0,o=0;u<i;++u)o+=e[u][n][1]||0;r[n][1]+=r[n][0]=-o/2}bp(e,t)};var Ep=function(e,t){if(!((u=e.length)>0)||!((a=(i=e[t[0]]).length)>0))return;for(var n=0,r=1,i,a,u;r<a;++r){for(var o=0,f=0,c=0;o<u;++o){var l=e[t[o]],s=l[r][1]||0,d=l[r-1][1]||0,h=(s-d)/2;for(var p=0;p<o;++p){var v=e[t[p]],g=v[r][1]||0,m=v[r-1][1]||0;h+=g-m}f+=s,c+=h*s}i[r-1][1]+=i[r-1][0]=n;if(f)n-=c/f}i[r-1][1]+=i[r-1][0]=n;bp(e,t)};var Mp=function(e){var t=e.map(Sp);return xp(e).sort(function(e,n){return t[e]-t[n]})};function Sp(e){var t=-1,n=0,r=e.length,i,a=-Infinity;while(++t<r)if((i=+e[t][1])>a)a=i,n=t;return n}var Cp=function(e){var t=e.map(Dp);return xp(e).sort(function(e,n){return t[e]-t[n]})};function Dp(e){var t=0,n=-1,r=e.length,i;while(++n<r)if(i=+e[n][1])t+=i;return t}var jp=function(e){return Cp(e).reverse()};var Np=function(e){var t=e.length,n,r,i=e.map(Dp),a=Mp(e),u=0,o=0,f=[],c=[];for(n=0;n<t;++n){r=a[n];if(u<o){u+=i[r];f.push(r)}else{o+=i[r];c.push(r)}}return c.reverse().concat(f)};var Fp=function(e){return xp(e).reverse()};var Tp={basis:{curve:Th},"basis-closed":{curve:Rh},"basis-open":{curve:Lh},bundle:{curve:Ih,tension:"beta",value:.85},cardinal:{curve:Wh,tension:"tension",value:0},"cardinal-open":{curve:$h,tension:"tension",value:0},"cardinal-closed":{curve:Gh,tension:"tension",value:0},"catmull-rom":{curve:Zh,tension:"alpha",value:.5},"catmull-rom-closed":{curve:Qh,tension:"alpha",value:.5},"catmull-rom-open":{curve:ep,tension:"alpha",value:.5},linear:{curve:Id},"linear-closed":{curve:np},monotone:{horizontal:sp,vertical:lp},natural:{curve:pp},step:{curve:gp},"step-after":{curve:yp},"step-before":{curve:mp}};function zp(e,t,n){var r=Tp.hasOwnProperty(e)&&Tp[e],i=null;if(r){i=r.curve||r[t||"vertical"];if(r.tension&&n!=null){i=i[r.tension](n)}}return i}var Rp={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},Pp=[/([MLHVCSQTAZmlhvcsqtaz])/g,/###/,/(\d)([-+])/g,/\s|,|###/];var Lp=function(e){var t=[],n,r,i,a,u,o,f,c,l,s,d;n=e.slice().replace(Pp[0],"###$1").split(Pp[1]).slice(1);for(c=0,s=n.length;c<s;++c){r=n[c];i=r.slice(1).trim().replace(Pp[2],"$1###$2").split(Pp[3]);o=r.charAt(0);a=[o];for(l=0,d=i.length;l<d;++l){if((u=+i[l])===u){a.push(u)}}f=Rp[o.toLowerCase()];if(a.length-1>f){for(l=1,d=a.length;l<d;l+=f){t.push([o].concat(a.slice(l,l+f)))}}else{t.push(a)}}return t};var Bp={};var Ip={};var Up=[].join;function qp(e,t,n,r,i,a,u,o,f){var c=Up.call(arguments);if(Bp[c]){return Bp[c]}var l=u*(Math.PI/180);var s=Math.sin(l);var d=Math.cos(l);n=Math.abs(n);r=Math.abs(r);var h=d*(o-e)*.5+s*(f-t)*.5;var p=d*(f-t)*.5-s*(o-e)*.5;var v=h*h/(n*n)+p*p/(r*r);if(v>1){v=Math.sqrt(v);n*=v;r*=v}var g=d/n;var m=s/n;var y=-s/r;var b=d/r;var x=g*o+m*f;var _=y*o+b*f;var w=g*e+m*t;var k=y*e+b*t;var O=(w-x)*(w-x)+(k-_)*(k-_);var A=1/O-.25;if(A<0)A=0;var E=Math.sqrt(A);if(a==i)E=-E;var M=.5*(x+w)-E*(k-_);var S=.5*(_+k)+E*(w-x);var C=Math.atan2(_-S,x-M);var D=Math.atan2(k-S,w-M);var j=D-C;if(j<0&&a===1){j+=2*Math.PI}else if(j>0&&a===0){j-=2*Math.PI}var N=Math.ceil(Math.abs(j/(Math.PI*.5+.001)));var F=[];for(var T=0;T<N;++T){var z=C+T*j/N;var R=C+(T+1)*j/N;F[T]=[M,S,z,R,n,r,s,d]}return Bp[c]=F}function Wp(e){var t=Up.call(e);if(Ip[t]){return Ip[t]}var n=e[0],r=e[1],i=e[2],a=e[3],u=e[4],o=e[5],f=e[6],c=e[7];var l=c*u;var s=-f*o;var d=f*u;var h=c*o;var p=Math.cos(i);var v=Math.sin(i);var g=Math.cos(a);var m=Math.sin(a);var y=.5*(a-i);var b=Math.sin(y*.5);var x=8/3*b*b/Math.sin(y);var _=n+p-x*v;var w=r+v+x*p;var k=n+g;var O=r+m;var A=k+x*m;var E=O-x*g;return Ip[t]=[l*_+s*w,d*_+h*w,l*A+s*E,d*A+h*E,l*k+s*O,d*k+h*O]}var Hp=["l",0,0,0,0,0,0,0];function Gp(e,t){var n=Hp[0]=e[0];if(n==="a"||n==="A"){Hp[1]=t*e[1];Hp[2]=t*e[2];Hp[3]=e[3];Hp[4]=e[4];Hp[5]=e[5];Hp[6]=t*e[6];Hp[7]=t*e[7]}else{for(var r=1,i=e.length;r<i;++r){Hp[r]=t*e[r]}}return Hp}var Yp=function(e,t,n,r,i){var a,u=null,o=0,f=0,c=0,l=0,s,d,h,p;if(n==null)n=0;if(r==null)r=0;if(i==null)i=1;if(e.beginPath)e.beginPath();for(var v=0,g=t.length;v<g;++v){a=t[v];if(i!==1)a=Gp(a,i);switch(a[0]){case"l":o+=a[1];f+=a[2];e.lineTo(o+n,f+r);break;case"L":o=a[1];f=a[2];e.lineTo(o+n,f+r);break;case"h":o+=a[1];e.lineTo(o+n,f+r);break;case"H":o=a[1];e.lineTo(o+n,f+r);break;case"v":f+=a[1];e.lineTo(o+n,f+r);break;case"V":f=a[1];e.lineTo(o+n,f+r);break;case"m":o+=a[1];f+=a[2];e.moveTo(o+n,f+r);break;case"M":o=a[1];f=a[2];e.moveTo(o+n,f+r);break;case"c":s=o+a[5];d=f+a[6];c=o+a[3];l=f+a[4];e.bezierCurveTo(o+a[1]+n,f+a[2]+r,c+n,l+r,s+n,d+r);o=s;f=d;break;case"C":o=a[5];f=a[6];c=a[3];l=a[4];e.bezierCurveTo(a[1]+n,a[2]+r,c+n,l+r,o+n,f+r);break;case"s":s=o+a[3];d=f+a[4];c=2*o-c;l=2*f-l;e.bezierCurveTo(c+n,l+r,o+a[1]+n,f+a[2]+r,s+n,d+r);c=o+a[1];l=f+a[2];o=s;f=d;break;case"S":s=a[3];d=a[4];c=2*o-c;l=2*f-l;e.bezierCurveTo(c+n,l+r,a[1]+n,a[2]+r,s+n,d+r);o=s;f=d;c=a[1];l=a[2];break;case"q":s=o+a[3];d=f+a[4];c=o+a[1];l=f+a[2];e.quadraticCurveTo(c+n,l+r,s+n,d+r);o=s;f=d;break;case"Q":s=a[3];d=a[4];e.quadraticCurveTo(a[1]+n,a[2]+r,s+n,d+r);o=s;f=d;c=a[1];l=a[2];break;case"t":s=o+a[1];d=f+a[2];if(u[0].match(/[QqTt]/)===null){c=o;l=f}else if(u[0]==="t"){c=2*o-h;l=2*f-p}else if(u[0]==="q"){c=2*o-c;l=2*f-l}h=c;p=l;e.quadraticCurveTo(c+n,l+r,s+n,d+r);o=s;f=d;c=o+a[1];l=f+a[2];break;case"T":s=a[1];d=a[2];c=2*o-c;l=2*f-l;e.quadraticCurveTo(c+n,l+r,s+n,d+r);o=s;f=d;break;case"a":$p(e,o+n,f+r,[a[1],a[2],a[3],a[4],a[5],a[6]+o+n,a[7]+f+r]);o+=a[6];f+=a[7];break;case"A":$p(e,o+n,f+r,[a[1],a[2],a[3],a[4],a[5],a[6]+n,a[7]+r]);o=a[6];f=a[7];break;case"z":case"Z":e.closePath();break}u=a}};function $p(e,t,n,r){var i=qp(r[5],r[6],r[0],r[1],r[3],r[4],r[2],t,n);for(var a=0;a<i.length;++a){var u=Wp(i[a]);e.bezierCurveTo(u[0],u[1],u[2],u[3],u[4],u[5])}}var Vp=2*Math.PI,Xp=Math.sqrt(3)/2;var Zp={circle:{draw:function(e,t){var n=Math.sqrt(t)/2;e.moveTo(n,0);e.arc(0,0,n,0,Vp)}},cross:{draw:function(e,t){var n=Math.sqrt(t)/2,r=n/2.5;e.moveTo(-n,-r);e.lineTo(-n,r);e.lineTo(-r,r);e.lineTo(-r,n);e.lineTo(r,n);e.lineTo(r,r);e.lineTo(n,r);e.lineTo(n,-r);e.lineTo(r,-r);e.lineTo(r,-n);e.lineTo(-r,-n);e.lineTo(-r,-r);e.closePath()}},diamond:{draw:function(e,t){var n=Math.sqrt(t)/2;e.moveTo(-n,0);e.lineTo(0,-n);e.lineTo(n,0);e.lineTo(0,n);e.closePath()}},square:{draw:function(e,t){var n=Math.sqrt(t),r=-n/2;e.rect(r,r,n,n)}},"triangle-up":{draw:function(e,t){var n=Math.sqrt(t)/2,r=Xp*n;e.moveTo(0,-r);e.lineTo(-n,r);e.lineTo(n,r);e.closePath()}},"triangle-down":{draw:function(e,t){var n=Math.sqrt(t)/2,r=Xp*n;e.moveTo(0,r);e.lineTo(-n,-r);e.lineTo(n,-r);e.closePath()}},"triangle-right":{draw:function(e,t){var n=Math.sqrt(t)/2,r=Xp*n;e.moveTo(r,0);e.lineTo(-r,-n);e.lineTo(-r,n);e.closePath()}},"triangle-left":{draw:function(e,t){var n=Math.sqrt(t)/2,r=Xp*n;e.moveTo(-r,0);e.lineTo(r,-n);e.lineTo(r,n);e.closePath()}}};function Jp(e){return Zp.hasOwnProperty(e)?Zp[e]:Kp(e)}var Qp={};function Kp(e){if(!Qp.hasOwnProperty(e)){var t=Lp(e);Qp[e]={draw:function(e,n){Yp(e,t,0,0,Math.sqrt(n)/2)}}}return Qp[e]}function ev(e){return e.x}function tv(e){return e.y}function nv(e){return e.width}function rv(e){return e.height}function iv(e){return function(){return e}}var av=function(){var e=ev,t=tv,n=nv,r=rv,i=iv(0),a=null;function u(u,o,f){var c,l=o!=null?o:+e.call(this,u),s=f!=null?f:+t.call(this,u),d=+n.call(this,u),h=+r.call(this,u),p=+i.call(this,u);if(!a)a=c=gd();if(p<=0){a.rect(l,s,d,h)}else{var v=l+d,g=s+h;a.moveTo(l+p,s);a.lineTo(v-p,s);a.quadraticCurveTo(v,s,v,s+p);a.lineTo(v,g-p);a.quadraticCurveTo(v,g,v-p,g);a.lineTo(l+p,g);a.quadraticCurveTo(l,g,l,g-p);a.lineTo(l,s+p);a.quadraticCurveTo(l,s,l+p,s);a.closePath()}if(c){a=null;return c+""||null}}u.x=function(t){if(arguments.length){e=typeof t==="function"?t:iv(+t);return u}else{return e}};u.y=function(e){if(arguments.length){t=typeof e==="function"?e:iv(+e);return u}else{return t}};u.width=function(e){if(arguments.length){n=typeof e==="function"?e:iv(+e);return u}else{return n}};u.height=function(e){if(arguments.length){r=typeof e==="function"?e:iv(+e);return u}else{return r}};u.cornerRadius=function(e){if(arguments.length){i=typeof e==="function"?e:iv(+e);return u}else{return i}};u.context=function(e){if(arguments.length){a=e==null?null:e;return u}else{return a}};return u};var uv=Math.PI;var ov=function(){var e,t,n,r,i=null,a,u,o,f;function c(e,t,n){var r=n/2;if(a){var c=o-t,l=e-u;if(c||l){var s=Math.sqrt(c*c+l*l),d=(c/=s)*f,h=(l/=s)*f,p=Math.atan2(l,c);i.moveTo(u-d,o-h);i.lineTo(e-c*r,t-l*r);i.arc(e,t,r,p-uv,p);i.lineTo(u+d,o+h);i.arc(u,o,f,p,p+uv)}else{i.arc(e,t,r,0,2*uv)}i.closePath()}else{a=1}u=e;o=t;f=r}function l(u){var o,f=u.length,l,s=false,d;if(i==null)i=d=gd();for(o=0;o<=f;++o){if(!(o<f&&r(l=u[o],o,u))===s){if(s=!s)a=0}if(s)c(+e(l,o,u),+t(l,o,u),+n(l,o,u))}if(d){i=null;return d+""||null}}l.x=function(t){if(arguments.length){e=t;return l}else{return e}};l.y=function(e){if(arguments.length){t=e;return l}else{return t}};l.size=function(e){if(arguments.length){n=e;return l}else{return n}};l.defined=function(e){if(arguments.length){r=e;return l}else{return r}};l.context=function(e){if(arguments.length){if(e==null){i=null}else{i=e}return l}else{return i}};return l};function fv(e){return e.x||0}function cv(e){return e.y||0}function lv(e){return e.width||0}function sv(e){return e.size||1}function dv(e){return e.height||0}function hv(e){return(e.x||0)+(e.width||0)}function pv(e){return(e.y||0)+(e.height||0)}function vv(e){return e.startAngle||0}function gv(e){return e.endAngle||0}function mv(e){return e.padAngle||0}function yv(e){return e.innerRadius||0}function bv(e){return e.outerRadius||0}function xv(e){return e.cornerRadius||0}function _v(e){return!(e.defined===false)}function wv(e){return e.size==null?64:e.size}function kv(e){return Jp(e.shape||"circle")}var Ov=Ld().startAngle(vv).endAngle(gv).padAngle(mv).innerRadius(yv).outerRadius(bv).cornerRadius(xv),Av=Hd().x(fv).y1(cv).y0(pv).defined(_v),Ev=Hd().y(cv).x1(fv).x0(hv).defined(_v),Mv=Wd().x(fv).y(cv).defined(_v),Sv=av().x(fv).y(cv).width(lv).height(dv).cornerRadius(xv),Cv=Dh().type(kv).size(wv),Dv=ov().x(fv).y(cv).defined(_v).size(sv);function jv(e,t){return Ov.context(e)(t)}function Nv(e,t){var n=t[0],r=n.interpolate||"linear";return(n.orient==="horizontal"?Ev:Av).curve(zp(r,n.orient,n.tension)).context(e)(t)}function Fv(e,t){var n=t[0],r=n.interpolate||"linear";return Mv.curve(zp(r,n.orient,n.tension)).context(e)(t)}function Tv(e,t,n,r){return Sv.context(e)(t,n,r)}function zv(e,t){return(t.mark.shape||t.shape).context(e)(t)}function Rv(e,t){return Cv.context(e)(t)}function Pv(e,t){return Dv.context(e)(t)}var Lv=function(e,t){if(t.stroke&&t.opacity!==0&&t.strokeOpacity!==0){e.expand(t.strokeWidth!=null?+t.strokeWidth:1)}return e};var Bv,Iv=Math.PI*2,Uv=Iv/4,qv=Iv-1e-8;function Wv(e){Bv=e;return Wv}function Hv(){}function Gv(e,t){Bv.add(e,t)}Wv.beginPath=Hv;Wv.closePath=Hv;Wv.moveTo=Gv;Wv.lineTo=Gv;Wv.rect=function(e,t,n,r){Gv(e,t);Gv(e+n,t+r)};Wv.quadraticCurveTo=function(e,t,n,r){Gv(e,t);Gv(n,r)};Wv.bezierCurveTo=function(e,t,n,r,i,a){Gv(e,t);Gv(n,r);Gv(i,a)};Wv.arc=function(e,t,n,r,i,a){if(Math.abs(i-r)>qv){Gv(e-n,t-n);Gv(e+n,t+n);return}var u=Infinity,o=-Infinity,f=Infinity,c=-Infinity,l,s,d,h;function p(e){d=n*Math.cos(e);h=n*Math.sin(e);if(d<u)u=d;if(d>o)o=d;if(h<f)f=h;if(h>c)c=h}p(r);p(i);if(i!==r){r=r%Iv;if(r<0)r+=Iv;i=i%Iv;if(i<0)i+=Iv;if(i<r){a=!a;l=r;r=i;i=l}if(a){i-=Iv;l=r-r%Uv;for(s=0;s<4&&l>i;++s,l-=Uv)p(l)}else{l=r-r%Uv+Uv;for(s=0;s<4&&l<i;++s,l=l+Uv)p(l)}}Gv(e+u,t+f);Gv(e+o,t+c)};var Yv=function(e,t,n){var r=n.width(),i=n.height(),a=n.x1+t.x1*r,u=n.y1+t.y1*i,o=n.x1+t.x2*r,f=n.y1+t.y2*i,c=t.stops,l=0,s=c.length,d=e.createLinearGradient(a,u,o,f);for(;l<s;++l){d.addColorStop(c[l].offset,c[l].color)}return d};var $v=function(e,t,n){return n.id?Yv(e,n,t.bounds):n};var Vv=function(e,t,n){n*=t.fillOpacity==null?1:t.fillOpacity;if(n>0){e.globalAlpha=n;e.fillStyle=$v(e,t,t.fill);return true}else{return false}};var Xv=[];var Zv=function(e,t,n){var r=(r=t.strokeWidth)!=null?r:1;if(r<=0)return false;n*=t.strokeOpacity==null?1:t.strokeOpacity;if(n>0){e.globalAlpha=n;e.strokeStyle=$v(e,t,t.stroke);e.lineWidth=r;e.lineCap=t.strokeCap||"butt";e.lineJoin=t.strokeJoin||"miter";e.miterLimit=t.strokeMiterLimit||10;if(e.setLineDash){e.setLineDash(t.strokeDash||Xv);e.lineDashOffset=t.strokeDashOffset||0}return true}else{return false}};function Jv(e,t){return e.zindex-t.zindex||e.index-t.index}function Qv(e){if(!e.zdirty)return e.zitems;var t=e.items,n=[],r,i,a;for(i=0,a=t.length;i<a;++i){r=t[i];r.index=i;if(r.zindex)n.push(r)}e.zdirty=false;return e.zitems=n.sort(Jv)}function Kv(e,t){var n=e.items,r,i;if(!n||!n.length)return;var a=Qv(e);if(a&&a.length){for(r=0,i=n.length;r<i;++r){if(!n[r].zindex)t(n[r])}n=a}for(r=0,i=n.length;r<i;++r){t(n[r])}}function eg(e,t){var n=e.items,r,i;if(!n||!n.length)return null;var a=Qv(e);if(a&&a.length)n=a;for(i=n.length;--i>=0;){if(r=t(n[i]))return r}if(n===a){for(n=e.items,i=n.length;--i>=0;){if(!n[i].zindex){if(r=t(n[i]))return r}}}return null}function tg(e){return function(t,n,r){Kv(n,function(n){if(!r||r.intersects(n.bounds)){rg(e,t,n,n)}})}}function ng(e){return function(t,n,r){if(n.items.length&&(!r||r.intersects(n.bounds))){rg(e,t,n.items[0],n.items)}}}function rg(e,t,n,r){var i=n.opacity==null?1:n.opacity;if(i===0)return;if(e(t,r))return;if(n.fill&&Vv(t,n,i)){t.fill()}if(n.stroke&&Zv(t,n,i)){t.stroke()}}var ig=function(){return true};function ag(e){if(!e)e=ig;return function(t,n,r,i,a,u){r*=t.pixelRatio;i*=t.pixelRatio;return eg(n,function(n){var o=n.bounds;if(o&&!o.contains(a,u)||!o)return;if(e(t,n,r,i,a,u))return n})}}function ug(e,t){return function(n,r,i,a){var u=Array.isArray(r)?r[0]:r,o=t==null?u.fill:t,f=u.stroke&&n.isPointInStroke,c,l;if(f){c=u.strokeWidth;l=u.strokeCap;n.lineWidth=c!=null?c:1;n.lineCap=l!=null?l:"butt"}return e(n,r)?false:o&&n.isPointInPath(i,a)||f&&n.isPointInStroke(i,a)}}function og(e){return ag(ug(e))}var fg=function(e,t){return"translate("+e+","+t+")"};var cg=function(e){return fg(e.x||0,e.y||0)};var lg=function(e,t){function n(e,n){e("transform",cg(n));e("d",t(null,n))}function r(e,n){t(Wv(e),n);return Lv(e,n).translate(n.x||0,n.y||0)}function i(e,n){var r=n.x||0,i=n.y||0;e.translate(r,i);e.beginPath();t(e,n);e.translate(-r,-i)}return{type:e,tag:"path",nested:false,attr:n,bound:r,draw:tg(i),pick:og(i)}};var sg=lg("arc",jv);function dg(e,t){var n=e[0].orient==="horizontal"?t[1]:t[0],r=e[0].orient==="horizontal"?"y":"x",i=e.length,a=+Infinity,u,o;while(--i>=0){if(e[i].defined===false)continue;o=Math.abs(e[i][r]-n);if(o<a){a=o;u=e[i]}}return u}function hg(e,t){var n=Math.pow(e[0].strokeWidth||1,2),r=e.length,i,a,u;while(--r>=0){if(e[r].defined===false)continue;i=e[r].x-t[0];a=e[r].y-t[1];u=i*i+a*a;if(u<n)return e[r]}return null}function pg(e,t){var n=e.length,r,i,a;while(--n>=0){if(e[n].defined===false)continue;r=e[n].x-t[0];i=e[n].y-t[1];a=r*r+i*i;r=e[n].size||1;if(a<r*r)return e[n]}return null}var vg=function(e,t,n){function r(e,n){var r=n.mark.items;if(r.length)e("d",t(null,r))}function i(e,n){var r=n.items;if(r.length===0){return e}else{t(Wv(e),r);return Lv(e,r[0])}}function a(e,n){e.beginPath();t(e,n)}var u=ug(a);function o(e,t,n,r,i,a){var o=t.items,f=t.bounds;if(!o||!o.length||f&&!f.contains(i,a)){return null}n*=e.pixelRatio;r*=e.pixelRatio;return u(e,o,n,r)?o[0]:null}return{type:e,tag:"path",nested:true,attr:r,bound:i,draw:ng(a),pick:o,tip:n}};var gg=vg("area",Nv,dg);var mg=1;function yg(){mg=1}var bg=function(e,t,n){var r=t.clip,i=e._defs,a=t.clip_id||(t.clip_id="clip"+mg++),u=i.clipping[a]||(i.clipping[a]={id:a});if(Object(dn["C"])(r)){u.path=r(null)}else{u.width=n.width||0;u.height=n.height||0}return"url(#"+a+")"};var xg=.5;function _g(e,t){e("transform",cg(t))}function wg(e,t){var n=t.stroke?xg:0;e("class","background");e("d",Tv(null,t,n,n))}function kg(e,t,n){var r=t.clip?bg(n,t,t):null;e("clip-path",r)}function Og(e,t){if(!t.clip&&t.items){var n=t.items;for(var r=0,i=n.length;r<i;++r){e.union(n[r].bounds)}}if((t.clip||t.width||t.height)&&!t.noBound){e.add(0,0).add(t.width||0,t.height||0)}Lv(e,t);return e.translate(t.x||0,t.y||0)}function Ag(e,t){var n=t.stroke?xg:0;e.beginPath();Tv(e,t,n,n)}var Eg=ug(Ag);function Mg(e,t,n){var r=this;Kv(t,function(t){var i=t.x||0,a=t.y||0,u=t.width||0,o=t.height||0,f;e.save();e.translate(i,a);if(t.stroke||t.fill){f=t.opacity==null?1:t.opacity;if(f>0){Ag(e,t);if(t.fill&&Vv(e,t,f)){e.fill()}if(t.stroke&&Zv(e,t,f)){e.stroke()}}}if(t.clip){e.beginPath();e.rect(0,0,u,o);e.clip()}if(n)n.translate(-i,-a);Kv(t,function(t){r.draw(e,t,n)});if(n)n.translate(i,a);e.restore()})}function Sg(e,t,n,r,i,a){if(t.bounds&&!t.bounds.contains(i,a)||!t.items){return null}var u=this,o=n*e.pixelRatio,f=r*e.pixelRatio;return eg(t,function(c){var l,s,d,h;h=c.bounds;if(h&&!h.contains(i,a))return;s=c.x||0;d=c.y||0;e.save();e.translate(s,d);s=i-s;d=a-d;l=eg(c,function(e){return Cg(e,s,d)?u.pick(e,n,r,s,d):null});if(!l&&t.interactive!==false&&(c.fill||c.stroke)&&Eg(e,c,o,f)){l=c}e.restore();return l||null})}function Cg(e,t,n){return(e.interactive!==false||e.marktype==="group")&&e.bounds&&e.bounds.contains(t,n)}var Dg={type:"group",tag:"g",nested:false,attr:_g,bound:Og,draw:Mg,pick:Sg,background:wg,foreground:kg};function jg(e,t){var n=e.image;if(!n||n.url!==e.url){n={loaded:false,width:0,height:0};t.loadImage(e.url).then(function(t){e.image=t;e.image.url=e.url})}return n}function Ng(e,t){return e==="center"?t/2:e==="right"?t:0}function Fg(e,t){return e==="middle"?t/2:e==="bottom"?t:0}function Tg(e,t,n){var r=jg(t,n),i=t.x||0,a=t.y||0,u=(t.width!=null?t.width:r.width)||0,o=(t.height!=null?t.height:r.height)||0,f=t.aspect===false?"none":"xMidYMid";i-=Ng(t.align,u);a-=Fg(t.baseline,o);e("href",r.src||"","http://www.w3.org/1999/xlink","xlink:href");e("transform",fg(i,a));e("width",u);e("height",o);e("preserveAspectRatio",f)}function zg(e,t){var n=t.image,r=t.x||0,i=t.y||0,a=(t.width!=null?t.width:n&&n.width)||0,u=(t.height!=null?t.height:n&&n.height)||0;r-=Ng(t.align,a);i-=Fg(t.baseline,u);return e.set(r,i,r+a,i+u)}function Rg(e,t,n){var r=this;Kv(t,function(t){if(n&&!n.intersects(t.bounds))return;var i=jg(t,r),a=t.x||0,u=t.y||0,o=(t.width!=null?t.width:i.width)||0,f=(t.height!=null?t.height:i.height)||0,c,l,s,d;a-=Ng(t.align,o);u-=Fg(t.baseline,f);if(t.aspect!==false){l=i.width/i.height;s=t.width/t.height;if(l===l&&s===s&&l!==s){if(s<l){d=o/l;u+=(f-d)/2;f=d}else{d=f*l;a+=(o-d)/2;o=d}}}if(i.loaded){e.globalAlpha=(c=t.opacity)!=null?c:1;e.drawImage(i,a,u,o,f)}})}var Pg={type:"image",tag:"image",nested:false,attr:Tg,bound:zg,draw:Rg,pick:ag(),get:jg,xOffset:Ng,yOffset:Fg};var Lg=vg("line",Fv,hg);function Bg(e,t){e("transform",cg(t));e("d",t.path)}function Ig(e,t){var n=t.path;if(n==null)return true;var r=t.pathCache;if(!r||r.path!==n){(t.pathCache=r=Lp(n)).path=n}Yp(e,r,t.x,t.y)}function Ug(e,t){return Ig(Wv(e),t)?e.set(0,0,0,0):Lv(e,t)}var qg={type:"path",tag:"path",nested:false,attr:Bg,bound:Ug,draw:tg(Ig),pick:og(Ig)};function Wg(e,t){e("d",Tv(null,t))}function Hg(e,t){var n,r;return Lv(e.set(n=t.x||0,r=t.y||0,n+t.width||0,r+t.height||0),t)}function Gg(e,t){e.beginPath();Tv(e,t)}var Yg={type:"rect",tag:"path",nested:false,attr:Wg,bound:Hg,draw:tg(Gg),pick:og(Gg)};function $g(e,t){e("transform",cg(t));e("x2",t.x2!=null?t.x2-(t.x||0):0);e("y2",t.y2!=null?t.y2-(t.y||0):0)}function Vg(e,t){var n,r;return Lv(e.set(n=t.x||0,r=t.y||0,t.x2!=null?t.x2:n,t.y2!=null?t.y2:r),t)}function Xg(e,t,n){var r,i,a,u;if(t.stroke&&Zv(e,t,n)){r=t.x||0;i=t.y||0;a=t.x2!=null?t.x2:r;u=t.y2!=null?t.y2:i;e.beginPath();e.moveTo(r,i);e.lineTo(a,u);return true}return false}function Zg(e,t,n){Kv(t,function(t){if(n&&!n.intersects(t.bounds))return;var r=t.opacity==null?1:t.opacity;if(r&&Xg(e,t,r)){e.stroke()}})}function Jg(e,t,n,r){if(!e.isPointInStroke)return false;return Xg(e,t,1)&&e.isPointInStroke(n,r)}var Qg={type:"rule",tag:"line",nested:false,attr:$g,bound:Vg,draw:Zg,pick:ag(Jg)};var Kg=lg("shape",zv);var em=lg("symbol",Rv);var tm,nm;var rm={height:fm,measureWidth:um,estimateWidth:im,width:im,canvas:cm};cm(true);function im(e){nm=fm(e);return am(lm(e))}function am(e){return~~(.8*e.length*nm)}function um(e){tm.font=hm(e);return om(lm(e))}function om(e){return tm.measureText(e).width}function fm(e){return e.fontSize!=null?e.fontSize:11}function cm(e){tm=e&&(tm=id(1,1))?tm.getContext("2d"):null;rm.width=tm?um:im}function lm(e){var t=e.text;if(t==null){return""}else{return e.limit>0?sm(e):t+""}}function sm(e){var t=+e.limit,n=e.text+"",r;if(tm){tm.font=hm(e);r=om}else{nm=fm(e);r=am}if(r(n)<t)return n;var i=e.ellipsis||"â€¦",a=e.dir==="rtl",u=0,o=n.length,f;t-=r(i);if(a){while(u<o){f=u+o>>>1;if(r(n.slice(f))>t)u=f+1;else o=f}return i+n.slice(u)}else{while(u<o){f=1+(u+o>>>1);if(r(n.slice(0,f))<t)u=f;else o=f-1}return n.slice(0,u)+i}}function dm(e,t){var n=e.font;return(t&&n?String(n).replace(/"/g,"'"):n)||"sans-serif"}function hm(e,t){return""+(e.fontStyle?e.fontStyle+" ":"")+(e.fontVariant?e.fontVariant+" ":"")+(e.fontWeight?e.fontWeight+" ":"")+fm(e)+"px "+dm(e,t)}function pm(e){var t=e.baseline,n=fm(e);return Math.round(t==="top"?.79*n:t==="middle"?.3*n:t==="bottom"?-.21*n:0)}var vm={left:"start",center:"middle",right:"end"};var gm=new Qs;function mm(e,t){var n=t.dx||0,r=(t.dy||0)+pm(t),i=t.x||0,a=t.y||0,u=t.angle||0,o=t.radius||0,f;if(o){f=(t.theta||0)-Math.PI/2;i+=o*Math.cos(f);a+=o*Math.sin(f)}e("text-anchor",vm[t.align]||"start");if(u){f=fg(i,a)+" rotate("+u+")";if(n||r)f+=" "+fg(n,r)}else{f=fg(i+n,a+r)}e("transform",f)}function ym(e,t,n){var r=rm.height(t),i=t.align,a=t.radius||0,u=t.x||0,o=t.y||0,f=t.dx||0,c=(t.dy||0)+pm(t)-Math.round(.8*r),l,s;if(a){s=(t.theta||0)-Math.PI/2;u+=a*Math.cos(s);o+=a*Math.sin(s)}l=rm.width(t);if(i==="center"){f-=l/2}else if(i==="right"){f-=l}else{}e.set(f+=u,c+=o,f+l,c+r);if(t.angle&&!n){e.rotate(t.angle*Math.PI/180,u,o)}return e.expand(n||!l?0:1)}function bm(e,t,n){Kv(t,function(t){var r,i,a,u,o,f;if(n&&!n.intersects(t.bounds))return;if(!(f=lm(t)))return;r=t.opacity==null?1:t.opacity;if(r===0)return;e.font=hm(t);e.textAlign=t.align||"left";i=t.x||0;a=t.y||0;if(u=t.radius){o=(t.theta||0)-Math.PI/2;i+=u*Math.cos(o);a+=u*Math.sin(o)}if(t.angle){e.save();e.translate(i,a);e.rotate(t.angle*Math.PI/180);i=a=0}i+=t.dx||0;a+=(t.dy||0)+pm(t);if(t.fill&&Vv(e,t,r)){e.fillText(f,i,a)}if(t.stroke&&Zv(e,t,r)){e.strokeText(f,i,a)}if(t.angle)e.restore()})}function xm(e,t,n,r,i,a){if(t.fontSize<=0)return false;if(!t.angle)return true;var u=ym(gm,t,true),o=-t.angle*Math.PI/180,f=Math.cos(o),c=Math.sin(o),l=t.x,s=t.y,d=f*i-c*a+(l-l*f+s*c),h=c*i+f*a+(s-l*c-s*f);return u.contains(d,h)}var _m={type:"text",tag:"text",nested:false,attr:mm,bound:ym,draw:bm,pick:ag(xm)};var wm=vg("trail",Pv,pg);var km={arc:sg,area:gg,group:Dg,image:Pg,line:Lg,path:qg,rect:Yg,rule:Qg,shape:Kg,symbol:em,text:_m,trail:wm};var Om=function(e,t,n){var r=km[e.mark.marktype],i=t||r.bound;if(r.nested)e=e.mark;return i(e.bounds||(e.bounds=new Qs),e,n)};var Am={mark:null};var Em=function(e,t,n){var r=km[e.marktype],i=r.bound,a=e.items,u=a&&a.length,o,f,c,l;if(r.nested){if(u){c=a[0]}else{Am.mark=e;c=Am}l=Om(c,i,n);t=t&&t.union(l)||l;return t}t=t||e.bounds&&e.bounds.clear()||new Qs;if(u){for(o=0,f=a.length;o<f;++o){t.union(Om(a[o],i,n))}}return e.bounds=t};var Mm=["marktype","name","role","interactive","clip","items","zindex","x","y","width","height","align","baseline","fill","fillOpacity","opacity","stroke","strokeOpacity","strokeWidth","strokeCap","strokeDash","strokeDashOffset","startAngle","endAngle","innerRadius","outerRadius","cornerRadius","padAngle","interpolate","tension","orient","defined","url","path","x2","y2","size","shape","text","angle","theta","radius","dx","dy","font","fontSize","fontWeight","fontStyle","fontVariant"];function Sm(e,t){return JSON.stringify(e,Mm,t)}function Cm(e){var t=typeof e==="string"?JSON.parse(e):e;return Dm(t)}function Dm(e){var t=e.marktype,n=e.items,r,i,a;if(n){for(i=0,a=n.length;i<a;++i){r=t?"mark":"group";n[i][r]=e;if(n[i].zindex)n[i][r].zdirty=true;if("group"===(t||r))Dm(n[i])}}if(t)Em(e);return e}function jm(e){if(arguments.length){this.root=Cm(e)}else{this.root=Fm({marktype:"group",name:"root",role:"frame"});this.root.items=[new rd(this.root)]}}var Nm=jm.prototype;Nm.toJSON=function(e){return Sm(this.root,e||0)};Nm.mark=function(e,t,n){t=t||this.root.items[0];var r=Fm(e,t);t.items[n]=r;if(r.zindex)r.group.zdirty=true;return r};function Fm(e,t){return{bounds:new Qs,clip:!!e.clip,group:t,interactive:e.interactive===false?false:true,items:[],marktype:e.marktype,name:e.name||undefined,role:e.role||undefined,zindex:e.zindex||0}}function Tm(e,t,n){if(!e&&typeof document!=="undefined"&&document.createElement){e=document}return e?n?e.createElementNS(n,t):e.createElement(t):null}function zm(e,t){t=t.toLowerCase();var n=e.childNodes,r=0,i=n.length;for(;r<i;++r)if(n[r].tagName.toLowerCase()===t){return n[r]}}function Rm(e,t,n,r){var i=e.childNodes[t],a;if(!i||i.tagName.toLowerCase()!==n.toLowerCase()){a=i||null;i=Tm(e.ownerDocument,n,r);e.insertBefore(i,a)}return i}function Pm(e,t){var n=e.childNodes,r=n.length;while(r>t)e.removeChild(n[--r]);return e}function Lm(e){return"mark-"+e.marktype+(e.role?" role-"+e.role:"")+(e.name?" "+e.name:"")}var Bm=function(e,t){var n=t.getBoundingClientRect();return[e.clientX-n.left-(t.clientLeft||0),e.clientY-n.top-(t.clientTop||0)]};var Im=function(e,t,n,r){var i=e&&e.mark,a,u;if(i&&(a=km[i.marktype]).tip){u=Bm(t,n);u[0]-=r[0];u[1]-=r[1];while(e=e.mark.group){u[0]-=e.x||0;u[1]-=e.y||0}e=a.tip(i.items,u)}return e};function Um(e,t){this._active=null;this._handlers={};this._loader=e||Yn();this._tooltip=t||qm}function qm(e,t,n,r){e.element().setAttribute("title",r||"")}var Wm=Um.prototype;Wm.initialize=function(e,t,n){this._el=e;this._obj=n||null;return this.origin(t)};Wm.element=function(){return this._el};Wm.canvas=function(){return this._el&&this._el.firstChild};Wm.origin=function(e){if(arguments.length){this._origin=e||[0,0];return this}else{return this._origin.slice()}};Wm.scene=function(e){if(!arguments.length)return this._scene;this._scene=e;return this};Wm.on=function(){};Wm.off=function(){};Wm._handlerIndex=function(e,t,n){for(var r=e?e.length:0;--r>=0;){if(e[r].type===t&&(!n||e[r].handler===n)){return r}}return-1};Wm.handlers=function(e){var t=this._handlers,n=[],r;if(e){n.push.apply(n,t[this.eventName(e)])}else{for(r in t){n.push.apply(n,t[r])}}return n};Wm.eventName=function(e){var t=e.indexOf(".");return t<0?e:e.slice(0,t)};Wm.handleHref=function(e,t,n){this._loader.sanitize(n,{context:"href"}).then(function(t){var n=new MouseEvent(e.type,e),r=Tm(null,"a");for(var i in t)r.setAttribute(i,t[i]);r.dispatchEvent(n)}).catch(function(){})};Wm.handleTooltip=function(e,t,n){if(t&&t.tooltip!=null){t=Im(t,e,this.canvas(),this._origin);var r=n&&t&&t.tooltip||null;this._tooltip.call(this._obj,this,e,t,r)}};Wm.getItemBoundingClientRect=function(e){if(!(t=this.canvas()))return;var t,n=t.getBoundingClientRect(),r=this._origin,i=e.bounds,a=i.x1+r[0]+n.left,u=i.y1+r[1]+n.top,o=i.width(),f=i.height();while(e.mark&&(e=e.mark.group)){a+=e.x||0;u+=e.y||0}return{x:a,y:u,width:o,height:f,left:a,top:u,right:a+o,bottom:u+f}};function Hm(e){this._el=null;this._bgcolor=null;this._loader=new ud(e)}var Gm=Hm.prototype;Gm.initialize=function(e,t,n,r,i){this._el=e;return this.resize(t,n,r,i)};Gm.element=function(){return this._el};Gm.canvas=function(){return this._el&&this._el.firstChild};Gm.background=function(e){if(arguments.length===0)return this._bgcolor;this._bgcolor=e;return this};Gm.resize=function(e,t,n,r){this._width=e;this._height=t;this._origin=n||[0,0];this._scale=r||1;return this};Gm.dirty=function(){};Gm.render=function(e){var t=this;t._call=function(){t._render(e)};t._call();t._call=null;return t};Gm._render=function(){};Gm.renderAsync=function(e){var t=this.render(e);return this._ready?this._ready.then(function(){return t}):Promise.resolve(t)};Gm._load=function(e,t){var n=this,r=n._loader[e](t);if(!n._ready){var i=n._call;n._ready=n._loader.ready().then(function(e){if(e)i();n._ready=null})}return r};Gm.sanitizeURL=function(e){return this._load("sanitizeURL",e)};Gm.loadImage=function(e){return this._load("loadImage",e)};var Ym=["keydown","keypress","keyup","dragenter","dragleave","dragover","mousedown","mouseup","mousemove","mouseout","mouseover","click","dblclick","wheel","mousewheel","touchstart","touchmove","touchend"];var $m="mousemove";var Vm="mouseout";var Xm="click";function Zm(e,t){Um.call(this,e,t);this._down=null;this._touch=null;this._first=true}var Jm=Object(dn["x"])(Zm,Um);Jm.initialize=function(e,t,n){var r=this._canvas=e&&zm(e,"canvas");if(r){var i=this;this.events.forEach(function(e){r.addEventListener(e,function(t){if(Jm[e]){Jm[e].call(i,t)}else{i.fire(e,t)}})})}return Um.prototype.initialize.call(this,e,t,n)};Jm.canvas=function(){return this._canvas};Jm.context=function(){return this._canvas.getContext("2d")};Jm.events=Ym;Jm.DOMMouseScroll=function(e){this.fire("mousewheel",e)};function Qm(e,t,n){return function(r){var i=this._active,a=this.pickEvent(r);if(a===i){this.fire(e,r)}else{if(!i||!i.exit){this.fire(n,r)}this._active=a;this.fire(t,r);this.fire(e,r)}}}function Km(e){return function(t){this.fire(e,t);this._active=null}}Jm.mousemove=Qm("mousemove","mouseover","mouseout");Jm.dragover=Qm("dragover","dragenter","dragleave");Jm.mouseout=Km("mouseout");Jm.dragleave=Km("dragleave");Jm.mousedown=function(e){this._down=this._active;this.fire("mousedown",e)};Jm.click=function(e){if(this._down===this._active){this.fire("click",e);this._down=null}};Jm.touchstart=function(e){this._touch=this.pickEvent(e.changedTouches[0]);if(this._first){this._active=this._touch;this._first=false}this.fire("touchstart",e,true)};Jm.touchmove=function(e){this.fire("touchmove",e,true)};Jm.touchend=function(e){this.fire("touchend",e,true);this._touch=null};Jm.fire=function(e,t,n){var r=n?this._touch:this._active,i=this._handlers[e],a,u;t.vegaType=e;if(e===Xm&&r&&r.href){this.handleHref(t,r,r.href)}else if(e===$m||e===Vm){this.handleTooltip(t,r,e!==Vm)}if(i){for(a=0,u=i.length;a<u;++a){i[a].handler.call(this._obj,t,r)}}};Jm.on=function(e,t){var n=this.eventName(e),r=this._handlers,i=this._handlerIndex(r[n],e,t);if(i<0){(r[n]||(r[n]=[])).push({type:e,handler:t})}return this};Jm.off=function(e,t){var n=this.eventName(e),r=this._handlers[n],i=this._handlerIndex(r,e,t);if(i>=0){r.splice(i,1)}return this};Jm.pickEvent=function(e){var t=Bm(e,this._canvas),n=this._origin;return this.pick(this._scene,t[0],t[1],t[0]-n[0],t[1]-n[1])};Jm.pick=function(e,t,n,r,i){var a=this.context(),u=km[e.marktype];return u.pick.call(this,a,e,t,n,r,i)};var ey=function(e,t){var n=t.clip;e.save();e.beginPath();if(Object(dn["C"])(n)){n(e)}else{var r=t.group;e.rect(0,0,r.width||0,r.height||0)}e.clip()};function ty(){return typeof window!=="undefined"?window.devicePixelRatio||1:1}var ny=ty();var ry=function(e,t,n,r,i){var a=typeof HTMLElement!=="undefined"&&e instanceof HTMLElement&&e.parentNode!=null;var u=e.getContext("2d"),o=a?ny:i;e.width=t*o;e.height=n*o;if(a&&o!==1){e.style.width=t+"px";e.style.height=n+"px"}u.pixelRatio=o;u.setTransform(o,0,0,o,o*r[0],o*r[1]);return e};function iy(e){Hm.call(this,e);this._redraw=false;this._dirty=new Qs}var ay=Object(dn["x"])(iy,Hm),uy=Hm.prototype,oy=new Qs;ay.initialize=function(e,t,n,r,i){this._canvas=id(1,1);if(e){Pm(e,0).appendChild(this._canvas);this._canvas.setAttribute("class","marks")}return uy.initialize.call(this,e,t,n,r,i)};ay.resize=function(e,t,n,r){uy.resize.call(this,e,t,n,r);ry(this._canvas,this._width,this._height,this._origin,this._scale);this._redraw=true;return this};ay.canvas=function(){return this._canvas};ay.context=function(){return this._canvas?this._canvas.getContext("2d"):null};ay.dirty=function(e){var t=cy(e.bounds,e.mark.group);this._dirty.union(t)};function fy(e,t,n){t.expand(1).round();t.translate(-(n[0]%1),-(n[1]%1));e.beginPath();e.rect(t.x1,t.y1,t.width(),t.height());e.clip();return t}function cy(e,t){if(t==null)return e;var n=oy.clear().union(e);for(;t!=null;t=t.mark.group){n.translate(t.x||0,t.y||0)}return n}ay._render=function(e){var t=this.context(),n=this._origin,r=this._width,i=this._height,a=this._dirty;t.save();if(this._redraw||a.empty()){this._redraw=false;a=null}else{a=fy(t,a,n)}this.clear(-n[0],-n[1],r,i);this.draw(t,e,a);t.restore();this._dirty.clear();return this};ay.draw=function(e,t,n){var r=km[t.marktype];if(t.clip)ey(e,t);r.draw.call(this,e,t,n);if(t.clip)e.restore()};ay.clear=function(e,t,n,r){var i=this.context();i.clearRect(e,t,n,r);if(this._bgcolor!=null){i.fillStyle=this._bgcolor;i.fillRect(e,t,n,r)}};function ly(e,t){Um.call(this,e,t);var n=this;n._hrefHandler=dy(n,function(e,t){if(t&&t.href)n.handleHref(e,t,t.href)});n._tooltipHandler=dy(n,function(e,t){n.handleTooltip(e,t,e.type!==Vm)})}var sy=Object(dn["x"])(ly,Um);sy.initialize=function(e,t,n){var r=this._svg;if(r){r.removeEventListener(Xm,this._hrefHandler);r.removeEventListener($m,this._tooltipHandler);r.removeEventListener(Vm,this._tooltipHandler)}this._svg=r=e&&zm(e,"svg");if(r){r.addEventListener(Xm,this._hrefHandler);r.addEventListener($m,this._tooltipHandler);r.addEventListener(Vm,this._tooltipHandler)}return Um.prototype.initialize.call(this,e,t,n)};sy.canvas=function(){return this._svg};function dy(e,t){return function(n){var r=n.target,i=r.__data__;n.vegaType=n.type;i=Array.isArray(i)?i[0]:i;t.call(e._obj,n,i)}}sy.on=function(e,t){var n=this.eventName(e),r=this._handlers,i=this._handlerIndex(r[n],e,t);if(i<0){var a={type:e,handler:t,listener:dy(this,t)};(r[n]||(r[n]=[])).push(a);if(this._svg){this._svg.addEventListener(n,a.listener)}}return this};sy.off=function(e,t){var n=this.eventName(e),r=this._handlers[n],i=this._handlerIndex(r,e,t);if(i>=0){if(this._svg){this._svg.removeEventListener(n,r[i].listener)}r.splice(i,1)}return this};function hy(e,t,n){var r="<"+e,i,a;if(t){for(i in t){a=t[i];if(a!=null){r+=" "+i+'="'+a+'"'}}}if(n)r+=" "+n;return r+">"}function py(e){return"</"+e+">"}var vy={version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"};var gy={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity"};var my=Object.keys(gy);var yy=vy.xmlns;function by(e){Hm.call(this,e);this._dirtyID=1;this._dirty=[];this._svg=null;this._root=null;this._defs=null}var xy=Object(dn["x"])(by,Hm);var _y=Hm.prototype;xy.initialize=function(e,t,n,r){if(e){this._svg=Rm(e,0,"svg",yy);this._svg.setAttribute("class","marks");Pm(e,1);this._root=Rm(this._svg,0,"g",yy);Pm(this._svg,1)}this._defs={gradient:{},clipping:{}};this.background(this._bgcolor);return _y.initialize.call(this,e,t,n,r)};xy.background=function(e){if(arguments.length&&this._svg){this._svg.style.setProperty("background-color",e)}return _y.background.apply(this,arguments)};xy.resize=function(e,t,n,r){_y.resize.call(this,e,t,n,r);if(this._svg){this._svg.setAttribute("width",this._width*this._scale);this._svg.setAttribute("height",this._height*this._scale);this._svg.setAttribute("viewBox","0 0 "+this._width+" "+this._height);this._root.setAttribute("transform","translate("+this._origin+")")}this._dirty=[];return this};xy.canvas=function(){return this._svg};xy.svg=function(){if(!this._svg)return null;var e={class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:"0 0 "+this._width+" "+this._height};for(var t in vy){e[t]=vy[t]}var n=!this._bgcolor?"":hy("rect",{width:this._width,height:this._height,style:"fill: "+this._bgcolor+";"})+py("rect");return hy("svg",e)+n+this._svg.innerHTML+py("svg")};xy._render=function(e){if(this._dirtyCheck()){if(this._dirtyAll)this._resetDefs();this.draw(this._root,e);Pm(this._root,1)}this.updateDefs();this._dirty=[];++this._dirtyID;return this};xy.updateDefs=function(){var e=this._svg,t=this._defs,n=t.el,r=0,i;for(i in t.gradient){if(!n)t.el=n=Rm(e,0,"defs",yy);wy(n,t.gradient[i],r++)}for(i in t.clipping){if(!n)t.el=n=Rm(e,0,"defs",yy);ky(n,t.clipping[i],r++)}if(n){if(r===0){e.removeChild(n);t.el=null}else{Pm(n,r)}}};function wy(e,t,n){var r,i,a;e=Rm(e,n,"linearGradient",yy);e.setAttribute("id",t.id);e.setAttribute("x1",t.x1);e.setAttribute("x2",t.x2);e.setAttribute("y1",t.y1);e.setAttribute("y2",t.y2);for(r=0,i=t.stops.length;r<i;++r){a=Rm(e,r,"stop",yy);a.setAttribute("offset",t.stops[r].offset);a.setAttribute("stop-color",t.stops[r].color)}Pm(e,r)}function ky(e,t,n){var r;e=Rm(e,n,"clipPath",yy);e.setAttribute("id",t.id);if(t.path){r=Rm(e,0,"path",yy);r.setAttribute("d",t.path)}else{r=Rm(e,0,"rect",yy);r.setAttribute("x",0);r.setAttribute("y",0);r.setAttribute("width",t.width);r.setAttribute("height",t.height)}}xy._resetDefs=function(){var e=this._defs;e.gradient={};e.clipping={}};xy.dirty=function(e){if(e.dirty!==this._dirtyID){e.dirty=this._dirtyID;this._dirty.push(e)}};xy.isDirty=function(e){return this._dirtyAll||!e._svg||e.dirty===this._dirtyID};xy._dirtyCheck=function(){this._dirtyAll=true;var e=this._dirty;if(!e.length)return true;var t=++this._dirtyID,n,r,i,a,u,o,f;for(u=0,o=e.length;u<o;++u){n=e[u];r=n.mark;if(r.marktype!==i){i=r.marktype;a=km[i]}if(r.zdirty&&r.dirty!==t){this._dirtyAll=false;Oy(n,t);r.items.forEach(function(e){e.dirty=t})}if(r.zdirty)continue;if(n.exit){if(a.nested&&r.items.length){f=r.items[0];if(f._svg)this._update(a,f._svg,f)}else if(n._svg){f=n._svg.parentNode;if(f)f.removeChild(n._svg)}n._svg=null;continue}n=a.nested?r.items[0]:n;if(n._update===t)continue;if(!n._svg||!n._svg.ownerSVGElement){this._dirtyAll=false;Oy(n,t)}else{this._update(a,n._svg,n)}n._update=t}return!this._dirtyAll};function Oy(e,t){for(;e&&e.dirty!==t;e=e.mark.group){e.dirty=t;if(e.mark&&e.mark.dirty!==t){e.mark.dirty=t}else return}}xy.draw=function(e,t,n){if(!this.isDirty(t))return t._svg;var r=this,i=this._svg,a=km[t.marktype],u=t.interactive===false?"none":null,o=a.tag==="g",f=null,c=0,l;l=Ey(t,e,n,"g",i);l.setAttribute("class",Lm(t));if(!o){l.style.setProperty("pointer-events",u)}if(t.clip){l.setAttribute("clip-path",bg(r,t,t.group))}else{l.removeAttribute("clip-path")}function s(e){var t=r.isDirty(e),n=Ey(e,l,f,a.tag,i);if(t){r._update(a,n,e);if(o)Ay(r,n,e)}f=n;++c}if(a.nested){if(t.items.length)s(t.items[0])}else{Kv(t,s)}Pm(l,c);return l};function Ay(e,t,n){t=t.lastChild;var r,i=0;Kv(n,function(n){r=e.draw(t,n,r);++i});Pm(t,1+i)}function Ey(e,t,n,r,i){var a=e._svg,u;if(!a){u=t.ownerDocument;a=Tm(u,r,yy);e._svg=a;if(e.mark){a.__data__=e;a.__values__={fill:"default"};if(r==="g"){var o=Tm(u,"path",yy);o.setAttribute("class","background");a.appendChild(o);o.__data__=e;var f=Tm(u,"g",yy);a.appendChild(f);f.__data__=e}}}if(a.ownerSVGElement!==i||My(e)&&a.previousSibling!==n){t.insertBefore(a,n?n.nextSibling:t.firstChild)}return a}function My(e){var t=e.mark||e.group;return t&&t.items.length>1}var Sy=null,Cy=null;var Dy={group:function(e,t,n){Cy=t.__values__;Sy=t.childNodes[1];e.foreground(Ny,n,this);Sy=t.childNodes[0];e.background(Ny,n,this);var r=n.mark.interactive===false?"none":null;if(r!==Cy.events){Sy.style.setProperty("pointer-events",r);Cy.events=r}},text:function(e,t,n){var r;r=lm(n);if(r!==Cy.text){t.textContent=r;Cy.text=r}jy(t,"font-family",dm(n));jy(t,"font-size",fm(n)+"px");jy(t,"font-style",n.fontStyle);jy(t,"font-variant",n.fontVariant);jy(t,"font-weight",n.fontWeight)}};function jy(e,t,n){if(n!==Cy[t]){if(n==null){e.style.removeProperty(t)}else{e.style.setProperty(t,n+"")}Cy[t]=n}}xy._update=function(e,t,n){Sy=t;Cy=t.__values__;e.attr(Ny,n,this);var r=Dy[e.type];if(r)r.call(this,e,t,n);this.style(Sy,n)};function Ny(e,t,n){if(t===Cy[e])return;if(t!=null){if(n){Sy.setAttributeNS(n,e,t)}else{Sy.setAttribute(e,t)}}else{if(n){Sy.removeAttributeNS(n,e)}else{Sy.removeAttribute(e)}}Cy[e]=t}xy.style=function(e,t){if(t==null)return;var n,r,i,a,u;for(n=0,r=my.length;n<r;++n){i=my[n];u=t[i];if(i==="font"){u=dm(t)}if(u===Cy[i])continue;a=gy[i];if(u==null){if(a==="fill"){e.style.setProperty(a,"none")}else{e.style.removeProperty(a)}}else{if(u.id){this._defs.gradient[u.id]=u;u="url("+Fy()+"#"+u.id+")"}e.style.setProperty(a,u+"")}Cy[i]=u}};function Fy(){var e;return typeof window==="undefined"?"":(e=window.location).hash?e.href.slice(0,-e.hash.length):e.href}function Ty(e){Hm.call(this,e);this._text={head:"",bg:"",root:"",foot:"",defs:"",body:""};this._defs={gradient:{},clipping:{}}}var zy=Object(dn["x"])(Ty,Hm);var Ry=Hm.prototype;zy.resize=function(e,t,n,r){Ry.resize.call(this,e,t,n,r);var i=this._origin,a=this._text;var u={class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:"0 0 "+this._width+" "+this._height};for(var o in vy){u[o]=vy[o]}a.head=hy("svg",u);var f=this._bgcolor;if(f==="transparent"||f==="none")f=null;if(f){a.bg=hy("rect",{width:this._width,height:this._height,style:"fill: "+f+";"})+py("rect")}else{a.bg=""}a.root=hy("g",{transform:"translate("+i+")"});a.foot=py("g")+py("svg");return this};zy.background=function(){var e=Ry.background.apply(this,arguments);if(arguments.length&&this._text.head){this.resize(this._width,this._height,this._origin,this._scale)}return e};zy.svg=function(){var e=this._text;return e.head+e.bg+e.defs+e.root+e.body+e.foot};zy._render=function(e){this._text.body=this.mark(e);this._text.defs=this.buildDefs();return this};zy.buildDefs=function(){var e=this._defs,t="",n,r,i,a;for(r in e.gradient){i=e.gradient[r];a=i.stops;t+=hy("linearGradient",{id:r,x1:i.x1,x2:i.x2,y1:i.y1,y2:i.y2});for(n=0;n<a.length;++n){t+=hy("stop",{offset:a[n].offset,"stop-color":a[n].color})+py("stop")}t+=py("linearGradient")}for(r in e.clipping){i=e.clipping[r];t+=hy("clipPath",{id:r});if(i.path){t+=hy("path",{d:i.path})+py("path")}else{t+=hy("rect",{x:0,y:0,width:i.width,height:i.height})+py("rect")}t+=py("clipPath")}return t.length>0?hy("defs")+t+py("defs"):""};var Py;function Ly(e,t,n,r){Py[r||e]=t}zy.attributes=function(e,t){Py={};e(Ly,t,this);return Py};zy.href=function(e){var t=this,n=e.href,r;if(n){if(r=t._hrefs&&t._hrefs[n]){return r}else{t.sanitizeURL(n).then(function(e){e["xlink:href"]=e.href;e.href=null;(t._hrefs||(t._hrefs={}))[n]=e})}}return null};zy.mark=function(e){var t=this,n=km[e.marktype],r=n.tag,i=this._defs,a="",u;if(r!=="g"&&e.interactive===false){u='style="pointer-events: none;"'}a+=hy("g",{class:Lm(e),"clip-path":e.clip?bg(t,e,e.group):null},u);function o(o){var f=t.href(o);if(f)a+=hy("a",f);u=r!=="g"?By(o,e,r,i):null;a+=hy(r,t.attributes(n.attr,o),u);if(r==="text"){a+=Iy(lm(o))}else if(r==="g"){a+=hy("path",t.attributes(n.background,o),By(o,e,"bgrect",i))+py("path");a+=hy("g",t.attributes(n.foreground,o))+t.markGroup(o)+py("g")}a+=py(r);if(f)a+=py("a")}if(n.nested){if(e.items&&e.items.length)o(e.items[0])}else{Kv(e,o)}return a+py("g")};zy.markGroup=function(e){var t=this,n="";Kv(e,function(e){n+=t.mark(e)});return n};function By(e,t,n,r){if(e==null)return"";var i,a,u,o,f,c="";if(n==="bgrect"&&t.interactive===false){c+="pointer-events: none; "}if(n==="text"){c+="font-family: "+dm(e)+"; ";c+="font-size: "+fm(e)+"px; ";if(e.fontStyle)c+="font-style: "+e.fontStyle+"; ";if(e.fontVariant)c+="font-variant: "+e.fontVariant+"; ";if(e.fontWeight)c+="font-weight: "+e.fontWeight+"; "}for(i=0,a=my.length;i<a;++i){u=my[i];o=gy[u];f=e[u];if(f==null){if(o==="fill"){c+="fill: none; "}}else if(f==="transparent"&&(o==="fill"||o==="stroke")){c+=o+": none; "}else{if(f.id){r.gradient[f.id]=f;f="url(#"+f.id+")"}c+=o+": "+f+"; "}}return c?'style="'+c.trim()+'"':null}function Iy(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}var Uy="canvas";var qy="png";var Wy="svg";var Hy="none";var Gy={Canvas:Uy,PNG:qy,SVG:Wy,None:Hy};var Yy={};Yy[Uy]=Yy[qy]={renderer:iy,headless:iy,handler:Zm};Yy[Wy]={renderer:by,headless:Ty,handler:ly};Yy[Hy]={};function $y(e,t){e=String(e||"").toLowerCase();if(arguments.length>1){Yy[e]=t;return this}else{return Yy[e]}}var Vy=new Qs;var Xy=function(e){var t=e.clip;if(Object(dn["C"])(t)){t(Wv(Vy.clear()))}else if(t){Vy.set(0,0,e.group.width,e.group.height)}else return;e.bounds.intersect(Vy)};var Zy=1e-9;function Jy(e,t,n){return e===t?true:n==="path"?Qy(e,t):e instanceof Date&&t instanceof Date?+e===+t:Object(dn["D"])(e)&&Object(dn["D"])(t)?Math.abs(e-t)<=Zy:!e||!t||!Object(dn["E"])(e)&&!Object(dn["E"])(t)?e==t:e==null||t==null?false:Ky(e,t)}function Qy(e,t){return Jy(Lp(e),Lp(t))}function Ky(e,t){var n=Object.keys(e),r=Object.keys(t),i,a;if(n.length!==r.length)return false;n.sort();r.sort();for(a=n.length-1;a>=0;a--){if(n[a]!=r[a])return false}for(a=n.length-1;a>=0;a--){i=n[a];if(!Jy(e[i],t[i],i))return false}return typeof e===typeof t}function eb(e){Go.call(this,null,e)}var tb=Object(dn["x"])(eb,Go);tb.transform=function(e,t){var n=t.dataflow,r=e.mark,i=r.marktype,a=km[i],u=a.bound,o=r.bounds,f;if(a.nested){if(r.items.length)n.dirty(r.items[0]);o=nb(r,u);r.items.forEach(function(e){e.bounds.clear().union(o)})}else if(i===Ss||e.modified()){t.visit(t.MOD,function(e){n.dirty(e)});o.clear();r.items.forEach(function(e){o.union(nb(e,u))});if(r.role===Fs)t.reflow()}else{f=t.changed(t.REM);t.visit(t.ADD,function(e){o.union(nb(e,u))});t.visit(t.MOD,function(e){f=f||o.alignsWith(e.bounds);n.dirty(e);o.union(nb(e,u))});if(f){o.clear();r.items.forEach(function(e){o.union(e.bounds)})}}Xy(r);return t.modifies("bounds")};function nb(e,t,n){return t(e.bounds.clear(),e,n)}var rb=":vega_identifier:";function ib(e){Go.call(this,0,e)}ib.Definition={type:"Identifier",metadata:{modifies:true},params:[{name:"as",type:"string",required:true}]};var ab=Object(dn["x"])(ib,Go);ab.transform=function(e,t){var n=ub(t.dataflow),r=n.value,i=e.as;t.visit(t.ADD,function(e){if(!e[i])e[i]=++r});n.set(this.value=r);return t};function ub(e){var t=e._signals[rb];if(!t){e._signals[rb]=t=e.add(0)}return t}function ob(e){Go.call(this,null,e)}var fb=Object(dn["x"])(ob,Go);fb.transform=function(e,t){var n=this.value;if(!n){n=t.dataflow.scenegraph().mark(e.markdef,cb(e),e.index);n.group.context=e.context;if(!e.context.group)e.context.group=n.group;n.source=this;n.clip=e.clip;n.interactive=e.interactive;this.value=n}var r=n.marktype===Ss?rd:nd;t.visit(t.ADD,function(e){r.call(e,n)});if(e.modified("clip")||e.modified("interactive")){n.clip=e.clip;n.interactive=!!e.interactive;n.zdirty=true;t.reflow()}n.items=t.source;return t};function cb(e){var t=e.groups,n=e.parent;return t&&t.size===1?t.get(Object.keys(t.object)[0]):t&&n?t.lookup(n):null}function lb(e){Go.call(this,null,e)}var sb=Object(dn["x"])(lb,Go);var db={parity:function(e){return e.filter(function(e,t){return t%2?e.opacity=0:1})},greedy:function(e){var t;return e.filter(function(e,n){if(!n||!hb(t.bounds,e.bounds)){t=e;return 1}else{return e.opacity=0}})}};function hb(e,t){return!(e.x2-1<t.x1||e.x1+1>t.x2||e.y2-1<t.y1||e.y1+1>t.y2)}function pb(e){for(var t=1,n=e.length,r=e[0].bounds,i;t<n;r=i,++t){if(hb(r,i=e[t].bounds))return true}}function vb(e){var t=e.bounds;return t.width()>1&&t.height()>1}function gb(e,t,n){var r=e.range(),i=new Qs;if(t===ms||t===xs){i.set(r[0],-Infinity,r[1],+Infinity)}else{i.set(-Infinity,r[0],+Infinity,r[1])}i.expand(n||1);return function(e){return i.encloses(e.bounds)}}function mb(e){e.forEach(function(e){e.opacity=1});return e}function yb(e,t){return e.reflow(t.modified()).modifies("opacity")}sb.transform=function(e,t){var n=db[e.method]||db.parity,r=t.materialize(t.SOURCE).source,i,a;if(!r)return;if(!e.method){if(e.modified("method")){mb(r);t=yb(t,e)}return t}if(e.sort){r=r.slice().sort(e.sort)}if(e.method==="greedy"){r=r.filter(vb)}i=mb(r);t=yb(t,e);if(i.length>=3&&pb(i)){do{i=n(i)}while(i.length>=3&&pb(i));if(i.length<3&&!Object(dn["R"])(r).opacity){if(i.length>1)Object(dn["R"])(i).opacity=0;Object(dn["R"])(r).opacity=1}}if(e.boundScale&&e.boundTolerance>=0){a=gb(e.boundScale,e.boundOrient,+e.boundTolerance);r.forEach(function(e){if(!a(e))e.opacity=0})}return t};function bb(e){Go.call(this,null,e)}var xb=Object(dn["x"])(bb,Go);xb.transform=function(e,t){var n=t.dataflow;t.visit(t.ALL,function(e){n.dirty(e)});if(t.fields&&t.fields["zindex"]){var r=t.source&&t.source[0];if(r)r.mark.zdirty=true}};function _b(e){var t=e.items,n=t.length,r=0,i,a;var u={marks:[],rowheaders:[],rowfooters:[],colheaders:[],colfooters:[],rowtitle:null,coltitle:null};for(;r<n;++r){i=t[r];a=i.items;if(i.marktype===Ss){switch(i.role){case Cs:case Fs:break;case Ts:wb(a,u.rowheaders);break;case zs:wb(a,u.rowfooters);break;case Ps:wb(a,u.colheaders);break;case Ls:wb(a,u.colfooters);break;case Rs:u.rowtitle=a[0];break;case Bs:u.coltitle=a[0];break;default:wb(a,u.marks)}}}return u}function wb(e,t){for(var n=0,r=e.length;n<r;++n){t.push(e[n])}}function kb(e){return{x1:0,y1:0,x2:e.width||0,y2:e.height||0}}function Ob(e){var t=e.bounds.clone();return t.empty()?t.set(0,0,0,0):t.translate(-(e.x||0),-(e.y||0))}function Ab(e,t){return t==="x1"?e.x||0:t==="y1"?e.y||0:t==="x2"?(e.x||0)+(e.width||0):t==="y2"?(e.y||0)+(e.height||0):undefined}function Eb(e,t){return e.bounds[t]}function Mb(e,t,n){var r=Object(dn["E"])(e)?e[t]:e;return r!=null?r:n!==undefined?n:0}function Sb(e){return e<0?Math.ceil(-e):0}function Cb(e,t,n){var r=_b(t,n),i=r.marks,a=n.bounds===Xs,u=a?kb:Ob,o=new Qs(0,0,0,0),f=Mb(n.align,Zs),c=Mb(n.align,Js),l=Mb(n.padding,Zs),s=Mb(n.padding,Js),d=n.offset,h=t.columns||n.columns||i.length,p=h<0?1:Math.ceil(i.length/h),v=p*h,g=[],m=[],y=0,b=0,x=[],_=[],w=0,k=0,O=i.length,A,E,M,S,C,D,j,N,F,T,z,R;for(E=0;E<h;++E){m[E]=0}for(E=0;E<p;++E){_[E]=0}for(E=0;E<O;++E){C=u(i[E]);M=E%h;S=~~(E/h);j=Math.ceil(u(i[E]).x2);N=Math.ceil(u(i[E]).y2);y=Math.max(y,j);w=Math.max(w,N);m[M]=Math.max(m[M],j);_[S]=Math.max(_[S],N);g.push(l+Sb(C.x1));x.push(s+Sb(C.y1));e.dirty(i[E])}for(E=0;E<O;++E){if(E%h===0)g[E]=b;if(E<h)x[E]=k}if(f===Vs){for(M=1;M<h;++M){for(R=0,E=M;E<O;E+=h){if(R<g[E])R=g[E]}for(E=M;E<O;E+=h){g[E]=R+m[M-1]}}}else if(f===$s){for(R=0,E=0;E<O;++E){if(E%h&&R<g[E])R=g[E]}for(E=0;E<O;++E){if(E%h)g[E]=R+y}}else{for(f=false,M=1;M<h;++M){for(E=M;E<O;E+=h){g[E]+=m[M-1]}}}if(c===Vs){for(S=1;S<p;++S){for(R=0,E=S*h,A=E+h;E<A;++E){if(R<x[E])R=x[E]}for(E=S*h;E<A;++E){x[E]=R+_[S-1]}}}else if(c===$s){for(R=0,E=h;E<O;++E){if(R<x[E])R=x[E]}for(E=h;E<O;++E){x[E]=R+w}}else{for(c=false,S=1;S<p;++S){for(E=S*h,A=E+h;E<A;++E){x[E]+=_[S-1]}}}for(F=0,E=0;E<O;++E){D=i[E];j=D.x||0;D.x=F=g[E]+(E%h?F:0);D.bounds.translate(F-j,0)}for(M=0;M<h;++M){for(T=0,E=M;E<O;E+=h){D=i[E];N=D.y||0;D.y=T+=x[E];D.bounds.translate(0,T-N)}}if(Mb(n.center,Zs)&&p>1&&f){for(E=0;E<O;++E){D=i[E];C=f===$s?y:m[E%h];F=C-u(D).x2;if(F>0){D.x+=j=F/2;D.bounds.translate(j,0)}}}if(Mb(n.center,Js)&&h!==1&&c){for(E=0;E<O;++E){D=i[E];C=c===$s?w:_[~~(E/h)];T=C-u(D).y2;if(T>0){D.y+=N=T/2;D.bounds.translate(0,N)}}}for(E=0;E<O;++E)i[E].mark.bounds.clear();for(E=0;E<O;++E){D=i[E];e.dirty(D);o.union(D.mark.bounds.union(D.bounds))}function P(e,t){return Math.floor(Math.min(e,t))}function L(e,t){return Math.ceil(Math.max(e,t))}u=a?Ab:Eb;z=Mb(n.headerBand,Js,null);F=Db(e,r.rowheaders,i,h,p,-Mb(d,"rowHeader"),P,0,u,"x1",0,h,1,z);z=Mb(n.headerBand,Zs,null);T=Db(e,r.colheaders,i,h,h,-Mb(d,"columnHeader"),P,1,u,"y1",0,1,h,z);z=Mb(n.footerBand,Js,null);Db(e,r.rowfooters,i,h,p,Mb(d,"rowFooter"),L,0,u,"x2",h-1,h,1,z);z=Mb(n.footerBand,Zs,null);Db(e,r.colfooters,i,h,h,Mb(d,"columnFooter"),L,1,u,"y2",v-h,1,h,z);if(r.rowtitle){R=F-Mb(d,"rowTitle");z=Mb(n.titleBand,Js,.5);jb(e,r.rowtitle,R,0,o,z)}if(r.coltitle){R=T-Mb(d,"columnTitle");z=Mb(n.titleBand,Zs,.5);jb(e,r.coltitle,R,1,o,z)}}function Db(e,t,n,r,i,a,u,o,f,c,l,s,d,h){var p=n.length,v=0,g=0,m,y,b,x,_,w,k,O,A;if(!p)return v;for(m=l;m<p;m+=s){if(n[m])v=u(v,f(n[m],c))}if(!t.length)return v;if(t.length>i){e.warn("Grid headers exceed limit: "+i);t=t.slice(0,i)}v+=a;for(y=0,x=t.length;y<x;++y){e.dirty(t[y]);t[y].mark.bounds.clear()}for(m=l,y=0,x=t.length;y<x;++y,m+=s){w=t[y];_=w.mark.bounds;for(b=m;b>=0&&(k=n[b])==null;b-=d);if(o){O=h==null?k.x:Math.round(k.bounds.x1+h*k.bounds.width());A=v}else{O=v;A=h==null?k.y:Math.round(k.bounds.y1+h*k.bounds.height())}_.union(w.bounds.translate(O-(w.x||0),A-(w.y||0)));w.x=O;w.y=A;e.dirty(w);g=u(g,_[c])}return g}function jb(e,t,n,r,i,a){if(!t)return;e.dirty(t);var u=n,o=n;r?u=Math.round(i.x1+a*i.width()):o=Math.round(i.y1+a*i.height());t.bounds.translate(u-(t.x||0),o-(t.y||0));t.mark.bounds.clear().union(t.bounds);t.x=u;t.y=o;e.dirty(t)}var Nb=.5,Fb=new Qs;function Tb(e){Go.call(this,null,e)}var zb=Object(dn["x"])(Tb,Go);zb.transform=function(e,t){var n=t.dataflow;e.mark.items.forEach(function(t){if(e.layout)Cb(n,t,e.layout);Rb(n,t,e)});if(e.modified())t.reflow();return t};function Rb(e,t,n){var r=t.items,i=Math.max(0,t.width||0),a=Math.max(0,t.height||0),u=(new Qs).set(0,0,i,a),o=u.clone(),f=u.clone(),c=[],l,s,d,h,p,v;for(p=0,v=r.length;p<v;++p){s=r[p];switch(s.role){case Cs:h=Lb(s)?o:f;h.union(Ib(e,s,i,a));break;case Ds:l=s;break;case Fs:c.push(s);break;case js:case Ns:case Ts:case zs:case Rs:case Ps:case Ls:case Bs:o.union(s.bounds);f.union(s.bounds);break;default:u.union(s.bounds)}}if(c.length){d={leftWidth:Wb(e,c),margin:n.legendMargin||8,left:0,right:0,top:0,bottom:0};for(p=0,v=c.length;p<v;++p){h=Gb(e,c[p],d,o,f,i,a);if(n.autosize&&n.autosize.type===qs){var g=c[p].items[0].datum.orient;if(g===ys||g===bs){u.add(h.x1,0).add(h.x2,0)}else if(g===ms||g===xs){u.add(0,h.y1).add(0,h.y2)}}else{u.union(h)}}}u.union(o).union(f);if(l){u.union(qb(e,l,i,a,u))}$b(e,t,u,n)}function Pb(e,t,n){if(e[t]===n){return 0}else{e[t]=n;return 1}}function Lb(e){var t=e.items[0].datum.orient;return t===ys||t===bs}function Bb(e){var t=+e.grid;return[e.ticks?t++:-1,e.labels?t++:-1,t+ +e.domain]}function Ib(e,t,n,r){var i=t.items[0],a=i.datum,u=a.orient,o=Bb(a),f=i.range,c=i.offset,l=i.position,s=i.minExtent,d=i.maxExtent,h=a.title&&i.items[o[2]].items[0],p=i.titlePadding,v=i.bounds,g=0,m=0,y,b;Fb.clear().union(v);v.clear();if((y=o[0])>-1)v.union(i.items[y].bounds);if((y=o[1])>-1)v.union(i.items[y].bounds);switch(u){case ms:g=l||0;m=-c;b=Math.max(s,Math.min(d,-v.y1));if(h)b=Ub(h,b,p,0,-1,v);v.add(0,-b).add(f,0);break;case ys:g=-c;m=l||0;b=Math.max(s,Math.min(d,-v.x1));if(h)b=Ub(h,b,p,1,-1,v);v.add(-b,0).add(0,f);break;case bs:g=n+c;m=l||0;b=Math.max(s,Math.min(d,v.x2));if(h)b=Ub(h,b,p,1,1,v);v.add(0,0).add(b,f);break;case xs:g=l||0;m=r+c;b=Math.max(s,Math.min(d,v.y2));if(h)b=Ub(h,b,p,0,1,v);v.add(0,0).add(f,b);break;default:g=i.x;m=i.y}Lv(v.translate(g,m),i);if(Pb(i,"x",g+Nb)|Pb(i,"y",m+Nb)){i.bounds=Fb;e.dirty(i);i.bounds=v;e.dirty(i)}return i.mark.bounds.clear().union(v)}function Ub(e,t,n,r,i,a){var u=e.bounds,o=0,f=0;if(e.auto){t+=n;r?o=(e.x||0)-(e.x=i*t):f=(e.y||0)-(e.y=i*t);u.translate(-o,-f);e.mark.bounds.set(u.x1,u.y1,u.x2,u.y2);if(r){a.add(0,u.y1).add(0,u.y2);t+=u.width()}else{a.add(u.x1,0).add(u.x2,0);t+=u.height()}}else{a.union(u)}return t}function qb(e,t,n,r,i){var a=t.items[0],u=a.orient,o=a.frame,f=a.anchor,c=a.offset,l=a.bounds,s=u===ys||u===bs,d=0,h=s?r:n,p=0,v=0,g;if(o!==Ss){u===ys?(d=i.y2,h=i.y1):u===bs?(d=i.y1,h=i.y2):(d=i.x1,h=i.x2)}else if(u===ys){d=r,h=0}g=f===As?d:f===Ms?h:(d+h)/2;Fb.clear().union(l);switch(u){case ms:p=g;v=i.y1-c;break;case ys:p=i.x1-c;v=g;break;case bs:p=i.x2+c;v=g;break;case xs:p=g;v=i.y2+c;break;default:p=a.x;v=a.y}l.translate(p-a.x,v-a.y);if(Pb(a,"x",p)|Pb(a,"y",v)){a.bounds=Fb;e.dirty(a);a.bounds=l;e.dirty(a)}return t.bounds.clear().union(l)}function Wb(e,t){return t.reduce(function(t,n){var r=n.items[0];Hb(e,r,r.items[0].items[0]);if(r.datum.orient===ys){var i=Fb.clear();r.items.forEach(function(e){i.union(e.bounds)});t=Math.max(t,Math.ceil(i.width()+2*r.padding-1))}return t},0)}function Hb(e,t,n){var r=t.padding-n.x,i=t.padding-n.y;if(t.datum.title){var a=t.items[1].items[0];i+=t.titlePadding+a.fontSize}if(r||i){n.x+=r;n.y+=i;n.bounds.translate(r,i);n.mark.bounds.translate(r,i);e.dirty(n)}}function Gb(e,t,n,r,i,a,u){var o=t.items[0],f=o.datum,c=f.orient,l=o.offset,s=o.bounds,d=0,h=0,p,v,g;if(c===ms||c===xs){g=i,d=n[c]}else if(c===ys||c===bs){g=r;h=n[c]}Fb.clear().union(s);s.clear();o.items.forEach(function(e){s.union(e.bounds)});p=2*o.padding-1;v=2*o.padding-1;if(!s.empty()){p=Math.ceil(s.width()+p);v=Math.ceil(s.height()+v)}if(f.type===Us){Yb(o.items[0].items[0].items[0].items)}switch(c){case ys:d-=n.leftWidth+l-Math.floor(g.x1);n.left+=v+n.margin;break;case bs:d+=l+Math.ceil(g.x2);n.right+=v+n.margin;break;case ms:h-=v+l-Math.floor(g.y1);n.top+=p+n.margin;break;case xs:h+=l+Math.ceil(g.y2);n.bottom+=p+n.margin;break;case _s:d+=l;h+=l;break;case ws:d+=a-p-l;h+=l;break;case ks:d+=l;h+=u-v-l;break;case Os:d+=a-p-l;h+=u-v-l;break;default:d=o.x;h=o.y}Lv(s.set(d,h,d+p,h+v),o);if(Pb(o,"x",d)|Pb(o,"width",p)|Pb(o,"y",h)|Pb(o,"height",v)){o.bounds=Fb;e.dirty(o);o.bounds=s;e.dirty(o)}return o.mark.bounds.clear().union(s)}function Yb(e){var t=e.reduce(function(e,t){e[t.column]=Math.max(t.bounds.x2-t.x,e[t.column]||0);return e},{});e.forEach(function(e){e.width=t[e.column];e.height=e.bounds.y2-e.y})}function $b(e,t,n,r){var i=r.autosize||{},a=i.type,u=e._width,o=e._height,f=e.padding();if(e._autosize<1||!a)return;var c=Math.max(0,t.width||0),l=Math.max(0,Math.ceil(-n.x1)),s=Math.max(0,Math.ceil(n.x2-c)),d=Math.max(0,t.height||0),h=Math.max(0,Math.ceil(-n.y1)),p=Math.max(0,Math.ceil(n.y2-d));if(i.contains===Is){u-=f.left+f.right;o-=f.top+f.bottom}if(a===Ys){l=0;h=0;c=u;d=o}else if(a===qs){c=Math.max(0,u-l-s);d=Math.max(0,o-h-p)}else if(a===Ws){c=Math.max(0,u-l-s);o=d+h+p}else if(a===Hs){u=c+l+s;d=Math.max(0,o-h-p)}else if(a===Gs){u=c+l+s;o=d+h+p}e._resizeView(u,o,c,d,[l,h],i.resize)}var Vb="log";var Xb="pow";var Zb="utc";var Jb="sqrt";var Qb="band";var Kb="time";var ex="point";var tx="linear";var nx="ordinal";var rx="quantile";var ix="quantize";var ax="threshold";var ux="bin-linear";var ox="bin-ordinal";var fx="sequential";var cx=function(e,t,n){var r=e-t+n*2;return e?r>0?r:1:0};var lx=function(e){return function(t){var n=t[0],r=t[1],i;if(r<n){i=n;n=r;r=i}return[e.invert(n),e.invert(r)]}};var sx=function(e){return function(t){var n=e.range(),r=t[0],i=t[1],a=-1,u,o,f,c;if(i<r){o=r;r=i;i=o}for(f=0,c=n.length;f<c;++f){if(n[f]>=r&&n[f]<=i){if(a<0)a=f;u=f}}if(a<0)return undefined;r=e.invertExtent(n[a]);i=e.invertExtent(n[u]);return[r[0]===undefined?r[1]:r[0],i[1]===undefined?i[0]:i[1]]}};var dx=function(e,t){return e<t?-1:e>t?1:e>=t?0:NaN};var hx=function(e){if(e.length===1)e=px(e);return{left:function(t,n,r,i){if(r==null)r=0;if(i==null)i=t.length;while(r<i){var a=r+i>>>1;if(e(t[a],n)<0)r=a+1;else i=a}return r},right:function(t,n,r,i){if(r==null)r=0;if(i==null)i=t.length;while(r<i){var a=r+i>>>1;if(e(t[a],n)>0)i=a;else r=a+1}return r}}};function px(e){return function(t,n){return dx(e(t),n)}}var vx=hx(dx);var gx=vx.right;var mx=vx.left;var yx=gx;var bx=function(e,t){if(t==null)t=xx;var n=0,r=e.length-1,i=e[0],a=new Array(r<0?0:r);while(n<r)a[n]=t(i,i=e[++n]);return a};function xx(e,t){return[e,t]}var _x=function(e,t,n){var r=e.length,i=t.length,a=new Array(r*i),u,o,f,c;if(n==null)n=xx;for(u=f=0;u<r;++u){for(c=e[u],o=0;o<i;++o,++f){a[f]=n(c,t[o])}}return a};var wx=function(e,t){return t<e?-1:t>e?1:t>=e?0:NaN};var kx=function(e){return e===null?NaN:+e};var Ox=function(e,t){var n=e.length,r=0,i=-1,a=0,u,o,f=0;if(t==null){while(++i<n){if(!isNaN(u=kx(e[i]))){o=u-a;a+=o/++r;f+=o*(u-a)}}}else{while(++i<n){if(!isNaN(u=kx(t(e[i],i,e)))){o=u-a;a+=o/++r;f+=o*(u-a)}}}if(r>1)return f/(r-1)};var Ax=function(e,t){var n=Ox(e,t);return n?Math.sqrt(n):n};var Ex=function(e,t){var n=e.length,r=-1,i,a,u;if(t==null){while(++r<n){if((i=e[r])!=null&&i>=i){a=u=i;while(++r<n){if((i=e[r])!=null){if(a>i)a=i;if(u<i)u=i}}}}}else{while(++r<n){if((i=t(e[r],r,e))!=null&&i>=i){a=u=i;while(++r<n){if((i=t(e[r],r,e))!=null){if(a>i)a=i;if(u<i)u=i}}}}}return[a,u]};var Mx=Array.prototype;var Sx=Mx.slice;var Cx=Mx.map;var Dx=function(e){return function(){return e}};var jx=function(e){return e};var Nx=function(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;var r=-1,i=Math.max(0,Math.ceil((t-e)/n))|0,a=new Array(i);while(++r<i){a[r]=e+r*n}return a};var Fx=Math.sqrt(50),Tx=Math.sqrt(10),zx=Math.sqrt(2);var Rx=function(e,t,n){var r,i=-1,a,u,o;t=+t,e=+e,n=+n;if(e===t&&n>0)return[e];if(r=t<e)a=e,e=t,t=a;if((o=Px(e,t,n))===0||!isFinite(o))return[];if(o>0){e=Math.ceil(e/o);t=Math.floor(t/o);u=new Array(a=Math.ceil(t-e+1));while(++i<a)u[i]=(e+i)*o}else{e=Math.floor(e*o);t=Math.ceil(t*o);u=new Array(a=Math.ceil(e-t+1));while(++i<a)u[i]=(e-i)/o}if(r)u.reverse();return u};function Px(e,t,n){var r=(t-e)/Math.max(0,n),i=Math.floor(Math.log(r)/Math.LN10),a=r/Math.pow(10,i);return i>=0?(a>=Fx?10:a>=Tx?5:a>=zx?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(a>=Fx?10:a>=Tx?5:a>=zx?2:1)}function Lx(e,t,n){var r=Math.abs(t-e)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),a=r/i;if(a>=Fx)i*=10;else if(a>=Tx)i*=5;else if(a>=zx)i*=2;return t<e?-i:i}var Bx=function(e){return Math.ceil(Math.log(e.length)/Math.LN2)+1};var Ix=function(){var e=jx,t=Ex,n=Bx;function r(r){var i,a=r.length,u,o=new Array(a);for(i=0;i<a;++i){o[i]=e(r[i],i,r)}var f=t(o),c=f[0],l=f[1],s=n(o,c,l);if(!Array.isArray(s)){s=Lx(c,l,s);s=Nx(Math.ceil(c/s)*s,l,s)}var d=s.length;while(s[0]<=c)s.shift(),--d;while(s[d-1]>l)s.pop(),--d;var h=new Array(d+1),p;for(i=0;i<=d;++i){p=h[i]=[];p.x0=i>0?s[i-1]:c;p.x1=i<d?s[i]:l}for(i=0;i<a;++i){u=o[i];if(c<=u&&u<=l){h[yx(s,u,0,d)].push(r[i])}}return h}r.value=function(t){return arguments.length?(e=typeof t==="function"?t:Dx(t),r):e};r.domain=function(e){return arguments.length?(t=typeof e==="function"?e:Dx([e[0],e[1]]),r):t};r.thresholds=function(e){return arguments.length?(n=typeof e==="function"?e:Array.isArray(e)?Dx(Sx.call(e)):Dx(e),r):n};return r};var Ux=function(e,t,n){if(n==null)n=kx;if(!(r=e.length))return;if((t=+t)<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,i=(r-1)*t,a=Math.floor(i),u=+n(e[a],a,e),o=+n(e[a+1],a+1,e);return u+(o-u)*(i-a)};var qx=function(e,t,n){e=Cx.call(e,kx).sort(dx);return Math.ceil((n-t)/(2*(Ux(e,.75)-Ux(e,.25))*Math.pow(e.length,-1/3)))};var Wx=function(e,t,n){return Math.ceil((n-t)/(3.5*Ax(e)*Math.pow(e.length,-1/3)))};var Hx=function(e,t){var n=e.length,r=-1,i,a;if(t==null){while(++r<n){if((i=e[r])!=null&&i>=i){a=i;while(++r<n){if((i=e[r])!=null&&i>a){a=i}}}}}else{while(++r<n){if((i=t(e[r],r,e))!=null&&i>=i){a=i;while(++r<n){if((i=t(e[r],r,e))!=null&&i>a){a=i}}}}}return a};var Gx=function(e,t){var n=e.length,r=n,i=-1,a,u=0;if(t==null){while(++i<n){if(!isNaN(a=kx(e[i])))u+=a;else--r}}else{while(++i<n){if(!isNaN(a=kx(t(e[i],i,e))))u+=a;else--r}}if(r)return u/r};var Yx=function(e,t){var n=e.length,r=-1,i,a=[];if(t==null){while(++r<n){if(!isNaN(i=kx(e[r]))){a.push(i)}}}else{while(++r<n){if(!isNaN(i=kx(t(e[r],r,e)))){a.push(i)}}}return Ux(a.sort(dx),.5)};var $x=function(e){var t=e.length,n,r=-1,i=0,a,u;while(++r<t)i+=e[r].length;a=new Array(i);while(--t>=0){u=e[t];n=u.length;while(--n>=0){a[--i]=u[n]}}return a};var Vx=function(e,t){var n=e.length,r=-1,i,a;if(t==null){while(++r<n){if((i=e[r])!=null&&i>=i){a=i;while(++r<n){if((i=e[r])!=null&&a>i){a=i}}}}}else{while(++r<n){if((i=t(e[r],r,e))!=null&&i>=i){a=i;while(++r<n){if((i=t(e[r],r,e))!=null&&a>i){a=i}}}}}return a};var Xx=function(e,t){var n=t.length,r=new Array(n);while(n--)r[n]=e[t[n]];return r};var Zx=function(e,t){if(!(n=e.length))return;var n,r=0,i=0,a,u=e[i];if(t==null)t=dx;while(++r<n){if(t(a=e[r],u)<0||t(u,u)!==0){u=a,i=r}}if(t(u,u)===0)return i};var Jx=function(e,t,n){var r=(n==null?e.length:n)-(t=t==null?0:+t),i,a;while(r){a=Math.random()*r--|0;i=e[r+t];e[r+t]=e[a+t];e[a+t]=i}return e};var Qx=function(e,t){var n=e.length,r=-1,i,a=0;if(t==null){while(++r<n){if(i=+e[r])a+=i}}else{while(++r<n){if(i=+t(e[r],r,e))a+=i}}return a};var Kx=function(e){if(!(a=e.length))return[];for(var t=-1,n=Vx(e,e_),r=new Array(n);++t<n;){for(var i=-1,a,u=r[t]=new Array(a);++i<a;){u[i]=e[i][t]}}return r};function e_(e){return e.length}var t_=function(){return Kx(arguments)};function n_(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function r_(e,t){switch(arguments.length){case 0:break;case 1:this.interpolator(e);break;default:this.interpolator(t).domain(e);break}return this}var i_="$";function a_(){}a_.prototype=u_.prototype={constructor:a_,has:function(e){return i_+e in this},get:function(e){return this[i_+e]},set:function(e,t){this[i_+e]=t;return this},remove:function(e){var t=i_+e;return t in this&&delete this[t]},clear:function(){for(var e in this)if(e[0]===i_)delete this[e]},keys:function(){var e=[];for(var t in this)if(t[0]===i_)e.push(t.slice(1));return e},values:function(){var e=[];for(var t in this)if(t[0]===i_)e.push(this[t]);return e},entries:function(){var e=[];for(var t in this)if(t[0]===i_)e.push({key:t.slice(1),value:this[t]});return e},size:function(){var e=0;for(var t in this)if(t[0]===i_)++e;return e},empty:function(){for(var e in this)if(e[0]===i_)return false;return true},each:function(e){for(var t in this)if(t[0]===i_)e(this[t],t.slice(1),this)}};function u_(e,t){var n=new a_;if(e instanceof a_)e.each(function(e,t){n.set(t,e)});else if(Array.isArray(e)){var r=-1,i=e.length,a;if(t==null)while(++r<i)n.set(r,e[r]);else while(++r<i)n.set(t(a=e[r],r,e),a)}else if(e)for(var u in e)n.set(u,e[u]);return n}var o_=u_;var f_=function(){var e=[],t=[],n,r,i;function a(t,i,u,o){if(i>=e.length){if(n!=null)t.sort(n);return r!=null?r(t):t}var f=-1,c=t.length,l=e[i++],s,d,h=o_(),p,v=u();while(++f<c){if(p=h.get(s=l(d=t[f])+"")){p.push(d)}else{h.set(s,[d])}}h.each(function(e,t){o(v,t,a(e,i,u,o))});return v}function u(n,i){if(++i>e.length)return n;var a,o=t[i-1];if(r!=null&&i>=e.length)a=n.entries();else a=[],n.each(function(e,t){a.push({key:t,values:u(e,i)})});return o!=null?a.sort(function(e,t){return o(e.key,t.key)}):a}return i={object:function(e){return a(e,0,c_,l_)},map:function(e){return a(e,0,s_,d_)},entries:function(e){return u(a(e,0,s_,d_),0)},key:function(t){e.push(t);return i},sortKeys:function(n){t[e.length-1]=n;return i},sortValues:function(e){n=e;return i},rollup:function(e){r=e;return i}}};function c_(){return{}}function l_(e,t,n){e[t]=n}function s_(){return o_()}function d_(e,t,n){e.set(t,n)}function h_(){}var p_=o_.prototype;h_.prototype=v_.prototype={constructor:h_,has:p_.has,add:function(e){e+="";this[i_+e]=e;return this},remove:p_.remove,clear:p_.clear,values:p_.keys,size:p_.size,empty:p_.empty,each:p_.each};function v_(e,t){var n=new h_;if(e instanceof h_)e.each(function(e){n.add(e)});else if(e){var r=-1,i=e.length;if(t==null)while(++r<i)n.add(e[r]);else while(++r<i)n.add(t(e[r],r,e))}return n}var g_=v_;var m_=function(e){var t=[];for(var n in e)t.push(n);return t};var y_=function(e){var t=[];for(var n in e)t.push(e[n]);return t};var b_=function(e){var t=[];for(var n in e)t.push({key:n,value:e[n]});return t};var x_=Array.prototype;var __=x_.map;var w_=x_.slice;var k_={name:"implicit"};function O_(){var e=o_(),t=[],n=[],r=k_;function i(i){var a=i+"",u=e.get(a);if(!u){if(r!==k_)return r;e.set(a,u=t.push(i))}return n[(u-1)%n.length]}i.domain=function(n){if(!arguments.length)return t.slice();t=[],e=o_();var r=-1,a=n.length,u,o;while(++r<a)if(!e.has(o=(u=n[r])+""))e.set(o,t.push(u));return i};i.range=function(e){return arguments.length?(n=w_.call(e),i):n.slice()};i.unknown=function(e){return arguments.length?(r=e,i):r};i.copy=function(){return O_(t,n).unknown(r)};n_.apply(i,arguments);return i}function A_(){var e=O_().unknown(undefined),t=e.domain,n=e.range,r=[0,1],i,a,u=false,o=0,f=0,c=.5;delete e.unknown;function l(){var e=t().length,l=r[1]<r[0],s=r[l-0],d=r[1-l];i=(d-s)/Math.max(1,e-o+f*2);if(u)i=Math.floor(i);s+=(d-s-i*(e-o))*c;a=i*(1-o);if(u)s=Math.round(s),a=Math.round(a);var h=Nx(e).map(function(e){return s+i*e});return n(l?h.reverse():h)}e.domain=function(e){return arguments.length?(t(e),l()):t()};e.range=function(e){return arguments.length?(r=[+e[0],+e[1]],l()):r.slice()};e.rangeRound=function(e){return r=[+e[0],+e[1]],u=true,l()};e.bandwidth=function(){return a};e.step=function(){return i};e.round=function(e){return arguments.length?(u=!!e,l()):u};e.padding=function(e){return arguments.length?(o=Math.min(1,f=+e),l()):o};e.paddingInner=function(e){return arguments.length?(o=Math.min(1,e),l()):o};e.paddingOuter=function(e){return arguments.length?(f=+e,l()):f};e.align=function(e){return arguments.length?(c=Math.max(0,Math.min(1,e)),l()):c};e.copy=function(){return A_(t(),r).round(u).paddingInner(o).paddingOuter(f).align(c)};return n_.apply(l(),arguments)}function E_(e){var t=e.copy;e.padding=e.paddingOuter;delete e.paddingInner;delete e.paddingOuter;e.copy=function(){return E_(t())};return e}function M_(){return E_(A_.apply(null,arguments).paddingInner(1))}var S_=function(e,t,n){e.prototype=t.prototype=n;n.constructor=e};function C_(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function D_(){}var j_=.7;var N_=1/j_;var F_="\\s*([+-]?\\d+)\\s*",T_="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",z_="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",R_=/^#([0-9a-f]{3})$/,P_=/^#([0-9a-f]{6})$/,L_=new RegExp("^rgb\\("+[F_,F_,F_]+"\\)$"),B_=new RegExp("^rgb\\("+[z_,z_,z_]+"\\)$"),I_=new RegExp("^rgba\\("+[F_,F_,F_,T_]+"\\)$"),U_=new RegExp("^rgba\\("+[z_,z_,z_,T_]+"\\)$"),q_=new RegExp("^hsl\\("+[T_,z_,z_]+"\\)$"),W_=new RegExp("^hsla\\("+[T_,z_,z_,T_]+"\\)$");var H_={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};S_(D_,G_,{displayable:function(){return this.rgb().displayable()},hex:function(){return this.rgb().hex()},toString:function(){return this.rgb()+""}});function G_(e){var t;e=(e+"").trim().toLowerCase();return(t=R_.exec(e))?(t=parseInt(t[1],16),new Z_(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1)):(t=P_.exec(e))?Y_(parseInt(t[1],16)):(t=L_.exec(e))?new Z_(t[1],t[2],t[3],1):(t=B_.exec(e))?new Z_(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=I_.exec(e))?$_(t[1],t[2],t[3],t[4]):(t=U_.exec(e))?$_(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=q_.exec(e))?Q_(t[1],t[2]/100,t[3]/100,1):(t=W_.exec(e))?Q_(t[1],t[2]/100,t[3]/100,t[4]):H_.hasOwnProperty(e)?Y_(H_[e]):e==="transparent"?new Z_(NaN,NaN,NaN,0):null}function Y_(e){return new Z_(e>>16&255,e>>8&255,e&255,1)}function $_(e,t,n,r){if(r<=0)e=t=n=NaN;return new Z_(e,t,n,r)}function V_(e){if(!(e instanceof D_))e=G_(e);if(!e)return new Z_;e=e.rgb();return new Z_(e.r,e.g,e.b,e.opacity)}function X_(e,t,n,r){return arguments.length===1?V_(e):new Z_(e,t,n,r==null?1:r)}function Z_(e,t,n,r){this.r=+e;this.g=+t;this.b=+n;this.opacity=+r}S_(Z_,X_,C_(D_,{brighter:function(e){e=e==null?N_:Math.pow(N_,e);return new Z_(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){e=e==null?j_:Math.pow(j_,e);return new Z_(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return 0<=this.r&&this.r<=255&&(0<=this.g&&this.g<=255)&&(0<=this.b&&this.b<=255)&&(0<=this.opacity&&this.opacity<=1)},hex:function(){return"#"+J_(this.r)+J_(this.g)+J_(this.b)},toString:function(){var e=this.opacity;e=isNaN(e)?1:Math.max(0,Math.min(1,e));return(e===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(e===1?")":", "+e+")")}}));function J_(e){e=Math.max(0,Math.min(255,Math.round(e)||0));return(e<16?"0":"")+e.toString(16)}function Q_(e,t,n,r){if(r<=0)e=t=n=NaN;else if(n<=0||n>=1)e=t=NaN;else if(t<=0)e=NaN;return new tw(e,t,n,r)}function K_(e){if(e instanceof tw)return new tw(e.h,e.s,e.l,e.opacity);if(!(e instanceof D_))e=G_(e);if(!e)return new tw;if(e instanceof tw)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),a=Math.max(t,n,r),u=NaN,o=a-i,f=(a+i)/2;if(o){if(t===a)u=(n-r)/o+(n<r)*6;else if(n===a)u=(r-t)/o+2;else u=(t-n)/o+4;o/=f<.5?a+i:2-a-i;u*=60}else{o=f>0&&f<1?0:u}return new tw(u,o,f,e.opacity)}function ew(e,t,n,r){return arguments.length===1?K_(e):new tw(e,t,n,r==null?1:r)}function tw(e,t,n,r){this.h=+e;this.s=+t;this.l=+n;this.opacity=+r}S_(tw,ew,C_(D_,{brighter:function(e){e=e==null?N_:Math.pow(N_,e);return new tw(this.h,this.s,this.l*e,this.opacity)},darker:function(e){e=e==null?j_:Math.pow(j_,e);return new tw(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new Z_(nw(e>=240?e-240:e+120,i,r),nw(e,i,r),nw(e<120?e+240:e-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&(0<=this.l&&this.l<=1)&&(0<=this.opacity&&this.opacity<=1)}}));function nw(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}var rw=Math.PI/180;var iw=180/Math.PI;var aw=18,uw=.96422,ow=1,fw=.82521,cw=4/29,lw=6/29,sw=3*lw*lw,dw=lw*lw*lw;function hw(e){if(e instanceof gw)return new gw(e.l,e.a,e.b,e.opacity);if(e instanceof Ow){if(isNaN(e.h))return new gw(e.l,0,0,e.opacity);var t=e.h*rw;return new gw(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}if(!(e instanceof Z_))e=V_(e);var n=xw(e.r),r=xw(e.g),i=xw(e.b),a=mw((.2225045*n+.7168786*r+.0606169*i)/ow),u,o;if(n===r&&r===i)u=o=a;else{u=mw((.4360747*n+.3850649*r+.1430804*i)/uw);o=mw((.0139322*n+.0971045*r+.7141733*i)/fw)}return new gw(116*a-16,500*(u-a),200*(a-o),e.opacity)}function pw(e,t){return new gw(e,0,0,t==null?1:t)}function vw(e,t,n,r){return arguments.length===1?hw(e):new gw(e,t,n,r==null?1:r)}function gw(e,t,n,r){this.l=+e;this.a=+t;this.b=+n;this.opacity=+r}S_(gw,vw,C_(D_,{brighter:function(e){return new gw(this.l+aw*(e==null?1:e),this.a,this.b,this.opacity)},darker:function(e){return new gw(this.l-aw*(e==null?1:e),this.a,this.b,this.opacity)},rgb:function(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;t=uw*yw(t);e=ow*yw(e);n=fw*yw(n);return new Z_(bw(3.1338561*t-1.6168667*e-.4906146*n),bw(-.9787684*t+1.9161415*e+.033454*n),bw(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}}));function mw(e){return e>dw?Math.pow(e,1/3):e/sw+cw}function yw(e){return e>lw?e*e*e:sw*(e-cw)}function bw(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function xw(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function _w(e){if(e instanceof Ow)return new Ow(e.h,e.c,e.l,e.opacity);if(!(e instanceof gw))e=hw(e);if(e.a===0&&e.b===0)return new Ow(NaN,0,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*iw;return new Ow(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function ww(e,t,n,r){return arguments.length===1?_w(e):new Ow(n,t,e,r==null?1:r)}function kw(e,t,n,r){return arguments.length===1?_w(e):new Ow(e,t,n,r==null?1:r)}function Ow(e,t,n,r){this.h=+e;this.c=+t;this.l=+n;this.opacity=+r}S_(Ow,kw,C_(D_,{brighter:function(e){return new Ow(this.h,this.c,this.l+aw*(e==null?1:e),this.opacity)},darker:function(e){return new Ow(this.h,this.c,this.l-aw*(e==null?1:e),this.opacity)},rgb:function(){return hw(this).rgb()}}));var Aw=-.14861,Ew=+1.78277,Mw=-.29227,Sw=-.90649,Cw=+1.97294,Dw=Cw*Sw,jw=Cw*Ew,Nw=Ew*Mw-Sw*Aw;function Fw(e){if(e instanceof zw)return new zw(e.h,e.s,e.l,e.opacity);if(!(e instanceof Z_))e=V_(e);var t=e.r/255,n=e.g/255,r=e.b/255,i=(Nw*r+Dw*t-jw*n)/(Nw+Dw-jw),a=r-i,u=(Cw*(n-i)-Mw*a)/Sw,o=Math.sqrt(u*u+a*a)/(Cw*i*(1-i)),f=o?Math.atan2(u,a)*iw-120:NaN;return new zw(f<0?f+360:f,o,i,e.opacity)}function Tw(e,t,n,r){return arguments.length===1?Fw(e):new zw(e,t,n,r==null?1:r)}function zw(e,t,n,r){this.h=+e;this.s=+t;this.l=+n;this.opacity=+r}S_(zw,Tw,C_(D_,{brighter:function(e){e=e==null?N_:Math.pow(N_,e);return new zw(this.h,this.s,this.l*e,this.opacity)},darker:function(e){e=e==null?j_:Math.pow(j_,e);return new zw(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=isNaN(this.h)?0:(this.h+120)*rw,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),r=Math.cos(e),i=Math.sin(e);return new Z_(255*(t+n*(Aw*r+Ew*i)),255*(t+n*(Mw*r+Sw*i)),255*(t+n*(Cw*r)),this.opacity)}}));function Rw(e,t,n,r,i){var a=e*e,u=a*e;return((1-3*e+3*a-u)*t+(4-6*a+3*u)*n+(1+3*e+3*a-3*u)*r+u*i)/6}var Pw=function(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),i=e[r],a=e[r+1],u=r>0?e[r-1]:2*i-a,o=r<t-1?e[r+2]:2*a-i;return Rw((n-r/t)*t,u,i,a,o)}};var Lw=function(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),i=e[(r+t-1)%t],a=e[r%t],u=e[(r+1)%t],o=e[(r+2)%t];return Rw((n-r/t)*t,i,a,u,o)}};var Bw=function(e){return function(){return e}};function Iw(e,t){return function(n){return e+n*t}}function Uw(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function qw(e,t){var n=t-e;return n?Iw(e,n>180||n<-180?n-360*Math.round(n/360):n):Bw(isNaN(e)?t:e)}function Ww(e){return(e=+e)===1?Hw:function(t,n){return n-t?Uw(t,n,e):Bw(isNaN(t)?n:t)}}function Hw(e,t){var n=t-e;return n?Iw(e,n):Bw(isNaN(e)?t:e)}var Gw=function e(t){var n=Ww(t);function r(e,t){var r=n((e=X_(e)).r,(t=X_(t)).r),i=n(e.g,t.g),a=n(e.b,t.b),u=Hw(e.opacity,t.opacity);return function(t){e.r=r(t);e.g=i(t);e.b=a(t);e.opacity=u(t);return e+""}}r.gamma=e;return r}(1);function Yw(e){return function(t){var n=t.length,r=new Array(n),i=new Array(n),a=new Array(n),u,o;for(u=0;u<n;++u){o=X_(t[u]);r[u]=o.r||0;i[u]=o.g||0;a[u]=o.b||0}r=e(r);i=e(i);a=e(a);o.opacity=1;return function(e){o.r=r(e);o.g=i(e);o.b=a(e);return o+""}}}var $w=Yw(Pw);var Vw=Yw(Lw);var Xw=function(e,t){var n=t?t.length:0,r=e?Math.min(n,e.length):0,i=new Array(r),a=new Array(n),u;for(u=0;u<r;++u)i[u]=ik(e[u],t[u]);for(;u<n;++u)a[u]=t[u];return function(e){for(u=0;u<r;++u)a[u]=i[u](e);return a}};var Zw=function(e,t){var n=new Date;return e=+e,t-=e,function(r){return n.setTime(e+t*r),n}};var Jw=function(e,t){return e=+e,t-=e,function(n){return e+t*n}};var Qw=function(e,t){var n={},r={},i;if(e===null||typeof e!=="object")e={};if(t===null||typeof t!=="object")t={};for(i in t){if(i in e){n[i]=ik(e[i],t[i])}else{r[i]=t[i]}}return function(e){for(i in n)r[i]=n[i](e);return r}};var Kw=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,ek=new RegExp(Kw.source,"g");function tk(e){return function(){return e}}function nk(e){return function(t){return e(t)+""}}var rk=function(e,t){var n=Kw.lastIndex=ek.lastIndex=0,r,i,a,u=-1,o=[],f=[];e=e+"",t=t+"";while((r=Kw.exec(e))&&(i=ek.exec(t))){if((a=i.index)>n){a=t.slice(n,a);if(o[u])o[u]+=a;else o[++u]=a}if((r=r[0])===(i=i[0])){if(o[u])o[u]+=i;else o[++u]=i}else{o[++u]=null;f.push({i:u,x:Jw(r,i)})}n=ek.lastIndex}if(n<t.length){a=t.slice(n);if(o[u])o[u]+=a;else o[++u]=a}return o.length<2?f[0]?nk(f[0].x):tk(t):(t=f.length,function(e){for(var n=0,r;n<t;++n)o[(r=f[n]).i]=r.x(e);return o.join("")})};var ik=function(e,t){var n=typeof t,r;return t==null||n==="boolean"?Bw(t):(n==="number"?Jw:n==="string"?(r=G_(t))?(t=r,Gw):rk:t instanceof G_?Gw:t instanceof Date?Zw:Array.isArray(t)?Xw:typeof t.valueOf!=="function"&&typeof t.toString!=="function"||isNaN(t)?Qw:Jw)(e,t)};var ak=function(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}};var uk=function(e,t){var n=qw(+e,+t);return function(e){var t=n(e);return t-360*Math.floor(t/360)}};var ok=function(e,t){return e=+e,t-=e,function(n){return Math.round(e+t*n)}};var fk=180/Math.PI;var ck={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};var lk=function(e,t,n,r,i,a){var u,o,f;if(u=Math.sqrt(e*e+t*t))e/=u,t/=u;if(f=e*n+t*r)n-=e*f,r-=t*f;if(o=Math.sqrt(n*n+r*r))n/=o,r/=o,f/=o;if(e*r<t*n)e=-e,t=-t,f=-f,u=-u;return{translateX:i,translateY:a,rotate:Math.atan2(t,e)*fk,skewX:Math.atan(f)*fk,scaleX:u,scaleY:o}};var sk,dk,hk,pk;function vk(e){if(e==="none")return ck;if(!sk)sk=document.createElement("DIV"),dk=document.documentElement,hk=document.defaultView;sk.style.transform=e;e=hk.getComputedStyle(dk.appendChild(sk),null).getPropertyValue("transform");dk.removeChild(sk);e=e.slice(7,-1).split(",");return lk(+e[0],+e[1],+e[2],+e[3],+e[4],+e[5])}function gk(e){if(e==null)return ck;if(!pk)pk=document.createElementNS("http://www.w3.org/2000/svg","g");pk.setAttribute("transform",e);if(!(e=pk.transform.baseVal.consolidate()))return ck;e=e.matrix;return lk(e.a,e.b,e.c,e.d,e.e,e.f)}function mk(e,t,n,r){function i(e){return e.length?e.pop()+" ":""}function a(e,r,i,a,u,o){if(e!==i||r!==a){var f=u.push("translate(",null,t,null,n);o.push({i:f-4,x:Jw(e,i)},{i:f-2,x:Jw(r,a)})}else if(i||a){u.push("translate("+i+t+a+n)}}function u(e,t,n,a){if(e!==t){if(e-t>180)t+=360;else if(t-e>180)e+=360;a.push({i:n.push(i(n)+"rotate(",null,r)-2,x:Jw(e,t)})}else if(t){n.push(i(n)+"rotate("+t+r)}}function o(e,t,n,a){if(e!==t){a.push({i:n.push(i(n)+"skewX(",null,r)-2,x:Jw(e,t)})}else if(t){n.push(i(n)+"skewX("+t+r)}}function f(e,t,n,r,a,u){if(e!==n||t!==r){var o=a.push(i(a)+"scale(",null,",",null,")");u.push({i:o-4,x:Jw(e,n)},{i:o-2,x:Jw(t,r)})}else if(n!==1||r!==1){a.push(i(a)+"scale("+n+","+r+")")}}return function(t,n){var r=[],i=[];t=e(t),n=e(n);a(t.translateX,t.translateY,n.translateX,n.translateY,r,i);u(t.rotate,n.rotate,r,i);o(t.skewX,n.skewX,r,i);f(t.scaleX,t.scaleY,n.scaleX,n.scaleY,r,i);t=n=null;return function(e){var t=-1,n=i.length,a;while(++t<n)r[(a=i[t]).i]=a.x(e);return r.join("")}}}var yk=mk(vk,"px, ","px)","deg)");var bk=mk(gk,", ",")",")");var xk=Math.SQRT2,_k=2,wk=4,kk=1e-12;function Ok(e){return((e=Math.exp(e))+1/e)/2}function Ak(e){return((e=Math.exp(e))-1/e)/2}function Ek(e){return((e=Math.exp(2*e))-1)/(e+1)}var Mk=function(e,t){var n=e[0],r=e[1],i=e[2],a=t[0],u=t[1],o=t[2],f=a-n,c=u-r,l=f*f+c*c,s,d;if(l<kk){d=Math.log(o/i)/xk;s=function(e){return[n+e*f,r+e*c,i*Math.exp(xk*e*d)]}}else{var h=Math.sqrt(l),p=(o*o-i*i+wk*l)/(2*i*_k*h),v=(o*o-i*i-wk*l)/(2*o*_k*h),g=Math.log(Math.sqrt(p*p+1)-p),m=Math.log(Math.sqrt(v*v+1)-v);d=(m-g)/xk;s=function(e){var t=e*d,a=Ok(g),u=i/(_k*h)*(a*Ek(xk*t+g)-Ak(g));return[n+u*f,r+u*c,i*a/Ok(xk*t+g)]}}s.duration=d*1e3;return s};function Sk(e){return function(t,n){var r=e((t=ew(t)).h,(n=ew(n)).h),i=Hw(t.s,n.s),a=Hw(t.l,n.l),u=Hw(t.opacity,n.opacity);return function(e){t.h=r(e);t.s=i(e);t.l=a(e);t.opacity=u(e);return t+""}}}var Ck=Sk(qw);var Dk=Sk(Hw);function jk(e,t){var n=Hw((e=vw(e)).l,(t=vw(t)).l),r=Hw(e.a,t.a),i=Hw(e.b,t.b),a=Hw(e.opacity,t.opacity);return function(t){e.l=n(t);e.a=r(t);e.b=i(t);e.opacity=a(t);return e+""}}function Nk(e){return function(t,n){var r=e((t=kw(t)).h,(n=kw(n)).h),i=Hw(t.c,n.c),a=Hw(t.l,n.l),u=Hw(t.opacity,n.opacity);return function(e){t.h=r(e);t.c=i(e);t.l=a(e);t.opacity=u(e);return t+""}}}var Fk=Nk(qw);var Tk=Nk(Hw);function zk(e){return function t(n){n=+n;function r(t,r){var i=e((t=Tw(t)).h,(r=Tw(r)).h),a=Hw(t.s,r.s),u=Hw(t.l,r.l),o=Hw(t.opacity,r.opacity);return function(e){t.h=i(e);t.s=a(e);t.l=u(Math.pow(e,n));t.opacity=o(e);return t+""}}r.gamma=t;return r}(1)}var Rk=zk(qw);var Pk=zk(Hw);function Lk(e,t){var n=0,r=t.length-1,i=t[0],a=new Array(r<0?0:r);while(n<r)a[n]=e(i,i=t[++n]);return function(e){var t=Math.max(0,Math.min(r-1,Math.floor(e*=r)));return a[t](e-t)}}var Bk=function(e,t){var n=new Array(t);for(var r=0;r<t;++r)n[r]=e(r/(t-1));return n};var Ik=function(e){return function(){return e}};var Uk=function(e){return+e};var qk=[0,1];function Wk(e){return e}function Hk(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:Ik(isNaN(t)?NaN:.5)}function Gk(e){var t=e[0],n=e[e.length-1],r;if(t>n)r=t,t=n,n=r;return function(e){return Math.max(t,Math.min(n,e))}}function Yk(e,t,n){var r=e[0],i=e[1],a=t[0],u=t[1];if(i<r)r=Hk(i,r),a=n(u,a);else r=Hk(r,i),a=n(a,u);return function(e){return a(r(e))}}function $k(e,t,n){var r=Math.min(e.length,t.length)-1,i=new Array(r),a=new Array(r),u=-1;if(e[r]<e[0]){e=e.slice().reverse();t=t.slice().reverse()}while(++u<r){i[u]=Hk(e[u],e[u+1]);a[u]=n(t[u],t[u+1])}return function(t){var n=yx(e,t,1,r)-1;return a[n](i[n](t))}}function Vk(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function Xk(){var e=qk,t=qk,n=ik,r,i,a,u=Wk,o,f,c;function l(){o=Math.min(e.length,t.length)>2?$k:Yk;f=c=null;return s}function s(i){return isNaN(i=+i)?a:(f||(f=o(e.map(r),t,n)))(r(u(i)))}s.invert=function(n){return u(i((c||(c=o(t,e.map(r),Jw)))(n)))};s.domain=function(t){return arguments.length?(e=__.call(t,Uk),u===Wk||(u=Gk(e)),l()):e.slice()};s.range=function(e){return arguments.length?(t=w_.call(e),l()):t.slice()};s.rangeRound=function(e){return t=w_.call(e),n=ok,l()};s.clamp=function(t){return arguments.length?(u=t?Gk(e):Wk,s):u!==Wk};s.interpolate=function(e){return arguments.length?(n=e,l()):n};s.unknown=function(e){return arguments.length?(a=e,s):a};return function(e,t){r=e,i=t;return l()}}function Zk(e,t){return Xk()(e,t)}var Jk=function(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]};var Qk=function(e){return e=Jk(Math.abs(e)),e?e[1]:NaN};var Kk=function(e,t){return function(n,r){var i=n.length,a=[],u=0,o=e[0],f=0;while(i>0&&o>0){if(f+o+1>r)o=Math.max(1,r-f);a.push(n.substring(i-=o,i+o));if((f+=o+1)>r)break;o=e[u=(u+1)%e.length]}return a.reverse().join(t)}};var eO=function(e){return function(t){return t.replace(/[0-9]/g,function(t){return e[+t]})}};var tO=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function nO(e){return new rO(e)}nO.prototype=rO.prototype;function rO(e){if(!(t=tO.exec(e)))throw new Error("invalid format: "+e);var t;this.fill=t[1]||" ";this.align=t[2]||">";this.sign=t[3]||"-";this.symbol=t[4]||"";this.zero=!!t[5];this.width=t[6]&&+t[6];this.comma=!!t[7];this.precision=t[8]&&+t[8].slice(1);this.trim=!!t[9];this.type=t[10]||""}rO.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width==null?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision==null?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};var iO=function(e){e:for(var t=e.length,n=1,r=-1,i;n<t;++n){switch(e[n]){case".":r=i=n;break;case"0":if(r===0)r=n;i=n;break;default:if(r>0){if(!+e[n])break e;r=0}break}}return r>0?e.slice(0,r)+e.slice(i+1):e};var aO;var uO=function(e,t){var n=Jk(e,t);if(!n)return e+"";var r=n[0],i=n[1],a=i-(aO=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,u=r.length;return a===u?r:a>u?r+new Array(a-u+1).join("0"):a>0?r.slice(0,a)+"."+r.slice(a):"0."+new Array(1-a).join("0")+Jk(e,Math.max(0,t+a-1))[0]};var oO=function(e,t){var n=Jk(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")};var fO={"%":function(e,t){return(e*100).toFixed(t)},b:function(e){return Math.round(e).toString(2)},c:function(e){return e+""},d:function(e){return Math.round(e).toString(10)},e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},g:function(e,t){return e.toPrecision(t)},o:function(e){return Math.round(e).toString(8)},p:function(e,t){return oO(e*100,t)},r:oO,s:uO,X:function(e){return Math.round(e).toString(16).toUpperCase()},x:function(e){return Math.round(e).toString(16)}};var cO=function(e){return e};var lO=["y","z","a","f","p","n","Âµ","m","","k","M","G","T","P","E","Z","Y"];var sO=function(e){var t=e.grouping&&e.thousands?Kk(e.grouping,e.thousands):cO,n=e.currency,r=e.decimal,i=e.numerals?eO(e.numerals):cO,a=e.percent||"%";function u(e){e=nO(e);var u=e.fill,o=e.align,f=e.sign,c=e.symbol,l=e.zero,s=e.width,d=e.comma,h=e.precision,p=e.trim,v=e.type;if(v==="n")d=true,v="g";else if(!fO[v])h==null&&(h=12),p=true,v="g";if(l||u==="0"&&o==="=")l=true,u="0",o="=";var g=c==="$"?n[0]:c==="#"&&/[boxX]/.test(v)?"0"+v.toLowerCase():"",m=c==="$"?n[1]:/[%p]/.test(v)?a:"";var y=fO[v],b=/[defgprs%]/.test(v);h=h==null?6:/[gprs]/.test(v)?Math.max(1,Math.min(21,h)):Math.max(0,Math.min(20,h));function x(e){var n=g,a=m,c,x,_;if(v==="c"){a=y(e)+a;e=""}else{e=+e;var w=e<0;e=y(Math.abs(e),h);if(p)e=iO(e);if(w&&+e===0)w=false;n=(w?f==="("?f:"-":f==="-"||f==="("?"":f)+n;a=(v==="s"?lO[8+aO/3]:"")+a+(w&&f==="("?")":"");if(b){c=-1,x=e.length;while(++c<x){if(_=e.charCodeAt(c),48>_||_>57){a=(_===46?r+e.slice(c+1):e.slice(c))+a;e=e.slice(0,c);break}}}}if(d&&!l)e=t(e,Infinity);var k=n.length+e.length+a.length,O=k<s?new Array(s-k+1).join(u):"";if(d&&l)e=t(O+e,O.length?s-a.length:Infinity),O="";switch(o){case"<":e=n+e+a+O;break;case"=":e=n+O+e+a;break;case"^":e=O.slice(0,k=O.length>>1)+n+e+a+O.slice(k);break;default:e=O+n+e+a;break}return i(e)}x.toString=function(){return e+""};return x}function o(e,t){var n=u((e=nO(e),e.type="f",e)),r=Math.max(-8,Math.min(8,Math.floor(Qk(t)/3)))*3,i=Math.pow(10,-r),a=lO[8+r/3];return function(e){return n(i*e)+a}}return{format:u,formatPrefix:o}};var dO;var hO;var pO;vO({decimal:".",thousands:",",grouping:[3],currency:["$",""]});function vO(e){dO=sO(e);hO=dO.format;pO=dO.formatPrefix;return dO}var gO=function(e){return Math.max(0,-Qk(Math.abs(e)))};var mO=function(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Qk(t)/3)))*3-Qk(Math.abs(e)))};var yO=function(e,t){e=Math.abs(e),t=Math.abs(t)-e;return Math.max(0,Qk(t)-Qk(e))+1};var bO=function(e,t,n,r){var i=Lx(e,t,n),a;r=nO(r==null?",f":r);switch(r.type){case"s":{var u=Math.max(Math.abs(e),Math.abs(t));if(r.precision==null&&!isNaN(a=mO(i,u)))r.precision=a;return pO(r,u)}case"":case"e":case"g":case"p":case"r":{if(r.precision==null&&!isNaN(a=yO(i,Math.max(Math.abs(e),Math.abs(t)))))r.precision=a-(r.type==="e");break}case"f":case"%":{if(r.precision==null&&!isNaN(a=gO(i)))r.precision=a-(r.type==="%")*2;break}}return hO(r)};function xO(e){var t=e.domain;e.ticks=function(e){var n=t();return Rx(n[0],n[n.length-1],e==null?10:e)};e.tickFormat=function(e,n){var r=t();return bO(r[0],r[r.length-1],e==null?10:e,n)};e.nice=function(n){if(n==null)n=10;var r=t(),i=0,a=r.length-1,u=r[i],o=r[a],f;if(o<u){f=u,u=o,o=f;f=i,i=a,a=f}f=Px(u,o,n);if(f>0){u=Math.floor(u/f)*f;o=Math.ceil(o/f)*f;f=Px(u,o,n)}else if(f<0){u=Math.ceil(u*f)/f;o=Math.floor(o*f)/f;f=Px(u,o,n)}if(f>0){r[i]=Math.floor(u/f)*f;r[a]=Math.ceil(o/f)*f;t(r)}else if(f<0){r[i]=Math.ceil(u*f)/f;r[a]=Math.floor(o*f)/f;t(r)}return e};return e}function _O(){var e=Zk(Wk,Wk);e.copy=function(){return Vk(e,_O())};n_.apply(e,arguments);return xO(e)}function wO(e){var t;function n(e){return isNaN(e=+e)?t:e}n.invert=n;n.domain=n.range=function(t){return arguments.length?(e=__.call(t,Uk),n):e.slice()};n.unknown=function(e){return arguments.length?(t=e,n):t};n.copy=function(){return wO(e).unknown(t)};e=arguments.length?__.call(e,Uk):[0,1];return xO(n)}var kO=function(e,t){e=e.slice();var n=0,r=e.length-1,i=e[n],a=e[r],u;if(a<i){u=n,n=r,r=u;u=i,i=a,a=u}e[n]=t.floor(i);e[r]=t.ceil(a);return e};function OO(e){return Math.log(e)}function AO(e){return Math.exp(e)}function EO(e){return-Math.log(-e)}function MO(e){return-Math.exp(-e)}function SO(e){return isFinite(e)?+("1e"+e):e<0?0:e}function CO(e){return e===10?SO:e===Math.E?Math.exp:function(t){return Math.pow(e,t)}}function DO(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),function(t){return Math.log(t)/e})}function jO(e){return function(t){return-e(-t)}}function NO(e){var t=e(OO,AO),n=t.domain,r=10,i,a;function u(){i=DO(r),a=CO(r);if(n()[0]<0){i=jO(i),a=jO(a);e(EO,MO)}else{e(OO,AO)}return t}t.base=function(e){return arguments.length?(r=+e,u()):r};t.domain=function(e){return arguments.length?(n(e),u()):n()};t.ticks=function(e){var t=n(),u=t[0],o=t[t.length-1],f;if(f=o<u)c=u,u=o,o=c;var c=i(u),l=i(o),s,d,h,p=e==null?10:+e,v=[];if(!(r%1)&&l-c<p){c=Math.round(c)-1,l=Math.round(l)+1;if(u>0)for(;c<l;++c){for(d=1,s=a(c);d<r;++d){h=s*d;if(h<u)continue;if(h>o)break;v.push(h)}}else for(;c<l;++c){for(d=r-1,s=a(c);d>=1;--d){h=s*d;if(h<u)continue;if(h>o)break;v.push(h)}}}else{v=Rx(c,l,Math.min(l-c,p)).map(a)}return f?v.reverse():v};t.tickFormat=function(e,n){if(n==null)n=r===10?".0e":",";if(typeof n!=="function")n=hO(n);if(e===Infinity)return n;if(e==null)e=10;var u=Math.max(1,r*e/t.ticks().length);return function(e){var t=e/a(Math.round(i(e)));if(t*r<r-.5)t*=r;return t<=u?n(e):""}};t.nice=function(){return n(kO(n(),{floor:function(e){return a(Math.floor(i(e)))},ceil:function(e){return a(Math.ceil(i(e)))}}))};return t}function FO(){var e=NO(Xk()).domain([1,10]);e.copy=function(){return Vk(e,FO()).base(e.base())};n_.apply(e,arguments);return e}function TO(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function zO(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function RO(e){var t=1,n=e(TO(t),zO(t));n.constant=function(n){return arguments.length?e(TO(t=+n),zO(t)):t};return xO(n)}function PO(){var e=RO(Xk());e.copy=function(){return Vk(e,PO()).constant(e.constant())};return n_.apply(e,arguments)}function LO(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function BO(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function IO(e){return e<0?-e*e:e*e}function UO(e){var t=e(Wk,Wk),n=1;function r(){return n===1?e(Wk,Wk):n===.5?e(BO,IO):e(LO(n),LO(1/n))}t.exponent=function(e){return arguments.length?(n=+e,r()):n};return xO(t)}function qO(){var e=UO(Xk());e.copy=function(){return Vk(e,qO()).exponent(e.exponent())};n_.apply(e,arguments);return e}function WO(){return qO.apply(null,arguments).exponent(.5)}function HO(){var e=[],t=[],n=[],r;function i(){var r=0,i=Math.max(1,t.length);n=new Array(i-1);while(++r<i)n[r-1]=Ux(e,r/i);return a}function a(e){return isNaN(e=+e)?r:t[yx(n,e)]}a.invertExtent=function(r){var i=t.indexOf(r);return i<0?[NaN,NaN]:[i>0?n[i-1]:e[0],i<n.length?n[i]:e[e.length-1]]};a.domain=function(t){if(!arguments.length)return e.slice();e=[];for(var n=0,r=t.length,a;n<r;++n)if(a=t[n],a!=null&&!isNaN(a=+a))e.push(a);e.sort(dx);return i()};a.range=function(e){return arguments.length?(t=w_.call(e),i()):t.slice()};a.unknown=function(e){return arguments.length?(r=e,a):r};a.quantiles=function(){return n.slice()};a.copy=function(){return HO().domain(e).range(t).unknown(r)};return n_.apply(a,arguments)}function GO(){var e=0,t=1,n=1,r=[.5],i=[0,1],a;function u(e){return e<=e?i[yx(r,e,0,n)]:a}function o(){var i=-1;r=new Array(n);while(++i<n)r[i]=((i+1)*t-(i-n)*e)/(n+1);return u}u.domain=function(n){return arguments.length?(e=+n[0],t=+n[1],o()):[e,t]};u.range=function(e){return arguments.length?(n=(i=w_.call(e)).length-1,o()):i.slice()};u.invertExtent=function(a){var u=i.indexOf(a);return u<0?[NaN,NaN]:u<1?[e,r[0]]:u>=n?[r[n-1],t]:[r[u-1],r[u]]};u.unknown=function(e){return arguments.length?(a=e,u):u};u.thresholds=function(){return r.slice()};u.copy=function(){return GO().domain([e,t]).range(i).unknown(a)};return n_.apply(xO(u),arguments)}function YO(){var e=[.5],t=[0,1],n,r=1;function i(i){return i<=i?t[yx(e,i,0,r)]:n}i.domain=function(n){return arguments.length?(e=w_.call(n),r=Math.min(e.length,t.length-1),i):e.slice()};i.range=function(n){return arguments.length?(t=w_.call(n),r=Math.min(e.length,t.length-1),i):t.slice()};i.invertExtent=function(n){var r=t.indexOf(n);return[e[r-1],e[r]]};i.unknown=function(e){return arguments.length?(n=e,i):n};i.copy=function(){return YO().domain(e).range(t).unknown(n)};return n_.apply(i,arguments)}var $O=1e3,VO=$O*60,XO=VO*60,ZO=XO*24,JO=ZO*7,QO=ZO*30,KO=ZO*365;function eA(e){return new Date(e)}function tA(e){return e instanceof Date?+e:+new Date(+e)}function nA(e,t,n,r,i,a,u,o,f){var c=Zk(Wk,Wk),l=c.invert,s=c.domain;var d=f(".%L"),h=f(":%S"),p=f("%I:%M"),v=f("%I %p"),g=f("%a %d"),m=f("%b %d"),y=f("%B"),b=f("%Y");var x=[[u,1,$O],[u,5,5*$O],[u,15,15*$O],[u,30,30*$O],[a,1,VO],[a,5,5*VO],[a,15,15*VO],[a,30,30*VO],[i,1,XO],[i,3,3*XO],[i,6,6*XO],[i,12,12*XO],[r,1,ZO],[r,2,2*ZO],[n,1,JO],[t,1,QO],[t,3,3*QO],[e,1,KO]];function _(o){return(u(o)<o?d:a(o)<o?h:i(o)<o?p:r(o)<o?v:t(o)<o?n(o)<o?g:m:e(o)<o?y:b)(o)}function w(t,n,r,i){if(t==null)t=10;if(typeof t==="number"){var a=Math.abs(r-n)/t,u=hx(function(e){return e[2]}).right(x,a);if(u===x.length){i=Lx(n/KO,r/KO,t);t=e}else if(u){u=x[a/x[u-1][2]<x[u][2]/a?u-1:u];i=u[1];t=u[0]}else{i=Math.max(Lx(n,r,t),1);t=o}}return i==null?t:t.every(i)}c.invert=function(e){return new Date(l(e))};c.domain=function(e){return arguments.length?s(__.call(e,tA)):s().map(eA)};c.ticks=function(e,t){var n=s(),r=n[0],i=n[n.length-1],a=i<r,u;if(a)u=r,r=i,i=u;u=w(e,r,i,t);u=u?u.range(r,i+1):[];return a?u.reverse():u};c.tickFormat=function(e,t){return t==null?_:f(t)};c.nice=function(e,t){var n=s();return(e=w(e,n[0],n[n.length-1],t))?s(kO(n,e)):c};c.copy=function(){return Vk(c,nA(e,t,n,r,i,a,u,o,f))};return c}var rA=function(){return n_.apply(nA($i,Hi,Ci,Ei,ki,xi,mi,ci,Iu).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)};var iA=function(){return n_.apply(nA(ka,xa,aa,na,Ki,Zi,mi,ci,qu).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)};function aA(){var e=0,t=1,n,r,i,a,u=Wk,o=false,f;function c(e){return isNaN(e=+e)?f:u(i===0?.5:(e=(a(e)-n)*i,o?Math.max(0,Math.min(1,e)):e))}c.domain=function(u){return arguments.length?(n=a(e=+u[0]),r=a(t=+u[1]),i=n===r?0:1/(r-n),c):[e,t]};c.clamp=function(e){return arguments.length?(o=!!e,c):o};c.interpolator=function(e){return arguments.length?(u=e,c):u};c.unknown=function(e){return arguments.length?(f=e,c):f};return function(u){a=u,n=u(e),r=u(t),i=n===r?0:1/(r-n);return c}}function uA(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function oA(){var e=xO(aA()(Wk));e.copy=function(){return uA(e,oA())};return r_.apply(e,arguments)}function fA(){var e=NO(aA()).domain([1,10]);e.copy=function(){return uA(e,fA()).base(e.base())};return r_.apply(e,arguments)}function cA(){var e=RO(aA());e.copy=function(){return uA(e,cA()).constant(e.constant())};return r_.apply(e,arguments)}function lA(){var e=UO(aA());e.copy=function(){return uA(e,lA()).exponent(e.exponent())};return r_.apply(e,arguments)}function sA(){return lA.apply(null,arguments).exponent(.5)}function dA(){var e=[],t=Wk;function n(n){if(!isNaN(n=+n))return t((yx(e,n)-1)/(e.length-1))}n.domain=function(t){if(!arguments.length)return e.slice();e=[];for(var r=0,i=t.length,a;r<i;++r)if(a=t[r],a!=null&&!isNaN(a=+a))e.push(a);e.sort(dx);return n};n.interpolator=function(e){return arguments.length?(t=e,n):t};n.copy=function(){return dA(t).domain(e)};return r_.apply(n,arguments)}function hA(){var e=0,t=.5,n=1,r,i,a,u,o,f=Wk,c,l=false,s;function d(e){return isNaN(e=+e)?s:(e=.5+((e=+c(e))-i)*(e<i?u:o),f(l?Math.max(0,Math.min(1,e)):e))}d.domain=function(f){return arguments.length?(r=c(e=+f[0]),i=c(t=+f[1]),a=c(n=+f[2]),u=r===i?0:.5/(i-r),o=i===a?0:.5/(a-i),d):[e,t,n]};d.clamp=function(e){return arguments.length?(l=!!e,d):l};d.interpolator=function(e){return arguments.length?(f=e,d):f};d.unknown=function(e){return arguments.length?(s=e,d):s};return function(f){c=f,r=f(e),i=f(t),a=f(n),u=r===i?0:.5/(i-r),o=i===a?0:.5/(a-i);return d}}function pA(){var e=xO(hA()(Wk));e.copy=function(){return uA(e,pA())};return r_.apply(e,arguments)}function vA(){var e=NO(hA()).domain([.1,1,10]);e.copy=function(){return uA(e,vA()).base(e.base())};return r_.apply(e,arguments)}function gA(){var e=RO(hA());e.copy=function(){return uA(e,gA()).constant(e.constant())};return r_.apply(e,arguments)}function mA(){var e=UO(hA());e.copy=function(){return uA(e,mA()).exponent(e.exponent())};return r_.apply(e,arguments)}function yA(){return mA.apply(null,arguments).exponent(.5)}function bA(){var e=O_().unknown(undefined),t=e.domain,n=e.range,r=[0,1],i,a,u=false,o=0,f=0,c=.5;delete e.unknown;function l(){var e=t().length,l=r[1]<r[0],s=r[l-0],d=r[1-l],h=cx(e,o,f);i=(d-s)/(h||1);if(u){i=Math.floor(i)}s+=(d-s-i*(e-o))*c;a=i*(1-o);if(u){s=Math.round(s);a=Math.round(a)}var p=Rf(e).map(function(e){return s+i*e});return n(l?p.reverse():p)}e.domain=function(e){if(arguments.length){t(e);return l()}else{return t()}};e.range=function(e){if(arguments.length){r=[+e[0],+e[1]];return l()}else{return r.slice()}};e.rangeRound=function(e){r=[+e[0],+e[1]];u=true;return l()};e.bandwidth=function(){return a};e.step=function(){return i};e.round=function(e){if(arguments.length){u=!!e;return l()}else{return u}};e.padding=function(e){if(arguments.length){f=Math.max(0,Math.min(1,e));o=f;return l()}else{return o}};e.paddingInner=function(e){if(arguments.length){o=Math.max(0,Math.min(1,e));return l()}else{return o}};e.paddingOuter=function(e){if(arguments.length){f=Math.max(0,Math.min(1,e));return l()}else{return f}};e.align=function(e){if(arguments.length){c=Math.max(0,Math.min(1,e));return l()}else{return c}};e.invertRange=function(e){if(e[0]==null||e[1]==null)return;var i=+e[0],u=+e[1],o=r[1]<r[0],f=o?n().reverse():n(),c=f.length-1,l,s,d;if(i!==i||u!==u)return;if(u<i){d=i;i=u;u=d}if(u<f[0]||i>r[1-o])return;l=Math.max(0,gf(f,i)-1);s=i===u?l:gf(f,u)-1;if(i-f[l]>a+1e-10)++l;if(o){d=l;l=c-s;s=c-d}return l>s?undefined:t().slice(l,s+1)};e.invert=function(t){var n=e.invertRange([t,t]);return n?n[0]:n};e.copy=function(){return bA().domain(t()).range(r).round(u).paddingInner(o).paddingOuter(f).align(c)};return l()}function xA(e){var t=e.copy;e.padding=e.paddingOuter;delete e.paddingInner;e.copy=function(){return xA(t())};return e}function _A(){return xA(bA().paddingInner(1))}var wA=Array.prototype.map,kA=Array.prototype.slice;function OA(e){return wA.call(e,function(e){return+e})}function AA(){var e=_O(),t=[];function n(t){return e(t)}function r(n){t=OA(n);e.domain([t[0],Object(dn["R"])(t)])}n.domain=function(e){return arguments.length?(r(e),n):t.slice()};n.range=function(t){return arguments.length?(e.range(t),n):e.range()};n.rangeRound=function(t){return arguments.length?(e.rangeRound(t),n):e.rangeRound()};n.interpolate=function(t){return arguments.length?(e.interpolate(t),n):e.interpolate()};n.invert=function(t){return e.invert(t)};n.ticks=function(e){var r=t.length,i=~~(r/(e||r));return i<2?n.domain():t.filter(function(e,t){return!(t%i)})};n.tickFormat=function(){return e.tickFormat.apply(e,arguments)};n.copy=function(){return AA().domain(n.domain()).range(n.range())};return n}function EA(){var e=[],t=[];function n(n){return n==null||n!==n?undefined:t[(yf(e,n)-1)%t.length]}n.domain=function(t){if(arguments.length){e=OA(t);return n}else{return e.slice()}};n.range=function(e){if(arguments.length){t=kA.call(e);return n}else{return t.slice()}};n.tickFormat=function(){var t=_O().domain([e[0],Object(dn["R"])(e)]);return t.tickFormat.apply(t,arguments)};n.copy=function(){return EA().domain(n.domain()).range(n.range())};return n}function MA(e){var t=_O(),n=0,r=1,i=false;function a(){var e=t.domain();n=e[0];r=Object(dn["R"])(e)-n}function u(t){var a=(t-n)/r;return e(i?Math.max(0,Math.min(1,a)):a)}u.clamp=function(e){if(arguments.length){i=!!e;return u}else{return i}};u.domain=function(e){return arguments.length?(t.domain(e),a(),u):t.domain()};u.interpolator=function(t){if(arguments.length){e=t;return u}else{return e}};u.copy=function(){return MA().domain(t.domain()).clamp(i).interpolator(e)};u.ticks=function(e){return t.ticks(e)};u.tickFormat=function(e,n){return t.tickFormat(e,n)};u.nice=function(e){return t.nice(e),a(),u};return u}function SA(e,t){return function n(){var r=t();if(!r.invertRange){r.invertRange=r.invert?lx(r):r.invertExtent?sx(r):undefined}r.type=e;return r}}function CA(e,t){if(arguments.length>1){DA[e]=SA(e,t);return this}else{return DA.hasOwnProperty(e)?DA[e]:undefined}}var DA={identity:wO,linear:_O,log:FO,ordinal:O_,pow:qO,sqrt:WO,quantile:HO,quantize:GO,threshold:YO,time:rA,utc:iA,band:bA,point:_A,sequential:MA,"bin-linear":AA,"bin-ordinal":EA};for(var jA in DA){CA(jA,DA[jA])}function NA(e,t){var n=t[0],r=Object(dn["R"])(t)-n;return function(t){return e(n+t*r)}}function FA(e,t,n){var r=n-t;return!r||!isFinite(r)?Object(dn["l"])(0):e.type==="linear"||e.type==="sequential"?function(e){return(e-t)/r}:e.copy().domain([t,n]).range([0,1]).interpolate(TA)}function TA(e,t){var n=t-e;return function(t){return e+t*n}}function zA(e,t){var n=a[RA(e)];return t!=null&&n&&n.gamma?n.gamma(t):n}function RA(e){return"interpolate"+e.toLowerCase().split("-").map(function(e){return e[0].toUpperCase()+e.slice(1)}).join("")}function PA(e){var t=e.length/6|0,n=new Array(t),r=0;while(r<t)n[r]="#"+e.slice(r*6,++r*6);return n}var LA=PA("1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5");var BA=PA("393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6");var IA=PA("3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9");var UA=PA("4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac");var qA=PA("4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5");var WA=new Array(3).concat("67a9cff7f7f7f1a340","0571b092c5defdb863e66101","0571b092c5def7f7f7fdb863e66101","2166ac67a9cfd1e5f0fee0b6f1a340b35806","2166ac67a9cfd1e5f0f7f7f7fee0b6f1a340b35806","2166ac4393c392c5ded1e5f0fee0b6fdb863e08214b35806","2166ac4393c392c5ded1e5f0f7f7f7fee0b6fdb863e08214b35806","0530612166ac4393c392c5ded1e5f0fee0b6fdb863e08214b358067f3b08","0530612166ac4393c392c5ded1e5f0f7f7f7fee0b6fdb863e08214b358067f3b08").map(PA);var HA=function(e){var t=e.length/6|0,n=new Array(t),r=0;while(r<t)n[r]="#"+e.slice(r*6,++r*6);return n};var GA=HA("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf");var YA=HA("7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666");var $A=HA("1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666");var VA=HA("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928");var XA=HA("fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2");var ZA=HA("b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc");var JA=HA("e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999");var QA=HA("66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3");var KA=HA("8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f");var eE=function(e){return $w(e[e.length-1])};var tE=new Array(3).concat("d8b365f5f5f55ab4ac","a6611adfc27d80cdc1018571","a6611adfc27df5f5f580cdc1018571","8c510ad8b365f6e8c3c7eae55ab4ac01665e","8c510ad8b365f6e8c3f5f5f5c7eae55ab4ac01665e","8c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e","8c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e","5430058c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e003c30","5430058c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e003c30").map(HA);var nE=eE(tE);var rE=new Array(3).concat("af8dc3f7f7f77fbf7b","7b3294c2a5cfa6dba0008837","7b3294c2a5cff7f7f7a6dba0008837","762a83af8dc3e7d4e8d9f0d37fbf7b1b7837","762a83af8dc3e7d4e8f7f7f7d9f0d37fbf7b1b7837","762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b7837","762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b7837","40004b762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b783700441b","40004b762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b783700441b").map(HA);var iE=eE(rE);var aE=new Array(3).concat("e9a3c9f7f7f7a1d76a","d01c8bf1b6dab8e1864dac26","d01c8bf1b6daf7f7f7b8e1864dac26","c51b7de9a3c9fde0efe6f5d0a1d76a4d9221","c51b7de9a3c9fde0eff7f7f7e6f5d0a1d76a4d9221","c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221","c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221","8e0152c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221276419","8e0152c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221276419").map(HA);var uE=eE(aE);var oE=new Array(3).concat("998ec3f7f7f7f1a340","5e3c99b2abd2fdb863e66101","5e3c99b2abd2f7f7f7fdb863e66101","542788998ec3d8daebfee0b6f1a340b35806","542788998ec3d8daebf7f7f7fee0b6f1a340b35806","5427888073acb2abd2d8daebfee0b6fdb863e08214b35806","5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b35806","2d004b5427888073acb2abd2d8daebfee0b6fdb863e08214b358067f3b08","2d004b5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b358067f3b08").map(HA);var fE=eE(oE);var cE=new Array(3).concat("ef8a62f7f7f767a9cf","ca0020f4a58292c5de0571b0","ca0020f4a582f7f7f792c5de0571b0","b2182bef8a62fddbc7d1e5f067a9cf2166ac","b2182bef8a62fddbc7f7f7f7d1e5f067a9cf2166ac","b2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac","b2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac","67001fb2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac053061","67001fb2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac053061").map(HA);var lE=eE(cE);var sE=new Array(3).concat("ef8a62ffffff999999","ca0020f4a582bababa404040","ca0020f4a582ffffffbababa404040","b2182bef8a62fddbc7e0e0e09999994d4d4d","b2182bef8a62fddbc7ffffffe0e0e09999994d4d4d","b2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d","b2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d","67001fb2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d1a1a1a","67001fb2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d1a1a1a").map(HA);var dE=eE(sE);var hE=new Array(3).concat("fc8d59ffffbf91bfdb","d7191cfdae61abd9e92c7bb6","d7191cfdae61ffffbfabd9e92c7bb6","d73027fc8d59fee090e0f3f891bfdb4575b4","d73027fc8d59fee090ffffbfe0f3f891bfdb4575b4","d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4","d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4","a50026d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4313695","a50026d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4313695").map(HA);var pE=eE(hE);var vE=new Array(3).concat("fc8d59ffffbf91cf60","d7191cfdae61a6d96a1a9641","d7191cfdae61ffffbfa6d96a1a9641","d73027fc8d59fee08bd9ef8b91cf601a9850","d73027fc8d59fee08bffffbfd9ef8b91cf601a9850","d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850","d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850","a50026d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850006837","a50026d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850006837").map(HA);var gE=eE(vE);var mE=new Array(3).concat("fc8d59ffffbf99d594","d7191cfdae61abdda42b83ba","d7191cfdae61ffffbfabdda42b83ba","d53e4ffc8d59fee08be6f59899d5943288bd","d53e4ffc8d59fee08bffffbfe6f59899d5943288bd","d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd","d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd","9e0142d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd5e4fa2","9e0142d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd5e4fa2").map(HA);var yE=eE(mE);var bE=new Array(3).concat("e5f5f999d8c92ca25f","edf8fbb2e2e266c2a4238b45","edf8fbb2e2e266c2a42ca25f006d2c","edf8fbccece699d8c966c2a42ca25f006d2c","edf8fbccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45006d2c00441b").map(HA);var xE=eE(bE);var _E=new Array(3).concat("e0ecf49ebcda8856a7","edf8fbb3cde38c96c688419d","edf8fbb3cde38c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d810f7c4d004b").map(HA);var wE=eE(_E);var kE=new Array(3).concat("e0f3dba8ddb543a2ca","f0f9e8bae4bc7bccc42b8cbe","f0f9e8bae4bc7bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe0868ac084081").map(HA);var OE=eE(kE);var AE=new Array(3).concat("fee8c8fdbb84e34a33","fef0d9fdcc8afc8d59d7301f","fef0d9fdcc8afc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301fb300007f0000").map(HA);var EE=eE(AE);var ME=new Array(3).concat("ece2f0a6bddb1c9099","f6eff7bdc9e167a9cf02818a","f6eff7bdc9e167a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016c59014636").map(HA);var SE=eE(ME);var CE=new Array(3).concat("ece7f2a6bddb2b8cbe","f1eef6bdc9e174a9cf0570b0","f1eef6bdc9e174a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0045a8d023858").map(HA);var DE=eE(CE);var jE=new Array(3).concat("e7e1efc994c7dd1c77","f1eef6d7b5d8df65b0ce1256","f1eef6d7b5d8df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125698004367001f").map(HA);var NE=eE(jE);var FE=new Array(3).concat("fde0ddfa9fb5c51b8a","feebe2fbb4b9f768a1ae017e","feebe2fbb4b9f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a017749006a").map(HA);var TE=eE(FE);var zE=new Array(3).concat("edf8b17fcdbb2c7fb8","ffffcca1dab441b6c4225ea8","ffffcca1dab441b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea8253494081d58").map(HA);var RE=eE(zE);var PE=new Array(3).concat("f7fcb9addd8e31a354","ffffccc2e69978c679238443","ffffccc2e69978c67931a354006837","ffffccd9f0a3addd8e78c67931a354006837","ffffccd9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443006837004529").map(HA);var LE=eE(PE);var BE=new Array(3).concat("fff7bcfec44fd95f0e","ffffd4fed98efe9929cc4c02","ffffd4fed98efe9929d95f0e993404","ffffd4fee391fec44ffe9929d95f0e993404","ffffd4fee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c02993404662506").map(HA);var IE=eE(BE);var UE=new Array(3).concat("ffeda0feb24cf03b20","ffffb2fecc5cfd8d3ce31a1c","ffffb2fecc5cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cbd0026800026").map(HA);var qE=eE(UE);var WE=new Array(3).concat("deebf79ecae13182bd","eff3ffbdd7e76baed62171b5","eff3ffbdd7e76baed63182bd08519c","eff3ffc6dbef9ecae16baed63182bd08519c","eff3ffc6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b508519c08306b").map(HA);var HE=eE(WE);var GE=new Array(3).concat("e5f5e0a1d99b31a354","edf8e9bae4b374c476238b45","edf8e9bae4b374c47631a354006d2c","edf8e9c7e9c0a1d99b74c47631a354006d2c","edf8e9c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45006d2c00441b").map(HA);var YE=eE(GE);var $E=new Array(3).concat("f0f0f0bdbdbd636363","f7f7f7cccccc969696525252","f7f7f7cccccc969696636363252525","f7f7f7d9d9d9bdbdbd969696636363252525","f7f7f7d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525000000").map(HA);var VE=eE($E);var XE=new Array(3).concat("efedf5bcbddc756bb1","f2f0f7cbc9e29e9ac86a51a3","f2f0f7cbc9e29e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a354278f3f007d").map(HA);var ZE=eE(XE);var JE=new Array(3).concat("fee0d2fc9272de2d26","fee5d9fcae91fb6a4acb181d","fee5d9fcae91fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181da50f1567000d").map(HA);var QE=eE(JE);var KE=new Array(3).concat("fee6cefdae6be6550d","feeddefdbe85fd8d3cd94701","feeddefdbe85fd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d94801a636037f2704").map(HA);var eM=eE(KE);var tM=Pk(Tw(300,.5,0),Tw(-240,.5,1));var nM=Pk(Tw(-100,.75,.35),Tw(80,1.5,.8));var rM=Pk(Tw(260,.75,.35),Tw(80,1.5,.8));var iM=Tw();var aM=function(e){if(e<0||e>1)e-=Math.floor(e);var t=Math.abs(e-.5);iM.h=360*e-100;iM.s=1.5-1.5*t;iM.l=.8-.9*t;return iM+""};var uM=X_(),oM=Math.PI/3,fM=Math.PI*2/3;var cM=function(e){var t;e=(.5-e)*Math.PI;uM.r=255*(t=Math.sin(e))*t;uM.g=255*(t=Math.sin(e+oM))*t;uM.b=255*(t=Math.sin(e+fM))*t;return uM+""};function lM(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}}var sM=lM(HA("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725"));var dM=lM(HA("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf"));var hM=lM(HA("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4"));var pM=lM(HA("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921"));var vM={blueorange:WA};var gM={category10:GA,accent:YA,dark2:$A,paired:VA,pastel1:XA,pastel2:ZA,set1:JA,set2:QA,set3:KA,category20:LA,category20b:BA,category20c:IA,tableau10:UA,tableau20:qA,viridis:sM,magma:dM,inferno:hM,plasma:pM,rainbow:aM,sinebow:cM,blueorange:$w(Object(dn["R"])(WA))};function mM(e,t){gM[e]=u["interpolate"+t];vM[e]=u["scheme"+t]}mM("blues","Blues");mM("greens","Greens");mM("greys","Greys");mM("purples","Purples");mM("reds","Reds");mM("oranges","Oranges");mM("brownbluegreen","BrBG");mM("purplegreen","PRGn");mM("pinkyellowgreen","PiYG");mM("purpleorange","PuOr");mM("redblue","RdBu");mM("redgrey","RdGy");mM("redyellowblue","RdYlBu");mM("redyellowgreen","RdYlGn");mM("spectral","Spectral");mM("bluegreen","BuGn");mM("bluepurple","BuPu");mM("greenblue","GnBu");mM("orangered","OrRd");mM("purplebluegreen","PuBuGn");mM("purpleblue","PuBu");mM("purplered","PuRd");mM("redpurple","RdPu");mM("yellowgreenblue","YlGnBu");mM("yellowgreen","YlGn");mM("yelloworangebrown","YlOrBr");mM("yelloworangered","YlOrRd");function yM(e,t){if(arguments.length>1){gM[e]=t;return this}var n=e.split("-");e=n[0];n=+n[1]+1;return n&&vM.hasOwnProperty(e)?vM[e][n-1]:!n&&gM.hasOwnProperty(e)?gM[e]:undefined}function bM(e,t,n){if(arguments.length>1){vM[e]=t;gM[e]=n||$w(Object(dn["R"])(t));return this}return vM.hasOwnProperty(e)?vM[e]:undefined}var xM={millisecond:ci,second:mi,minute:xi,hour:ki,day:Ei,week:Ci,month:Hi,year:$i};var _M={millisecond:ci,second:mi,minute:Zi,hour:Ki,day:na,week:aa,month:xa,year:ka};function wM(e){return xM.hasOwnProperty(e)&&xM[e]}function kM(e){return _M.hasOwnProperty(e)&&_M[e]}function OM(e,t){var n;if(Object(dn["E"])(t)){n=t.step;t=t.interval}if(Object(dn["G"])(t)){t=e.type==="time"?wM(t):e.type==="utc"?kM(t):Object(dn["n"])("Only time and utc scales accept interval strings.");if(n)t=t.every(n)}return t}function AM(e,t,n){var r=e.range(),i=r[0],a=Object(dn["R"])(r);if(i>a){r=a;a=i;i=r}t=t.filter(function(t){t=e(t);return!(t<i||t>a)});if(n>0&&t.length>1){var u=[t[0],Object(dn["R"])(t)];while(t.length>n&&t.length>=3){t=t.filter(function(e,t){return!(t%2)})}if(t.length<3){t=u}}return t}function EM(e,t){return e.ticks?e.ticks(t):e.domain()}function MM(e,t,n){var r=e.tickFormat?e.tickFormat(t,n):n?hO(n):String;return e.type===Vb?SM(r,CM(n)):r}function SM(e,t){return function(n){return e(n)?t(n):""}}function CM(e){var t=nO(e||",");if(t.precision==null){t.precision=12;switch(t.type){case"%":t.precision-=2;break;case"e":t.precision-=1;break}return DM(hO(t),hO(".1f")(1)[1])}else{return hO(t)}}function DM(e,t){return function(n){var r=e(n),i=r.indexOf(t),a,u;if(i<0)return r;a=jM(r,i);u=a<r.length?r.slice(a):"";while(--a>i)if(r[a]!=="0"){++a;break}return r.slice(0,a)+u}}function jM(e,t){var n=e.lastIndexOf("e"),r;if(n>0)return n;for(n=e.length;--n>t;){r=e.charCodeAt(n);if(r>=48&&r<=57)return n+1}}function NM(e){Go.call(this,null,e)}var FM=Object(dn["x"])(NM,Go);FM.transform=function(e,t){if(this.value&&!e.modified()){return t.StopPropagation}var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=this.value,i=e.scale,a=e.count==null?e.values?e.values.length:10:OM(i,e.count),u=e.format||MM(i,a,e.formatSpecifier),o=e.values?AM(i,e.values,a):EM(i,a);if(r)n.rem=r;r=o.map(function(e,t){return xn({index:t/(o.length-1),value:e,label:u(e)})});if(e.extra&&r.length){r.push(xn({index:-1,extra:{value:r[0].value},label:""}))}n.source=r;n.add=r;this.value=r;return n};function TM(e){Go.call(this,null,e)}var zM=Object(dn["x"])(TM,Go);function RM(){return xn({})}function PM(e){return e.exit}zM.transform=function(e,t){var n=t.dataflow,r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=e.item||RM,a=e.key||yn,u=this.value;if(Object(dn["z"])(r.encode)){r.encode=null}if(u&&(e.modified("key")||t.modified(a))){Object(dn["n"])("DataJoin does not support modified key function or fields.")}if(!u){t=t.addAll();this.value=u=Object(dn["s"])().test(PM);u.lookup=function(e){return u.get(a(e))}}t.visit(t.ADD,function(e){var t=a(e),n=u.get(t);if(n){if(n.exit){u.empty--;r.add.push(n)}else{r.mod.push(n)}}else{u.set(t,n=i(e));r.add.push(n)}n.datum=e;n.exit=false});t.visit(t.MOD,function(e){var t=a(e),n=u.get(t);if(n){n.datum=e;r.mod.push(n)}});t.visit(t.REM,function(e){var t=a(e),n=u.get(t);if(e===n.datum&&!n.exit){r.rem.push(n);n.exit=true;++u.empty}});if(t.changed(t.ADD_MOD))r.modifies("datum");if(e.clean&&u.empty>n.cleanThreshold)n.runAfter(u.clean);return r};function LM(e){Go.call(this,null,e)}var BM=Object(dn["x"])(LM,Go);BM.transform=function(e,t){var n=t.fork(t.ADD_REM),r=e.encoders,i=t.encode;if(Object(dn["z"])(i)){if(n.changed()||i.every(function(e){return r[e]})){i=i[0];n.encode=null}else{return t.StopPropagation}}var a=i==="enter",u=r.update||dn["r"],o=r.enter||dn["r"],f=r.exit||dn["r"],c=(i&&!a?r[i]:u)||dn["r"];if(t.changed(t.ADD)){t.visit(t.ADD,function(t){o(t,e);u(t,e);if(c!==dn["r"]&&c!==u)c(t,e)});n.modifies(o.output);n.modifies(u.output);if(c!==dn["r"]&&c!==u)n.modifies(c.output)}if(t.changed(t.REM)&&f!==dn["r"]){t.visit(t.REM,function(t){f(t,e)});n.modifies(f.output)}if(a||c!==dn["r"]){var l=t.MOD|(e.modified()?t.REFLOW:0);if(a){t.visit(l,function(t){var r=o(t,e);if(c(t,e)||r)n.mod.push(t)});if(n.mod.length)n.modifies(o.output)}else{t.visit(l,function(t){if(c(t,e))n.mod.push(t)})}if(n.mod.length)n.modifies(c.output)}return n.changed()?n:t.StopPropagation};var IM="symbol";var UM="discrete";var qM="gradient";var WM={};WM[rx]=YM;WM[ix]=GM;WM[ax]=$M;WM[ux]=WM[ox]=VM;function HM(e,t){var n=WM[e.type];return n?n(e):EM(e,t)}function GM(e){var t=e.domain(),n=t[0],r=Object(dn["R"])(t),i=e.range().length,a=new Array(i),u=0;a[0]=-Infinity;while(++u<i)a[u]=(u*r-(u-i)*n)/i;a.max=+Infinity;return a}function YM(e){var t=[-Infinity].concat(e.quantiles());t.max=+Infinity;return t}function $M(e){var t=[-Infinity].concat(e.domain());t.max=+Infinity;return t}function VM(e){var t=e.domain();t.max=t.pop();return t}function XM(e,t,n){return n===IM&&WM[e.type]?ZM(t):n===UM?JM(t):QM(t)}function ZM(e){return function(t,n,r){var i=r[n+1]||r.max||+Infinity,a=KM(t,e),u=KM(i,e);return a&&u?a+"â€“"+u:u?"< "+u:"â‰¥ "+a}}function JM(e){return function(t,n){return n?e(t):null}}function QM(e){return function(t){return e(t)}}function KM(e,t){return isFinite(e)?t(e):null}function eS(e){var t=e.domain(),n=t.length-1,r=+t[0],i=+Object(dn["R"])(t),a=i-r;if(e.type===ax){var u=n?a/n:.1;r-=u;i+=u;a=i-r}return function(e){return(e-r)/a}}function tS(e){Go.call(this,[],e)}var nS=Object(dn["x"])(tS,Go);nS.transform=function(e,t){if(this.value!=null&&!e.modified()){return t.StopPropagation}var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=this.value,i=e.type||IM,a=e.scale,u=e.count==null?5:OM(a,e.count),o=e.format||MM(a,u,e.formatSpecifier),f=e.values||HM(a,u,i),c,l,s,d;o=XM(a,o,i);if(r)n.rem=r;if(i===IM){if(Object(dn["C"])(s=e.size)){if(!e.values&&a(f[0])===0){f=f.slice(1)}d=f.reduce(function(t,n){return Math.max(t,s(n,e))},0)}else{s=Object(dn["l"])(d=s||8)}r=f.map(function(t,n){return xn({index:n,label:o(t,n,f),value:t,offset:d,size:s(t,e)})})}else if(i===qM){c=a.domain(),l=FA(a,c[0],Object(dn["R"])(c));if(f.length<3&&!e.values&&c[0]!==Object(dn["R"])(c)){f=[c[0],Object(dn["R"])(c)]}r=f.map(function(e,t){return xn({index:t,label:o(e,t,f),value:e,perc:l(e)})})}else{s=f.length-1;l=eS(a);r=f.map(function(e,t){return xn({index:t,label:o(e,t,f),value:e,perc:t?l(e):0,perc2:t===s?1:l(f[t+1])})})}n.source=r;n.add=r;this.value=r;return n};var rS=Object(dn["s"])({line:lS,"line-radial":sS,arc:dS,"arc-radial":hS,curve:pS,"curve-radial":vS,"orthogonal-horizontal":gS,"orthogonal-vertical":mS,"orthogonal-radial":yS,"diagonal-horizontal":bS,"diagonal-vertical":xS,"diagonal-radial":_S});function iS(e){return e.source.x}function aS(e){return e.source.y}function uS(e){return e.target.x}function oS(e){return e.target.y}function fS(e){Go.call(this,{},e)}fS.Definition={type:"LinkPath",metadata:{modifies:true},params:[{name:"sourceX",type:"field",default:"source.x"},{name:"sourceY",type:"field",default:"source.y"},{name:"targetX",type:"field",default:"target.x"},{name:"targetY",type:"field",default:"target.y"},{name:"orient",type:"enum",default:"vertical",values:["horizontal","vertical","radial"]},{name:"shape",type:"enum",default:"line",values:["line","arc","curve","diagonal","orthogonal"]},{name:"require",type:"signal"},{name:"as",type:"string",default:"path"}]};var cS=Object(dn["x"])(fS,Go);cS.transform=function(e,t){var n=e.sourceX||iS,r=e.sourceY||aS,i=e.targetX||uS,a=e.targetY||oS,u=e.as||"path",o=e.orient||"vertical",f=e.shape||"line",c=rS.get(f+"-"+o)||rS.get(f);if(!c){Object(dn["n"])("LinkPath unsupported type: "+e.shape+(e.orient?"-"+e.orient:""))}t.visit(t.SOURCE,function(e){e[u]=c(n(e),r(e),i(e),a(e))});return t.reflow(e.modified()).modifies(u)};function lS(e,t,n,r){return"M"+e+","+t+"L"+n+","+r}function sS(e,t,n,r){return lS(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n))}function dS(e,t,n,r){var i=n-e,a=r-t,u=Math.sqrt(i*i+a*a)/2,o=180*Math.atan2(a,i)/Math.PI;return"M"+e+","+t+"A"+u+","+u+" "+o+" 0 1"+" "+n+","+r}function hS(e,t,n,r){return dS(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n))}function pS(e,t,n,r){var i=n-e,a=r-t,u=.2*(i+a),o=.2*(a-i);return"M"+e+","+t+"C"+(e+u)+","+(t+o)+" "+(n+o)+","+(r-u)+" "+n+","+r}function vS(e,t,n,r){return pS(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n))}function gS(e,t,n,r){return"M"+e+","+t+"V"+r+"H"+n}function mS(e,t,n,r){return"M"+e+","+t+"H"+n+"V"+r}function yS(e,t,n,r){var i=Math.cos(e),a=Math.sin(e),u=Math.cos(n),o=Math.sin(n),f=Math.abs(n-e)>Math.PI?n<=e:n>e;return"M"+t*i+","+t*a+"A"+t+","+t+" 0 0,"+(f?1:0)+" "+t*u+","+t*o+"L"+r*u+","+r*o}function bS(e,t,n,r){var i=(e+n)/2;return"M"+e+","+t+"C"+i+","+t+" "+i+","+r+" "+n+","+r}function xS(e,t,n,r){var i=(t+r)/2;return"M"+e+","+t+"C"+e+","+i+" "+n+","+i+" "+n+","+r}function _S(e,t,n,r){var i=Math.cos(e),a=Math.sin(e),u=Math.cos(n),o=Math.sin(n),f=(t+r)/2;return"M"+t*i+","+t*a+"C"+f*i+","+f*a+" "+f*u+","+f*o+" "+r*u+","+r*o}function wS(e){Go.call(this,null,e)}wS.Definition={type:"Pie",metadata:{modifies:true},params:[{name:"field",type:"field"},{name:"startAngle",type:"number",default:0},{name:"endAngle",type:"number",default:6.283185307179586},{name:"sort",type:"boolean",default:false},{name:"as",type:"string",array:true,length:2,default:["startAngle","endAngle"]}]};var kS=Object(dn["x"])(wS,Go);kS.transform=function(e,t){var n=e.as||["startAngle","endAngle"],r=n[0],i=n[1],a=e.field||dn["L"],u=e.startAngle||0,o=e.endAngle!=null?e.endAngle:2*Math.PI,f=t.source,c=f.map(a),l=c.length,s=u,d=(o-u)/cc(c),h=Rf(l),p,v,g;if(e.sort){h.sort(function(e,t){return c[e]-c[t]})}for(p=0;p<l;++p){g=c[h[p]];v=f[h[p]];v[r]=s;v[i]=s+=g*d}this.value=c;return t.reflow(e.modified()).modifies(n)};var OS=5;var AS=Object(dn["ab"])([tx,Xb,Jb]);var ES=Object(dn["ab"])([tx,Vb,Xb,Jb,Kb,Zb]);var MS=Object(dn["ab"])(["set","modified","clear","type","scheme","schemeExtent","schemeCount","domain","domainMin","domainMid","domainMax","domainRaw","domainImplicit","nice","zero","range","rangeStep","round","reverse","interpolate","interpolateGamma"]);function SS(e){Go.call(this,null,e);this.modified(true)}var CS=Object(dn["x"])(SS,Go);CS.transform=function(e,t){var n=t.dataflow,r=this.value,i;if(!r||e.modified("type")){this.value=r=CA((e.type||tx).toLowerCase())()}for(i in e)if(!MS[i]){if(i==="padding"&&ES[r.type])continue;Object(dn["C"])(r[i])?r[i](e[i]):n.warn("Unsupported scale property: "+i)}TS(r,e,DS(r,e,n));return t.fork(t.NO_SOURCE|t.NO_FIELDS)};function DS(e,t,n){var r=jS(e,t.domainRaw,n);if(r>-1)return r;var i=t.domain,a=e.type,u=t.zero||t.zero===undefined&&AS[a],o,f;if(!i)return 0;if(ES[a]&&t.padding&&i[0]!==Object(dn["R"])(i)){i=NS(a,i,t.range,t.padding,t.exponent)}if(u||t.domainMin!=null||t.domainMax!=null||t.domainMid!=null){o=(i=i.slice()).length-1||1;if(u){if(i[0]>0)i[0]=0;if(i[o]<0)i[o]=0}if(t.domainMin!=null)i[0]=t.domainMin;if(t.domainMax!=null)i[o]=t.domainMax;if(t.domainMid!=null){f=t.domainMid;if(f<i[0]||f>i[o]){n.warn("Scale domainMid exceeds domain min or max.",f)}i.splice(o,0,f)}}e.domain(FS(a,i,n));if(a===nx){e.unknown(t.domainImplicit?k_:undefined)}if(t.nice&&e.nice){e.nice(t.nice!==true&&OM(e,t.nice)||null)}return i.length}function jS(e,t,n){if(t){e.domain(FS(e.type,t,n));return t.length}else{return-1}}function NS(e,t,n,r,i){var a=Math.abs(Object(dn["R"])(n)-n[0]),u=a/(a-2*r),o=e===Vb?Object(dn["ib"])(t,null,u):e===Jb?Object(dn["jb"])(t,null,u,.5):e===Xb?Object(dn["jb"])(t,null,u,i):Object(dn["hb"])(t,null,u);t=t.slice();t[0]=o[0];t[t.length-1]=o[1];return t}function FS(e,t,n){if(e===Vb){var r=Math.abs(t.reduce(function(e,t){return e+(t<0?-1:t>0?1:0)},0));if(r!==t.length){n.warn("Log scale domain includes zero: "+Object(dn["W"])(t))}}return t}function TS(e,t,n){var r=t.round||false,i=t.range;if(t.rangeStep!=null){i=zS(e.type,t,n)}else if(t.scheme){i=RS(e.type,t,n);if(Object(dn["C"])(i))return e.interpolator(i)}else if(i&&e.type===fx){return e.interpolator($w(LS(i,t.reverse)))}if(i&&t.interpolate&&e.interpolate){e.interpolate(zA(t.interpolate,t.interpolateGamma))}else if(Object(dn["C"])(e.round)){e.round(r)}else if(Object(dn["C"])(e.rangeRound)){e.interpolate(r?ok:ik)}if(i)e.range(LS(i,t.reverse))}function zS(e,t,n){if(e!==Qb&&e!==ex){Object(dn["n"])("Only band and point scales support rangeStep.")}var r=(t.paddingOuter!=null?t.paddingOuter:t.padding)||0,i=e===ex?1:(t.paddingInner!=null?t.paddingInner:t.padding)||0;return[0,t.rangeStep*cx(n,i,r)]}function RS(e,t,n){var r=t.scheme.toLowerCase(),i=yM(r),a=t.schemeExtent,u;if(!i){Object(dn["n"])("Unrecognized scheme name: "+t.scheme)}n=e===ax?n+1:e===ox?n-1:e===rx||e===ix?+t.schemeCount||OS:n;return e===fx?PS(i,a,t.reverse):!a&&(u=yM(r+"-"+n))?u:Object(dn["C"])(i)?BS(PS(i,a),n):e===nx?i:i.slice(0,n)}function PS(e,t,n){return Object(dn["C"])(e)&&(t||n)?NA(e,LS(t||[0,1],n)):e}function LS(e,t){return t?e.slice().reverse():e}function BS(e,t){var n=new Array(t),r=t+1;for(var i=0;i<t;)n[i]=e(++i/r);return n}function IS(e){Go.call(this,null,e)}var US=Object(dn["x"])(IS,Go);US.transform=function(e,t){var n=e.modified("sort")||t.changed(t.ADD)||t.modified(e.sort.fields)||t.modified("datum");if(n)t.source.sort(e.sort);this.modified(n);return t};var qS="zero",WS="center",HS="normalize",GS=["y0","y1"];function YS(e){Go.call(this,null,e)}YS.Definition={type:"Stack",metadata:{modifies:true},params:[{name:"field",type:"field"},{name:"groupby",type:"field",array:true},{name:"sort",type:"compare"},{name:"offset",type:"enum",default:qS,values:[qS,WS,HS]},{name:"as",type:"string",array:true,length:2,default:GS}]};var $S=Object(dn["x"])(YS,Go);$S.transform=function(e,t){var n=e.as||GS,r=n[0],i=n[1],a=e.field||dn["L"],u=e.offset===WS?VS:e.offset===HS?XS:ZS,o,f,c,l;o=JS(t.source,e.groupby,e.sort,a);for(f=0,c=o.length,l=o.max;f<c;++f){u(o[f],l,a,r,i)}return t.reflow(e.modified()).modifies(n)};function VS(e,t,n,r,i){var a=(t-e.sum)/2,u=e.length,o=0,f;for(;o<u;++o){f=e[o];f[r]=a;f[i]=a+=Math.abs(n(f))}}function XS(e,t,n,r,i){var a=1/e.sum,u=0,o=e.length,f=0,c=0,l;for(;f<o;++f){l=e[f];l[r]=u;l[i]=u=a*(c+=Math.abs(n(l)))}}function ZS(e,t,n,r,i){var a=0,u=0,o=e.length,f=0,c,l;for(;f<o;++f){l=e[f];c=n(l);if(c<0){l[r]=u;l[i]=u+=c}else{l[r]=a;l[i]=a+=c}}}function JS(e,t,n,r){var i=[],a=function(e){return e(l)},u,o,f,c,l,s,d,h,p;if(t==null){i.push(e.slice())}else{for(u={},o=0,f=e.length;o<f;++o){l=e[o];s=t.map(a);d=u[s];if(!d){u[s]=d=[];i.push(d)}d.push(l)}}for(s=0,p=0,c=i.length;s<c;++s){d=i[s];for(o=0,h=0,f=d.length;o<f;++o){h+=Math.abs(r(d[o]))}d.sum=h;if(h>p)p=h;if(n)d.sort(n)}i.max=p;return i}var QS=function(e,t){return e<t?-1:e>t?1:e>=t?0:NaN};var KS=function(e){if(e.length===1)e=eC(e);return{left:function(t,n,r,i){if(r==null)r=0;if(i==null)i=t.length;while(r<i){var a=r+i>>>1;if(e(t[a],n)<0)r=a+1;else i=a}return r},right:function(t,n,r,i){if(r==null)r=0;if(i==null)i=t.length;while(r<i){var a=r+i>>>1;if(e(t[a],n)>0)i=a;else r=a+1}return r}}};function eC(e){return function(t,n){return QS(e(t),n)}}var tC=KS(QS);var nC=tC.right;var rC=tC.left;var iC=nC;var aC=function(e,t){if(t==null)t=uC;var n=0,r=e.length-1,i=e[0],a=new Array(r<0?0:r);while(n<r)a[n]=t(i,i=e[++n]);return a};function uC(e,t){return[e,t]}var oC=function(e,t,n){var r=e.length,i=t.length,a=new Array(r*i),u,o,f,c;if(n==null)n=uC;for(u=f=0;u<r;++u){for(c=e[u],o=0;o<i;++o,++f){a[f]=n(c,t[o])}}return a};var fC=function(e,t){return t<e?-1:t>e?1:t>=e?0:NaN};var cC=function(e){return e===null?NaN:+e};var lC=function(e,t){var n=e.length,r=0,i=-1,a=0,u,o,f=0;if(t==null){while(++i<n){if(!isNaN(u=cC(e[i]))){o=u-a;a+=o/++r;f+=o*(u-a)}}}else{while(++i<n){if(!isNaN(u=cC(t(e[i],i,e)))){o=u-a;a+=o/++r;f+=o*(u-a)}}}if(r>1)return f/(r-1)};var sC=function(e,t){var n=lC(e,t);return n?Math.sqrt(n):n};var dC=function(e,t){var n=e.length,r=-1,i,a,u;if(t==null){while(++r<n){if((i=e[r])!=null&&i>=i){a=u=i;while(++r<n){if((i=e[r])!=null){if(a>i)a=i;if(u<i)u=i}}}}}else{while(++r<n){if((i=t(e[r],r,e))!=null&&i>=i){a=u=i;while(++r<n){if((i=t(e[r],r,e))!=null){if(a>i)a=i;if(u<i)u=i}}}}}return[a,u]};var hC=Array.prototype;var pC=hC.slice;var vC=hC.map;var gC=function(e){return function(){return e}};var mC=function(e){return e};var yC=function(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;var r=-1,i=Math.max(0,Math.ceil((t-e)/n))|0,a=new Array(i);while(++r<i){a[r]=e+r*n}return a};var bC=Math.sqrt(50),xC=Math.sqrt(10),_C=Math.sqrt(2);var wC=function(e,t,n){var r,i=-1,a,u,o;t=+t,e=+e,n=+n;if(e===t&&n>0)return[e];if(r=t<e)a=e,e=t,t=a;if((o=kC(e,t,n))===0||!isFinite(o))return[];if(o>0){e=Math.ceil(e/o);t=Math.floor(t/o);u=new Array(a=Math.ceil(t-e+1));while(++i<a)u[i]=(e+i)*o}else{e=Math.floor(e*o);t=Math.ceil(t*o);u=new Array(a=Math.ceil(e-t+1));while(++i<a)u[i]=(e-i)/o}if(r)u.reverse();return u};function kC(e,t,n){var r=(t-e)/Math.max(0,n),i=Math.floor(Math.log(r)/Math.LN10),a=r/Math.pow(10,i);return i>=0?(a>=bC?10:a>=xC?5:a>=_C?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(a>=bC?10:a>=xC?5:a>=_C?2:1)}function OC(e,t,n){var r=Math.abs(t-e)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),a=r/i;if(a>=bC)i*=10;else if(a>=xC)i*=5;else if(a>=_C)i*=2;return t<e?-i:i}var AC=function(e){return Math.ceil(Math.log(e.length)/Math.LN2)+1};var EC=function(){var e=mC,t=dC,n=AC;function r(r){var i,a=r.length,u,o=new Array(a);for(i=0;i<a;++i){o[i]=e(r[i],i,r)}var f=t(o),c=f[0],l=f[1],s=n(o,c,l);if(!Array.isArray(s)){s=OC(c,l,s);s=yC(Math.ceil(c/s)*s,l,s)}var d=s.length;while(s[0]<=c)s.shift(),--d;while(s[d-1]>l)s.pop(),--d;var h=new Array(d+1),p;for(i=0;i<=d;++i){p=h[i]=[];p.x0=i>0?s[i-1]:c;p.x1=i<d?s[i]:l}for(i=0;i<a;++i){u=o[i];if(c<=u&&u<=l){h[iC(s,u,0,d)].push(r[i])}}return h}r.value=function(t){return arguments.length?(e=typeof t==="function"?t:gC(t),r):e};r.domain=function(e){return arguments.length?(t=typeof e==="function"?e:gC([e[0],e[1]]),r):t};r.thresholds=function(e){return arguments.length?(n=typeof e==="function"?e:Array.isArray(e)?gC(pC.call(e)):gC(e),r):n};return r};var MC=function(e,t,n){if(n==null)n=cC;if(!(r=e.length))return;if((t=+t)<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,i=(r-1)*t,a=Math.floor(i),u=+n(e[a],a,e),o=+n(e[a+1],a+1,e);return u+(o-u)*(i-a)};var SC=function(e,t,n){e=vC.call(e,cC).sort(QS);return Math.ceil((n-t)/(2*(MC(e,.75)-MC(e,.25))*Math.pow(e.length,-1/3)))};var CC=function(e,t,n){return Math.ceil((n-t)/(3.5*sC(e)*Math.pow(e.length,-1/3)))};var DC=function(e,t){var n=e.length,r=-1,i,a;if(t==null){while(++r<n){if((i=e[r])!=null&&i>=i){a=i;while(++r<n){if((i=e[r])!=null&&i>a){a=i}}}}}else{while(++r<n){if((i=t(e[r],r,e))!=null&&i>=i){a=i;while(++r<n){if((i=t(e[r],r,e))!=null&&i>a){a=i}}}}}return a};var jC=function(e,t){var n=e.length,r=n,i=-1,a,u=0;if(t==null){while(++i<n){if(!isNaN(a=cC(e[i])))u+=a;else--r}}else{while(++i<n){if(!isNaN(a=cC(t(e[i],i,e))))u+=a;else--r}}if(r)return u/r};var NC=function(e,t){var n=e.length,r=-1,i,a=[];if(t==null){while(++r<n){if(!isNaN(i=cC(e[r]))){a.push(i)}}}else{while(++r<n){if(!isNaN(i=cC(t(e[r],r,e)))){a.push(i)}}}return MC(a.sort(QS),.5)};var FC=function(e){var t=e.length,n,r=-1,i=0,a,u;while(++r<t)i+=e[r].length;a=new Array(i);while(--t>=0){u=e[t];n=u.length;while(--n>=0){a[--i]=u[n]}}return a};var TC=function(e,t){var n=e.length,r=-1,i,a;if(t==null){while(++r<n){if((i=e[r])!=null&&i>=i){a=i;while(++r<n){if((i=e[r])!=null&&a>i){a=i}}}}}else{while(++r<n){if((i=t(e[r],r,e))!=null&&i>=i){a=i;while(++r<n){if((i=t(e[r],r,e))!=null&&a>i){a=i}}}}}return a};var zC=function(e,t){var n=t.length,r=new Array(n);while(n--)r[n]=e[t[n]];return r};var RC=function(e,t){if(!(n=e.length))return;var n,r=0,i=0,a,u=e[i];if(t==null)t=QS;while(++r<n){if(t(a=e[r],u)<0||t(u,u)!==0){u=a,i=r}}if(t(u,u)===0)return i};var PC=function(e,t,n){var r=(n==null?e.length:n)-(t=t==null?0:+t),i,a;while(r){a=Math.random()*r--|0;i=e[r+t];e[r+t]=e[a+t];e[a+t]=i}return e};var LC=function(e,t){var n=e.length,r=-1,i,a=0;if(t==null){while(++r<n){if(i=+e[r])a+=i}}else{while(++r<n){if(i=+t(e[r],r,e))a+=i}}return a};var BC=function(e){if(!(a=e.length))return[];for(var t=-1,n=TC(e,IC),r=new Array(n);++t<n;){for(var i=-1,a,u=r[t]=new Array(a);++i<a;){u[i]=e[i][t]}}return r};function IC(e){return e.length}var UC=function(){return BC(arguments)};var qC=Array.prototype;var WC=qC.slice;var HC=function(e,t){return e-t};var GC=function(e){var t=0,n=e.length,r=e[n-1][1]*e[0][0]-e[n-1][0]*e[0][1];while(++t<n)r+=e[t-1][1]*e[t][0]-e[t-1][0]*e[t][1];return r};var YC=function(e){return function(){return e}};var $C=function(e,t){var n=-1,r=t.length,i;while(++n<r)if(i=VC(e,t[n]))return i;return 0};function VC(e,t){var n=t[0],r=t[1],i=-1;for(var a=0,u=e.length,o=u-1;a<u;o=a++){var f=e[a],c=f[0],l=f[1],s=e[o],d=s[0],h=s[1];if(XC(f,s,t))return 0;if(l>r!==h>r&&n<(d-c)*(r-l)/(h-l)+c)i=-i}return i}function XC(e,t,n){var r;return ZC(e,t,n)&&JC(e[r=+(e[0]===t[0])],n[r],t[r])}function ZC(e,t,n){return(t[0]-e[0])*(n[1]-e[1])===(n[0]-e[0])*(t[1]-e[1])}function JC(e,t,n){return e<=t&&t<=n||n<=t&&t<=e}var QC=function(){};var KC=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];var eD=function(){var e=1,t=1,n=AC,r=f;function i(e){var t=n(e);if(!Array.isArray(t)){var r=dC(e),i=r[0],u=r[1];t=OC(i,u,t);t=yC(Math.floor(i/t)*t,Math.floor(u/t)*t,t)}else{t=t.slice().sort(HC)}return t.map(function(t){return a(e,t)})}function a(e,t){var n=[],i=[];u(e,t,function(a){r(a,e,t);if(GC(a)>0)n.push([a]);else i.push(a)});i.forEach(function(e){for(var t=0,r=n.length,i;t<r;++t){if($C((i=n[t])[0],e)!==-1){i.push(e);return}}});return{type:"MultiPolygon",value:t,coordinates:n}}function u(n,r,i){var a=new Array,u=new Array,f,c,l,s,d,h;f=c=-1;s=n[0]>=r;KC[s<<1].forEach(p);while(++f<e-1){l=s,s=n[f+1]>=r;KC[l|s<<1].forEach(p)}KC[s<<0].forEach(p);while(++c<t-1){f=-1;s=n[c*e+e]>=r;d=n[c*e]>=r;KC[s<<1|d<<2].forEach(p);while(++f<e-1){l=s,s=n[c*e+e+f+1]>=r;h=d,d=n[c*e+f+1]>=r;KC[l|s<<1|d<<2|h<<3].forEach(p)}KC[s|d<<3].forEach(p)}f=-1;d=n[c*e]>=r;KC[d<<2].forEach(p);while(++f<e-1){h=d,d=n[c*e+f+1]>=r;KC[d<<2|h<<3].forEach(p)}KC[d<<3].forEach(p);function p(e){var t=[e[0][0]+f,e[0][1]+c],n=[e[1][0]+f,e[1][1]+c],r=o(t),l=o(n),s,d;if(s=u[r]){if(d=a[l]){delete u[s.end];delete a[d.start];if(s===d){s.ring.push(n);i(s.ring)}else{a[s.start]=u[d.end]={start:s.start,end:d.end,ring:s.ring.concat(d.ring)}}}else{delete u[s.end];s.ring.push(n);u[s.end=l]=s}}else if(s=a[l]){if(d=u[r]){delete a[s.start];delete u[d.end];if(s===d){s.ring.push(n);i(s.ring)}else{a[d.start]=u[s.end]={start:d.start,end:s.end,ring:d.ring.concat(s.ring)}}}else{delete a[s.start];s.ring.unshift(t);a[s.start=r]=s}}else{a[r]=u[l]={start:r,end:l,ring:[t,n]}}}}function o(t){return t[0]*2+t[1]*(e+1)*4}function f(n,r,i){n.forEach(function(n){var a=n[0],u=n[1],o=a|0,f=u|0,c,l=r[f*e+o];if(a>0&&a<e&&o===a){c=r[f*e+o-1];n[0]=a+(i-c)/(l-c)-.5}if(u>0&&u<t&&f===u){c=r[(f-1)*e+o];n[1]=u+(i-c)/(l-c)-.5}})}i.contour=a;i.size=function(n){if(!arguments.length)return[e,t];var r=Math.ceil(n[0]),a=Math.ceil(n[1]);if(!(r>0)||!(a>0))throw new Error("invalid size");return e=r,t=a,i};i.thresholds=function(e){return arguments.length?(n=typeof e==="function"?e:Array.isArray(e)?YC(WC.call(e)):YC(e),i):n};i.smooth=function(e){return arguments.length?(r=e?f:QC,i):r===f};return i};function tD(e,t,n){var r=e.width,i=e.height,a=(n<<1)+1;for(var u=0;u<i;++u){for(var o=0,f=0;o<r+n;++o){if(o<r){f+=e.data[o+u*r]}if(o>=n){if(o>=a){f-=e.data[o-a+u*r]}t.data[o-n+u*r]=f/Math.min(o+1,r-1+a-o,a)}}}}function nD(e,t,n){var r=e.width,i=e.height,a=(n<<1)+1;for(var u=0;u<r;++u){for(var o=0,f=0;o<i+n;++o){if(o<i){f+=e.data[u+o*r]}if(o>=n){if(o>=a){f-=e.data[u+(o-a)*r]}t.data[u+(o-n)*r]=f/Math.min(o+1,i-1+a-o,a)}}}}function rD(e){return e[0]}function iD(e){return e[1]}function aD(){return 1}var uD=function(){var e=rD,t=iD,n=aD,r=960,i=500,a=20,u=2,o=a*3,f=r+o*2>>u,c=i+o*2>>u,l=YC(20);function s(r){var i=new Float32Array(f*c),s=new Float32Array(f*c);r.forEach(function(r,a,l){var s=+e(r,a,l)+o>>u,d=+t(r,a,l)+o>>u,h=+n(r,a,l);if(s>=0&&s<f&&d>=0&&d<c){i[s+d*f]+=h}});tD({width:f,height:c,data:i},{width:f,height:c,data:s},a>>u);nD({width:f,height:c,data:s},{width:f,height:c,data:i},a>>u);tD({width:f,height:c,data:i},{width:f,height:c,data:s},a>>u);nD({width:f,height:c,data:s},{width:f,height:c,data:i},a>>u);tD({width:f,height:c,data:i},{width:f,height:c,data:s},a>>u);nD({width:f,height:c,data:s},{width:f,height:c,data:i},a>>u);var h=l(i);if(!Array.isArray(h)){var p=DC(i);h=OC(0,p,h);h=yC(0,Math.floor(p/h)*h,h);h.shift()}return eD().thresholds(h).size([f,c])(i).map(d)}function d(e){e.value*=Math.pow(2,-2*u);e.coordinates.forEach(h);return e}function h(e){e.forEach(p)}function p(e){e.forEach(v)}function v(e){e[0]=e[0]*Math.pow(2,u)-o;e[1]=e[1]*Math.pow(2,u)-o}function g(){o=a*3;f=r+o*2>>u;c=i+o*2>>u;return s}s.x=function(t){return arguments.length?(e=typeof t==="function"?t:YC(+t),s):e};s.y=function(e){return arguments.length?(t=typeof e==="function"?e:YC(+e),s):t};s.weight=function(e){return arguments.length?(n=typeof e==="function"?e:YC(+e),s):n};s.size=function(e){if(!arguments.length)return[r,i];var t=Math.ceil(e[0]),n=Math.ceil(e[1]);if(!(t>=0)&&!(t>=0))throw new Error("invalid size");return r=t,i=n,g()};s.cellSize=function(e){if(!arguments.length)return 1<<u;if(!((e=+e)>=1))throw new Error("invalid cell size");return u=Math.floor(Math.log(e)/Math.LN2),g()};s.thresholds=function(e){return arguments.length?(l=typeof e==="function"?e:Array.isArray(e)?YC(WC.call(e)):YC(e),s):l};s.bandwidth=function(e){if(!arguments.length)return Math.sqrt(a*(a+1));if(!((e=+e)>=0))throw new Error("invalid bandwidth");return a=Math.round((Math.sqrt(4*e*e+1)-1)/2),g()};return s};var oD=["size","smooth"];var fD=["x","y","weight","size","cellSize","bandwidth"];function cD(e){Go.call(this,null,e)}cD.Definition={type:"Contour",metadata:{generates:true},params:[{name:"size",type:"number",array:true,length:2,required:true},{name:"values",type:"number",array:true},{name:"x",type:"field"},{name:"y",type:"field"},{name:"weight",type:"field"},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number"},{name:"count",type:"number"},{name:"smooth",type:"boolean"},{name:"nice",type:"boolean",default:false},{name:"thresholds",type:"number",array:true}]};var lD=Object(dn["x"])(cD,Go);lD.transform=function(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=e.count||10,i,a,u;if(e.values){i=eD();a=oD;u=e.values}else{i=uD();a=fD;u=t.materialize(t.SOURCE).source}i.thresholds(e.thresholds||(e.nice?r:sD(r)));a.forEach(function(t){if(e[t]!=null)i[t](e[t])});if(this.value)n.rem=this.value;u=u&&u.length?i(u).map(xn):[];this.value=n.source=n.add=u;return n};function sD(e){return function(t){var n=Mf(t),r=n[0],i=n[1]-r,a=[],u=1;for(;u<=e;++u)a.push(r+i*u/(e+1));return a}}var dD="Feature";var hD="FeatureCollection";var pD="MultiPoint";function vD(e){Go.call(this,null,e)}vD.Definition={type:"GeoJSON",metadata:{},params:[{name:"fields",type:"field",array:true,length:2},{name:"geojson",type:"field"}]};var gD=Object(dn["x"])(vD,Go);gD.transform=function(e,t){var n=this._features,r=this._points,i=e.fields,a=i&&i[0],u=i&&i[1],o=e.geojson,f=t.ADD,c;c=e.modified()||t.changed(t.REM)||t.modified(Object(dn["g"])(o))||a&&t.modified(Object(dn["g"])(a))||u&&t.modified(Object(dn["g"])(u));if(!this.value||c){f=t.SOURCE;this._features=n=[];this._points=r=[]}if(o){t.visit(f,function(e){n.push(o(e))})}if(a&&u){t.visit(f,function(e){var t=a(e),n=u(e);if(t!=null&&n!=null&&(t=+t)===t&&(n=+n)===n){r.push([t,n])}});n=n.concat({type:dD,geometry:{type:pD,coordinates:r}})}this.value={type:hD,features:n}};var mD=function(){return new yD};function yD(){this.reset()}yD.prototype={constructor:yD,reset:function(){this.s=this.t=0},add:function(e){xD(bD,e,this.t);xD(this,bD.s,this.s);if(this.s)this.t+=bD.t;else this.s=bD.t},valueOf:function(){return this.s}};var bD=new yD;function xD(e,t,n){var r=e.s=t+n,i=r-t,a=r-i;e.t=t-a+(n-i)}var _D=1e-6;var wD=1e-12;var kD=Math.PI;var OD=kD/2;var AD=kD/4;var ED=kD*2;var MD=180/kD;var SD=kD/180;var CD=Math.abs;var DD=Math.atan;var jD=Math.atan2;var ND=Math.cos;var FD=Math.ceil;var TD=Math.exp;var zD=Math.floor;var RD=Math.log;var PD=Math.pow;var LD=Math.sin;var BD=Math.sign||function(e){return e>0?1:e<0?-1:0};var ID=Math.sqrt;var UD=Math.tan;function qD(e){return e>1?0:e<-1?kD:Math.acos(e)}function WD(e){return e>1?OD:e<-1?-OD:Math.asin(e)}function HD(e){return(e=LD(e/2))*e}function GD(){}function YD(e,t){if(e&&VD.hasOwnProperty(e.type)){VD[e.type](e,t)}}var $D={Feature:function(e,t){YD(e.geometry,t)},FeatureCollection:function(e,t){var n=e.features,r=-1,i=n.length;while(++r<i)YD(n[r].geometry,t)}};var VD={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates;t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){var n=e.coordinates,r=-1,i=n.length;while(++r<i)e=n[r],t.point(e[0],e[1],e[2])},LineString:function(e,t){XD(e.coordinates,t,0)},MultiLineString:function(e,t){var n=e.coordinates,r=-1,i=n.length;while(++r<i)XD(n[r],t,0)},Polygon:function(e,t){ZD(e.coordinates,t)},MultiPolygon:function(e,t){var n=e.coordinates,r=-1,i=n.length;while(++r<i)ZD(n[r],t)},GeometryCollection:function(e,t){var n=e.geometries,r=-1,i=n.length;while(++r<i)YD(n[r],t)}};function XD(e,t,n){var r=-1,i=e.length-n,a;t.lineStart();while(++r<i)a=e[r],t.point(a[0],a[1],a[2]);t.lineEnd()}function ZD(e,t){var n=-1,r=e.length;t.polygonStart();while(++n<r)XD(e[n],t,1);t.polygonEnd()}var JD=function(e,t){if(e&&$D.hasOwnProperty(e.type)){$D[e.type](e,t)}else{YD(e,t)}};var QD=mD();var KD=mD(),ej,tj,nj,rj,ij;var aj={point:GD,lineStart:GD,lineEnd:GD,polygonStart:function(){QD.reset();aj.lineStart=uj;aj.lineEnd=oj},polygonEnd:function(){var e=+QD;KD.add(e<0?ED+e:e);this.lineStart=this.lineEnd=this.point=GD},sphere:function(){KD.add(ED)}};function uj(){aj.point=fj}function oj(){cj(ej,tj)}function fj(e,t){aj.point=cj;ej=e,tj=t;e*=SD,t*=SD;nj=e,rj=ND(t=t/2+AD),ij=LD(t)}function cj(e,t){e*=SD,t*=SD;t=t/2+AD;var n=e-nj,r=n>=0?1:-1,i=r*n,a=ND(t),u=LD(t),o=ij*u,f=rj*a+o*ND(i),c=o*r*LD(i);QD.add(jD(c,f));nj=e,rj=a,ij=u}var lj=function(e){KD.reset();JD(e,aj);return KD*2};function sj(e){return[jD(e[1],e[0]),WD(e[2])]}function dj(e){var t=e[0],n=e[1],r=ND(n);return[r*ND(t),r*LD(t),LD(n)]}function hj(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function pj(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function vj(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function gj(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function mj(e){var t=ID(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}var yj,bj,xj,_j,wj,kj,Oj,Aj,Ej=mD(),Mj,Sj;var Cj={point:Dj,lineStart:Nj,lineEnd:Fj,polygonStart:function(){Cj.point=Tj;Cj.lineStart=zj;Cj.lineEnd=Rj;Ej.reset();aj.polygonStart()},polygonEnd:function(){aj.polygonEnd();Cj.point=Dj;Cj.lineStart=Nj;Cj.lineEnd=Fj;if(QD<0)yj=-(xj=180),bj=-(_j=90);else if(Ej>_D)_j=90;else if(Ej<-_D)bj=-90;Sj[0]=yj,Sj[1]=xj}};function Dj(e,t){Mj.push(Sj=[yj=e,xj=e]);if(t<bj)bj=t;if(t>_j)_j=t}function jj(e,t){var n=dj([e*SD,t*SD]);if(Aj){var r=pj(Aj,n),i=[r[1],-r[0],0],a=pj(i,r);mj(a);a=sj(a);var u=e-wj,o=u>0?1:-1,f=a[0]*MD*o,c,l=CD(u)>180;if(l^(o*wj<f&&f<o*e)){c=a[1]*MD;if(c>_j)_j=c}else if(f=(f+360)%360-180,l^(o*wj<f&&f<o*e)){c=-a[1]*MD;if(c<bj)bj=c}else{if(t<bj)bj=t;if(t>_j)_j=t}if(l){if(e<wj){if(Pj(yj,e)>Pj(yj,xj))xj=e}else{if(Pj(e,xj)>Pj(yj,xj))yj=e}}else{if(xj>=yj){if(e<yj)yj=e;if(e>xj)xj=e}else{if(e>wj){if(Pj(yj,e)>Pj(yj,xj))xj=e}else{if(Pj(e,xj)>Pj(yj,xj))yj=e}}}}else{Mj.push(Sj=[yj=e,xj=e])}if(t<bj)bj=t;if(t>_j)_j=t;Aj=n,wj=e}function Nj(){Cj.point=jj}function Fj(){Sj[0]=yj,Sj[1]=xj;Cj.point=Dj;Aj=null}function Tj(e,t){if(Aj){var n=e-wj;Ej.add(CD(n)>180?n+(n>0?360:-360):n)}else{kj=e,Oj=t}aj.point(e,t);jj(e,t)}function zj(){aj.lineStart()}function Rj(){Tj(kj,Oj);aj.lineEnd();if(CD(Ej)>_D)yj=-(xj=180);Sj[0]=yj,Sj[1]=xj;Aj=null}function Pj(e,t){return(t-=e)<0?t+360:t}function Lj(e,t){return e[0]-t[0]}function Bj(e,t){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}var Ij=function(e){var t,n,r,i,a,u,o;_j=xj=-(yj=bj=Infinity);Mj=[];JD(e,Cj);if(n=Mj.length){Mj.sort(Lj);for(t=1,r=Mj[0],a=[r];t<n;++t){i=Mj[t];if(Bj(r,i[0])||Bj(r,i[1])){if(Pj(r[0],i[1])>Pj(r[0],r[1]))r[1]=i[1];if(Pj(i[0],r[1])>Pj(r[0],r[1]))r[0]=i[0]}else{a.push(r=i)}}for(u=-Infinity,n=a.length-1,t=0,r=a[n];t<=n;r=i,++t){i=a[t];if((o=Pj(r[1],i[0]))>u)u=o,yj=i[0],xj=r[1]}}Mj=Sj=null;return yj===Infinity||bj===Infinity?[[NaN,NaN],[NaN,NaN]]:[[yj,bj],[xj,_j]]};var Uj,qj,Wj,Hj,Gj,Yj,$j,Vj,Xj,Zj,Jj,Qj,Kj,eN,tN,nN;var rN={sphere:GD,point:iN,lineStart:uN,lineEnd:cN,polygonStart:function(){rN.lineStart=lN;rN.lineEnd=sN},polygonEnd:function(){rN.lineStart=uN;rN.lineEnd=cN}};function iN(e,t){e*=SD,t*=SD;var n=ND(t);aN(n*ND(e),n*LD(e),LD(t))}function aN(e,t,n){++Uj;Wj+=(e-Wj)/Uj;Hj+=(t-Hj)/Uj;Gj+=(n-Gj)/Uj}function uN(){rN.point=oN}function oN(e,t){e*=SD,t*=SD;var n=ND(t);eN=n*ND(e);tN=n*LD(e);nN=LD(t);rN.point=fN;aN(eN,tN,nN)}function fN(e,t){e*=SD,t*=SD;var n=ND(t),r=n*ND(e),i=n*LD(e),a=LD(t),u=jD(ID((u=tN*a-nN*i)*u+(u=nN*r-eN*a)*u+(u=eN*i-tN*r)*u),eN*r+tN*i+nN*a);qj+=u;Yj+=u*(eN+(eN=r));$j+=u*(tN+(tN=i));Vj+=u*(nN+(nN=a));aN(eN,tN,nN)}function cN(){rN.point=iN}function lN(){rN.point=dN}function sN(){hN(Qj,Kj);rN.point=iN}function dN(e,t){Qj=e,Kj=t;e*=SD,t*=SD;rN.point=hN;var n=ND(t);eN=n*ND(e);tN=n*LD(e);nN=LD(t);aN(eN,tN,nN)}function hN(e,t){e*=SD,t*=SD;var n=ND(t),r=n*ND(e),i=n*LD(e),a=LD(t),u=tN*a-nN*i,o=nN*r-eN*a,f=eN*i-tN*r,c=ID(u*u+o*o+f*f),l=WD(c),s=c&&-l/c;Xj+=s*u;Zj+=s*o;Jj+=s*f;qj+=l;Yj+=l*(eN+(eN=r));$j+=l*(tN+(tN=i));Vj+=l*(nN+(nN=a));aN(eN,tN,nN)}var pN=function(e){Uj=qj=Wj=Hj=Gj=Yj=$j=Vj=Xj=Zj=Jj=0;JD(e,rN);var t=Xj,n=Zj,r=Jj,i=t*t+n*n+r*r;if(i<wD){t=Yj,n=$j,r=Vj;if(qj<_D)t=Wj,n=Hj,r=Gj;i=t*t+n*n+r*r;if(i<wD)return[NaN,NaN]}return[jD(n,t)*MD,WD(r/ID(i))*MD]};var vN=function(e){return function(){return e}};var gN=function(e,t){function n(n,r){return n=e(n,r),t(n[0],n[1])}if(e.invert&&t.invert)n.invert=function(n,r){return n=t.invert(n,r),n&&e.invert(n[0],n[1])};return n};function mN(e,t){return[CD(e)>kD?e+Math.round(-e/ED)*ED:e,t]}mN.invert=mN;function yN(e,t,n){return(e%=ED)?t||n?gN(xN(e),_N(t,n)):xN(e):t||n?_N(t,n):mN}function bN(e){return function(t,n){return t+=e,[t>kD?t-ED:t<-kD?t+ED:t,n]}}function xN(e){var t=bN(e);t.invert=bN(-e);return t}function _N(e,t){var n=ND(e),r=LD(e),i=ND(t),a=LD(t);function u(e,t){var u=ND(t),o=ND(e)*u,f=LD(e)*u,c=LD(t),l=c*n+o*r;return[jD(f*i-l*a,o*n-c*r),WD(l*i+f*a)]}u.invert=function(e,t){var u=ND(t),o=ND(e)*u,f=LD(e)*u,c=LD(t),l=c*i-f*a;return[jD(f*i+c*a,o*n+l*r),WD(l*n-o*r)]};return u}var wN=function(e){e=yN(e[0]*SD,e[1]*SD,e.length>2?e[2]*SD:0);function t(t){t=e(t[0]*SD,t[1]*SD);return t[0]*=MD,t[1]*=MD,t}t.invert=function(t){t=e.invert(t[0]*SD,t[1]*SD);return t[0]*=MD,t[1]*=MD,t};return t};function kN(e,t,n,r,i,a){if(!n)return;var u=ND(t),o=LD(t),f=r*n;if(i==null){i=t+r*ED;a=t-f/2}else{i=ON(u,i);a=ON(u,a);if(r>0?i<a:i>a)i+=r*ED}for(var c,l=i;r>0?l>a:l<a;l-=f){c=sj([u,-o*ND(l),-o*LD(l)]);e.point(c[0],c[1])}}function ON(e,t){t=dj(t),t[0]-=e;mj(t);var n=qD(-t[1]);return((-t[2]<0?-n:n)+ED-_D)%ED}var AN=function(){var e=vN([0,0]),t=vN(90),n=vN(6),r,i,a={point:u};function u(e,t){r.push(e=i(e,t));e[0]*=MD,e[1]*=MD}function o(){var u=e.apply(this,arguments),o=t.apply(this,arguments)*SD,f=n.apply(this,arguments)*SD;r=[];i=yN(-u[0]*SD,-u[1]*SD,0).invert;kN(a,o,f,1);u={type:"Polygon",coordinates:[r]};r=i=null;return u}o.center=function(t){return arguments.length?(e=typeof t==="function"?t:vN([+t[0],+t[1]]),o):e};o.radius=function(e){return arguments.length?(t=typeof e==="function"?e:vN(+e),o):t};o.precision=function(e){return arguments.length?(n=typeof e==="function"?e:vN(+e),o):n};return o};var EN=function(){var e=[],t;return{point:function(e,n){t.push([e,n])},lineStart:function(){e.push(t=[])},lineEnd:GD,rejoin:function(){if(e.length>1)e.push(e.pop().concat(e.shift()))},result:function(){var n=e;e=[];t=null;return n}}};var MN=function(e,t){return CD(e[0]-t[0])<_D&&CD(e[1]-t[1])<_D};function SN(e,t,n,r){this.x=e;this.z=t;this.o=n;this.e=r;this.v=false;this.n=this.p=null}var CN=function(e,t,n,r,i){var a=[],u=[],o,f;e.forEach(function(e){if((t=e.length-1)<=0)return;var t,n=e[0],r=e[t],f;if(MN(n,r)){i.lineStart();for(o=0;o<t;++o)i.point((n=e[o])[0],n[1]);i.lineEnd();return}a.push(f=new SN(n,e,null,true));u.push(f.o=new SN(n,null,f,false));a.push(f=new SN(r,e,null,false));u.push(f.o=new SN(r,null,f,true))});if(!a.length)return;u.sort(t);DN(a);DN(u);for(o=0,f=u.length;o<f;++o){u[o].e=n=!n}var c=a[0],l,s;while(1){var d=c,h=true;while(d.v)if((d=d.n)===c)return;l=d.z;i.lineStart();do{d.v=d.o.v=true;if(d.e){if(h){for(o=0,f=l.length;o<f;++o)i.point((s=l[o])[0],s[1])}else{r(d.x,d.n.x,1,i)}d=d.n}else{if(h){l=d.p.z;for(o=l.length-1;o>=0;--o)i.point((s=l[o])[0],s[1])}else{r(d.x,d.p.x,-1,i)}d=d.p}d=d.o;l=d.z;h=!h}while(!d.v);i.lineEnd()}};function DN(e){if(!(t=e.length))return;var t,n=0,r=e[0],i;while(++n<t){r.n=i=e[n];i.p=r;r=i}r.n=i=e[0];i.p=r}var jN=mD();var NN=function(e,t){var n=t[0],r=t[1],i=LD(r),a=[LD(n),-ND(n),0],u=0,o=0;jN.reset();if(i===1)r=OD+_D;else if(i===-1)r=-OD-_D;for(var f=0,c=e.length;f<c;++f){if(!(s=(l=e[f]).length))continue;var l,s,d=l[s-1],h=d[0],p=d[1]/2+AD,v=LD(p),g=ND(p);for(var m=0;m<s;++m,h=b,v=_,g=w,d=y){var y=l[m],b=y[0],x=y[1]/2+AD,_=LD(x),w=ND(x),k=b-h,O=k>=0?1:-1,A=O*k,E=A>kD,M=v*_;jN.add(jD(M*O*LD(A),g*w+M*ND(A)));u+=E?k+O*ED:k;if(E^h>=n^b>=n){var S=pj(dj(d),dj(y));mj(S);var C=pj(a,S);mj(C);var D=(E^k>=0?-1:1)*WD(C[2]);if(r>D||r===D&&(S[0]||S[1])){o+=E^k>=0?1:-1}}}}return(u<-_D||u<_D&&jN<-_D)^o&1};var FN=function(e,t){return e<t?-1:e>t?1:e>=t?0:NaN};var TN=function(e){if(e.length===1)e=zN(e);return{left:function(t,n,r,i){if(r==null)r=0;if(i==null)i=t.length;while(r<i){var a=r+i>>>1;if(e(t[a],n)<0)r=a+1;else i=a}return r},right:function(t,n,r,i){if(r==null)r=0;if(i==null)i=t.length;while(r<i){var a=r+i>>>1;if(e(t[a],n)>0)i=a;else r=a+1}return r}}};function zN(e){return function(t,n){return FN(e(t),n)}}var RN=TN(FN);var PN=RN.right;var LN=RN.left;var BN=PN;var IN=function(e,t){if(t==null)t=UN;var n=0,r=e.length-1,i=e[0],a=new Array(r<0?0:r);while(n<r)a[n]=t(i,i=e[++n]);return a};function UN(e,t){return[e,t]}var qN=function(e,t,n){var r=e.length,i=t.length,a=new Array(r*i),u,o,f,c;if(n==null)n=UN;for(u=f=0;u<r;++u){for(c=e[u],o=0;o<i;++o,++f){a[f]=n(c,t[o])}}return a};var WN=function(e,t){return t<e?-1:t>e?1:t>=e?0:NaN};var HN=function(e){return e===null?NaN:+e};var GN=function(e,t){var n=e.length,r=0,i=-1,a=0,u,o,f=0;if(t==null){while(++i<n){if(!isNaN(u=HN(e[i]))){o=u-a;a+=o/++r;f+=o*(u-a)}}}else{while(++i<n){if(!isNaN(u=HN(t(e[i],i,e)))){o=u-a;a+=o/++r;f+=o*(u-a)}}}if(r>1)return f/(r-1)};var YN=function(e,t){var n=GN(e,t);return n?Math.sqrt(n):n};var $N=function(e,t){var n=e.length,r=-1,i,a,u;if(t==null){while(++r<n){if((i=e[r])!=null&&i>=i){a=u=i;while(++r<n){if((i=e[r])!=null){if(a>i)a=i;if(u<i)u=i}}}}}else{while(++r<n){if((i=t(e[r],r,e))!=null&&i>=i){a=u=i;while(++r<n){if((i=t(e[r],r,e))!=null){if(a>i)a=i;if(u<i)u=i}}}}}return[a,u]};var VN=Array.prototype;var XN=VN.slice;var ZN=VN.map;var JN=function(e){return function(){return e}};var QN=function(e){return e};var KN=function(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;var r=-1,i=Math.max(0,Math.ceil((t-e)/n))|0,a=new Array(i);while(++r<i){a[r]=e+r*n}return a};var eF=Math.sqrt(50),tF=Math.sqrt(10),nF=Math.sqrt(2);var rF=function(e,t,n){var r,i=-1,a,u,o;t=+t,e=+e,n=+n;if(e===t&&n>0)return[e];if(r=t<e)a=e,e=t,t=a;if((o=iF(e,t,n))===0||!isFinite(o))return[];if(o>0){e=Math.ceil(e/o);t=Math.floor(t/o);u=new Array(a=Math.ceil(t-e+1));while(++i<a)u[i]=(e+i)*o}else{e=Math.floor(e*o);t=Math.ceil(t*o);u=new Array(a=Math.ceil(e-t+1));while(++i<a)u[i]=(e-i)/o}if(r)u.reverse();return u};function iF(e,t,n){var r=(t-e)/Math.max(0,n),i=Math.floor(Math.log(r)/Math.LN10),a=r/Math.pow(10,i);return i>=0?(a>=eF?10:a>=tF?5:a>=nF?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(a>=eF?10:a>=tF?5:a>=nF?2:1)}function aF(e,t,n){var r=Math.abs(t-e)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),a=r/i;if(a>=eF)i*=10;else if(a>=tF)i*=5;else if(a>=nF)i*=2;return t<e?-i:i}var uF=function(e){return Math.ceil(Math.log(e.length)/Math.LN2)+1};var oF=function(){var e=QN,t=$N,n=uF;function r(r){var i,a=r.length,u,o=new Array(a);for(i=0;i<a;++i){o[i]=e(r[i],i,r)}var f=t(o),c=f[0],l=f[1],s=n(o,c,l);if(!Array.isArray(s)){s=aF(c,l,s);s=KN(Math.ceil(c/s)*s,l,s)}var d=s.length;while(s[0]<=c)s.shift(),--d;while(s[d-1]>l)s.pop(),--d;var h=new Array(d+1),p;for(i=0;i<=d;++i){p=h[i]=[];p.x0=i>0?s[i-1]:c;p.x1=i<d?s[i]:l}for(i=0;i<a;++i){u=o[i];if(c<=u&&u<=l){h[BN(s,u,0,d)].push(r[i])}}return h}r.value=function(t){return arguments.length?(e=typeof t==="function"?t:JN(t),r):e};r.domain=function(e){return arguments.length?(t=typeof e==="function"?e:JN([e[0],e[1]]),r):t};r.thresholds=function(e){return arguments.length?(n=typeof e==="function"?e:Array.isArray(e)?JN(XN.call(e)):JN(e),r):n};return r};var fF=function(e,t,n){if(n==null)n=HN;if(!(r=e.length))return;if((t=+t)<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,i=(r-1)*t,a=Math.floor(i),u=+n(e[a],a,e),o=+n(e[a+1],a+1,e);return u+(o-u)*(i-a)};var cF=function(e,t,n){e=ZN.call(e,HN).sort(FN);return Math.ceil((n-t)/(2*(fF(e,.75)-fF(e,.25))*Math.pow(e.length,-1/3)))};var lF=function(e,t,n){return Math.ceil((n-t)/(3.5*YN(e)*Math.pow(e.length,-1/3)))};var sF=function(e,t){var n=e.length,r=-1,i,a;if(t==null){while(++r<n){if((i=e[r])!=null&&i>=i){a=i;while(++r<n){if((i=e[r])!=null&&i>a){a=i}}}}}else{while(++r<n){if((i=t(e[r],r,e))!=null&&i>=i){a=i;while(++r<n){if((i=t(e[r],r,e))!=null&&i>a){a=i}}}}}return a};var dF=function(e,t){var n=e.length,r=n,i=-1,a,u=0;if(t==null){while(++i<n){if(!isNaN(a=HN(e[i])))u+=a;else--r}}else{while(++i<n){if(!isNaN(a=HN(t(e[i],i,e))))u+=a;else--r}}if(r)return u/r};var hF=function(e,t){var n=e.length,r=-1,i,a=[];if(t==null){while(++r<n){if(!isNaN(i=HN(e[r]))){a.push(i)}}}else{while(++r<n){if(!isNaN(i=HN(t(e[r],r,e)))){a.push(i)}}}return fF(a.sort(FN),.5)};var pF=function(e){var t=e.length,n,r=-1,i=0,a,u;while(++r<t)i+=e[r].length;a=new Array(i);while(--t>=0){u=e[t];n=u.length;while(--n>=0){a[--i]=u[n]}}return a};var vF=function(e,t){var n=e.length,r=-1,i,a;if(t==null){while(++r<n){if((i=e[r])!=null&&i>=i){a=i;while(++r<n){if((i=e[r])!=null&&a>i){a=i}}}}}else{while(++r<n){if((i=t(e[r],r,e))!=null&&i>=i){a=i;while(++r<n){if((i=t(e[r],r,e))!=null&&a>i){a=i}}}}}return a};var gF=function(e,t){var n=t.length,r=new Array(n);while(n--)r[n]=e[t[n]];return r};var mF=function(e,t){if(!(n=e.length))return;var n,r=0,i=0,a,u=e[i];if(t==null)t=FN;while(++r<n){if(t(a=e[r],u)<0||t(u,u)!==0){u=a,i=r}}if(t(u,u)===0)return i};var yF=function(e,t,n){var r=(n==null?e.length:n)-(t=t==null?0:+t),i,a;while(r){a=Math.random()*r--|0;i=e[r+t];e[r+t]=e[a+t];e[a+t]=i}return e};var bF=function(e,t){var n=e.length,r=-1,i,a=0;if(t==null){while(++r<n){if(i=+e[r])a+=i}}else{while(++r<n){if(i=+t(e[r],r,e))a+=i}}return a};var xF=function(e){if(!(a=e.length))return[];for(var t=-1,n=vF(e,_F),r=new Array(n);++t<n;){for(var i=-1,a,u=r[t]=new Array(a);++i<a;){u[i]=e[i][t]}}return r};function _F(e){return e.length}var wF=function(){return xF(arguments)};var kF=function(e,t,n,r){return function(i){var a=t(i),u=EN(),o=t(u),f=false,c,l,s;var d={point:h,lineStart:v,lineEnd:g,polygonStart:function(){d.point=m;d.lineStart=y;d.lineEnd=b;l=[];c=[]},polygonEnd:function(){d.point=h;d.lineStart=v;d.lineEnd=g;l=pF(l);var e=NN(c,r);if(l.length){if(!f)i.polygonStart(),f=true;CN(l,AF,e,n,i)}else if(e){if(!f)i.polygonStart(),f=true;i.lineStart();n(null,null,1,i);i.lineEnd()}if(f)i.polygonEnd(),f=false;l=c=null},sphere:function(){i.polygonStart();i.lineStart();n(null,null,1,i);i.lineEnd();i.polygonEnd()}};function h(t,n){if(e(t,n))i.point(t,n)}function p(e,t){a.point(e,t)}function v(){d.point=p;a.lineStart()}function g(){d.point=h;a.lineEnd()}function m(e,t){s.push([e,t]);o.point(e,t)}function y(){o.lineStart();s=[]}function b(){m(s[0][0],s[0][1]);o.lineEnd();var e=o.clean(),t=u.result(),n,r=t.length,a,d,h;s.pop();c.push(s);s=null;if(!r)return;if(e&1){d=t[0];if((a=d.length-1)>0){if(!f)i.polygonStart(),f=true;i.lineStart();for(n=0;n<a;++n)i.point((h=d[n])[0],h[1]);i.lineEnd()}return}if(r>1&&e&2)t.push(t.pop().concat(t.shift()));l.push(t.filter(OF))}return d}};function OF(e){return e.length>1}function AF(e,t){return((e=e.x)[0]<0?e[1]-OD-_D:OD-e[1])-((t=t.x)[0]<0?t[1]-OD-_D:OD-t[1])}var EF=kF(function(){return true},MF,CF,[-kD,-OD]);function MF(e){var t=NaN,n=NaN,r=NaN,i;return{lineStart:function(){e.lineStart();i=1},point:function(a,u){var o=a>0?kD:-kD,f=CD(a-t);if(CD(f-kD)<_D){e.point(t,n=(n+u)/2>0?OD:-OD);e.point(r,n);e.lineEnd();e.lineStart();e.point(o,n);e.point(a,n);i=0}else if(r!==o&&f>=kD){if(CD(t-r)<_D)t-=r*_D;if(CD(a-o)<_D)a-=o*_D;n=SF(t,n,a,u);e.point(r,n);e.lineEnd();e.lineStart();e.point(o,n);i=0}e.point(t=a,n=u);r=o},lineEnd:function(){e.lineEnd();t=n=NaN},clean:function(){return 2-i}}}function SF(e,t,n,r){var i,a,u=LD(e-n);return CD(u)>_D?DD((LD(t)*(a=ND(r))*LD(n)-LD(r)*(i=ND(t))*LD(e))/(i*a*u)):(t+r)/2}function CF(e,t,n,r){var i;if(e==null){i=n*OD;r.point(-kD,i);r.point(0,i);r.point(kD,i);r.point(kD,0);r.point(kD,-i);r.point(0,-i);r.point(-kD,-i);r.point(-kD,0);r.point(-kD,i)}else if(CD(e[0]-t[0])>_D){var a=e[0]<t[0]?kD:-kD;i=n*a/2;r.point(-a,i);r.point(0,i);r.point(a,i)}else{r.point(t[0],t[1])}}var DF=function(e){var t=ND(e),n=6*SD,r=t>0,i=CD(t)>_D;function a(t,r,i,a){kN(a,e,n,i,t,r)}function u(e,n){return ND(e)*ND(n)>t}function o(e){var t,n,a,o,l;return{lineStart:function(){o=a=false;l=1},point:function(s,d){var h=[s,d],p,v=u(s,d),g=r?v?0:c(s,d):v?c(s+(s<0?kD:-kD),d):0;if(!t&&(o=a=v))e.lineStart();if(v!==a){p=f(t,h);if(!p||MN(t,p)||MN(h,p)){h[0]+=_D;h[1]+=_D;v=u(h[0],h[1])}}if(v!==a){l=0;if(v){e.lineStart();p=f(h,t);e.point(p[0],p[1])}else{p=f(t,h);e.point(p[0],p[1]);e.lineEnd()}t=p}else if(i&&t&&r^v){var m;if(!(g&n)&&(m=f(h,t,true))){l=0;if(r){e.lineStart();e.point(m[0][0],m[0][1]);e.point(m[1][0],m[1][1]);e.lineEnd()}else{e.point(m[1][0],m[1][1]);e.lineEnd();e.lineStart();e.point(m[0][0],m[0][1])}}}if(v&&(!t||!MN(t,h))){e.point(h[0],h[1])}t=h,a=v,n=g},lineEnd:function(){if(a)e.lineEnd();t=null},clean:function(){return l|(o&&a)<<1}}}function f(e,n,r){var i=dj(e),a=dj(n);var u=[1,0,0],o=pj(i,a),f=hj(o,o),c=o[0],l=f-c*c;if(!l)return!r&&e;var s=t*f/l,d=-t*c/l,h=pj(u,o),p=gj(u,s),v=gj(o,d);vj(p,v);var g=h,m=hj(p,g),y=hj(g,g),b=m*m-y*(hj(p,p)-1);if(b<0)return;var x=ID(b),_=gj(g,(-m-x)/y);vj(_,p);_=sj(_);if(!r)return _;var w=e[0],k=n[0],O=e[1],A=n[1],E;if(k<w)E=w,w=k,k=E;var M=k-w,S=CD(M-kD)<_D,C=S||M<_D;if(!S&&A<O)E=O,O=A,A=E;if(C?S?O+A>0^_[1]<(CD(_[0]-w)<_D?O:A):O<=_[1]&&_[1]<=A:M>kD^(w<=_[0]&&_[0]<=k)){var D=gj(g,(-m+x)/y);vj(D,p);return[_,sj(D)]}}function c(t,n){var i=r?e:kD-e,a=0;if(t<-i)a|=1;else if(t>i)a|=2;if(n<-i)a|=4;else if(n>i)a|=8;return a}return kF(u,o,a,r?[0,-e]:[-kD,e-kD])};var jF=function(e,t,n,r,i,a){var u=e[0],o=e[1],f=t[0],c=t[1],l=0,s=1,d=f-u,h=c-o,p;p=n-u;if(!d&&p>0)return;p/=d;if(d<0){if(p<l)return;if(p<s)s=p}else if(d>0){if(p>s)return;if(p>l)l=p}p=i-u;if(!d&&p<0)return;p/=d;if(d<0){if(p>s)return;if(p>l)l=p}else if(d>0){if(p<l)return;if(p<s)s=p}p=r-o;if(!h&&p>0)return;p/=h;if(h<0){if(p<l)return;if(p<s)s=p}else if(h>0){if(p>s)return;if(p>l)l=p}p=a-o;if(!h&&p<0)return;p/=h;if(h<0){if(p>s)return;if(p>l)l=p}else if(h>0){if(p<l)return;if(p<s)s=p}if(l>0)e[0]=u+l*d,e[1]=o+l*h;if(s<1)t[0]=u+s*d,t[1]=o+s*h;return true};var NF=1e9,FF=-NF;function TF(e,t,n,r){function i(i,a){return e<=i&&i<=n&&t<=a&&a<=r}function a(i,a,o,c){var l=0,s=0;if(i==null||(l=u(i,o))!==(s=u(a,o))||f(i,a)<0^o>0){do{c.point(l===0||l===3?e:n,l>1?r:t)}while((l=(l+o+4)%4)!==s)}else{c.point(a[0],a[1])}}function u(r,i){return CD(r[0]-e)<_D?i>0?0:3:CD(r[0]-n)<_D?i>0?2:1:CD(r[1]-t)<_D?i>0?1:0:i>0?3:2}function o(e,t){return f(e.x,t.x)}function f(e,t){var n=u(e,1),r=u(t,1);return n!==r?n-r:n===0?t[1]-e[1]:n===1?e[0]-t[0]:n===2?e[1]-t[1]:t[0]-e[0]}return function(u){var f=u,c=EN(),l,s,d,h,p,v,g,m,y,b,x;var _={point:w,lineStart:E,lineEnd:M,polygonStart:O,polygonEnd:A};function w(e,t){if(i(e,t))f.point(e,t)}function k(){var t=0;for(var n=0,i=s.length;n<i;++n){for(var a=s[n],u=1,o=a.length,f=a[0],c,l,d=f[0],h=f[1];u<o;++u){c=d,l=h,f=a[u],d=f[0],h=f[1];if(l<=r){if(h>r&&(d-c)*(r-l)>(h-l)*(e-c))++t}else{if(h<=r&&(d-c)*(r-l)<(h-l)*(e-c))--t}}}return t}function O(){f=c,l=[],s=[],x=true}function A(){var e=k(),t=x&&e,n=(l=pF(l)).length;if(t||n){u.polygonStart();if(t){u.lineStart();a(null,null,1,u);u.lineEnd()}if(n){CN(l,o,e,a,u)}u.polygonEnd()}f=u,l=s=d=null}function E(){_.point=S;if(s)s.push(d=[]);b=true;y=false;g=m=NaN}function M(){if(l){S(h,p);if(v&&y)c.rejoin();l.push(c.result())}_.point=w;if(y)f.lineEnd()}function S(a,u){var o=i(a,u);if(s)d.push([a,u]);if(b){h=a,p=u,v=o;b=false;if(o){f.lineStart();f.point(a,u)}}else{if(o&&y)f.point(a,u);else{var c=[g=Math.max(FF,Math.min(NF,g)),m=Math.max(FF,Math.min(NF,m))],l=[a=Math.max(FF,Math.min(NF,a)),u=Math.max(FF,Math.min(NF,u))];if(jF(c,l,e,t,n,r)){if(!y){f.lineStart();f.point(c[0],c[1])}f.point(l[0],l[1]);if(!o)f.lineEnd();x=false}else if(o){f.lineStart();f.point(a,u);x=false}}}g=a,m=u,y=o}return _}}var zF=function(){var e=0,t=0,n=960,r=500,i,a,u;return u={stream:function(u){return i&&a===u?i:i=TF(e,t,n,r)(a=u)},extent:function(o){return arguments.length?(e=+o[0][0],t=+o[0][1],n=+o[1][0],r=+o[1][1],i=a=null,u):[[e,t],[n,r]]}}};var RF=mD(),PF,LF,BF;var IF={sphere:GD,point:GD,lineStart:UF,lineEnd:GD,polygonStart:GD,polygonEnd:GD};function UF(){IF.point=WF;IF.lineEnd=qF}function qF(){IF.point=IF.lineEnd=GD}function WF(e,t){e*=SD,t*=SD;PF=e,LF=LD(t),BF=ND(t);IF.point=HF}function HF(e,t){e*=SD,t*=SD;var n=LD(t),r=ND(t),i=CD(e-PF),a=ND(i),u=LD(i),o=r*u,f=BF*n-LF*r*a,c=LF*n+BF*r*a;RF.add(jD(ID(o*o+f*f),c));PF=e,LF=n,BF=r}var GF=function(e){RF.reset();JD(e,IF);return+RF};var YF=[null,null],$F={type:"LineString",coordinates:YF};var VF=function(e,t){YF[0]=e;YF[1]=t;return GF($F)};var XF={Feature:function(e,t){return JF(e.geometry,t)},FeatureCollection:function(e,t){var n=e.features,r=-1,i=n.length;while(++r<i)if(JF(n[r].geometry,t))return true;return false}};var ZF={Sphere:function(){return true},Point:function(e,t){return QF(e.coordinates,t)},MultiPoint:function(e,t){var n=e.coordinates,r=-1,i=n.length;while(++r<i)if(QF(n[r],t))return true;return false},LineString:function(e,t){return KF(e.coordinates,t)},MultiLineString:function(e,t){var n=e.coordinates,r=-1,i=n.length;while(++r<i)if(KF(n[r],t))return true;return false},Polygon:function(e,t){return eT(e.coordinates,t)},MultiPolygon:function(e,t){var n=e.coordinates,r=-1,i=n.length;while(++r<i)if(eT(n[r],t))return true;return false},GeometryCollection:function(e,t){var n=e.geometries,r=-1,i=n.length;while(++r<i)if(JF(n[r],t))return true;return false}};function JF(e,t){return e&&ZF.hasOwnProperty(e.type)?ZF[e.type](e,t):false}function QF(e,t){return VF(e,t)===0}function KF(e,t){var n=VF(e[0],e[1]),r=VF(e[0],t),i=VF(t,e[1]);return r+i<=n+_D}function eT(e,t){return!!NN(e.map(tT),nT(t))}function tT(e){return e=e.map(nT),e.pop(),e}function nT(e){return[e[0]*SD,e[1]*SD]}var rT=function(e,t){return(e&&XF.hasOwnProperty(e.type)?XF[e.type]:JF)(e,t)};function iT(e,t,n){var r=KN(e,t-_D,n).concat(t);return function(e){return r.map(function(t){return[e,t]})}}function aT(e,t,n){var r=KN(e,t-_D,n).concat(t);return function(e){return r.map(function(t){return[t,e]})}}function uT(){var e,t,n,r,i,a,u,o,f=10,c=f,l=90,s=360,d,h,p,v,g=2.5;function m(){return{type:"MultiLineString",coordinates:y()}}function y(){return KN(FD(r/l)*l,n,l).map(p).concat(KN(FD(o/s)*s,u,s).map(v)).concat(KN(FD(t/f)*f,e,f).filter(function(e){return CD(e%l)>_D}).map(d)).concat(KN(FD(a/c)*c,i,c).filter(function(e){return CD(e%s)>_D}).map(h))}m.lines=function(){return y().map(function(e){return{type:"LineString",coordinates:e}})};m.outline=function(){return{type:"Polygon",coordinates:[p(r).concat(v(u).slice(1),p(n).reverse().slice(1),v(o).reverse().slice(1))]}};m.extent=function(e){if(!arguments.length)return m.extentMinor();return m.extentMajor(e).extentMinor(e)};m.extentMajor=function(e){if(!arguments.length)return[[r,o],[n,u]];r=+e[0][0],n=+e[1][0];o=+e[0][1],u=+e[1][1];if(r>n)e=r,r=n,n=e;if(o>u)e=o,o=u,u=e;return m.precision(g)};m.extentMinor=function(n){if(!arguments.length)return[[t,a],[e,i]];t=+n[0][0],e=+n[1][0];a=+n[0][1],i=+n[1][1];if(t>e)n=t,t=e,e=n;if(a>i)n=a,a=i,i=n;return m.precision(g)};m.step=function(e){if(!arguments.length)return m.stepMinor();return m.stepMajor(e).stepMinor(e)};m.stepMajor=function(e){if(!arguments.length)return[l,s];l=+e[0],s=+e[1];return m};m.stepMinor=function(e){if(!arguments.length)return[f,c];f=+e[0],c=+e[1];return m};m.precision=function(f){if(!arguments.length)return g;g=+f;d=iT(a,i,90);h=aT(t,e,g);p=iT(o,u,90);v=aT(r,n,g);return m};return m.extentMajor([[-180,-90+_D],[180,90-_D]]).extentMinor([[-180,-80-_D],[180,80+_D]])}function oT(){return uT()()}var fT=function(e,t){var n=e[0]*SD,r=e[1]*SD,i=t[0]*SD,a=t[1]*SD,u=ND(r),o=LD(r),f=ND(a),c=LD(a),l=u*ND(n),s=u*LD(n),d=f*ND(i),h=f*LD(i),p=2*WD(ID(HD(a-r)+u*f*HD(i-n))),v=LD(p);var g=p?function(e){var t=LD(e*=p)/v,n=LD(p-e)/v,r=n*l+t*d,i=n*s+t*h,a=n*o+t*c;return[jD(i,r)*MD,jD(a,ID(r*r+i*i))*MD]}:function(){return[n*MD,r*MD]};g.distance=p;return g};var cT=function(e){return e};var lT=mD(),sT=mD(),dT,hT,pT,vT;var gT={point:GD,lineStart:GD,lineEnd:GD,polygonStart:function(){gT.lineStart=mT;gT.lineEnd=xT},polygonEnd:function(){gT.lineStart=gT.lineEnd=gT.point=GD;lT.add(CD(sT));sT.reset()},result:function(){var e=lT/2;lT.reset();return e}};function mT(){gT.point=yT}function yT(e,t){gT.point=bT;dT=pT=e,hT=vT=t}function bT(e,t){sT.add(vT*e-pT*t);pT=e,vT=t}function xT(){bT(dT,hT)}var _T=gT;var wT=Infinity,kT=wT,OT=-wT,AT=OT;var ET={point:MT,lineStart:GD,lineEnd:GD,polygonStart:GD,polygonEnd:GD,result:function(){var e=[[wT,kT],[OT,AT]];OT=AT=-(kT=wT=Infinity);return e}};function MT(e,t){if(e<wT)wT=e;if(e>OT)OT=e;if(t<kT)kT=t;if(t>AT)AT=t}var ST=ET;var CT=0,DT=0,jT=0,NT=0,FT=0,TT=0,zT=0,RT=0,PT=0,LT,BT,IT,UT;var qT={point:WT,lineStart:HT,lineEnd:$T,polygonStart:function(){qT.lineStart=VT;qT.lineEnd=XT},polygonEnd:function(){qT.point=WT;qT.lineStart=HT;qT.lineEnd=$T},result:function(){var e=PT?[zT/PT,RT/PT]:TT?[NT/TT,FT/TT]:jT?[CT/jT,DT/jT]:[NaN,NaN];CT=DT=jT=NT=FT=TT=zT=RT=PT=0;return e}};function WT(e,t){CT+=e;DT+=t;++jT}function HT(){qT.point=GT}function GT(e,t){qT.point=YT;WT(IT=e,UT=t)}function YT(e,t){var n=e-IT,r=t-UT,i=ID(n*n+r*r);NT+=i*(IT+e)/2;FT+=i*(UT+t)/2;TT+=i;WT(IT=e,UT=t)}function $T(){qT.point=WT}function VT(){qT.point=ZT}function XT(){JT(LT,BT)}function ZT(e,t){qT.point=JT;WT(LT=IT=e,BT=UT=t)}function JT(e,t){var n=e-IT,r=t-UT,i=ID(n*n+r*r);NT+=i*(IT+e)/2;FT+=i*(UT+t)/2;TT+=i;i=UT*e-IT*t;zT+=i*(IT+e);RT+=i*(UT+t);PT+=i*3;WT(IT=e,UT=t)}var QT=qT;function KT(e){this._context=e}KT.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){if(this._line===0)this._context.closePath();this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._context.moveTo(e,t);this._point=1;break}case 1:{this._context.lineTo(e,t);break}default:{this._context.moveTo(e+this._radius,t);this._context.arc(e,t,this._radius,0,ED);break}}},result:GD};var ez=mD(),tz,nz,rz,iz,az;var uz={point:GD,lineStart:function(){uz.point=oz},lineEnd:function(){if(tz)fz(nz,rz);uz.point=GD},polygonStart:function(){tz=true},polygonEnd:function(){tz=null},result:function(){var e=+ez;ez.reset();return e}};function oz(e,t){uz.point=fz;nz=iz=e,rz=az=t}function fz(e,t){iz-=e,az-=t;ez.add(ID(iz*iz+az*az));iz=e,az=t}var cz=uz;function lz(){this._string=[]}lz.prototype={_radius:4.5,_circle:sz(4.5),pointRadius:function(e){if((e=+e)!==this._radius)this._radius=e,this._circle=null;return this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){if(this._line===0)this._string.push("Z");this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._string.push("M",e,",",t);this._point=1;break}case 1:{this._string.push("L",e,",",t);break}default:{if(this._circle==null)this._circle=sz(this._radius);this._string.push("M",e,",",t,this._circle);break}}},result:function(){if(this._string.length){var e=this._string.join("");this._string=[];return e}else{return null}}};function sz(e){return"m0,"+e+"a"+e+","+e+" 0 1,1 0,"+-2*e+"a"+e+","+e+" 0 1,1 0,"+2*e+"z"}var dz=function(e,t){var n=4.5,r,i;function a(e){if(e){if(typeof n==="function")i.pointRadius(+n.apply(this,arguments));JD(e,r(i))}return i.result()}a.area=function(e){JD(e,r(_T));return _T.result()};a.measure=function(e){JD(e,r(cz));return cz.result()};a.bounds=function(e){JD(e,r(ST));return ST.result()};a.centroid=function(e){JD(e,r(QT));return QT.result()};a.projection=function(t){return arguments.length?(r=t==null?(e=null,cT):(e=t).stream,a):e};a.context=function(e){if(!arguments.length)return t;i=e==null?(t=null,new lz):new KT(t=e);if(typeof n!=="function")i.pointRadius(n);return a};a.pointRadius=function(e){if(!arguments.length)return n;n=typeof e==="function"?e:(i.pointRadius(+e),+e);return a};return a.projection(e).context(t)};var hz=function(e){return{stream:pz(e)}};function pz(e){return function(t){var n=new vz;for(var r in e)n[r]=e[r];n.stream=t;return n}}function vz(){}vz.prototype={constructor:vz,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function gz(e,t,n){var r=e.clipExtent&&e.clipExtent();e.scale(150).translate([0,0]);if(r!=null)e.clipExtent(null);JD(n,e.stream(ST));t(ST.result());if(r!=null)e.clipExtent(r);return e}function mz(e,t,n){return gz(e,function(n){var r=t[1][0]-t[0][0],i=t[1][1]-t[0][1],a=Math.min(r/(n[1][0]-n[0][0]),i/(n[1][1]-n[0][1])),u=+t[0][0]+(r-a*(n[1][0]+n[0][0]))/2,o=+t[0][1]+(i-a*(n[1][1]+n[0][1]))/2;e.scale(150*a).translate([u,o])},n)}function yz(e,t,n){return mz(e,[[0,0],t],n)}function bz(e,t,n){return gz(e,function(n){var r=+t,i=r/(n[1][0]-n[0][0]),a=(r-i*(n[1][0]+n[0][0]))/2,u=-i*n[0][1];e.scale(150*i).translate([a,u])},n)}function xz(e,t,n){return gz(e,function(n){var r=+t,i=r/(n[1][1]-n[0][1]),a=-i*n[0][0],u=(r-i*(n[1][1]+n[0][1]))/2;e.scale(150*i).translate([a,u])},n)}var _z=16,wz=ND(30*SD);var kz=function(e,t){return+t?Az(e,t):Oz(e)};function Oz(e){return pz({point:function(t,n){t=e(t,n);this.stream.point(t[0],t[1])}})}function Az(e,t){function n(r,i,a,u,o,f,c,l,s,d,h,p,v,g){var m=c-r,y=l-i,b=m*m+y*y;if(b>4*t&&v--){var x=u+d,_=o+h,w=f+p,k=ID(x*x+_*_+w*w),O=WD(w/=k),A=CD(CD(w)-1)<_D||CD(a-s)<_D?(a+s)/2:jD(_,x),E=e(A,O),M=E[0],S=E[1],C=M-r,D=S-i,j=y*C-m*D;if(j*j/b>t||CD((m*C+y*D)/b-.5)>.3||u*d+o*h+f*p<wz){n(r,i,a,u,o,f,M,S,A,x/=k,_/=k,w,v,g);g.point(M,S);n(M,S,A,x,_,w,c,l,s,d,h,p,v,g)}}}return function(t){var r,i,a,u,o,f,c,l,s,d,h,p;var v={point:g,lineStart:m,lineEnd:b,polygonStart:function(){t.polygonStart();v.lineStart=x},polygonEnd:function(){t.polygonEnd();v.lineStart=m}};function g(n,r){n=e(n,r);t.point(n[0],n[1])}function m(){l=NaN;v.point=y;t.lineStart()}function y(r,i){var a=dj([r,i]),u=e(r,i);n(l,s,c,d,h,p,l=u[0],s=u[1],c=r,d=a[0],h=a[1],p=a[2],_z,t);t.point(l,s)}function b(){v.point=g;t.lineEnd()}function x(){m();v.point=_;v.lineEnd=w}function _(e,t){y(r=e,t),i=l,a=s,u=d,o=h,f=p;v.point=y}function w(){n(l,s,c,d,h,p,i,a,r,u,o,f,_z,t);v.lineEnd=b;b()}return v}}var Ez=pz({point:function(e,t){this.stream.point(e*SD,t*SD)}});function Mz(e){return pz({point:function(t,n){var r=e(t,n);return this.stream.point(r[0],r[1])}})}function Sz(e,t,n){function r(r,i){return[t+e*r,n-e*i]}r.invert=function(r,i){return[(r-t)/e,(n-i)/e]};return r}function Cz(e,t,n,r){var i=ND(r),a=LD(r),u=i*e,o=a*e,f=i/e,c=a/e,l=(a*n-i*t)/e,s=(a*t+i*n)/e;function d(e,r){return[u*e-o*r+t,n-o*e-u*r]}d.invert=function(e,t){return[f*e-c*t+l,s-c*e-f*t]};return d}function Dz(e){return jz(function(){return e})()}function jz(e){var t,n=150,r=480,i=250,a=0,u=0,o=0,f=0,c=0,l,s=0,d=null,h=EF,p=null,v,g,m,y=cT,b=.5,x,_,w,k,O;function A(e){return w(e[0]*SD,e[1]*SD)}function E(e){e=w.invert(e[0],e[1]);return e&&[e[0]*MD,e[1]*MD]}A.stream=function(e){return k&&O===e?k:k=Ez(Mz(l)(h(x(y(O=e)))))};A.preclip=function(e){return arguments.length?(h=e,d=undefined,S()):h};A.postclip=function(e){return arguments.length?(y=e,p=v=g=m=null,S()):y};A.clipAngle=function(e){return arguments.length?(h=+e?DF(d=e*SD):(d=null,EF),S()):d*MD};A.clipExtent=function(e){return arguments.length?(y=e==null?(p=v=g=m=null,cT):TF(p=+e[0][0],v=+e[0][1],g=+e[1][0],m=+e[1][1]),S()):p==null?null:[[p,v],[g,m]]};A.scale=function(e){return arguments.length?(n=+e,M()):n};A.translate=function(e){return arguments.length?(r=+e[0],i=+e[1],M()):[r,i]};A.center=function(e){return arguments.length?(a=e[0]%360*SD,u=e[1]%360*SD,M()):[a*MD,u*MD]};A.rotate=function(e){return arguments.length?(o=e[0]%360*SD,f=e[1]%360*SD,c=e.length>2?e[2]%360*SD:0,M()):[o*MD,f*MD,c*MD]};A.angle=function(e){return arguments.length?(s=e%360*SD,M()):s*MD};A.precision=function(e){return arguments.length?(x=kz(_,b=e*e),S()):ID(b)};A.fitExtent=function(e,t){return mz(A,e,t)};A.fitSize=function(e,t){return yz(A,e,t)};A.fitWidth=function(e,t){return bz(A,e,t)};A.fitHeight=function(e,t){return xz(A,e,t)};function M(){var e=Cz(n,0,0,s).apply(null,t(a,u)),d=(s?Cz:Sz)(n,r-e[0],i-e[1],s);l=yN(o,f,c);_=gN(t,d);w=gN(l,_);x=kz(_,b);return S()}function S(){k=O=null;return A}return function(){t=e.apply(this,arguments);A.invert=t.invert&&E;return M()}}function Nz(e){var t=0,n=kD/3,r=jz(e),i=r(t,n);i.parallels=function(e){return arguments.length?r(t=e[0]*SD,n=e[1]*SD):[t*MD,n*MD]};return i}function Fz(e){var t=ND(e);function n(e,n){return[e*t,LD(n)/t]}n.invert=function(e,n){return[e/t,WD(n*t)]};return n}function Tz(e,t){var n=LD(e),r=(n+LD(t))/2;if(CD(r)<_D)return Fz(e);var i=1+n*(2*r-n),a=ID(i)/r;function u(e,t){var n=ID(i-2*r*LD(t))/r;return[n*LD(e*=r),a-n*ND(e)]}u.invert=function(e,t){var n=a-t;return[jD(e,CD(n))/r*BD(n),WD((i-(e*e+n*n)*r*r)/(2*r))]};return u}var zz=function(){return Nz(Tz).scale(155.424).center([0,33.6442])};var Rz=function(){return zz().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])};function Pz(e){var t=e.length;return{point:function(n,r){var i=-1;while(++i<t)e[i].point(n,r)},sphere:function(){var n=-1;while(++n<t)e[n].sphere()},lineStart:function(){var n=-1;while(++n<t)e[n].lineStart()},lineEnd:function(){var n=-1;while(++n<t)e[n].lineEnd()},polygonStart:function(){var n=-1;while(++n<t)e[n].polygonStart()},polygonEnd:function(){var n=-1;while(++n<t)e[n].polygonEnd()}}}var Lz=function(){var e,t,n=Rz(),r,i=zz().rotate([154,0]).center([-2,58.5]).parallels([55,65]),a,u=zz().rotate([157,0]).center([-3,19.9]).parallels([8,18]),o,f,c={point:function(e,t){f=[e,t]}};function l(e){var t=e[0],n=e[1];return f=null,(r.point(t,n),f)||(a.point(t,n),f)||(o.point(t,n),f)}l.invert=function(e){var t=n.scale(),r=n.translate(),a=(e[0]-r[0])/t,o=(e[1]-r[1])/t;return(o>=.12&&o<.234&&a>=-.425&&a<-.214?i:o>=.166&&o<.234&&a>=-.214&&a<-.115?u:n).invert(e)};l.stream=function(r){return e&&t===r?e:e=Pz([n.stream(t=r),i.stream(r),u.stream(r)])};l.precision=function(e){if(!arguments.length)return n.precision();n.precision(e),i.precision(e),u.precision(e);return s()};l.scale=function(e){if(!arguments.length)return n.scale();n.scale(e),i.scale(e*.35),u.scale(e);return l.translate(n.translate())};l.translate=function(e){if(!arguments.length)return n.translate();var t=n.scale(),f=+e[0],l=+e[1];r=n.translate(e).clipExtent([[f-.455*t,l-.238*t],[f+.455*t,l+.238*t]]).stream(c);a=i.translate([f-.307*t,l+.201*t]).clipExtent([[f-.425*t+_D,l+.12*t+_D],[f-.214*t-_D,l+.234*t-_D]]).stream(c);o=u.translate([f-.205*t,l+.212*t]).clipExtent([[f-.214*t+_D,l+.166*t+_D],[f-.115*t-_D,l+.234*t-_D]]).stream(c);return s()};l.fitExtent=function(e,t){return mz(l,e,t)};l.fitSize=function(e,t){return yz(l,e,t)};l.fitWidth=function(e,t){return bz(l,e,t)};l.fitHeight=function(e,t){return xz(l,e,t)};function s(){e=t=null;return l}return l.scale(1070)};function Bz(e){return function(t,n){var r=ND(t),i=ND(n),a=e(r*i);return[a*i*LD(t),a*LD(n)]}}function Iz(e){return function(t,n){var r=ID(t*t+n*n),i=e(r),a=LD(i),u=ND(i);return[jD(t*a,r*u),WD(r&&n*a/r)]}}var Uz=Bz(function(e){return ID(2/(1+e))});Uz.invert=Iz(function(e){return 2*WD(e/2)});var qz=function(){return Dz(Uz).scale(124.75).clipAngle(180-.001)};var Wz=Bz(function(e){return(e=qD(e))&&e/LD(e)});Wz.invert=Iz(function(e){return e});var Hz=function(){return Dz(Wz).scale(79.4188).clipAngle(180-.001)};function Gz(e,t){return[e,RD(UD((OD+t)/2))]}Gz.invert=function(e,t){return[e,2*DD(TD(t))-OD]};var Yz=function(){return $z(Gz).scale(961/ED)};function $z(e){var t=Dz(e),n=t.center,r=t.scale,i=t.translate,a=t.clipExtent,u=null,o,f,c;t.scale=function(e){return arguments.length?(r(e),l()):r()};t.translate=function(e){return arguments.length?(i(e),l()):i()};t.center=function(e){return arguments.length?(n(e),l()):n()};t.clipExtent=function(e){return arguments.length?(e==null?u=o=f=c=null:(u=+e[0][0],o=+e[0][1],f=+e[1][0],c=+e[1][1]),l()):u==null?null:[[u,o],[f,c]]};function l(){var n=kD*r(),i=t(wN(t.rotate()).invert([0,0]));return a(u==null?[[i[0]-n,i[1]-n],[i[0]+n,i[1]+n]]:e===Gz?[[Math.max(i[0]-n,u),o],[Math.min(i[0]+n,f),c]]:[[u,Math.max(i[1]-n,o)],[f,Math.min(i[1]+n,c)]])}return l()}function Vz(e){return UD((OD+e)/2)}function Xz(e,t){var n=ND(e),r=e===t?LD(e):RD(n/ND(t))/RD(Vz(t)/Vz(e)),i=n*PD(Vz(e),r)/r;if(!r)return Gz;function a(e,t){if(i>0){if(t<-OD+_D)t=-OD+_D}else{if(t>OD-_D)t=OD-_D}var n=i/PD(Vz(t),r);return[n*LD(r*e),i-n*ND(r*e)]}a.invert=function(e,t){var n=i-t,a=BD(r)*ID(e*e+n*n);return[jD(e,CD(n))/r*BD(n),2*DD(PD(i/a,1/r))-OD]};return a}var Zz=function(){return Nz(Xz).scale(109.5).parallels([30,30])};function Jz(e,t){return[e,t]}Jz.invert=Jz;var Qz=function(){return Dz(Jz).scale(152.63)};function Kz(e,t){var n=ND(e),r=e===t?LD(e):(n-ND(t))/(t-e),i=n/r+e;if(CD(r)<_D)return Jz;function a(e,t){var n=i-t,a=r*e;return[n*LD(a),i-n*ND(a)]}a.invert=function(e,t){var n=i-t;return[jD(e,CD(n))/r*BD(n),i-BD(r)*ID(e*e+n*n)]};return a}var eR=function(){return Nz(Kz).scale(131.154).center([0,13.9389])};var tR=1.340264,nR=-.081106,rR=893e-6,iR=.003796,aR=ID(3)/2,uR=12;function oR(e,t){var n=WD(aR*LD(t)),r=n*n,i=r*r*r;return[e*ND(n)/(aR*(tR+3*nR*r+i*(7*rR+9*iR*r))),n*(tR+nR*r+i*(rR+iR*r))]}oR.invert=function(e,t){var n=t,r=n*n,i=r*r*r;for(var a=0,u,o,f;a<uR;++a){o=n*(tR+nR*r+i*(rR+iR*r))-t;f=tR+3*nR*r+i*(7*rR+9*iR*r);n-=u=o/f,r=n*n,i=r*r*r;if(CD(u)<wD)break}return[aR*e*(tR+3*nR*r+i*(7*rR+9*iR*r))/ND(n),WD(LD(n)/aR)]};var fR=function(){return Dz(oR).scale(177.158)};function cR(e,t){var n=ND(t),r=ND(e)*n;return[n*LD(e)/r,LD(t)/r]}cR.invert=Iz(DD);var lR=function(){return Dz(cR).scale(144.049).clipAngle(60)};function sR(e,t,n,r){return e===1&&t===1&&n===0&&r===0?cT:pz({point:function(i,a){this.stream.point(i*e+n,a*t+r)}})}var dR=function(){var e=1,t=0,n=0,r=1,i=1,a=cT,u=null,o,f,c,l=cT,s,d,h;function p(){s=d=null;return h}return h={stream:function(e){return s&&d===e?s:s=a(l(d=e))},postclip:function(e){return arguments.length?(l=e,u=o=f=c=null,p()):l},clipExtent:function(e){return arguments.length?(l=e==null?(u=o=f=c=null,cT):TF(u=+e[0][0],o=+e[0][1],f=+e[1][0],c=+e[1][1]),p()):u==null?null:[[u,o],[f,c]]},scale:function(u){return arguments.length?(a=sR((e=+u)*r,e*i,t,n),p()):e},translate:function(u){return arguments.length?(a=sR(e*r,e*i,t=+u[0],n=+u[1]),p()):[t,n]},reflectX:function(u){return arguments.length?(a=sR(e*(r=u?-1:1),e*i,t,n),p()):r<0},reflectY:function(u){return arguments.length?(a=sR(e*r,e*(i=u?-1:1),t,n),p()):i<0},fitExtent:function(e,t){return mz(h,e,t)},fitSize:function(e,t){return yz(h,e,t)},fitWidth:function(e,t){return bz(h,e,t)},fitHeight:function(e,t){return xz(h,e,t)}}};function hR(e,t){var n=t*t,r=n*n;return[e*(.8707-.131979*n+r*(-.013791+r*(.003971*n-.001529*r))),t*(1.007226+n*(.015085+r*(-.044475+.028874*n-.005916*r)))]}hR.invert=function(e,t){var n=t,r=25,i;do{var a=n*n,u=a*a;n-=i=(n*(1.007226+a*(.015085+u*(-.044475+.028874*a-.005916*u)))-t)/(1.007226+a*(.015085*3+u*(-.044475*7+.028874*9*a-.005916*11*u)))}while(CD(i)>_D&&--r>0);return[e/(.8707+(a=n*n)*(-.131979+a*(-.013791+a*a*a*(.003971-.001529*a)))),n]};var pR=function(){return Dz(hR).scale(175.295)};function vR(e,t){return[ND(t)*LD(e),LD(t)]}vR.invert=Iz(WD);var gR=function(){return Dz(vR).scale(249.5).clipAngle(90+_D)};function mR(e,t){var n=ND(t),r=1+ND(e)*n;return[n*LD(e)/r,LD(t)/r]}mR.invert=Iz(function(e){return 2*DD(e)});var yR=function(){return Dz(mR).scale(250).clipAngle(142)};function bR(e,t){return[RD(UD((OD+t)/2)),-e]}bR.invert=function(e,t){return[-t,2*DD(TD(e))-OD]};var xR=function(){var e=$z(bR),t=e.center,n=e.rotate;e.center=function(e){return arguments.length?t([-e[1],e[0]]):(e=t(),[e[1],-e[0]])};e.rotate=function(e){return arguments.length?n([e[0],e[1],e.length>2?e[2]+90:90]):(e=n(),[e[0],e[1],e[2]-90])};return n([0,0,90]).scale(159.155)};var _R=dz();var wR=["clipAngle","clipExtent","scale","translate","center","rotate","parallels","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];function kR(e,t){return function n(){var r=t();r.type=e;r.path=dz().projection(r);r.copy=r.copy||function(){var e=n();wR.forEach(function(t){if(r.hasOwnProperty(t))e[t](r[t]())});e.path.pointRadius(r.path.pointRadius());return e};return r}}function OR(e,t){if(!e||typeof e!=="string"){throw new Error("Projection type must be a name string.")}e=e.toLowerCase();if(arguments.length>1){ER[e]=kR(e,t);return this}else{return ER.hasOwnProperty(e)?ER[e]:null}}function AR(e){return e&&e.path||_R}var ER={albers:Rz,albersusa:Lz,azimuthalequalarea:qz,azimuthalequidistant:Hz,conicconformal:Zz,conicequalarea:zz,conicequidistant:eR,equirectangular:Qz,gnomonic:lR,identity:dR,mercator:Yz,naturalEarth1:pR,orthographic:gR,stereographic:yR,transversemercator:xR};for(var MR in ER){OR(MR,ER[MR])}function SR(e){Go.call(this,null,e)}SR.Definition={type:"GeoPath",metadata:{modifies:true},params:[{name:"projection",type:"projection"},{name:"field",type:"field"},{name:"pointRadius",type:"number",expr:true},{name:"as",type:"string",default:"path"}]};var CR=Object(dn["x"])(SR,Go);CR.transform=function(e,t){var n=t.fork(t.ALL),r=this.value,i=e.field||dn["w"],a=e.as||"path",u=n.SOURCE;function o(e){e[a]=r(i(e))}if(!r||e.modified()){this.value=r=AR(e.projection);n.materialize().reflow()}else{u=i===dn["w"]||t.modified(i.fields)?n.ADD_MOD:n.ADD}var f=DR(r,e.pointRadius);n.visit(u,o);r.pointRadius(f);return n.modifies(a)};function DR(e,t){var n=e.pointRadius();e.context(null);if(t!=null){e.pointRadius(t)}return n}function jR(e){Go.call(this,null,e)}jR.Definition={type:"GeoPoint",metadata:{modifies:true},params:[{name:"projection",type:"projection",required:true},{name:"fields",type:"field",array:true,required:true,length:2},{name:"as",type:"string",array:true,length:2,default:["x","y"]}]};var NR=Object(dn["x"])(jR,Go);NR.transform=function(e,t){var n=e.projection,r=e.fields[0],i=e.fields[1],a=e.as||["x","y"],u=a[0],o=a[1],f;function c(e){var t=n([r(e),i(e)]);if(t){e[u]=t[0];e[o]=t[1]}else{e[u]=undefined;e[o]=undefined}}if(e.modified()){t=t.materialize().reflow(true).visit(t.SOURCE,c)}else{f=t.modified(r.fields)||t.modified(i.fields);t.visit(f?t.ADD_MOD:t.ADD,c)}return t.modifies(a)};function FR(e){Go.call(this,null,e)}FR.Definition={type:"GeoShape",metadata:{modifies:true},params:[{name:"projection",type:"projection"},{name:"field",type:"field",default:"datum"},{name:"pointRadius",type:"number",expr:true},{name:"as",type:"string",default:"shape"}]};var TR=Object(dn["x"])(FR,Go);TR.transform=function(e,t){var n=t.fork(t.ALL),r=this.value,i=e.field||Object(dn["t"])("datum"),a=e.as||"shape",u=n.ADD_MOD;if(!r||e.modified()){this.value=r=zR(AR(e.projection),i,e.pointRadius);n.materialize().reflow();u=n.SOURCE}n.visit(u,function(e){e[a]=r});return n.modifies(a)};function zR(e,t,n){var r=n==null?function(n){return e(t(n))}:function(r){var i=e.pointRadius(),a=e.pointRadius(n)(t(r));e.pointRadius(i);return a};r.context=function(t){e.context(t);return r};return r}function RR(e){Go.call(this,[],e);this.generator=uT()}RR.Definition={type:"Graticule",metadata:{changes:true},params:[{name:"extent",type:"array",array:true,length:2,content:{type:"number",array:true,length:2}},{name:"extentMajor",type:"array",array:true,length:2,content:{type:"number",array:true,length:2}},{name:"extentMinor",type:"array",array:true,length:2,content:{type:"number",array:true,length:2}},{name:"step",type:"number",array:true,length:2},{name:"stepMajor",type:"number",array:true,length:2,default:[90,360]},{name:"stepMinor",type:"number",array:true,length:2,default:[10,10]},{name:"precision",type:"number",default:2.5}]};var PR=Object(dn["x"])(RR,Go);PR.transform=function(e,t){var n=this.value,r=this.generator,i;if(!n.length||e.modified()){for(var a in e){if(Object(dn["C"])(r[a])){r[a](e[a])}}}i=r();if(n.length){t.mod.push(kn(n[0],i))}else{t.add.push(xn(i))}n[0]=i;return t};function LR(e){Go.call(this,null,e);this.modified(true)}var BR=Object(dn["x"])(LR,Go);BR.transform=function(e,t){var n=this.value;if(!n||e.modified("type")){this.value=n=UR(e.type);wR.forEach(function(t){if(e[t]!=null)qR(n,t,e[t])})}else{wR.forEach(function(t){if(e.modified(t))qR(n,t,e[t])})}if(e.pointRadius!=null)n.path.pointRadius(e.pointRadius);if(e.fit)IR(n,e);return t.fork(t.NO_SOURCE|t.NO_FIELDS)};function IR(e,t){var n=WR(t.fit);t.extent?e.fitExtent(t.extent,n):t.size?e.fitSize(t.size,n):0}function UR(e){var t=OR((e||"mercator").toLowerCase());if(!t)Object(dn["n"])("Unrecognized projection type: "+e);return t()}function qR(e,t,n){if(Object(dn["C"])(e[t]))e[t](n)}function WR(e){e=Object(dn["i"])(e);return e.length===1?e[0]:{type:hD,features:e.reduce(function(e,t){t&&t.type===hD?e.push.apply(e,t.features):Object(dn["z"])(t)?e.push.apply(e,t):e.push(t);return e},[])}}var HR=function(e,t){var n;if(e==null)e=0;if(t==null)t=0;function r(){var r,i=n.length,a,u=0,o=0;for(r=0;r<i;++r){a=n[r],u+=a.x,o+=a.y}for(u=u/i-e,o=o/i-t,r=0;r<i;++r){a=n[r],a.x-=u,a.y-=o}}r.initialize=function(e){n=e};r.x=function(t){return arguments.length?(e=+t,r):e};r.y=function(e){return arguments.length?(t=+e,r):t};return r};var GR=function(e){return function(){return e}};var YR=function(){return(Math.random()-.5)*1e-6};var $R=function(e){var t=+this._x.call(null,e),n=+this._y.call(null,e);return VR(this.cover(t,n),t,n,e)};function VR(e,t,n,r){if(isNaN(t)||isNaN(n))return e;var i,a=e._root,u={data:r},o=e._x0,f=e._y0,c=e._x1,l=e._y1,s,d,h,p,v,g,m,y;if(!a)return e._root=u,e;while(a.length){if(v=t>=(s=(o+c)/2))o=s;else c=s;if(g=n>=(d=(f+l)/2))f=d;else l=d;if(i=a,!(a=a[m=g<<1|v]))return i[m]=u,e}h=+e._x.call(null,a.data);p=+e._y.call(null,a.data);if(t===h&&n===p)return u.next=a,i?i[m]=u:e._root=u,e;do{i=i?i[m]=new Array(4):e._root=new Array(4);if(v=t>=(s=(o+c)/2))o=s;else c=s;if(g=n>=(d=(f+l)/2))f=d;else l=d}while((m=g<<1|v)===(y=(p>=d)<<1|h>=s));return i[y]=a,i[m]=u,e}function XR(e){var t,n,r=e.length,i,a,u=new Array(r),o=new Array(r),f=Infinity,c=Infinity,l=-Infinity,s=-Infinity;for(n=0;n<r;++n){if(isNaN(i=+this._x.call(null,t=e[n]))||isNaN(a=+this._y.call(null,t)))continue;u[n]=i;o[n]=a;if(i<f)f=i;if(i>l)l=i;if(a<c)c=a;if(a>s)s=a}if(f>l||c>s)return this;this.cover(f,c).cover(l,s);for(n=0;n<r;++n){VR(this,u[n],o[n],e[n])}return this}var ZR=function(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,r=this._y0,i=this._x1,a=this._y1;if(isNaN(n)){i=(n=Math.floor(e))+1;a=(r=Math.floor(t))+1}else{var u=i-n,o=this._root,f,c;while(n>e||e>=i||r>t||t>=a){c=(t<r)<<1|e<n;f=new Array(4),f[c]=o,o=f,u*=2;switch(c){case 0:i=n+u,a=r+u;break;case 1:n=i-u,a=r+u;break;case 2:i=n+u,r=a-u;break;case 3:n=i-u,r=a-u;break}}if(this._root&&this._root.length)this._root=o}this._x0=n;this._y0=r;this._x1=i;this._y1=a;return this};var JR=function(){var e=[];this.visit(function(t){if(!t.length)do{e.push(t.data)}while(t=t.next)});return e};var QR=function(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?undefined:[[this._x0,this._y0],[this._x1,this._y1]]};var KR=function(e,t,n,r,i){this.node=e;this.x0=t;this.y0=n;this.x1=r;this.y1=i};var eP=function(e,t,n){var r,i=this._x0,a=this._y0,u,o,f,c,l=this._x1,s=this._y1,d=[],h=this._root,p,v;if(h)d.push(new KR(h,i,a,l,s));if(n==null)n=Infinity;else{i=e-n,a=t-n;l=e+n,s=t+n;n*=n}while(p=d.pop()){if(!(h=p.node)||(u=p.x0)>l||(o=p.y0)>s||(f=p.x1)<i||(c=p.y1)<a)continue;if(h.length){var g=(u+f)/2,m=(o+c)/2;d.push(new KR(h[3],g,m,f,c),new KR(h[2],u,m,g,c),new KR(h[1],g,o,f,m),new KR(h[0],u,o,g,m));if(v=(t>=m)<<1|e>=g){p=d[d.length-1];d[d.length-1]=d[d.length-1-v];d[d.length-1-v]=p}}else{var y=e-+this._x.call(null,h.data),b=t-+this._y.call(null,h.data),x=y*y+b*b;if(x<n){var _=Math.sqrt(n=x);i=e-_,a=t-_;l=e+_,s=t+_;r=h.data}}}return r};var tP=function(e){if(isNaN(l=+this._x.call(null,e))||isNaN(s=+this._y.call(null,e)))return this;var t,n=this._root,r,i,a,u=this._x0,o=this._y0,f=this._x1,c=this._y1,l,s,d,h,p,v,g,m;if(!n)return this;if(n.length)while(true){if(p=l>=(d=(u+f)/2))u=d;else f=d;if(v=s>=(h=(o+c)/2))o=h;else c=h;if(!(t=n,n=n[g=v<<1|p]))return this;if(!n.length)break;if(t[g+1&3]||t[g+2&3]||t[g+3&3])r=t,m=g}while(n.data!==e)if(!(i=n,n=n.next))return this;if(a=n.next)delete n.next;if(i)return a?i.next=a:delete i.next,this;if(!t)return this._root=a,this;a?t[g]=a:delete t[g];if((n=t[0]||t[1]||t[2]||t[3])&&n===(t[3]||t[2]||t[1]||t[0])&&!n.length){if(r)r[m]=n;else this._root=n}return this};function nP(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this}var rP=function(){return this._root};var iP=function(){var e=0;this.visit(function(t){if(!t.length)do{++e}while(t=t.next)});return e};var aP=function(e){var t=[],n,r=this._root,i,a,u,o,f;if(r)t.push(new KR(r,this._x0,this._y0,this._x1,this._y1));while(n=t.pop()){if(!e(r=n.node,a=n.x0,u=n.y0,o=n.x1,f=n.y1)&&r.length){var c=(a+o)/2,l=(u+f)/2;if(i=r[3])t.push(new KR(i,c,l,o,f));if(i=r[2])t.push(new KR(i,a,l,c,f));if(i=r[1])t.push(new KR(i,c,u,o,l));if(i=r[0])t.push(new KR(i,a,u,c,l))}}return this};var uP=function(e){var t=[],n=[],r;if(this._root)t.push(new KR(this._root,this._x0,this._y0,this._x1,this._y1));while(r=t.pop()){var i=r.node;if(i.length){var a,u=r.x0,o=r.y0,f=r.x1,c=r.y1,l=(u+f)/2,s=(o+c)/2;if(a=i[0])t.push(new KR(a,u,o,l,s));if(a=i[1])t.push(new KR(a,l,o,f,s));if(a=i[2])t.push(new KR(a,u,s,l,c));if(a=i[3])t.push(new KR(a,l,s,f,c))}n.push(r)}while(r=n.pop()){e(r.node,r.x0,r.y0,r.x1,r.y1)}return this};function oP(e){return e[0]}var fP=function(e){return arguments.length?(this._x=e,this):this._x};function cP(e){return e[1]}var lP=function(e){return arguments.length?(this._y=e,this):this._y};function sP(e,t,n){var r=new dP(t==null?oP:t,n==null?cP:n,NaN,NaN,NaN,NaN);return e==null?r:r.addAll(e)}function dP(e,t,n,r,i,a){this._x=e;this._y=t;this._x0=n;this._y0=r;this._x1=i;this._y1=a;this._root=undefined}function hP(e){var t={data:e.data},n=t;while(e=e.next)n=n.next={data:e.data};return t}var pP=sP.prototype=dP.prototype;pP.copy=function(){var e=new dP(this._x,this._y,this._x0,this._y0,this._x1,this._y1),t=this._root,n,r;if(!t)return e;if(!t.length)return e._root=hP(t),e;n=[{source:t,target:e._root=new Array(4)}];while(t=n.pop()){for(var i=0;i<4;++i){if(r=t.source[i]){if(r.length)n.push({source:r,target:t.target[i]=new Array(4)});else t.target[i]=hP(r)}}}return e};pP.add=$R;pP.addAll=XR;pP.cover=ZR;pP.data=JR;pP.extent=QR;pP.find=eP;pP.remove=tP;pP.removeAll=nP;pP.root=rP;pP.size=iP;pP.visit=aP;pP.visitAfter=uP;pP.x=fP;pP.y=lP;function vP(e){return e.x+e.vx}function gP(e){return e.y+e.vy}var mP=function(e){var t,n,r=1,i=1;if(typeof e!=="function")e=GR(e==null?1:+e);function a(){var e,a=t.length,o,f,c,l,s,d;for(var h=0;h<i;++h){o=sP(t,vP,gP).visitAfter(u);for(e=0;e<a;++e){f=t[e];s=n[f.index],d=s*s;c=f.x+f.vx;l=f.y+f.vy;o.visit(p)}}function p(e,t,n,i,a){var u=e.data,o=e.r,h=s+o;if(u){if(u.index>f.index){var p=c-u.x-u.vx,v=l-u.y-u.vy,g=p*p+v*v;if(g<h*h){if(p===0)p=YR(),g+=p*p;if(v===0)v=YR(),g+=v*v;g=(h-(g=Math.sqrt(g)))/g*r;f.vx+=(p*=g)*(h=(o*=o)/(d+o));f.vy+=(v*=g)*h;u.vx-=p*(h=1-h);u.vy-=v*h}}return}return t>c+h||i<c-h||n>l+h||a<l-h}}function u(e){if(e.data)return e.r=n[e.data.index];for(var t=e.r=0;t<4;++t){if(e[t]&&e[t].r>e.r){e.r=e[t].r}}}function o(){if(!t)return;var r,i=t.length,a;n=new Array(i);for(r=0;r<i;++r)a=t[r],n[a.index]=+e(a,r,t)}a.initialize=function(e){t=e;o()};a.iterations=function(e){return arguments.length?(i=+e,a):i};a.strength=function(e){return arguments.length?(r=+e,a):r};a.radius=function(t){return arguments.length?(e=typeof t==="function"?t:GR(+t),o(),a):e};return a};function yP(e){return e.index}function bP(e,t){var n=e.get(t);if(!n)throw new Error("missing: "+t);return n}var xP=function(e){var t=yP,n=l,r,i=GR(30),a,u,o,f,c=1;if(e==null)e=[];function l(e){return 1/Math.min(o[e.source.index],o[e.target.index])}function s(t){for(var n=0,i=e.length;n<c;++n){for(var u=0,o,l,s,d,h,p,v;u<i;++u){o=e[u],l=o.source,s=o.target;d=s.x+s.vx-l.x-l.vx||YR();h=s.y+s.vy-l.y-l.vy||YR();p=Math.sqrt(d*d+h*h);p=(p-a[u])/p*t*r[u];d*=p,h*=p;s.vx-=d*(v=f[u]);s.vy-=h*v;l.vx+=d*(v=1-v);l.vy+=h*v}}}function d(){if(!u)return;var n,i=u.length,c=e.length,l=o_(u,t),s;for(n=0,o=new Array(i);n<c;++n){s=e[n],s.index=n;if(typeof s.source!=="object")s.source=bP(l,s.source);if(typeof s.target!=="object")s.target=bP(l,s.target);o[s.source.index]=(o[s.source.index]||0)+1;o[s.target.index]=(o[s.target.index]||0)+1}for(n=0,f=new Array(c);n<c;++n){s=e[n],f[n]=o[s.source.index]/(o[s.source.index]+o[s.target.index])}r=new Array(c),h();a=new Array(c),p()}function h(){if(!u)return;for(var t=0,i=e.length;t<i;++t){r[t]=+n(e[t],t,e)}}function p(){if(!u)return;for(var t=0,n=e.length;t<n;++t){a[t]=+i(e[t],t,e)}}s.initialize=function(e){u=e;d()};s.links=function(t){return arguments.length?(e=t,d(),s):e};s.id=function(e){return arguments.length?(t=e,s):t};s.iterations=function(e){return arguments.length?(c=+e,s):c};s.strength=function(e){return arguments.length?(n=typeof e==="function"?e:GR(+e),h(),s):n};s.distance=function(e){return arguments.length?(i=typeof e==="function"?e:GR(+e),p(),s):i};return s};var _P={value:function(){}};function wP(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n)throw new Error("illegal type: "+r);n[r]=[]}return new kP(n)}function kP(e){this._=e}function OP(e,t){return e.trim().split(/^|\s+/).map(function(e){var n="",r=e.indexOf(".");if(r>=0)n=e.slice(r+1),e=e.slice(0,r);if(e&&!t.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:n}})}kP.prototype=wP.prototype={constructor:kP,on:function(e,t){var n=this._,r=OP(e+"",n),i,a=-1,u=r.length;if(arguments.length<2){while(++a<u)if((i=(e=r[a]).type)&&(i=AP(n[i],e.name)))return i;return}if(t!=null&&typeof t!=="function")throw new Error("invalid callback: "+t);while(++a<u){if(i=(e=r[a]).type)n[i]=EP(n[i],e.name,t);else if(t==null)for(i in n)n[i]=EP(n[i],e.name,null)}return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new kP(e)},call:function(e,t){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,a;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(a=this._[e],r=0,i=a.length;r<i;++r)a[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],i=0,a=r.length;i<a;++i)r[i].value.apply(t,n)}};function AP(e,t){for(var n=0,r=e.length,i;n<r;++n){if((i=e[n]).name===t){return i.value}}}function EP(e,t,n){for(var r=0,i=e.length;r<i;++r){if(e[r].name===t){e[r]=_P,e=e.slice(0,r).concat(e.slice(r+1));break}}if(n!=null)e.push({name:t,value:n});return e}var MP=wP;var SP=0,CP=0,DP=0,jP=1e3,NP,FP,TP=0,zP=0,RP=0,PP=typeof performance==="object"&&performance.now?performance:Date,LP=typeof window==="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function BP(){return zP||(LP(IP),zP=PP.now()+RP)}function IP(){zP=0}function UP(){this._call=this._time=this._next=null}UP.prototype=qP.prototype={constructor:UP,restart:function(e,t,n){if(typeof e!=="function")throw new TypeError("callback is not a function");n=(n==null?BP():+n)+(t==null?0:+t);if(!this._next&&FP!==this){if(FP)FP._next=this;else NP=this;FP=this}this._call=e;this._time=n;$P()},stop:function(){if(this._call){this._call=null;this._time=Infinity;$P()}}};function qP(e,t,n){var r=new UP;r.restart(e,t,n);return r}function WP(){BP();++SP;var e=NP,t;while(e){if((t=zP-e._time)>=0)e._call.call(null,t);e=e._next}--SP}function HP(){zP=(TP=PP.now())+RP;SP=CP=0;try{WP()}finally{SP=0;YP();zP=0}}function GP(){var e=PP.now(),t=e-TP;if(t>jP)RP-=t,TP=e}function YP(){var e,t=NP,n,r=Infinity;while(t){if(t._call){if(r>t._time)r=t._time;e=t,t=t._next}else{n=t._next,t._next=null;t=e?e._next=n:NP=n}}FP=e;$P(r)}function $P(e){if(SP)return;if(CP)CP=clearTimeout(CP);var t=e-zP;if(t>24){if(e<Infinity)CP=setTimeout(HP,e-PP.now()-RP);if(DP)DP=clearInterval(DP)}else{if(!DP)TP=PP.now(),DP=setInterval(GP,jP);SP=1,LP(HP)}}var VP=function(e,t,n){var r=new UP;t=t==null?0:+t;r.restart(function(n){r.stop();e(n+t)},t,n);return r};var XP=function(e,t,n){var r=new UP,i=t;if(t==null)return r.restart(e,t,n),r;t=+t,n=n==null?BP():+n;r.restart(function a(u){u+=i;r.restart(a,i+=t,n);e(u)},t,n);return r};function ZP(e){return e.x}function JP(e){return e.y}var QP=10,KP=Math.PI*(3-Math.sqrt(5));var eL=function(e){var t,n=1,r=.001,i=1-Math.pow(r,1/300),a=0,u=.6,o=o_(),f=qP(l),c=MP("tick","end");if(e==null)e=[];function l(){s();c.call("tick",t);if(n<r){f.stop();c.call("end",t)}}function s(r){var f,c=e.length,l;if(r===undefined)r=1;for(var s=0;s<r;++s){n+=(a-n)*i;o.each(function(e){e(n)});for(f=0;f<c;++f){l=e[f];if(l.fx==null)l.x+=l.vx*=u;else l.x=l.fx,l.vx=0;if(l.fy==null)l.y+=l.vy*=u;else l.y=l.fy,l.vy=0}}return t}function d(){for(var t=0,n=e.length,r;t<n;++t){r=e[t],r.index=t;if(r.fx!=null)r.x=r.fx;if(r.fy!=null)r.y=r.fy;if(isNaN(r.x)||isNaN(r.y)){var i=QP*Math.sqrt(t),a=t*KP;r.x=i*Math.cos(a);r.y=i*Math.sin(a)}if(isNaN(r.vx)||isNaN(r.vy)){r.vx=r.vy=0}}}function h(t){if(t.initialize)t.initialize(e);return t}d();return t={tick:s,restart:function(){return f.restart(l),t},stop:function(){return f.stop(),t},nodes:function(n){return arguments.length?(e=n,d(),o.each(h),t):e},alpha:function(e){return arguments.length?(n=+e,t):n},alphaMin:function(e){return arguments.length?(r=+e,t):r},alphaDecay:function(e){return arguments.length?(i=+e,t):+i},alphaTarget:function(e){return arguments.length?(a=+e,t):a},velocityDecay:function(e){return arguments.length?(u=1-e,t):1-u},force:function(e,n){return arguments.length>1?(n==null?o.remove(e):o.set(e,h(n)),t):o.get(e)},find:function(t,n,r){var i=0,a=e.length,u,o,f,c,l;if(r==null)r=Infinity;else r*=r;for(i=0;i<a;++i){c=e[i];u=t-c.x;o=n-c.y;f=u*u+o*o;if(f<r)l=c,r=f}return l},on:function(e,n){return arguments.length>1?(c.on(e,n),t):c.on(e)}}};var tL=function(){var e,t,n,r=GR(-30),i,a=1,u=Infinity,o=.81;function f(r){var i,a=e.length,u=sP(e,ZP,JP).visitAfter(l);for(n=r,i=0;i<a;++i)t=e[i],u.visit(s)}function c(){if(!e)return;var t,n=e.length,a;i=new Array(n);for(t=0;t<n;++t)a=e[t],i[a.index]=+r(a,t,e)}function l(e){var t=0,n,r,a=0,u,o,f;if(e.length){for(u=o=f=0;f<4;++f){if((n=e[f])&&(r=Math.abs(n.value))){t+=n.value,a+=r,u+=r*n.x,o+=r*n.y}}e.x=u/a;e.y=o/a}else{n=e;n.x=n.data.x;n.y=n.data.y;do{t+=i[n.data.index]}while(n=n.next)}e.value=t}function s(e,r,f,c){if(!e.value)return true;var l=e.x-t.x,s=e.y-t.y,d=c-r,h=l*l+s*s;if(d*d/o<h){if(h<u){if(l===0)l=YR(),h+=l*l;if(s===0)s=YR(),h+=s*s;if(h<a)h=Math.sqrt(a*h);t.vx+=l*e.value*n/h;t.vy+=s*e.value*n/h}return true}else if(e.length||h>=u)return;if(e.data!==t||e.next){if(l===0)l=YR(),h+=l*l;if(s===0)s=YR(),h+=s*s;if(h<a)h=Math.sqrt(a*h)}do{if(e.data!==t){d=i[e.data.index]*n/h;t.vx+=l*d;t.vy+=s*d}}while(e=e.next)}f.initialize=function(t){e=t;c()};f.strength=function(e){return arguments.length?(r=typeof e==="function"?e:GR(+e),c(),f):r};f.distanceMin=function(e){return arguments.length?(a=e*e,f):Math.sqrt(a)};f.distanceMax=function(e){return arguments.length?(u=e*e,f):Math.sqrt(u)};f.theta=function(e){return arguments.length?(o=e*e,f):Math.sqrt(o)};return f};var nL=function(e,t,n){var r,i=GR(.1),a,u;if(typeof e!=="function")e=GR(+e);if(t==null)t=0;if(n==null)n=0;function o(e){for(var i=0,o=r.length;i<o;++i){var f=r[i],c=f.x-t||1e-6,l=f.y-n||1e-6,s=Math.sqrt(c*c+l*l),d=(u[i]-s)*a[i]*e/s;f.vx+=c*d;f.vy+=l*d}}function f(){if(!r)return;var t,n=r.length;a=new Array(n);u=new Array(n);for(t=0;t<n;++t){u[t]=+e(r[t],t,r);a[t]=isNaN(u[t])?0:+i(r[t],t,r)}}o.initialize=function(e){r=e,f()};o.strength=function(e){return arguments.length?(i=typeof e==="function"?e:GR(+e),f(),o):i};o.radius=function(t){return arguments.length?(e=typeof t==="function"?t:GR(+t),f(),o):e};o.x=function(e){return arguments.length?(t=+e,o):t};o.y=function(e){return arguments.length?(n=+e,o):n};return o};var rL=function(e){var t=GR(.1),n,r,i;if(typeof e!=="function")e=GR(e==null?0:+e);function a(e){for(var t=0,a=n.length,u;t<a;++t){u=n[t],u.vx+=(i[t]-u.x)*r[t]*e}}function u(){if(!n)return;var a,u=n.length;r=new Array(u);i=new Array(u);for(a=0;a<u;++a){r[a]=isNaN(i[a]=+e(n[a],a,n))?0:+t(n[a],a,n)}}a.initialize=function(e){n=e;u()};a.strength=function(e){return arguments.length?(t=typeof e==="function"?e:GR(+e),u(),a):t};a.x=function(t){return arguments.length?(e=typeof t==="function"?t:GR(+t),u(),a):e};return a};var iL=function(e){var t=GR(.1),n,r,i;if(typeof e!=="function")e=GR(e==null?0:+e);function a(e){for(var t=0,a=n.length,u;t<a;++t){u=n[t],u.vy+=(i[t]-u.y)*r[t]*e}}function u(){if(!n)return;var a,u=n.length;r=new Array(u);i=new Array(u);for(a=0;a<u;++a){r[a]=isNaN(i[a]=+e(n[a],a,n))?0:+t(n[a],a,n)}}a.initialize=function(e){n=e;u()};a.strength=function(e){return arguments.length?(t=typeof e==="function"?e:GR(+e),u(),a):t};a.y=function(t){return arguments.length?(e=typeof t==="function"?t:GR(+t),u(),a):e};return a};var aL={center:HR,collide:mP,nbody:tL,link:xP,x:rL,y:iL};var uL="forces",oL=["alpha","alphaMin","alphaTarget","velocityDecay","forces"],fL=["static","iterations"],cL=["x","y","vx","vy"];function lL(e){Go.call(this,null,e)}lL.Definition={type:"Force",metadata:{modifies:true},params:[{name:"static",type:"boolean",default:false},{name:"restart",type:"boolean",default:false},{name:"iterations",type:"number",default:300},{name:"alpha",type:"number",default:1},{name:"alphaMin",type:"number",default:.001},{name:"alphaTarget",type:"number",default:0},{name:"velocityDecay",type:"number",default:.4},{name:"forces",type:"param",array:true,params:[{key:{force:"center"},params:[{name:"x",type:"number",default:0},{name:"y",type:"number",default:0}]},{key:{force:"collide"},params:[{name:"radius",type:"number",expr:true},{name:"strength",type:"number",default:.7},{name:"iterations",type:"number",default:1}]},{key:{force:"nbody"},params:[{name:"strength",type:"number",default:-30},{name:"theta",type:"number",default:.9},{name:"distanceMin",type:"number",default:1},{name:"distanceMax",type:"number"}]},{key:{force:"link"},params:[{name:"links",type:"data"},{name:"id",type:"field"},{name:"distance",type:"number",default:30,expr:true},{name:"strength",type:"number",expr:true},{name:"iterations",type:"number",default:1}]},{key:{force:"x"},params:[{name:"strength",type:"number",default:.1},{name:"x",type:"field"}]},{key:{force:"y"},params:[{name:"strength",type:"number",default:.1},{name:"y",type:"field"}]}]},{name:"as",type:"string",array:true,modify:false,default:cL}]};var sL=Object(dn["x"])(lL,Go);sL.transform=function(e,t){var n=this.value,r=t.changed(t.ADD_REM),i=e.modified(oL),a=e.iterations||300;if(!n){this.value=n=hL(t.source,e);n.on("tick",dL(t.dataflow,this));if(!e.static){r=true;n.tick()}t.modifies("index")}else{if(r){t.modifies("index");n.nodes(t.source)}if(i||t.changed(t.MOD)){pL(n,e,0,t)}}if(i||r||e.modified(fL)||t.changed()&&e.restart){n.alpha(Math.max(n.alpha(),e.alpha||1)).alphaDecay(1-Math.pow(n.alphaMin(),1/a));if(e.static){for(n.stop();--a>=0;)n.tick()}else{if(n.stopped())n.restart();if(!r)return t.StopPropagation}}return this.finish(e,t)};sL.finish=function(e,t){var n=t.dataflow;for(var r=this._argops,i=0,a=r.length,u;i<a;++i){u=r[i];if(u.name!==uL||u.op._argval.force!=="link"){continue}for(var o=u.op._argops,f=0,c=o.length,l;f<c;++f){if(o[f].name==="links"&&(l=o[f].op.source)){n.pulse(l,n.changeset().reflow());break}}}return t.reflow(e.modified()).modifies(cL)};function dL(e,t){return function(){e.touch(t).run()}}function hL(e,t){var n=eL(e),r=false,i=n.stop,a=n.restart;n.stopped=function(){return r};n.restart=function(){r=false;return a()};n.stop=function(){r=true;return i()};return pL(n,t,true).on("end",function(){r=true})}function pL(e,t,n,r){var i=Object(dn["i"])(t.forces),a,u,o,f;for(a=0,u=oL.length;a<u;++a){o=oL[a];if(o!==uL&&t.modified(o))e[o](t[o])}for(a=0,u=i.length;a<u;++a){f=uL+a;o=n||t.modified(uL,a)?gL(i[a]):r&&vL(i[a],r)?e.force(f):null;if(o)e.force(f,o)}for(u=e.numForces||0;a<u;++a){e.force(uL+a,null)}e.numForces=i.length;return e}function vL(e,t){var n,r;for(n in e){if(Object(dn["C"])(r=e[n])&&t.modified(Object(dn["g"])(r)))return 1}return 0}function gL(e){var t,n;if(!aL.hasOwnProperty(e.force)){Object(dn["n"])("Unrecognized force: "+e.force)}t=aL[e.force]();for(n in e){if(Object(dn["C"])(t[n]))mL(t[n],e[n],e)}return t}function mL(e,t,n){e(Object(dn["C"])(t)?function(e){return t(e,n)}:t)}var yL=function(e,t,n){var r={};e.each(function(e){var i=e.data;if(n(i))r[t(i)]=e});e.lookup=r;return e};function bL(e,t){return e.parent===t.parent?1:2}function xL(e){return e.reduce(_L,0)/e.length}function _L(e,t){return e+t.x}function wL(e){return 1+e.reduce(kL,0)}function kL(e,t){return Math.max(e,t.y)}function OL(e){var t;while(t=e.children)e=t[0];return e}function AL(e){var t;while(t=e.children)e=t[t.length-1];return e}var EL=function(){var e=bL,t=1,n=1,r=false;function i(i){var a,u=0;i.eachAfter(function(t){var n=t.children;if(n){t.x=xL(n);t.y=wL(n)}else{t.x=a?u+=e(t,a):0;t.y=0;a=t}});var o=OL(i),f=AL(i),c=o.x-e(o,f)/2,l=f.x+e(f,o)/2;return i.eachAfter(r?function(e){e.x=(e.x-i.x)*t;e.y=(i.y-e.y)*n}:function(e){e.x=(e.x-c)/(l-c)*t;e.y=(1-(i.y?e.y/i.y:1))*n})}i.separation=function(t){return arguments.length?(e=t,i):e};i.size=function(e){return arguments.length?(r=false,t=+e[0],n=+e[1],i):r?null:[t,n]};i.nodeSize=function(e){return arguments.length?(r=true,t=+e[0],n=+e[1],i):r?[t,n]:null};return i};function ML(e){var t=0,n=e.children,r=n&&n.length;if(!r)t=1;else while(--r>=0)t+=n[r].value;e.value=t}var SL=function(){return this.eachAfter(ML)};var CL=function(e){var t=this,n,r=[t],i,a,u;do{n=r.reverse(),r=[];while(t=n.pop()){e(t),i=t.children;if(i)for(a=0,u=i.length;a<u;++a){r.push(i[a])}}}while(r.length);return this};var DL=function(e){var t=this,n=[t],r,i;while(t=n.pop()){e(t),r=t.children;if(r)for(i=r.length-1;i>=0;--i){n.push(r[i])}}return this};var jL=function(e){var t=this,n=[t],r=[],i,a,u;while(t=n.pop()){r.push(t),i=t.children;if(i)for(a=0,u=i.length;a<u;++a){n.push(i[a])}}while(t=r.pop()){e(t)}return this};var NL=function(e){return this.eachAfter(function(t){var n=+e(t.data)||0,r=t.children,i=r&&r.length;while(--i>=0)n+=r[i].value;t.value=n})};var FL=function(e){return this.eachBefore(function(t){if(t.children){t.children.sort(e)}})};var TL=function(e){var t=this,n=zL(t,e),r=[t];while(t!==n){t=t.parent;r.push(t)}var i=r.length;while(e!==n){r.splice(i,0,e);e=e.parent}return r};function zL(e,t){if(e===t)return e;var n=e.ancestors(),r=t.ancestors(),i=null;e=n.pop();t=r.pop();while(e===t){i=e;e=n.pop();t=r.pop()}return i}var RL=function(){var e=this,t=[e];while(e=e.parent){t.push(e)}return t};var PL=function(){var e=[];this.each(function(t){e.push(t)});return e};var LL=function(){var e=[];this.eachBefore(function(t){if(!t.children){e.push(t)}});return e};var BL=function(){var e=this,t=[];e.each(function(n){if(n!==e){t.push({source:n.parent,target:n})}});return t};function IL(e,t){var n=new GL(e),r=+e.value&&(n.value=e.value),i,a=[n],u,o,f,c;if(t==null)t=qL;while(i=a.pop()){if(r)i.value=+i.data.value;if((o=t(i.data))&&(c=o.length)){i.children=new Array(c);for(f=c-1;f>=0;--f){a.push(u=i.children[f]=new GL(o[f]));u.parent=i;u.depth=i.depth+1}}}return n.eachBefore(HL)}function UL(){return IL(this).eachBefore(WL)}function qL(e){return e.children}function WL(e){e.data=e.data.data}function HL(e){var t=0;do{e.height=t}while((e=e.parent)&&e.height<++t)}function GL(e){this.data=e;this.depth=this.height=0;this.parent=null}GL.prototype=IL.prototype={constructor:GL,count:SL,each:CL,eachAfter:jL,eachBefore:DL,sum:NL,sort:FL,path:TL,ancestors:RL,descendants:PL,leaves:LL,links:BL,copy:UL};var YL=Array.prototype.slice;function $L(e){var t=e.length,n,r;while(t){r=Math.random()*t--|0;n=e[t];e[t]=e[r];e[r]=n}return e}var VL=function(e){var t=0,n=(e=$L(YL.call(e))).length,r=[],i,a;while(t<n){i=e[t];if(a&&JL(a,i))++t;else a=KL(r=XL(r,i)),t=0}return a};function XL(e,t){var n,r;if(QL(t,e))return[t];for(n=0;n<e.length;++n){if(ZL(t,e[n])&&QL(tB(e[n],t),e)){return[e[n],t]}}for(n=0;n<e.length-1;++n){for(r=n+1;r<e.length;++r){if(ZL(tB(e[n],e[r]),t)&&ZL(tB(e[n],t),e[r])&&ZL(tB(e[r],t),e[n])&&QL(nB(e[n],e[r],t),e)){return[e[n],e[r],t]}}}throw new Error}function ZL(e,t){var n=e.r-t.r,r=t.x-e.x,i=t.y-e.y;return n<0||n*n<r*r+i*i}function JL(e,t){var n=e.r-t.r+1e-6,r=t.x-e.x,i=t.y-e.y;return n>0&&n*n>r*r+i*i}function QL(e,t){for(var n=0;n<t.length;++n){if(!JL(e,t[n])){return false}}return true}function KL(e){switch(e.length){case 1:return eB(e[0]);case 2:return tB(e[0],e[1]);case 3:return nB(e[0],e[1],e[2])}}function eB(e){return{x:e.x,y:e.y,r:e.r}}function tB(e,t){var n=e.x,r=e.y,i=e.r,a=t.x,u=t.y,o=t.r,f=a-n,c=u-r,l=o-i,s=Math.sqrt(f*f+c*c);return{x:(n+a+f/s*l)/2,y:(r+u+c/s*l)/2,r:(s+i+o)/2}}function nB(e,t,n){var r=e.x,i=e.y,a=e.r,u=t.x,o=t.y,f=t.r,c=n.x,l=n.y,s=n.r,d=r-u,h=r-c,p=i-o,v=i-l,g=f-a,m=s-a,y=r*r+i*i-a*a,b=y-u*u-o*o+f*f,x=y-c*c-l*l+s*s,_=h*p-d*v,w=(p*x-v*b)/(_*2)-r,k=(v*g-p*m)/_,O=(h*b-d*x)/(_*2)-i,A=(d*m-h*g)/_,E=k*k+A*A-1,M=2*(a+w*k+O*A),S=w*w+O*O-a*a,C=-(E?(M+Math.sqrt(M*M-4*E*S))/(2*E):S/M);return{x:r+w+k*C,y:i+O+A*C,r:C}}function rB(e,t,n){var r=e.x-t.x,i,a,u=e.y-t.y,o,f,c=r*r+u*u;if(c){a=t.r+n.r,a*=a;f=e.r+n.r,f*=f;if(a>f){i=(c+f-a)/(2*c);o=Math.sqrt(Math.max(0,f/c-i*i));n.x=e.x-i*r-o*u;n.y=e.y-i*u+o*r}else{i=(c+a-f)/(2*c);o=Math.sqrt(Math.max(0,a/c-i*i));n.x=t.x+i*r-o*u;n.y=t.y+i*u+o*r}}else{n.x=t.x+n.r;n.y=t.y}}function iB(e,t){var n=e.r+t.r-1e-6,r=t.x-e.x,i=t.y-e.y;return n>0&&n*n>r*r+i*i}function aB(e){var t=e._,n=e.next._,r=t.r+n.r,i=(t.x*n.r+n.x*t.r)/r,a=(t.y*n.r+n.y*t.r)/r;return i*i+a*a}function uB(e){this._=e;this.next=null;this.previous=null}function oB(e){if(!(i=e.length))return 0;var t,n,r,i,a,u,o,f,c,l,s;t=e[0],t.x=0,t.y=0;if(!(i>1))return t.r;n=e[1],t.x=-n.r,n.x=t.r,n.y=0;if(!(i>2))return t.r+n.r;rB(n,t,r=e[2]);t=new uB(t),n=new uB(n),r=new uB(r);t.next=r.previous=n;n.next=t.previous=r;r.next=n.previous=t;e:for(o=3;o<i;++o){rB(t._,n._,r=e[o]),r=new uB(r);f=n.next,c=t.previous,l=n._.r,s=t._.r;do{if(l<=s){if(iB(f._,r._)){n=f,t.next=n,n.previous=t,--o;continue e}l+=f._.r,f=f.next}else{if(iB(c._,r._)){t=c,t.next=n,n.previous=t,--o;continue e}s+=c._.r,c=c.previous}}while(f!==c.next);r.previous=t,r.next=n,t.next=n.previous=n=r;a=aB(t);while((r=r.next)!==n){if((u=aB(r))<a){t=r,a=u}}n=t.next}t=[n._],r=n;while((r=r.next)!==n)t.push(r._);r=VL(t);for(o=0;o<i;++o)t=e[o],t.x-=r.x,t.y-=r.y;return r.r}var fB=function(e){oB(e);return e};function cB(e){return e==null?null:lB(e)}function lB(e){if(typeof e!=="function")throw new Error;return e}function sB(){return 0}var dB=function(e){return function(){return e}};function hB(e){return Math.sqrt(e.value)}var pB=function(){var e=null,t=1,n=1,r=sB;function i(i){i.x=t/2,i.y=n/2;if(e){i.eachBefore(vB(e)).eachAfter(gB(r,.5)).eachBefore(mB(1))}else{i.eachBefore(vB(hB)).eachAfter(gB(sB,1)).eachAfter(gB(r,i.r/Math.min(t,n))).eachBefore(mB(Math.min(t,n)/(2*i.r)))}return i}i.radius=function(t){return arguments.length?(e=cB(t),i):e};i.size=function(e){return arguments.length?(t=+e[0],n=+e[1],i):[t,n]};i.padding=function(e){return arguments.length?(r=typeof e==="function"?e:dB(+e),i):r};return i};function vB(e){return function(t){if(!t.children){t.r=Math.max(0,+e(t)||0)}}}function gB(e,t){return function(n){if(r=n.children){var r,i,a=r.length,u=e(n)*t||0,o;if(u)for(i=0;i<a;++i)r[i].r+=u;o=oB(r);if(u)for(i=0;i<a;++i)r[i].r-=u;n.r=o+u}}}function mB(e){return function(t){var n=t.parent;t.r*=e;if(n){t.x=n.x+e*t.x;t.y=n.y+e*t.y}}}var yB=function(e){e.x0=Math.round(e.x0);e.y0=Math.round(e.y0);e.x1=Math.round(e.x1);e.y1=Math.round(e.y1)};var bB=function(e,t,n,r,i){var a=e.children,u,o=-1,f=a.length,c=e.value&&(r-t)/e.value;while(++o<f){u=a[o],u.y0=n,u.y1=i;u.x0=t,u.x1=t+=u.value*c}};var xB=function(){var e=1,t=1,n=0,r=false;function i(i){var u=i.height+1;i.x0=i.y0=n;i.x1=e;i.y1=t/u;i.eachBefore(a(t,u));if(r)i.eachBefore(yB);return i}function a(e,t){return function(r){if(r.children){bB(r,r.x0,e*(r.depth+1)/t,r.x1,e*(r.depth+2)/t)}var i=r.x0,a=r.y0,u=r.x1-n,o=r.y1-n;if(u<i)i=u=(i+u)/2;if(o<a)a=o=(a+o)/2;r.x0=i;r.y0=a;r.x1=u;r.y1=o}}i.round=function(e){return arguments.length?(r=!!e,i):r};i.size=function(n){return arguments.length?(e=+n[0],t=+n[1],i):[e,t]};i.padding=function(e){return arguments.length?(n=+e,i):n};return i};var _B="$",wB={depth:-1},kB={};function OB(e){return e.id}function AB(e){return e.parentId}var EB=function(){var e=OB,t=AB;function n(n){var r,i,a=n.length,u,o,f,c=new Array(a),l,s,d={};for(i=0;i<a;++i){r=n[i],f=c[i]=new GL(r);if((l=e(r,i,n))!=null&&(l+="")){s=_B+(f.id=l);d[s]=s in d?kB:f}}for(i=0;i<a;++i){f=c[i],l=t(n[i],i,n);if(l==null||!(l+="")){if(u)throw new Error("multiple roots");u=f}else{o=d[_B+l];if(!o)throw new Error("missing: "+l);if(o===kB)throw new Error("ambiguous: "+l);if(o.children)o.children.push(f);else o.children=[f];f.parent=o}}if(!u)throw new Error("no root");u.parent=wB;u.eachBefore(function(e){e.depth=e.parent.depth+1;--a}).eachBefore(HL);u.parent=null;if(a>0)throw new Error("cycle");return u}n.id=function(t){return arguments.length?(e=lB(t),n):e};n.parentId=function(e){return arguments.length?(t=lB(e),n):t};return n};function MB(e,t){return e.parent===t.parent?1:2}function SB(e){var t=e.children;return t?t[0]:e.t}function CB(e){var t=e.children;return t?t[t.length-1]:e.t}function DB(e,t,n){var r=n/(t.i-e.i);t.c-=r;t.s+=n;e.c+=r;t.z+=n;t.m+=n}function jB(e){var t=0,n=0,r=e.children,i=r.length,a;while(--i>=0){a=r[i];a.z+=t;a.m+=t;t+=a.s+(n+=a.c)}}function NB(e,t,n){return e.a.parent===t.parent?e.a:n}function FB(e,t){this._=e;this.parent=null;this.children=null;this.A=null;this.a=this;this.z=0;this.m=0;this.c=0;this.s=0;this.t=null;this.i=t}FB.prototype=Object.create(GL.prototype);function TB(e){var t=new FB(e,0),n,r=[t],i,a,u,o;while(n=r.pop()){if(a=n._.children){n.children=new Array(o=a.length);for(u=o-1;u>=0;--u){r.push(i=n.children[u]=new FB(a[u],u));i.parent=n}}}(t.parent=new FB(null,0)).children=[t];return t}var zB=function(){var e=MB,t=1,n=1,r=null;function i(i){var o=TB(i);o.eachAfter(a),o.parent.m=-o.z;o.eachBefore(u);if(r)i.eachBefore(f);else{var c=i,l=i,s=i;i.eachBefore(function(e){if(e.x<c.x)c=e;if(e.x>l.x)l=e;if(e.depth>s.depth)s=e});var d=c===l?1:e(c,l)/2,h=d-c.x,p=t/(l.x+d+h),v=n/(s.depth||1);i.eachBefore(function(e){e.x=(e.x+h)*p;e.y=e.depth*v})}return i}function a(t){var n=t.children,r=t.parent.children,i=t.i?r[t.i-1]:null;if(n){jB(t);var a=(n[0].z+n[n.length-1].z)/2;if(i){t.z=i.z+e(t._,i._);t.m=t.z-a}else{t.z=a}}else if(i){t.z=i.z+e(t._,i._)}t.parent.A=o(t,i,t.parent.A||r[0])}function u(e){e._.x=e.z+e.parent.m;e.m+=e.parent.m}function o(t,n,r){if(n){var i=t,a=t,u=n,o=i.parent.children[0],f=i.m,c=a.m,l=u.m,s=o.m,d;while(u=CB(u),i=SB(i),u&&i){o=SB(o);a=CB(a);a.a=t;d=u.z+l-i.z-f+e(u._,i._);if(d>0){DB(NB(u,t,r),t,d);f+=d;c+=d}l+=u.m;f+=i.m;s+=o.m;c+=a.m}if(u&&!CB(a)){a.t=u;a.m+=l-c}if(i&&!SB(o)){o.t=i;o.m+=f-s;r=t}}return r}function f(e){e.x*=t;e.y=e.depth*n}i.separation=function(t){return arguments.length?(e=t,i):e};i.size=function(e){return arguments.length?(r=false,t=+e[0],n=+e[1],i):r?null:[t,n]};i.nodeSize=function(e){return arguments.length?(r=true,t=+e[0],n=+e[1],i):r?[t,n]:null};return i};var RB=function(e,t,n,r,i){var a=e.children,u,o=-1,f=a.length,c=e.value&&(i-n)/e.value;while(++o<f){u=a[o],u.x0=t,u.x1=r;u.y0=n,u.y1=n+=u.value*c}};var PB=(1+Math.sqrt(5))/2;function LB(e,t,n,r,i,a){var u=[],o=t.children,f,c,l=0,s=0,d=o.length,h,p,v=t.value,g,m,y,b,x,_,w;while(l<d){h=i-n,p=a-r;do{g=o[s++].value}while(!g&&s<d);m=y=g;_=Math.max(p/h,h/p)/(v*e);w=g*g*_;x=Math.max(y/w,w/m);for(;s<d;++s){g+=c=o[s].value;if(c<m)m=c;if(c>y)y=c;w=g*g*_;b=Math.max(y/w,w/m);if(b>x){g-=c;break}x=b}u.push(f={value:g,dice:h<p,children:o.slice(l,s)});if(f.dice)bB(f,n,r,i,v?r+=p*g/v:a);else RB(f,n,r,v?n+=h*g/v:i,a);v-=g,l=s}return u}var BB=function e(t){function n(e,n,r,i,a){LB(t,e,n,r,i,a)}n.ratio=function(t){return e((t=+t)>1?t:1)};return n}(PB);var IB=function(){var e=BB,t=false,n=1,r=1,i=[0],a=sB,u=sB,o=sB,f=sB,c=sB;function l(e){e.x0=e.y0=0;e.x1=n;e.y1=r;e.eachBefore(s);i=[0];if(t)e.eachBefore(yB);return e}function s(t){var n=i[t.depth],r=t.x0+n,l=t.y0+n,s=t.x1-n,d=t.y1-n;if(s<r)r=s=(r+s)/2;if(d<l)l=d=(l+d)/2;t.x0=r;t.y0=l;t.x1=s;t.y1=d;if(t.children){n=i[t.depth+1]=a(t)/2;r+=c(t)-n;l+=u(t)-n;s-=o(t)-n;d-=f(t)-n;if(s<r)r=s=(r+s)/2;if(d<l)l=d=(l+d)/2;e(t,r,l,s,d)}}l.round=function(e){return arguments.length?(t=!!e,l):t};l.size=function(e){return arguments.length?(n=+e[0],r=+e[1],l):[n,r]};l.tile=function(t){return arguments.length?(e=lB(t),l):e};l.padding=function(e){return arguments.length?l.paddingInner(e).paddingOuter(e):l.paddingInner()};l.paddingInner=function(e){return arguments.length?(a=typeof e==="function"?e:dB(+e),l):a};l.paddingOuter=function(e){return arguments.length?l.paddingTop(e).paddingRight(e).paddingBottom(e).paddingLeft(e):l.paddingTop()};l.paddingTop=function(e){return arguments.length?(u=typeof e==="function"?e:dB(+e),l):u};l.paddingRight=function(e){return arguments.length?(o=typeof e==="function"?e:dB(+e),l):o};l.paddingBottom=function(e){return arguments.length?(f=typeof e==="function"?e:dB(+e),l):f};l.paddingLeft=function(e){return arguments.length?(c=typeof e==="function"?e:dB(+e),l):c};return l};var UB=function(e,t,n,r,i){var a=e.children,u,o=a.length,f,c=new Array(o+1);for(c[0]=f=u=0;u<o;++u){c[u+1]=f+=a[u].value}l(0,o,e.value,t,n,r,i);function l(e,t,n,r,i,u,o){if(e>=t-1){var f=a[e];f.x0=r,f.y0=i;f.x1=u,f.y1=o;return}var s=c[e],d=n/2+s,h=e+1,p=t-1;while(h<p){var v=h+p>>>1;if(c[v]<d)h=v+1;else p=v}if(d-c[h-1]<c[h]-d&&e+1<h)--h;var g=c[h]-s,m=n-g;if(u-r>o-i){var y=(r*m+u*g)/n;l(e,h,g,r,i,y,o);l(h,t,m,y,i,u,o)}else{var b=(i*m+o*g)/n;l(e,h,g,r,i,u,b);l(h,t,m,r,b,u,o)}}};var qB=function(e,t,n,r,i){(e.depth&1?RB:bB)(e,t,n,r,i)};var WB=function e(t){function n(e,n,r,i,a){if((u=e._squarify)&&u.ratio===t){var u,o,f,c,l=-1,s,d=u.length,h=e.value;while(++l<d){o=u[l],f=o.children;for(c=o.value=0,s=f.length;c<s;++c)o.value+=f[c].value;if(o.dice)bB(o,n,r,i,r+=(a-r)*o.value/h);else RB(o,n,r,n+=(i-n)*o.value/h,a);h-=o.value}}else{e._squarify=u=LB(t,e,n,r,i,a);u.ratio=t}}n.ratio=function(t){return e((t=+t)>1?t:1)};return n}(PB);function HB(e){Go.call(this,null,e)}HB.Definition={type:"Nest",metadata:{treesource:true,changes:true},params:[{name:"keys",type:"field",array:true},{name:"generate",type:"boolean"}]};var GB=Object(dn["x"])(HB,Go);function YB(e){return e.values}GB.transform=function(e,t){if(!t.source){Object(dn["n"])("Nest transform requires an upstream data source.")}var n=e.generate,r=e.modified(),i=t.clone(),a=this.value;if(!a||r||t.changed()){if(a){a.each(function(e){if(e.children&&mn(e.data)){i.rem.push(e.data)}})}this.value=a=IL({values:Object(dn["i"])(e.keys).reduce(function(e,t){e.key(t);return e},f_()).entries(i.source)},YB);if(n){a.each(function(e){if(e.children){e=xn(e.data);i.add.push(e);i.source.push(e)}})}yL(a,yn,yn)}i.source.root=a;return i};function $B(e){Go.call(this,null,e)}var VB=Object(dn["x"])($B,Go);VB.transform=function(e,t){if(!t.source||!t.source.root){Object(dn["n"])(this.constructor.name+" transform requires a backing tree data source.")}var n=this.layout(e.method),r=this.fields,i=t.source.root,a=e.as||r;if(e.field)i.sum(e.field);if(e.sort)i.sort(e.sort);XB(n,this.params,e);if(n.separation){n.separation(e.separation!==false?JB:dn["L"])}try{this.value=n(i)}catch(e){Object(dn["n"])(e)}i.each(function(e){ZB(e,r,a)});return t.reflow(e.modified()).modifies(a).modifies("leaf")};function XB(e,t,n){for(var r,i=0,a=t.length;i<a;++i){r=t[i];if(r in n)e[r](n[r])}}function ZB(e,t,n){var r=e.data;for(var i=0,a=t.length-1;i<a;++i){r[n[i]]=e[t[i]]}r[n[a]]=e.children?e.children.length:0}function JB(e,t){return e.parent===t.parent?1:2}var QB=["x","y","r","depth","children"];function KB(e){$B.call(this,e)}KB.Definition={type:"Pack",metadata:{tree:true,modifies:true},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"radius",type:"field",default:null},{name:"size",type:"number",array:true,length:2},{name:"as",type:"string",array:true,length:QB.length,default:QB}]};var eI=Object(dn["x"])(KB,$B);eI.layout=pB;eI.params=["size","padding"];eI.fields=QB;var tI=["x0","y0","x1","y1","depth","children"];function nI(e){$B.call(this,e)}nI.Definition={type:"Partition",metadata:{tree:true,modifies:true},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"round",type:"boolean",default:false},{name:"size",type:"number",array:true,length:2},{name:"as",type:"string",array:true,length:tI.length,default:tI}]};var rI=Object(dn["x"])(nI,$B);rI.layout=xB;rI.params=["size","round","padding"];rI.fields=tI;function iI(e){Go.call(this,null,e)}iI.Definition={type:"Stratify",metadata:{treesource:true},params:[{name:"key",type:"field",required:true},{name:"parentKey",type:"field",required:true}]};var aI=Object(dn["x"])(iI,Go);aI.transform=function(e,t){if(!t.source){Object(dn["n"])("Stratify transform requires an upstream data source.")}var n=this.value,r=e.modified(),i=t.fork(t.ALL).materialize(t.SOURCE),a=!this.value||r||t.changed(t.ADD_REM)||t.modified(e.key.fields)||t.modified(e.parentKey.fields);i.source=i.source.slice();if(a){if(i.source.length){n=yL(EB().id(e.key).parentId(e.parentKey)(i.source),e.key,dn["db"])}else{n=yL(EB()([{}]),e.key,e.key)}}i.source.root=this.value=n;return i};var uI={tidy:zB,cluster:EL};var oI=["x","y","depth","children"];function fI(e){$B.call(this,e)}fI.Definition={type:"Tree",metadata:{tree:true,modifies:true},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"tidy",values:["tidy","cluster"]},{name:"size",type:"number",array:true,length:2},{name:"nodeSize",type:"number",array:true,length:2},{name:"separation",type:"boolean",default:true},{name:"as",type:"string",array:true,length:oI.length,default:oI}]};var cI=Object(dn["x"])(fI,$B);cI.layout=function(e){var t=e||"tidy";if(uI.hasOwnProperty(t))return uI[t]();else Object(dn["n"])("Unrecognized Tree layout method: "+t)};cI.params=["size","nodeSize"];cI.fields=oI;function lI(e){Go.call(this,[],e)}lI.Definition={type:"TreeLinks",metadata:{tree:true,generates:true,changes:true},params:[]};var sI=Object(dn["x"])(lI,Go);sI.transform=function(e,t){var n=this.value,r=t.source&&t.source.root,i=t.fork(t.NO_SOURCE),a={};if(!r)Object(dn["n"])("TreeLinks transform requires a tree data source.");if(t.changed(t.ADD_REM)){i.rem=n;t.visit(t.SOURCE,function(e){a[yn(e)]=1});r.each(function(e){var t=e.data,n=e.parent&&e.parent.data;if(n&&a[yn(t)]&&a[yn(n)]){i.add.push(xn({source:n,target:t}))}});this.value=i.add}else if(t.changed(t.MOD)){t.visit(t.MOD,function(e){a[yn(e)]=1});n.forEach(function(e){if(a[yn(e.source)]||a[yn(e.target)]){i.mod.push(e)}})}return i};var dI={binary:UB,dice:bB,slice:RB,slicedice:qB,squarify:BB,resquarify:WB};var hI=["x0","y0","x1","y1","depth","children"];function pI(e){$B.call(this,e)}pI.Definition={type:"Treemap",metadata:{tree:true,modifies:true},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"squarify",values:["squarify","resquarify","binary","dice","slice","slicedice"]},{name:"padding",type:"number",default:0},{name:"paddingInner",type:"number",default:0},{name:"paddingOuter",type:"number",default:0},{name:"paddingTop",type:"number",default:0},{name:"paddingRight",type:"number",default:0},{name:"paddingBottom",type:"number",default:0},{name:"paddingLeft",type:"number",default:0},{name:"ratio",type:"number",default:1.618033988749895},{name:"round",type:"boolean",default:false},{name:"size",type:"number",array:true,length:2},{name:"as",type:"string",array:true,length:hI.length,default:hI}]};var vI=Object(dn["x"])(pI,$B);vI.layout=function(){var e=IB();e.ratio=function(t){var n=e.tile();if(n.ratio)e.tile(n.ratio(t))};e.method=function(t){if(dI.hasOwnProperty(t))e.tile(dI[t]);else Object(dn["n"])("Unrecognized Treemap layout method: "+t)};return e};vI.params=["method","ratio","size","round","padding","paddingInner","paddingOuter","paddingTop","paddingRight","paddingBottom","paddingLeft"];vI.fields=hI;var gI=function(e){return function(){return e}};function mI(e){return e[0]}function yI(e){return e[1]}function bI(){this._=null}function xI(e){e.U=e.C=e.L=e.R=e.P=e.N=null}bI.prototype={constructor:bI,insert:function(e,t){var n,r,i;if(e){t.P=e;t.N=e.N;if(e.N)e.N.P=t;e.N=t;if(e.R){e=e.R;while(e.L)e=e.L;e.L=t}else{e.R=t}n=e}else if(this._){e=kI(this._);t.P=null;t.N=e;e.P=e.L=t;n=e}else{t.P=t.N=null;this._=t;n=null}t.L=t.R=null;t.U=n;t.C=true;e=t;while(n&&n.C){r=n.U;if(n===r.L){i=r.R;if(i&&i.C){n.C=i.C=false;r.C=true;e=r}else{if(e===n.R){_I(this,n);e=n;n=e.U}n.C=false;r.C=true;wI(this,r)}}else{i=r.L;if(i&&i.C){n.C=i.C=false;r.C=true;e=r}else{if(e===n.L){wI(this,n);e=n;n=e.U}n.C=false;r.C=true;_I(this,r)}}n=e.U}this._.C=false},remove:function(e){if(e.N)e.N.P=e.P;if(e.P)e.P.N=e.N;e.N=e.P=null;var t=e.U,n,r=e.L,i=e.R,a,u;if(!r)a=i;else if(!i)a=r;else a=kI(i);if(t){if(t.L===e)t.L=a;else t.R=a}else{this._=a}if(r&&i){u=a.C;a.C=e.C;a.L=r;r.U=a;if(a!==i){t=a.U;a.U=e.U;e=a.R;t.L=e;a.R=i;i.U=a}else{a.U=t;t=a;e=a.R}}else{u=e.C;e=a}if(e)e.U=t;if(u)return;if(e&&e.C){e.C=false;return}do{if(e===this._)break;if(e===t.L){n=t.R;if(n.C){n.C=false;t.C=true;_I(this,t);n=t.R}if(n.L&&n.L.C||n.R&&n.R.C){if(!n.R||!n.R.C){n.L.C=false;n.C=true;wI(this,n);n=t.R}n.C=t.C;t.C=n.R.C=false;_I(this,t);e=this._;break}}else{n=t.L;if(n.C){n.C=false;t.C=true;wI(this,t);n=t.L}if(n.L&&n.L.C||n.R&&n.R.C){if(!n.L||!n.L.C){n.R.C=false;n.C=true;_I(this,n);n=t.L}n.C=t.C;t.C=n.L.C=false;wI(this,t);e=this._;break}}n.C=true;e=t;t=t.U}while(!e.C);if(e)e.C=false}};function _I(e,t){var n=t,r=t.R,i=n.U;if(i){if(i.L===n)i.L=r;else i.R=r}else{e._=r}r.U=i;n.U=r;n.R=r.L;if(n.R)n.R.U=n;r.L=n}function wI(e,t){var n=t,r=t.L,i=n.U;if(i){if(i.L===n)i.L=r;else i.R=r}else{e._=r}r.U=i;n.U=r;n.L=r.R;if(n.L)n.L.U=n;r.R=n}function kI(e){while(e.L)e=e.L;return e}var OI=bI;function AI(e,t,n,r){var i=[null,null],a=tU.push(i)-1;i.left=e;i.right=t;if(n)MI(i,e,t,n);if(r)MI(i,t,e,r);KI[e.index].halfedges.push(a);KI[t.index].halfedges.push(a);return i}function EI(e,t,n){var r=[t,n];r.left=e;return r}function MI(e,t,n,r){if(!e[0]&&!e[1]){e[0]=r;e.left=t;e.right=n}else if(e.left===n){e[1]=r}else{e[0]=r}}function SI(e,t,n,r,i){var a=e[0],u=e[1],o=a[0],f=a[1],c=u[0],l=u[1],s=0,d=1,h=c-o,p=l-f,v;v=t-o;if(!h&&v>0)return;v/=h;if(h<0){if(v<s)return;if(v<d)d=v}else if(h>0){if(v>d)return;if(v>s)s=v}v=r-o;if(!h&&v<0)return;v/=h;if(h<0){if(v>d)return;if(v>s)s=v}else if(h>0){if(v<s)return;if(v<d)d=v}v=n-f;if(!p&&v>0)return;v/=p;if(p<0){if(v<s)return;if(v<d)d=v}else if(p>0){if(v>d)return;if(v>s)s=v}v=i-f;if(!p&&v<0)return;v/=p;if(p<0){if(v>d)return;if(v>s)s=v}else if(p>0){if(v<s)return;if(v<d)d=v}if(!(s>0)&&!(d<1))return true;if(s>0)e[0]=[o+s*h,f+s*p];if(d<1)e[1]=[o+d*h,f+d*p];return true}function CI(e,t,n,r,i){var a=e[1];if(a)return true;var u=e[0],o=e.left,f=e.right,c=o[0],l=o[1],s=f[0],d=f[1],h=(c+s)/2,p=(l+d)/2,v,g;if(d===l){if(h<t||h>=r)return;if(c>s){if(!u)u=[h,n];else if(u[1]>=i)return;a=[h,i]}else{if(!u)u=[h,i];else if(u[1]<n)return;a=[h,n]}}else{v=(c-s)/(d-l);g=p-v*h;if(v<-1||v>1){if(c>s){if(!u)u=[(n-g)/v,n];else if(u[1]>=i)return;a=[(i-g)/v,i]}else{if(!u)u=[(i-g)/v,i];else if(u[1]<n)return;a=[(n-g)/v,n]}}else{if(l<d){if(!u)u=[t,v*t+g];else if(u[0]>=r)return;a=[r,v*r+g]}else{if(!u)u=[r,v*r+g];else if(u[0]<t)return;a=[t,v*t+g]}}}e[0]=u;e[1]=a;return true}function DI(e,t,n,r){var i=tU.length,a;while(i--){if(!CI(a=tU[i],e,t,n,r)||!SI(a,e,t,n,r)||!(Math.abs(a[0][0]-a[1][0])>ZI||Math.abs(a[0][1]-a[1][1])>ZI)){delete tU[i]}}}function jI(e){return KI[e.index]={site:e,halfedges:[]}}function NI(e,t){var n=e.site,r=t.left,i=t.right;if(n===i)i=r,r=n;if(i)return Math.atan2(i[1]-r[1],i[0]-r[0]);if(n===r)r=t[1],i=t[0];else r=t[0],i=t[1];return Math.atan2(r[0]-i[0],i[1]-r[1])}function FI(e,t){return t[+(t.left!==e.site)]}function TI(e,t){return t[+(t.left===e.site)]}function zI(){for(var e=0,t=KI.length,n,r,i,a;e<t;++e){if((n=KI[e])&&(a=(r=n.halfedges).length)){var u=new Array(a),o=new Array(a);for(i=0;i<a;++i)u[i]=i,o[i]=NI(n,tU[r[i]]);u.sort(function(e,t){return o[t]-o[e]});for(i=0;i<a;++i)o[i]=r[u[i]];for(i=0;i<a;++i)r[i]=o[i]}}}function RI(e,t,n,r){var i=KI.length,a,u,o,f,c,l,s,d,h,p,v,g,m=true;for(a=0;a<i;++a){if(u=KI[a]){o=u.site;c=u.halfedges;f=c.length;while(f--){if(!tU[c[f]]){c.splice(f,1)}}f=0,l=c.length;while(f<l){p=TI(u,tU[c[f]]),v=p[0],g=p[1];s=FI(u,tU[c[++f%l]]),d=s[0],h=s[1];if(Math.abs(v-d)>ZI||Math.abs(g-h)>ZI){c.splice(f,0,tU.push(EI(o,p,Math.abs(v-e)<ZI&&r-g>ZI?[e,Math.abs(d-e)<ZI?h:r]:Math.abs(g-r)<ZI&&n-v>ZI?[Math.abs(h-r)<ZI?d:n,r]:Math.abs(v-n)<ZI&&g-t>ZI?[n,Math.abs(d-n)<ZI?h:t]:Math.abs(g-t)<ZI&&v-e>ZI?[Math.abs(h-t)<ZI?d:e,t]:null))-1);++l}}if(l)m=false}}if(m){var y,b,x,_=Infinity;for(a=0,m=null;a<i;++a){if(u=KI[a]){o=u.site;y=o[0]-e;b=o[1]-t;x=y*y+b*b;if(x<_)_=x,m=u}}if(m){var w=[e,t],k=[e,r],O=[n,r],A=[n,t];m.halfedges.push(tU.push(EI(o=m.site,w,k))-1,tU.push(EI(o,k,O))-1,tU.push(EI(o,O,A))-1,tU.push(EI(o,A,w))-1)}}for(a=0;a<i;++a){if(u=KI[a]){if(!u.halfedges.length){delete KI[a]}}}}var PI=[];var LI;function BI(){xI(this);this.x=this.y=this.arc=this.site=this.cy=null}function II(e){var t=e.P,n=e.N;if(!t||!n)return;var r=t.site,i=e.site,a=n.site;if(r===a)return;var u=i[0],o=i[1],f=r[0]-u,c=r[1]-o,l=a[0]-u,s=a[1]-o;var d=2*(f*s-c*l);if(d>=-JI)return;var h=f*f+c*c,p=l*l+s*s,v=(s*h-c*p)/d,g=(f*p-l*h)/d;var m=PI.pop()||new BI;m.arc=e;m.site=i;m.x=v+u;m.y=(m.cy=g+o)+Math.sqrt(v*v+g*g);e.circle=m;var y=null,b=eU._;while(b){if(m.y<b.y||m.y===b.y&&m.x<=b.x){if(b.L)b=b.L;else{y=b.P;break}}else{if(b.R)b=b.R;else{y=b;break}}}eU.insert(y,m);if(!y)LI=m}function UI(e){var t=e.circle;if(t){if(!t.P)LI=t.N;eU.remove(t);PI.push(t);xI(t);e.circle=null}}var qI=[];function WI(){xI(this);this.edge=this.site=this.circle=null}function HI(e){var t=qI.pop()||new WI;t.site=e;return t}function GI(e){UI(e);QI.remove(e);qI.push(e);xI(e)}function YI(e){var t=e.circle,n=t.x,r=t.cy,i=[n,r],a=e.P,u=e.N,o=[e];GI(e);var f=a;while(f.circle&&Math.abs(n-f.circle.x)<ZI&&Math.abs(r-f.circle.cy)<ZI){a=f.P;o.unshift(f);GI(f);f=a}o.unshift(f);UI(f);var c=u;while(c.circle&&Math.abs(n-c.circle.x)<ZI&&Math.abs(r-c.circle.cy)<ZI){u=c.N;o.push(c);GI(c);c=u}o.push(c);UI(c);var l=o.length,s;for(s=1;s<l;++s){c=o[s];f=o[s-1];MI(c.edge,f.site,c.site,i)}f=o[0];c=o[l-1];c.edge=AI(f.site,c.site,null,i);II(f);II(c)}function $I(e){var t=e[0],n=e[1],r,i,a,u,o=QI._;while(o){a=VI(o,n)-t;if(a>ZI)o=o.L;else{u=t-XI(o,n);if(u>ZI){if(!o.R){r=o;break}o=o.R}else{if(a>-ZI){r=o.P;i=o}else if(u>-ZI){r=o;i=o.N}else{r=i=o}break}}}jI(e);var f=HI(e);QI.insert(r,f);if(!r&&!i)return;if(r===i){UI(r);i=HI(r.site);QI.insert(f,i);f.edge=i.edge=AI(r.site,f.site);II(r);II(i);return}if(!i){f.edge=AI(r.site,f.site);return}UI(r);UI(i);var c=r.site,l=c[0],s=c[1],d=e[0]-l,h=e[1]-s,p=i.site,v=p[0]-l,g=p[1]-s,m=2*(d*g-h*v),y=d*d+h*h,b=v*v+g*g,x=[(g*y-h*b)/m+l,(d*b-v*y)/m+s];MI(i.edge,c,p,x);f.edge=AI(c,e,null,x);i.edge=AI(e,p,null,x);II(r);II(i)}function VI(e,t){var n=e.site,r=n[0],i=n[1],a=i-t;if(!a)return r;var u=e.P;if(!u)return-Infinity;n=u.site;var o=n[0],f=n[1],c=f-t;if(!c)return o;var l=o-r,s=1/a-1/c,d=l/c;if(s)return(-d+Math.sqrt(d*d-2*s*(l*l/(-2*c)-f+c/2+i-a/2)))/s+r;return(r+o)/2}function XI(e,t){var n=e.N;if(n)return VI(n,t);var r=e.site;return r[1]===t?r[0]:Infinity}var ZI=1e-6;var JI=1e-12;var QI;var KI;var eU;var tU;function nU(e,t,n){return(e[0]-n[0])*(t[1]-e[1])-(e[0]-t[0])*(n[1]-e[1])}function rU(e,t){return t[1]-e[1]||t[0]-e[0]}function iU(e,t){var n=e.sort(rU).pop(),r,i,a;tU=[];KI=new Array(e.length);QI=new OI;eU=new OI;while(true){a=LI;if(n&&(!a||n[1]<a.y||n[1]===a.y&&n[0]<a.x)){if(n[0]!==r||n[1]!==i){$I(n);r=n[0],i=n[1]}n=e.pop()}else if(a){YI(a.arc)}else{break}}zI();if(t){var u=+t[0][0],o=+t[0][1],f=+t[1][0],c=+t[1][1];DI(u,o,f,c);RI(u,o,f,c)}this.edges=tU;this.cells=KI;QI=eU=tU=KI=null}iU.prototype={constructor:iU,polygons:function(){var e=this.edges;return this.cells.map(function(t){var n=t.halfedges.map(function(n){return FI(t,e[n])});n.data=t.site.data;return n})},triangles:function(){var e=[],t=this.edges;this.cells.forEach(function(n,r){if(!(o=(a=n.halfedges).length))return;var i=n.site,a,u=-1,o,f,c=t[a[o-1]],l=c.left===i?c.right:c.left;while(++u<o){f=l;c=t[a[u]];l=c.left===i?c.right:c.left;if(f&&l&&r<f.index&&r<l.index&&nU(i,f,l)<0){e.push([i.data,f.data,l.data])}}});return e},links:function(){return this.edges.filter(function(e){return e.right}).map(function(e){return{source:e.left.data,target:e.right.data}})},find:function(e,t,n){var r=this,i,a=r._found||0,u=r.cells.length,o;while(!(o=r.cells[a]))if(++a>=u)return null;var f=e-o.site[0],c=t-o.site[1],l=f*f+c*c;do{o=r.cells[i=a],a=null;o.halfedges.forEach(function(n){var i=r.edges[n],u=i.left;if((u===o.site||!u)&&!(u=i.right))return;var f=e-u[0],c=t-u[1],s=f*f+c*c;if(s<l)l=s,a=u.index})}while(a!==null);r._found=i;return n==null||l<=n*n?o.site:null}};var aU=function(){var e=mI,t=yI,n=null;function r(r){return new iU(r.map(function(n,i){var a=[Math.round(e(n,i,r)/ZI)*ZI,Math.round(t(n,i,r)/ZI)*ZI];a.index=i;a.data=n;return a}),n)}r.polygons=function(e){return r(e).polygons()};r.links=function(e){return r(e).links()};r.triangles=function(e){return r(e).triangles()};r.x=function(t){return arguments.length?(e=typeof t==="function"?t:gI(+t),r):e};r.y=function(e){return arguments.length?(t=typeof e==="function"?e:gI(+e),r):t};r.extent=function(e){return arguments.length?(n=e==null?null:[[+e[0][0],+e[0][1]],[+e[1][0],+e[1][1]]],r):n&&[[n[0][0],n[0][1]],[n[1][0],n[1][1]]]};r.size=function(e){return arguments.length?(n=e==null?null:[[0,0],[+e[0],+e[1]]],r):n&&[n[1][0]-n[0][0],n[1][1]-n[0][1]]};return r};function uU(e){Go.call(this,null,e)}uU.Definition={type:"Voronoi",metadata:{modifies:true},params:[{name:"x",type:"field",required:true},{name:"y",type:"field",required:true},{name:"size",type:"number",array:true,length:2},{name:"extent",type:"array",array:true,length:2,default:[[-1e5,-1e5],[1e5,1e5]],content:{type:"number",array:true,length:2}},{name:"as",type:"string",default:"path"}]};var oU=Object(dn["x"])(uU,Go);var fU=[[-1e5,-1e5],[1e5,1e5]];oU.transform=function(e,t){var n=e.as||"path",r=t.source,i,a,u,o;i=aU().x(e.x).y(e.y);if(e.size)i.size(e.size);else i.extent(e.extent||fU);this.value=i=i(r);a=i.polygons();for(u=0,o=r.length;u<o;++u){r[u][n]=a[u]?"M"+a[u].join("L")+"Z":null}return t.reflow(e.modified()).modifies(n)};var cU=Math.PI/180,lU=1<<11>>5,sU=1<<11;var dU=function(){var e=[256,256],t,n,r,i,a,u,o,f=mU,c=[],l=Math.random,s={};s.layout=function(){var f=d(id()),s=bU((e[0]>>5)*e[1]),p=null,v=c.length,g=-1,m=[],y=c.map(function(e){return{text:t(e),font:n(e),style:i(e),weight:a(e),rotate:u(e),size:~~r(e),padding:o(e),xoff:0,yoff:0,x1:0,y1:0,x0:0,y0:0,hasText:false,sprite:null,datum:e}}).sort(function(e,t){return t.size-e.size});while(++g<v){var b=y[g];b.x=e[0]*(l()+.5)>>1;b.y=e[1]*(l()+.5)>>1;hU(f,b,y,g);if(b.hasText&&h(s,b,p)){m.push(b);if(p)vU(p,b);else p=[{x:b.x+b.x0,y:b.y+b.y0},{x:b.x+b.x1,y:b.y+b.y1}];b.x-=e[0]>>1;b.y-=e[1]>>1}}return m};function d(e){e.width=e.height=1;var t=Math.sqrt(e.getContext("2d").getImageData(0,0,1,1).data.length>>2);e.width=(lU<<5)/t;e.height=sU/t;var n=e.getContext("2d");n.fillStyle=n.strokeStyle="red";n.textAlign="center";return{context:n,ratio:t}}function h(t,n,r){var i=n.x,a=n.y,u=Math.sqrt(e[0]*e[0]+e[1]*e[1]),o=f(e),c=l()<.5?1:-1,s=-c,d,h,p;while(d=o(s+=c)){h=~~d[0];p=~~d[1];if(Math.min(Math.abs(h),Math.abs(p))>=u)break;n.x=i+h;n.y=a+p;if(n.x+n.x0<0||n.y+n.y0<0||n.x+n.x1>e[0]||n.y+n.y1>e[1])continue;if(!r||!pU(n,t,e[0])){if(!r||gU(n,r)){var v=n.sprite,g=n.width>>5,m=e[0]>>5,y=n.x-(g<<4),b=y&127,x=32-b,_=n.y1-n.y0,w=(n.y+n.y0)*m+(y>>5),k;for(var O=0;O<_;O++){k=0;for(var A=0;A<=g;A++){t[w+A]|=k<<x|(A<g?(k=v[O*g+A])>>>b:0)}w+=m}n.sprite=null;return true}}}return false}s.words=function(e){if(arguments.length){c=e;return s}else{return c}};s.size=function(t){if(arguments.length){e=[+t[0],+t[1]];return s}else{return e}};s.font=function(e){if(arguments.length){n=xU(e);return s}else{return n}};s.fontStyle=function(e){if(arguments.length){i=xU(e);return s}else{return i}};s.fontWeight=function(e){if(arguments.length){a=xU(e);return s}else{return a}};s.rotate=function(e){if(arguments.length){u=xU(e);return s}else{return u}};s.text=function(e){if(arguments.length){t=xU(e);return s}else{return t}};s.spiral=function(e){if(arguments.length){f=_U[e]||e;return s}else{return f}};s.fontSize=function(e){if(arguments.length){r=xU(e);return s}else{return r}};s.padding=function(e){if(arguments.length){o=xU(e);return s}else{return o}};s.random=function(e){if(arguments.length){l=e;return s}else{return l}};return s};function hU(e,t,n,r){if(t.sprite)return;var i=e.context,a=e.ratio;i.clearRect(0,0,(lU<<5)/a,sU/a);var u=0,o=0,f=0,c=n.length,l,s,d,h,p;--r;while(++r<c){t=n[r];i.save();i.font=t.style+" "+t.weight+" "+~~((t.size+1)/a)+"px "+t.font;l=i.measureText(t.text+"m").width*a;d=t.size<<1;if(t.rotate){var v=Math.sin(t.rotate*cU),g=Math.cos(t.rotate*cU),m=l*g,y=l*v,b=d*g,x=d*v;l=Math.max(Math.abs(m+x),Math.abs(m-x))+31>>5<<5;d=~~Math.max(Math.abs(y+b),Math.abs(y-b))}else{l=l+31>>5<<5}if(d>f)f=d;if(u+l>=lU<<5){u=0;o+=f;f=0}if(o+d>=sU)break;i.translate((u+(l>>1))/a,(o+(d>>1))/a);if(t.rotate)i.rotate(t.rotate*cU);i.fillText(t.text,0,0);if(t.padding){i.lineWidth=2*t.padding;i.strokeText(t.text,0,0)}i.restore();t.width=l;t.height=d;t.xoff=u;t.yoff=o;t.x1=l>>1;t.y1=d>>1;t.x0=-t.x1;t.y0=-t.y1;t.hasText=true;u+=l}var _=i.getImageData(0,0,(lU<<5)/a,sU/a).data,w=[];while(--r>=0){t=n[r];if(!t.hasText)continue;l=t.width;s=l>>5;d=t.y1-t.y0;for(h=0;h<d*s;h++)w[h]=0;u=t.xoff;if(u==null)return;o=t.yoff;var k=0,O=-1;for(p=0;p<d;p++){for(h=0;h<l;h++){var A=s*p+(h>>5),E=_[(o+p)*(lU<<5)+(u+h)<<2]?1<<31-h%32:0;w[A]|=E;k|=E}if(k)O=p;else{t.y0++;d--;p--;o++}}t.y1=t.y0+O;t.sprite=w.slice(0,(t.y1-t.y0)*s)}}function pU(e,t,n){n>>=5;var r=e.sprite,i=e.width>>5,a=e.x-(i<<4),u=a&127,o=32-u,f=e.y1-e.y0,c=(e.y+e.y0)*n+(a>>5),l;for(var s=0;s<f;s++){l=0;for(var d=0;d<=i;d++){if((l<<o|(d<i?(l=r[s*i+d])>>>u:0))&t[c+d])return true}c+=n}return false}function vU(e,t){var n=e[0],r=e[1];if(t.x+t.x0<n.x)n.x=t.x+t.x0;if(t.y+t.y0<n.y)n.y=t.y+t.y0;if(t.x+t.x1>r.x)r.x=t.x+t.x1;if(t.y+t.y1>r.y)r.y=t.y+t.y1}function gU(e,t){return e.x+e.x1>t[0].x&&e.x+e.x0<t[1].x&&e.y+e.y1>t[0].y&&e.y+e.y0<t[1].y}function mU(e){var t=e[0]/e[1];return function(e){return[t*(e*=.1)*Math.cos(e),e*Math.sin(e)]}}function yU(e){var t=4,n=t*e[0]/e[1],r=0,i=0;return function(e){var a=e<0?-1:1;switch(Math.sqrt(1+4*a*e)-a&3){case 0:r+=n;break;case 1:i+=t;break;case 2:r-=n;break;default:i-=t;break}return[r,i]}}function bU(e){var t=[],n=-1;while(++n<e)t[n]=0;return t}function xU(e){return typeof e==="function"?e:function(){return e}}var _U={archimedean:mU,rectangular:yU};var wU=["x","y","font","fontSize","fontStyle","fontWeight","angle"];var kU=["text","font","rotate","fontSize","fontStyle","fontWeight"];function OU(e){Go.call(this,dU(),e)}OU.Definition={type:"Wordcloud",metadata:{modifies:true},params:[{name:"size",type:"number",array:true,length:2},{name:"font",type:"string",expr:true,default:"sans-serif"},{name:"fontStyle",type:"string",expr:true,default:"normal"},{name:"fontWeight",type:"string",expr:true,default:"normal"},{name:"fontSize",type:"number",expr:true,default:14},{name:"fontSizeRange",type:"number",array:"nullable",default:[10,50]},{name:"rotate",type:"number",expr:true,default:0},{name:"text",type:"field"},{name:"spiral",type:"string",values:["archimedean","rectangular"]},{name:"padding",type:"number",expr:true},{name:"as",type:"string",array:true,length:7,default:wU}]};var AU=Object(dn["x"])(OU,Go);AU.transform=function(e,t){function n(n){var r=e[n];return Object(dn["C"])(r)&&t.modified(r.fields)}var r=e.modified();if(!(r||t.changed(t.ADD_REM)||kU.some(n)))return;var i=t.materialize(t.SOURCE).source,a=this.value,u=e.as||wU,o=e.fontSize||14,f;Object(dn["C"])(o)?f=e.fontSizeRange:o=Object(dn["l"])(o);if(f){var c=o,l=CA("sqrt")().domain(EU(c,i)).range(f);o=function(e){return l(c(e))}}i.forEach(function(e){e[u[0]]=NaN;e[u[1]]=NaN;e[u[3]]=0});var s=a.words(i).text(e.text).size(e.size||[500,500]).padding(e.padding||1).spiral(e.spiral||"archimedean").rotate(e.rotate||0).font(e.font||"sans-serif").fontStyle(e.fontStyle||"normal").fontWeight(e.fontWeight||"normal").fontSize(o).random(lf).layout();var d=a.size(),h=d[0]>>1,p=d[1]>>1,v=0,g=s.length,m,y;for(;v<g;++v){m=s[v];y=m.datum;y[u[0]]=m.x+h;y[u[1]]=m.y+p;y[u[2]]=m.font;y[u[3]]=m.size;y[u[4]]=m.style;y[u[5]]=m.weight;y[u[6]]=m.rotate}return t.reflow(r).modifies(u)};function EU(e,t){var n=+Infinity,r=-Infinity,i=0,a=t.length,u;for(;i<a;++i){u=e(t[i]);if(u<n)n=u;if(u>r)r=u}return[n,r]}function MU(e){return new Uint8Array(e)}function SU(e){return new Uint16Array(e)}function CU(e){return new Uint32Array(e)}function DU(){var e=8,t=[],n=CU(0),r=NU(0,e),i=NU(0,e);return{data:function(){return t},seen:function(){return n=jU(n,t.length)},add:function(e){for(var n=0,r=t.length,i=e.length,a;n<i;++n){a=e[n];a._index=r++;t.push(a)}},remove:function(e,n){var a=t.length,u=Array(a-e),o=t,f,c,l;for(c=0;!n[c]&&c<a;++c){u[c]=t[c];o[c]=c}for(l=c;c<a;++c){f=t[c];if(!n[c]){o[c]=l;r[l]=r[c];i[l]=i[c];u[l]=f;f._index=l++}else{o[c]=-1}r[c]=0}t=u;return o},size:function(){return t.length},curr:function(){return r},prev:function(){return i},reset:function(e){i[e]=r[e]},all:function(){return e<257?255:e<65537?65535:4294967295},set:function(e,t){r[e]|=t},clear:function(e,t){r[e]&=~t},resize:function(t,n){var a=r.length;if(t>a||n>e){e=Math.max(n,e);r=NU(t,e,r);i=NU(t,e)}}}}function jU(e,t,n){if(e.length>=t)return e;n=n||new e.constructor(t);n.set(e);return n}function NU(e,t,n){var r=(t<257?MU:t<65537?SU:CU)(e);if(n)r.set(n);return r}var FU=function(e,t,n){var r=1<<t;return{one:r,zero:~r,range:n.slice(),bisect:e.bisect,index:e.index,size:e.size,onAdd:function(e,t){var n=this,i=n.bisect(n.range,e.value),a=e.index,u=i[0],o=i[1],f=a.length,c;for(c=0;c<u;++c)t[a[c]]|=r;for(c=o;c<f;++c)t[a[c]]|=r;return n}}};function TU(){var e=CU(0),t=[],n=0;function r(r,i,a){if(!i.length)return[];var u=n,o=i.length,f=Array(o),c=CU(o),l,s,d;for(d=0;d<o;++d){f[d]=r(i[d]);c[d]=d}f=zU(f,c);if(u){l=t;s=e;t=Array(u+o);e=CU(u+o);RU(a,l,s,u,f,c,o,t,e)}else{if(a>0)for(d=0;d<o;++d){c[d]+=a}t=f;e=c}n=u+o;return{index:c,value:f}}function i(r,i){var a=n,u,o,f;for(o=0;!i[e[o]]&&o<a;++o);for(f=o;o<a;++o){if(!i[u=e[o]]){e[f]=u;t[f]=t[o];++f}}n=a-r}function a(t){for(var r=0,i=n;r<i;++r){e[r]=t[e[r]]}}function u(e,r){var i;if(r){i=r.length}else{r=t;i=n}return[mf(r,e[0],0,i),gf(r,e[1],0,i)]}return{insert:r,remove:i,bisect:u,reindex:a,index:function(){return e},size:function(){return n}}}function zU(e,t){e.sort.call(t,function(t,n){var r=e[t],i=e[n];return r<i?-1:r>i?1:0});return uc(e,t)}function RU(e,t,n,r,i,a,u,o,f){var c=0,l=0,s;for(s=0;c<r&&l<u;++s){if(t[c]<i[l]){o[s]=t[c];f[s]=n[c++]}else{o[s]=i[l];f[s]=a[l++]+e}}for(;c<r;++c,++s){o[s]=t[c];f[s]=n[c]}for(;l<u;++l,++s){o[s]=i[l];f[s]=a[l]+e}}function PU(e){Go.call(this,DU(),e);this._indices=null;this._dims=null}PU.Definition={type:"CrossFilter",metadata:{},params:[{name:"fields",type:"field",array:true,required:true},{name:"query",type:"array",array:true,required:true,content:{type:"number",array:true,length:2}}]};var LU=Object(dn["x"])(PU,Go);LU.transform=function(e,t){if(!this._dims){return this.init(e,t)}else{var n=e.modified("fields")||e.fields.some(function(e){return t.modified(e.fields)});return n?this.reinit(e,t):this.eval(e,t)}};LU.init=function(e,t){var n=e.fields,r=e.query,i=this._indices={},a=this._dims=[],u=r.length,o=0,f,c;for(;o<u;++o){f=n[o].fname;c=i[f]||(i[f]=TU());a.push(FU(c,o,r[o]))}return this.eval(e,t)};LU.reinit=function(e,t){var n=t.materialize().fork(),r=e.fields,i=e.query,a=this._indices,u=this._dims,o=this.value,f=o.curr(),c=o.prev(),l=o.all(),s=n.rem=n.add,d=n.mod,h=i.length,p={},v,g,m,y,b,x,_,w,k;c.set(f);if(t.rem.length){b=this.remove(e,t,n)}if(t.add.length){o.add(t.add)}if(t.mod.length){x={};for(y=t.mod,_=0,w=y.length;_<w;++_){x[y[_]._index]=1}}for(_=0;_<h;++_){k=r[_];if(!u[_]||e.modified("fields",_)||t.modified(k.fields)){m=k.fname;if(!(v=p[m])){a[m]=g=TU();p[m]=v=g.insert(k,t.source,0)}u[_]=FU(g,_,i[_]).onAdd(v,f)}}for(_=0,w=o.data().length;_<w;++_){if(b[_]){continue}else if(c[_]!==f[_]){s.push(_)}else if(x[_]&&f[_]!==l){d.push(_)}}o.mask=(1<<h)-1;return n};LU.eval=function(e,t){var n=t.materialize().fork(),r=this._dims.length,i=0;if(t.rem.length){this.remove(e,t,n);i|=(1<<r)-1}if(e.modified("query")&&!e.modified("fields")){i|=this.update(e,t,n)}if(t.add.length){this.insert(e,t,n);i|=(1<<r)-1}if(t.mod.length){this.modify(t,n);i|=(1<<r)-1}this.value.mask=i;return n};LU.insert=function(e,t,n){var r=t.add,i=this.value,a=this._dims,u=this._indices,o=e.fields,f={},c=n.add,l=i.size(),s=l+r.length,d=a.length,h,p,v;i.resize(s,d);i.add(r);var g=i.curr(),m=i.prev(),y=i.all();for(h=0;h<d;++h){p=o[h].fname;v=f[p]||(f[p]=u[p].insert(o[h],r,l));a[h].onAdd(v,g)}for(;l<s;++l){m[l]=y;if(g[l]!==y)c.push(l)}};LU.modify=function(e,t){var n=t.mod,r=this.value,i=r.curr(),a=r.all(),u=e.mod,o,f,c;for(o=0,f=u.length;o<f;++o){c=u[o]._index;if(i[c]!==a)n.push(c)}};LU.remove=function(e,t,n){var r=this._indices,i=this.value,a=i.curr(),u=i.prev(),o=i.all(),f={},c=n.rem,l=t.rem,s,d,h,p;for(s=0,d=l.length;s<d;++s){h=l[s]._index;f[h]=1;u[h]=p=a[h];a[h]=o;if(p!==o)c.push(h)}for(h in r){r[h].remove(d,f)}this.reindex(t,d,f);return f};LU.reindex=function(e,t,n){var r=this._indices,i=this.value;e.runAfter(function(){var e=i.remove(t,n);for(var a in r)r[a].reindex(e)})};LU.update=function(e,t,n){var r=this._dims,i=e.query,a=t.stamp,u=r.length,o=0,f,c;n.filters=0;for(c=0;c<u;++c){if(e.modified("query",c)){f=c;++o}}if(o===1){o=r[f].one;this.incrementOne(r[f],i[f],n.add,n.rem)}else{for(c=0,o=0;c<u;++c){if(!e.modified("query",c))continue;o|=r[c].one;this.incrementAll(r[c],i[c],a,n.add);n.rem=n.add}}return o};LU.incrementAll=function(e,t,n,r){var i=this.value,a=i.seen(),u=i.curr(),o=i.prev(),f=e.index(),c=e.bisect(e.range),l=e.bisect(t),s=l[0],d=l[1],h=c[0],p=c[1],v=e.one,g,m,y;if(s<h){for(g=s,m=Math.min(h,d);g<m;++g){y=f[g];if(a[y]!==n){o[y]=u[y];a[y]=n;r.push(y)}u[y]^=v}}else if(s>h){for(g=h,m=Math.min(s,p);g<m;++g){y=f[g];if(a[y]!==n){o[y]=u[y];a[y]=n;r.push(y)}u[y]^=v}}if(d>p){for(g=Math.max(s,p),m=d;g<m;++g){y=f[g];if(a[y]!==n){o[y]=u[y];a[y]=n;r.push(y)}u[y]^=v}}else if(d<p){for(g=Math.max(h,d),m=p;g<m;++g){y=f[g];if(a[y]!==n){o[y]=u[y];a[y]=n;r.push(y)}u[y]^=v}}e.range=t.slice()};LU.incrementOne=function(e,t,n,r){var i=this.value,a=i.curr(),u=e.index(),o=e.bisect(e.range),f=e.bisect(t),c=f[0],l=f[1],s=o[0],d=o[1],h=e.one,p,v,g;if(c<s){for(p=c,v=Math.min(s,l);p<v;++p){g=u[p];a[g]^=h;n.push(g)}}else if(c>s){for(p=s,v=Math.min(c,d);p<v;++p){g=u[p];a[g]^=h;r.push(g)}}if(l>d){for(p=Math.max(c,d),v=l;p<v;++p){g=u[p];a[g]^=h;n.push(g)}}else if(l<d){for(p=Math.max(s,l),v=d;p<v;++p){g=u[p];a[g]^=h;r.push(g)}}e.range=t.slice()};function BU(e){Go.call(this,null,e)}BU.Definition={type:"ResolveFilter",metadata:{},params:[{name:"ignore",type:"number",required:true,description:"A bit mask indicating which filters to ignore."},{name:"filter",type:"object",required:true,description:"Per-tuple filter bitmaps from a CrossFilter transform."}]};var IU=Object(dn["x"])(BU,Go);IU.transform=function(e,t){var n=~(e.ignore||0),r=e.filter,i=r.mask;if((i&n)===0)return t.StopPropagation;var a=t.fork(t.ALL),u=r.data(),o=r.curr(),f=r.prev(),c=function(e){return!(o[e]&n)?u[e]:null};a.filter(a.MOD,c);if(!(i&i-1)){a.filter(a.ADD,c);a.filter(a.REM,function(e){return(o[e]&n)===i?u[e]:null})}else{a.filter(a.ADD,function(e){var t=o[e]&n,r=!t&&t^f[e]&n;return r?u[e]:null});a.filter(a.REM,function(e){var t=o[e]&n,r=t&&!(t^(t^f[e]&n));return r?u[e]:null})}return a.filter(a.SOURCE,function(e){return c(e._index)})};var UU=n("HIPa");var qU="default";var WU=function(e){var t=e._signals.cursor;if(!t){e._signals.cursor=t=e.add({user:qU,item:null})}e.on(e.events("view","mousemove"),t,function(e,n){var r=t.value,i=r?Object(dn["G"])(r)?r:r.user:qU,a=n.item&&n.item.cursor||null;return r&&i===r.user&&a==r.item?r:{user:i,item:a}});e.add(null,function(e){var t=e.cursor,n=this.value;if(!Object(dn["G"])(t)){n=t.item;t=t.user}HU(t&&t!==qU?t:n||t);return n},{cursor:t})};function HU(e){if(typeof document!=="undefined"&&document.body){document.body.style.cursor=e}}function GU(e,t){var n=e._runtime.data;if(!n.hasOwnProperty(t)){Object(dn["n"])("Unrecognized data set: "+t)}return n[t]}function YU(e){return GU(this,e).values.value}function $U(e,t){if(!On(t)){Object(dn["n"])("Second argument to changes must be a changeset.")}var n=GU(this,e);n.modified=true;return this.pulse(n.input,t)}function VU(e,t){return $U.call(this,e,An().insert(t))}function XU(e,t){return $U.call(this,e,An().remove(t))}function ZU(e){var t=e.padding();return Math.max(0,e._viewWidth+t.left+t.right)}function JU(e){var t=e.padding();return Math.max(0,e._viewHeight+t.top+t.bottom)}function QU(e){var t=e.padding(),n=e._origin;return[t.left+n[0],t.top+n[1]]}function KU(e){var t=QU(e),n=ZU(e),r=JU(e);e._renderer.background(e._background);e._renderer.resize(n,r,t);e._handler.origin(t);e._resizeListeners.forEach(function(t){try{t(n,r)}catch(t){e.error(t)}})}var eq=function(e,t,n){var r=e._renderer.canvas(),i,a,u;if(r){u=QU(e);a=t.changedTouches?t.changedTouches[0]:t;i=Bm(a,r);i[0]-=u[0];i[1]-=u[1]}t.dataflow=e;t.vega=tq(e,n,i);t.item=n;return t};function tq(e,t,n){var r=t?t.mark.marktype==="group"?t:t.mark.group:null;function i(e){var n=r,i;if(e)for(i=t;i;i=i.mark.group){if(i.mark.name===e){n=i;break}}return n&&n.mark&&n.mark.interactive?n:{}}function a(e){if(!e)return n;if(Object(dn["G"])(e))e=i(e);var t=n.slice();while(e){t[0]-=e.x||0;t[1]-=e.y||0;e=e.mark&&e.mark.group}return t}return{view:Object(dn["l"])(e),item:Object(dn["l"])(t||{}),group:i,xy:a,x:function(e){return a(e)[0]},y:function(e){return a(e)[1]}}}var nq="view",rq="timer",iq="window",aq={trap:false};function uq(e){e=Object(dn["o"])({},e);var t=e.defaults;if(t){if(Object(dn["z"])(t.prevent)){t.prevent=Object(dn["ab"])(t.prevent)}if(Object(dn["z"])(t.allow)){t.allow=Object(dn["ab"])(t.allow)}}return e}function oq(e,t){var n=e._eventConfig.defaults,r=n&&n.prevent,i=n&&n.allow;return r===false||i===true?false:r===true||i===false?true:r?r[t]:i?!i[t]:e.preventDefault()}function fq(e,t,n){var r=this,i=new In(n),a=function(n,a){if(e===nq&&oq(r,t)){n.preventDefault()}try{i.receive(eq(r,n,a))}catch(e){r.error(e)}finally{r.run()}},u;if(e===rq){r.timer(a,t)}else if(e===nq){r.addEventListener(t,a,aq)}else{if(e===iq){if(typeof window!=="undefined")u=[window]}else if(typeof document!=="undefined"){u=document.querySelectorAll(e)}if(!u){r.warn("Can not resolve event source: "+e)}else{for(var o=0,f=u.length;o<f;++o){u[o].addEventListener(t,a)}r._eventListeners.push({type:t,sources:u,handler:a})}}return i}function cq(e){return e.item}function lq(e){var t=e.item.mark.source;return t.source||t}function sq(e){return function(t,n){return n.vega.view().changeset().encode(n.item,e)}}var dq=function(e,t){e=[e||"hover"];t=[t||"update",e[0]];this.on(this.events("view","mouseover",cq),lq,sq(e));this.on(this.events("view","mouseout",cq),lq,sq(t));return this};var hq=function(){var e=this._tooltip,t=this._timers,n=this._eventListeners,r,i,a;r=t.length;while(--r>=0){t[r].stop()}r=n.length;while(--r>=0){a=n[r];i=a.sources.length;while(--i>=0){a.sources[i].removeEventListener(a.type,a.handler)}}if(e){e.call(this,this._handler,null,null,null)}return this};var pq=function(e,t,n){var r=document.createElement(e);for(var i in t)r.setAttribute(i,t[i]);if(n!=null)r.textContent=n;return r};var vq="vega-bind",gq="vega-bind-name",mq="vega-bind-radio",yq="vega-option-";var bq=function(e,t,n){if(!t)return;var r=n.param,i=n.state;if(!i){i=n.state={elements:null,active:false,set:null,update:function(t){if(t!==e.signal(r.signal)){i.source=true;e.signal(r.signal,t).run()}}};if(r.debounce){i.update=Object(dn["m"])(r.debounce,i.update)}}xq(i,t,r,e.signal(r.signal));if(!i.active){e.on(e._signals[r.signal],null,function(){i.source?i.source=false:i.set(e.signal(r.signal))});i.active=true}return i};function xq(e,t,n,r){var i=pq("div",{class:vq});i.appendChild(pq("span",{class:gq},n.name||n.signal));t.appendChild(i);var a=_q;switch(n.input){case"checkbox":a=wq;break;case"select":a=kq;break;case"radio":a=Oq;break;case"range":a=Aq;break}a(e,i,n,r)}function _q(e,t,n,r){var i=pq("input");for(var a in n){if(a!=="signal"&&a!=="element"){i.setAttribute(a==="input"?"type":a,n[a])}}i.setAttribute("name",n.signal);i.value=r;t.appendChild(i);i.addEventListener("input",function(){e.update(i.value)});e.elements=[i];e.set=function(e){i.value=e}}function wq(e,t,n,r){var i={type:"checkbox",name:n.signal};if(r)i.checked=true;var a=pq("input",i);t.appendChild(a);a.addEventListener("change",function(){e.update(a.checked)});e.elements=[a];e.set=function(e){a.checked=!!e||null}}function kq(e,t,n,r){var i=pq("select",{name:n.signal});n.options.forEach(function(e){var t={value:e};if(Eq(e,r))t.selected=true;i.appendChild(pq("option",t,e+""))});t.appendChild(i);i.addEventListener("change",function(){e.update(n.options[i.selectedIndex])});e.elements=[i];e.set=function(e){for(var t=0,r=n.options.length;t<r;++t){if(Eq(n.options[t],e)){i.selectedIndex=t;return}}}}function Oq(e,t,n,r){var i=pq("span",{class:mq});t.appendChild(i);e.elements=n.options.map(function(t){var a=yq+n.signal+"-"+t;var u={id:a,type:"radio",name:n.signal,value:t};if(Eq(t,r))u.checked=true;var o=pq("input",u);o.addEventListener("change",function(){e.update(t)});i.appendChild(o);i.appendChild(pq("label",{for:a},t+""));return o});e.set=function(t){var n=e.elements,r=0,i=n.length;for(;r<i;++r){if(Eq(n[r].value,t))n[r].checked=true}}}function Aq(e,t,n,r){r=r!==undefined?r:(+n.max+ +n.min)/2;var i=n.min||Math.min(0,+r)||0,a=n.max||Math.max(100,+r)||100,u=n.step||qf(i,a,100);var o=pq("input",{type:"range",name:n.signal,min:i,max:a,step:u});o.value=r;var f=pq("label",{},+r);t.appendChild(o);t.appendChild(f);function c(){f.textContent=o.value;e.update(+o.value)}o.addEventListener("input",c);o.addEventListener("change",c);e.elements=[o];e.set=function(e){o.value=e;f.textContent=e}}function Eq(e,t){return e===t||e+""===t+""}var Mq=function(e,t,n,r,i){t=t||new r(e.loader());return t.initialize(n,ZU(e),JU(e),QU(e),i).background(e._background)};var Sq=function(e,t){return!t?null:function(){try{t.apply(this,arguments)}catch(t){e.error(t)}}};var Cq=function(e,t,n,r){var i=new r(e.loader(),Sq(e,e.tooltip())).scene(e.scenegraph().root).initialize(n,QU(e),e);if(t){t.handlers().forEach(function(e){i.on(e.type,e.handler)})}return i};var Dq=function(e,t){var n=this,r=n._renderType,i=$y(r),a,u;e=n._el=e?jq(n,e):null;if(!i)n.error("Unrecognized renderer type: "+r);a=i.handler||Zm;u=e?i.renderer:i.headless;n._renderer=!u?null:Mq(n,n._renderer,e,u);n._handler=Cq(n,n._handler,e,a);n._redraw=true;if(e){t=t?jq(n,t):e.appendChild(pq("div",{class:"vega-bindings"}));n._bind.forEach(function(e){if(e.param.element){e.element=jq(n,e.param.element)}});n._bind.forEach(function(e){bq(n,e.element||t,e)})}return n};function jq(e,t){if(typeof t==="string"){if(typeof document!=="undefined"){t=document.querySelector(t);if(!t){e.error("Signal bind element not found: "+t);return null}}else{e.error("DOM document instance not found.");return null}}if(t){try{t.innerHTML=""}catch(n){t=null;e.error(n)}}return t}var Nq=function(e,t,n){var r=$y(t),i=r&&r.headless;return!i?Promise.reject("Unrecognized renderer type: "+t):e.runAsync().then(function(){return Mq(e,null,null,i,n).renderAsync(e._scenegraph.root)})};var Fq=function(e,t){return e!==Gy.Canvas&&e!==Gy.SVG&&e!==Gy.PNG?Promise.reject("Unrecognized image type: "+e):Nq(this,e,t).then(function(t){return e===Gy.SVG?Tq(t.svg(),"image/svg+xml"):t.canvas().toDataURL("image/png")})};function Tq(e,t){var n=new Blob([e],{type:t});return window.URL.createObjectURL(n)}var zq=function(e){return Nq(this,Gy.Canvas,e).then(function(e){return e.canvas()})};var Rq=function(e){return Nq(this,Gy.SVG,e).then(function(e){return e.svg()})};var Pq=function(e,t){e=e||t.autosize;if(Object(dn["E"])(e)){return e}else{e=e||"pad";return{type:e}}};var Lq=function(e,t){e=e||t.padding;return Object(dn["E"])(e)?{top:Bq(e.top),bottom:Bq(e.bottom),left:Bq(e.left),right:Bq(e.right)}:Iq(Bq(e))};function Bq(e){return+e||0}function Iq(e){return{top:e,bottom:e,left:e,right:e}}var Uq="outer",qq=["value","update","init","react","bind"];function Wq(e,t){Object(dn["n"])(e+' for "outer" push: '+Object(dn["W"])(t))}var Hq=function(e,t){var n=e.name;if(e.push===Uq){if(!t.signals[n])Wq("No prior signal definition",n);qq.forEach(function(t){if(e[t]!==undefined)Wq("Invalid property ",t)})}else{var r=t.addSignal(n,e.value);if(e.react===false)r.react=false;if(e.bind)t.addBinding(n,e.bind)}};var Gq="RawCode";var Yq="Literal";var $q="Property";var Vq="Identifier";var Xq="ArrayExpression";var Zq="BinaryExpression";var Jq="CallExpression";var Qq="ConditionalExpression";var Kq="LogicalExpression";var eW="MemberExpression";var tW="ObjectExpression";var nW="UnaryExpression";function rW(e){this.type=e}rW.prototype.visit=function(e){var t=this,n,r,i;if(e(t))return 1;for(n=iW(t),r=0,i=n.length;r<i;++r){if(n[r].visit(e))return 1}};function iW(e){switch(e.type){case Xq:return e.elements;case Zq:case Kq:return[e.left,e.right];case Jq:var t=e.arguments.slice();t.unshift(e.callee);return t;case Qq:return[e.test,e.consequent,e.alternate];case eW:return[e.object,e.property];case tW:return e.properties;case $q:return[e.key,e.value];case nW:return[e.argument];case Vq:case Yq:case Gq:default:return[]}}var aW,uW,oW,fW,cW;var lW=1,sW=2,dW=3,hW=4,pW=5,vW=6,gW=7,mW=8,yW=9;aW={};aW[lW]="Boolean";aW[sW]="<end>";aW[dW]="Identifier";aW[hW]="Keyword";aW[pW]="Null";aW[vW]="Numeric";aW[gW]="Punctuator";aW[mW]="String";aW[yW]="RegularExpression";var bW="ArrayExpression",xW="BinaryExpression",_W="CallExpression",wW="ConditionalExpression",kW="Identifier",OW="Literal",AW="LogicalExpression",EW="MemberExpression",MW="ObjectExpression",SW="Property",CW="UnaryExpression";var DW="Unexpected token %0",jW="Unexpected number",NW="Unexpected string",FW="Unexpected identifier",TW="Unexpected reserved word",zW="Unexpected end of input",RW="Invalid regular expression",PW="Invalid regular expression: missing /",LW="Octal literals are not allowed in strict mode.",BW="Duplicate data property in object literal not allowed in strict mode";var IW="ILLEGAL",UW="Disabled.";var qW=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),WW=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function HW(e,t){if(!e){throw new Error("ASSERT: "+t)}}function GW(e){return e>=48&&e<=57}function YW(e){return"0123456789abcdefABCDEF".indexOf(e)>=0}function $W(e){return"01234567".indexOf(e)>=0}function VW(e){return e===32||e===9||e===11||e===12||e===160||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(e)>=0}function XW(e){return e===10||e===13||e===8232||e===8233}function ZW(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e===92||e>=128&&qW.test(String.fromCharCode(e))}function JW(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||e===92||e>=128&&WW.test(String.fromCharCode(e))}var QW={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function KW(){var e;while(oW<fW){e=uW.charCodeAt(oW);if(VW(e)||XW(e)){++oW}else{break}}}function eH(e){var t,n,r,i=0;n=e==="u"?4:2;for(t=0;t<n;++t){if(oW<fW&&YW(uW[oW])){r=uW[oW++];i=i*16+"0123456789abcdef".indexOf(r.toLowerCase())}else{SH({},DW,IW)}}return String.fromCharCode(i)}function tH(){var e,t,n,r;e=uW[oW];t=0;if(e==="}"){SH({},DW,IW)}while(oW<fW){e=uW[oW++];if(!YW(e)){break}t=t*16+"0123456789abcdef".indexOf(e.toLowerCase())}if(t>1114111||e!=="}"){SH({},DW,IW)}if(t<=65535){return String.fromCharCode(t)}n=(t-65536>>10)+55296;r=(t-65536&1023)+56320;return String.fromCharCode(n,r)}function nH(){var e,t;e=uW.charCodeAt(oW++);t=String.fromCharCode(e);if(e===92){if(uW.charCodeAt(oW)!==117){SH({},DW,IW)}++oW;e=eH("u");if(!e||e==="\\"||!ZW(e.charCodeAt(0))){SH({},DW,IW)}t=e}while(oW<fW){e=uW.charCodeAt(oW);if(!JW(e)){break}++oW;t+=String.fromCharCode(e);if(e===92){t=t.substr(0,t.length-1);if(uW.charCodeAt(oW)!==117){SH({},DW,IW)}++oW;e=eH("u");if(!e||e==="\\"||!JW(e.charCodeAt(0))){SH({},DW,IW)}t+=e}}return t}function rH(){var e,t;e=oW++;while(oW<fW){t=uW.charCodeAt(oW);if(t===92){oW=e;return nH()}if(JW(t)){++oW}else{break}}return uW.slice(e,oW)}function iH(){var e,t,n;e=oW;t=uW.charCodeAt(oW)===92?nH():rH();if(t.length===1){n=dW}else if(QW.hasOwnProperty(t)){n=hW}else if(t==="null"){n=pW}else if(t==="true"||t==="false"){n=lW}else{n=dW}return{type:n,value:t,start:e,end:oW}}function aH(){var e=oW,t=uW.charCodeAt(oW),n,r=uW[oW],i,a,u;switch(t){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:++oW;return{type:gW,value:String.fromCharCode(t),start:e,end:oW};default:n=uW.charCodeAt(oW+1);if(n===61){switch(t){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:oW+=2;return{type:gW,value:String.fromCharCode(t)+String.fromCharCode(n),start:e,end:oW};case 33:case 61:oW+=2;if(uW.charCodeAt(oW)===61){++oW}return{type:gW,value:uW.slice(e,oW),start:e,end:oW}}}}u=uW.substr(oW,4);if(u===">>>="){oW+=4;return{type:gW,value:u,start:e,end:oW}}a=u.substr(0,3);if(a===">>>"||a==="<<="||a===">>="){oW+=3;return{type:gW,value:a,start:e,end:oW}}i=a.substr(0,2);if(r===i[1]&&"+-<>&|".indexOf(r)>=0||i==="=>"){oW+=2;return{type:gW,value:i,start:e,end:oW}}if("<>=!+-*%&|^/".indexOf(r)>=0){++oW;return{type:gW,value:r,start:e,end:oW}}SH({},DW,IW)}function uH(e){var t="";while(oW<fW){if(!YW(uW[oW])){break}t+=uW[oW++]}if(t.length===0){SH({},DW,IW)}if(ZW(uW.charCodeAt(oW))){SH({},DW,IW)}return{type:vW,value:parseInt("0x"+t,16),start:e,end:oW}}function oH(e){var t="0"+uW[oW++];while(oW<fW){if(!$W(uW[oW])){break}t+=uW[oW++]}if(ZW(uW.charCodeAt(oW))||GW(uW.charCodeAt(oW))){SH({},DW,IW)}return{type:vW,value:parseInt(t,8),octal:true,start:e,end:oW}}function fH(){var e,t,n;n=uW[oW];HW(GW(n.charCodeAt(0))||n===".","Numeric literal must start with a decimal digit or a decimal point");t=oW;e="";if(n!=="."){e=uW[oW++];n=uW[oW];if(e==="0"){if(n==="x"||n==="X"){++oW;return uH(t)}if($W(n)){return oH(t)}if(n&&GW(n.charCodeAt(0))){SH({},DW,IW)}}while(GW(uW.charCodeAt(oW))){e+=uW[oW++]}n=uW[oW]}if(n==="."){e+=uW[oW++];while(GW(uW.charCodeAt(oW))){e+=uW[oW++]}n=uW[oW]}if(n==="e"||n==="E"){e+=uW[oW++];n=uW[oW];if(n==="+"||n==="-"){e+=uW[oW++]}if(GW(uW.charCodeAt(oW))){while(GW(uW.charCodeAt(oW))){e+=uW[oW++]}}else{SH({},DW,IW)}}if(ZW(uW.charCodeAt(oW))){SH({},DW,IW)}return{type:vW,value:parseFloat(e),start:t,end:oW}}function cH(){var e="",t,n,r,i,a=false;t=uW[oW];HW(t==="'"||t==='"',"String literal must starts with a quote");n=oW;++oW;while(oW<fW){r=uW[oW++];if(r===t){t="";break}else if(r==="\\"){r=uW[oW++];if(!r||!XW(r.charCodeAt(0))){switch(r){case"u":case"x":if(uW[oW]==="{"){++oW;e+=tH()}else{e+=eH(r)}break;case"n":e+="\n";break;case"r":e+="\r";break;case"t":e+="\t";break;case"b":e+="\b";break;case"f":e+="\f";break;case"v":e+="\v";break;default:if($W(r)){i="01234567".indexOf(r);if(i!==0){a=true}if(oW<fW&&$W(uW[oW])){a=true;i=i*8+"01234567".indexOf(uW[oW++]);if("0123".indexOf(r)>=0&&oW<fW&&$W(uW[oW])){i=i*8+"01234567".indexOf(uW[oW++])}}e+=String.fromCharCode(i)}else{e+=r}break}}else{if(r==="\r"&&uW[oW]==="\n"){++oW}}}else if(XW(r.charCodeAt(0))){break}else{e+=r}}if(t!==""){SH({},DW,IW)}return{type:mW,value:e,octal:a,start:n,end:oW}}function lH(e,t){var n=e;if(t.indexOf("u")>=0){n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,function(e,t){if(parseInt(t,16)<=1114111){return"x"}SH({},RW)}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x")}try{new RegExp(n)}catch(e){SH({},RW)}try{return new RegExp(e,t)}catch(e){return null}}function sH(){var e,t,n,r,i;e=uW[oW];HW(e==="/","Regular expression literal must start with a slash");t=uW[oW++];n=false;r=false;while(oW<fW){e=uW[oW++];t+=e;if(e==="\\"){e=uW[oW++];if(XW(e.charCodeAt(0))){SH({},PW)}t+=e}else if(XW(e.charCodeAt(0))){SH({},PW)}else if(n){if(e==="]"){n=false}}else{if(e==="/"){r=true;break}else if(e==="["){n=true}}}if(!r){SH({},PW)}i=t.substr(1,t.length-2);return{value:i,literal:t}}function dH(){var e,t,n;t="";n="";while(oW<fW){e=uW[oW];if(!JW(e.charCodeAt(0))){break}++oW;if(e==="\\"&&oW<fW){SH({},DW,IW)}else{n+=e;t+=e}}if(n.search(/[^gimuy]/g)>=0){SH({},RW,n)}return{value:n,literal:t}}function hH(){var e,t,n,r;cW=null;KW();e=oW;t=sH();n=dH();r=lH(t.value,n.value);return{literal:t.literal+n.literal,value:r,regex:{pattern:t.value,flags:n.value},start:e,end:oW}}function pH(e){return e.type===dW||e.type===hW||e.type===lW||e.type===pW}function vH(){var e;KW();if(oW>=fW){return{type:sW,start:oW,end:oW}}e=uW.charCodeAt(oW);if(ZW(e)){return iH()}if(e===40||e===41||e===59){return aH()}if(e===39||e===34){return cH()}if(e===46){if(GW(uW.charCodeAt(oW+1))){return fH()}return aH()}if(GW(e)){return fH()}return aH()}function gH(){var e;e=cW;oW=e.end;cW=vH();oW=e.end;return e}function mH(){var e;e=oW;cW=vH();oW=e}function yH(e){var t=new rW(bW);t.elements=e;return t}function bH(e,t,n){var r=new rW(e==="||"||e==="&&"?AW:xW);r.operator=e;r.left=t;r.right=n;return r}function xH(e,t){var n=new rW(_W);n.callee=e;n.arguments=t;return n}function _H(e,t,n){var r=new rW(wW);r.test=e;r.consequent=t;r.alternate=n;return r}function wH(e){var t=new rW(kW);t.name=e;return t}function kH(e){var t=new rW(OW);t.value=e.value;t.raw=uW.slice(e.start,e.end);if(e.regex){if(t.raw==="//"){t.raw="/(?:)/"}t.regex=e.regex}return t}function OH(e,t,n){var r=new rW(EW);r.computed=e==="[";r.object=t;r.property=n;if(!r.computed)n.member=true;return r}function AH(e){var t=new rW(MW);t.properties=e;return t}function EH(e,t,n){var r=new rW(SW);r.key=t;r.value=n;r.kind=e;return r}function MH(e,t){var n=new rW(CW);n.operator=e;n.argument=t;n.prefix=true;return n}function SH(e,t){var n,r=Array.prototype.slice.call(arguments,2),i=t.replace(/%(\d)/g,function(e,t){HW(t<r.length,"Message reference must be in range");return r[t]});n=new Error(i);n.index=oW;n.description=i;throw n}function CH(e){if(e.type===sW){SH(e,zW)}if(e.type===vW){SH(e,jW)}if(e.type===mW){SH(e,NW)}if(e.type===dW){SH(e,FW)}if(e.type===hW){SH(e,TW)}SH(e,DW,e.value)}function DH(e){var t=gH();if(t.type!==gW||t.value!==e){CH(t)}}function jH(e){return cW.type===gW&&cW.value===e}function NH(e){return cW.type===hW&&cW.value===e}function FH(){var e=[];oW=cW.start;DH("[");while(!jH("]")){if(jH(",")){gH();e.push(null)}else{e.push(XH());if(!jH("]")){DH(",")}}}gH();return yH(e)}function TH(){var e;oW=cW.start;e=gH();if(e.type===mW||e.type===vW){if(e.octal){SH(e,LW)}return kH(e)}return wH(e.value)}function zH(){var e,t,n,r;oW=cW.start;e=cW;if(e.type===dW){n=TH();DH(":");r=XH();return EH("init",n,r)}if(e.type===sW||e.type===gW){CH(e)}else{t=TH();DH(":");r=XH();return EH("init",t,r)}}function RH(){var e=[],t,n,r,i={},a=String;oW=cW.start;DH("{");while(!jH("}")){t=zH();if(t.key.type===kW){n=t.key.name}else{n=a(t.key.value)}r="$"+n;if(Object.prototype.hasOwnProperty.call(i,r)){SH({},BW)}else{i[r]=true}e.push(t);if(!jH("}")){DH(",")}}DH("}");return AH(e)}function PH(){var e;DH("(");e=ZH();DH(")");return e}var LH={if:1,this:1};function BH(){var e,t,n;if(jH("(")){return PH()}if(jH("[")){return FH()}if(jH("{")){return RH()}e=cW.type;oW=cW.start;if(e===dW||LH[cW.value]){n=wH(gH().value)}else if(e===mW||e===vW){if(cW.octal){SH(cW,LW)}n=kH(gH())}else if(e===hW){throw new Error(UW)}else if(e===lW){t=gH();t.value=t.value==="true";n=kH(t)}else if(e===pW){t=gH();t.value=null;n=kH(t)}else if(jH("/")||jH("/=")){n=kH(hH());mH()}else{CH(gH())}return n}function IH(){var e=[];DH("(");if(!jH(")")){while(oW<fW){e.push(XH());if(jH(")")){break}DH(",")}}DH(")");return e}function UH(){var e;oW=cW.start;e=gH();if(!pH(e)){CH(e)}return wH(e.value)}function qH(){DH(".");return UH()}function WH(){var e;DH("[");e=ZH();DH("]");return e}function HH(){var e,t,n;e=BH();for(;;){if(jH(".")){n=qH();e=OH(".",e,n)}else if(jH("(")){t=IH();e=xH(e,t)}else if(jH("[")){n=WH();e=OH("[",e,n)}else{break}}return e}function GH(){var e=HH();if(cW.type===gW){if(jH("++")||jH("--")){throw new Error(UW)}}return e}function YH(){var e,t;if(cW.type!==gW&&cW.type!==hW){t=GH()}else if(jH("++")||jH("--")){throw new Error(UW)}else if(jH("+")||jH("-")||jH("~")||jH("!")){e=gH();t=YH();t=MH(e.value,t)}else if(NH("delete")||NH("void")||NH("typeof")){throw new Error(UW)}else{t=GH()}return t}function $H(e){var t=0;if(e.type!==gW&&e.type!==hW){return 0}switch(e.value){case"||":t=1;break;case"&&":t=2;break;case"|":t=3;break;case"^":t=4;break;case"&":t=5;break;case"==":case"!=":case"===":case"!==":t=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":t=7;break;case"<<":case">>":case">>>":t=8;break;case"+":case"-":t=9;break;case"*":case"/":case"%":t=11;break;default:break}return t}function VH(){var e,t,n,r,i,a,u,o,f,c;e=cW;f=YH();r=cW;i=$H(r);if(i===0){return f}r.prec=i;gH();t=[e,cW];u=YH();a=[f,r,u];while((i=$H(cW))>0){while(a.length>2&&i<=a[a.length-2].prec){u=a.pop();o=a.pop().value;f=a.pop();t.pop();n=bH(o,f,u);a.push(n)}r=gH();r.prec=i;a.push(r);t.push(cW);n=YH();a.push(n)}c=a.length-1;n=a[c];t.pop();while(c>1){t.pop();n=bH(a[c-1].value,a[c-2],n);c-=2}return n}function XH(){var e,t,n;e=VH();if(jH("?")){gH();t=XH();DH(":");n=XH();e=_H(e,t,n)}return e}function ZH(){var e=XH();if(jH(",")){throw new Error(UW)}return e}var JH=function(e){uW=e;oW=0;fW=uW.length;cW=null;mH();var t=ZH();if(cW.type!==sW){throw new Error("Unexpect token after expression.")}return t};var QH={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"};var KH=function(e){function t(t,n,r,i){var a=e(n[0]);if(r){a=r+"("+a+")";if(r.lastIndexOf("new ",0)===0)a="("+a+")"}return a+"."+t+(i<0?"":i===0?"()":"("+n.slice(1).map(e).join(",")+")")}function n(e,n,r){return function(i){return t(e,i,n,r)}}var r="new Date",i="String",a="RegExp";return{isNaN:"isNaN",isFinite:"isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(t){if(t.length<3)Object(dn["n"])("Missing arguments to clamp function.");if(t.length>3)Object(dn["n"])("Too many arguments to clamp function.");var n=t.map(e);return"Math.max("+n[1]+", Math.min("+n[2]+","+n[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:r,date:n("getDate",r,0),day:n("getDay",r,0),year:n("getFullYear",r,0),month:n("getMonth",r,0),hours:n("getHours",r,0),minutes:n("getMinutes",r,0),seconds:n("getSeconds",r,0),milliseconds:n("getMilliseconds",r,0),time:n("getTime",r,0),timezoneoffset:n("getTimezoneOffset",r,0),utcdate:n("getUTCDate",r,0),utcday:n("getUTCDay",r,0),utcyear:n("getUTCFullYear",r,0),utcmonth:n("getUTCMonth",r,0),utchours:n("getUTCHours",r,0),utcminutes:n("getUTCMinutes",r,0),utcseconds:n("getUTCSeconds",r,0),utcmilliseconds:n("getUTCMilliseconds",r,0),length:n("length",null,-1),join:n("join",null),indexof:n("indexOf",null),lastindexof:n("lastIndexOf",null),slice:n("slice",null),reverse:function(t){return"("+e(t[0])+").slice().reverse()"},parseFloat:"parseFloat",parseInt:"parseInt",upper:n("toUpperCase",i,0),lower:n("toLowerCase",i,0),substring:n("substring",i),split:n("split",i),replace:n("replace",i),trim:n("trim",i,0),regexp:a,test:n("test",a),if:function(t){if(t.length<3)Object(dn["n"])("Missing arguments to if function.");if(t.length>3)Object(dn["n"])("Too many arguments to if function.");var n=t.map(e);return"("+n[0]+"?"+n[1]+":"+n[2]+")"}}};function eG(e){var t=e&&e.length-1;return t&&(e[0]==='"'&&e[t]==='"'||e[0]==="'"&&e[t]==="'")?e.slice(1,-1):e}var tG=function(e){e=e||{};var t=e.whitelist?Object(dn["ab"])(e.whitelist):{},n=e.blacklist?Object(dn["ab"])(e.blacklist):{},r=e.constants||QH,i=(e.functions||KH)(s),a=e.globalvar,u=e.fieldvar,o={},f={},c=0;var l=Object(dn["C"])(a)?a:function(e){return a+'["'+e+'"]'};function s(e){if(Object(dn["G"])(e))return e;var t=d[e.type];if(t==null)Object(dn["n"])("Unsupported type: "+e.type);return t(e)}var d={Literal:function(e){return e.raw},Identifier:function(e){var i=e.name;if(c>0){return i}else if(n.hasOwnProperty(i)){return Object(dn["n"])("Illegal identifier: "+i)}else if(r.hasOwnProperty(i)){return r[i]}else if(t.hasOwnProperty(i)){return i}else{o[i]=1;return l(i)}},MemberExpression:function(e){var t=!e.computed;var n=s(e.object);if(t)c+=1;var r=s(e.property);if(n===u){f[eG(r)]=1}if(t)c-=1;return n+(t?"."+r:"["+r+"]")},CallExpression:function(e){if(e.callee.type!=="Identifier"){Object(dn["n"])("Illegal callee type: "+e.callee.type)}var t=e.callee.name;var n=e.arguments;var r=i.hasOwnProperty(t)&&i[t];if(!r)Object(dn["n"])("Unrecognized function: "+t);return Object(dn["C"])(r)?r(n):r+"("+n.map(s).join(",")+")"},ArrayExpression:function(e){return"["+e.elements.map(s).join(",")+"]"},BinaryExpression:function(e){return"("+s(e.left)+e.operator+s(e.right)+")"},UnaryExpression:function(e){return"("+e.operator+s(e.argument)+")"},ConditionalExpression:function(e){return"("+s(e.test)+"?"+s(e.consequent)+":"+s(e.alternate)+")"},LogicalExpression:function(e){return"("+s(e.left)+e.operator+s(e.right)+")"},ObjectExpression:function(e){return"{"+e.properties.map(s).join(",")+"}"},Property:function(e){c+=1;var t=s(e.key);c-=1;return t+":"+s(e.value)}};function h(e){var t={code:s(e),globals:Object.keys(o),fields:Object.keys(f)};o={};f={};return t}h.functions=i;h.constants=r;return h};var nG={};function rG(e,t,n){var r=e+":"+n,i=nG[r];if(!i||i[0]!==t){nG[r]=i=[t,t(n)]}return i[1]}function iG(e,t){return rG("format",hO,t)(e)}function aG(e,t){return rG("timeFormat",Iu,t)(e)}function uG(e,t){return rG("utcFormat",qu,t)(e)}function oG(e,t){return rG("timeParse",Uu,t)(e)}function fG(e,t){return rG("utcParse",Wu,t)(e)}var cG=new Date(2e3,0,1);function lG(e,t,n){cG.setMonth(e);cG.setDate(t);return aG(cG,n)}function sG(e){return lG(e,1,"%B")}function dG(e){return lG(e,1,"%b")}function hG(e){return lG(0,2+e,"%A")}function pG(e){return lG(0,2+e,"%a")}function vG(e){var t=0,n,r,i,a;if(e&&(n=e.length)){for(r=e[t];r==null||r!==r;r=e[++t]);i=a=r;for(;t<n;++t){r=e[t];if(r!=null){if(r<i)i=r;if(r>a)a=r}}}return[i,a]}function gG(e,t,n,r){var i=t[0],a=t[t.length-1],u;if(i>a){u=i;i=a;a=u}n=n===undefined||n;r=r===undefined||r;return(n?i<=e:i<e)&&(r?e<=a:e<a)}function mG(e,t,n){var r=e[0],i=e[1],a;if(i<r){a=i;i=r;r=a}a=i-r;return a>=n-t?[t,n]:[r=Math.min(Math.max(r,t),n-a),r+a]}function yG(e){return e[e.length-1]-e[0]||0}function bG(e){return 1+~~(new Date(e).getMonth()/3)}function xG(e){return 1+~~(new Date(e).getUTCMonth()/3)}function _G(e,t,n){try{e[t].apply(e,["EXPRESSION"].concat([].slice.call(n)))}catch(t){e.warn(t)}return n[n.length-1]}function wG(){return _G(this.context.dataflow,"warn",arguments)}function kG(){return _G(this.context.dataflow,"info",arguments)}function OG(){return _G(this.context.dataflow,"debug",arguments)}var AG=function(e){var t=this.context.group,n=false;if(t)while(e){if(e===t){n=true;break}e=e.mark.group}return n};function EG(e){var t=e.touches,n=t[0].clientX-t[1].clientX,r=t[0].clientY-t[1].clientY;return Math.sqrt(n*n+r*r)}function MG(e){var t=e.touches;return Math.atan2(t[0].clientY-t[1].clientY,t[0].clientX-t[1].clientX)}var SG=typeof window!=="undefined"&&window||null;function CG(){return SG?SG.screen:{}}function DG(){return SG?[SG.innerWidth,SG.innerHeight]:[undefined,undefined]}function jG(){var e=this.context.dataflow,t=e.container&&e.container();return t?[t.clientWidth,t.clientHeight]:[undefined,undefined]}var NG=function(e,t,n,r,i,a){if(!n&&n!==0)return a;var u=e[0],o=Object(dn["R"])(e),f=+n,c,l;if(o<u){c=u;u=o;o=c}c=Math.abs(t-u);l=Math.abs(o-t);return c<l&&c<=f?r:l<=f?i:a};var FG=function(){var e=[].slice.call(arguments);e.unshift({});return dn["o"].apply(null,e)};var TG="Literal";var zG="Identifier";var RG="@";var PG="%";var LG=":";function BG(e,t){var n;return Object(dn["C"])(e)?e:Object(dn["G"])(e)?(n=t.scales[e])&&n.value:undefined}function IG(e,t,n){var r=PG+n;if(!t.hasOwnProperty(r)){try{t[r]=e.scaleRef(n)}catch(e){}}}function UG(e,t,n,r){if(t[0].type===TG){IG(n,r,t[0].value)}else if(t[0].type===zG){for(e in n.scales){IG(n,r,e)}}}function qG(e,t){var n=BG(e,(t||this).context);return n&&n.range?n.range():[]}function WG(e,t){var n=BG(e,(t||this).context);return n?n.domain():[]}function HG(e,t){var n=BG(e,(t||this).context);return n&&n.bandwidth?n.bandwidth():0}function GG(e,t,n){return cx(e||0,t||0,n||0)}function YG(e,t){var n=BG(e,(t||this).context);return n?n.copy():undefined}function $G(e,t,n){var r=BG(e,(n||this).context);return r?r(t):undefined}function VG(e,t,n){var r=BG(e,(n||this).context);return!r?undefined:Object(dn["z"])(t)?(r.invertRange||r.invert)(t):(r.invert||r.invertExtent)(t)}var XG=function(e,t,n,r,i){e=BG(e,(i||this).context);var a=td(t,n),u=e.domain(),o=u[0],f=Object(dn["R"])(u),c=FA(e,o,f);if(e.ticks){u=e.ticks(+r||15);if(o!==u[0])u.unshift(o);if(f!==Object(dn["R"])(u))u.push(f)}for(var l=0,s=u.length;l<s;++l){a.stop(c(u[l]),e(u[l]))}return a};function ZG(e,t){return function(n,r,i){if(n){var a=BG(n,(i||this).context);return a&&a.path[e](r)}else{return t(r)}}}var JG=ZG("area",lj);var QG=ZG("bounds",Ij);var KG=ZG("centroid",pN);function eY(e,t,n){var r=BG(e,(n||this).context);return function(e){return r?r.path.context(e)(t):""}}function tY(e){var t=null;return function(n){return n?Yp(n,t=t||Lp(e)):e}}function nY(e){var t=this.context.data[e];return t?t.values.value:[]}function rY(e,t,n,r){if(t[0].type!==TG){Object(dn["n"])("First argument to data functions must be a string literal.")}var i=t[0].value,a=LG+i;if(!r.hasOwnProperty(a)){r[a]=n.getData(i).tuplesRef()}}function iY(e,t,n){var r=this.context.data[e]["index:"+t],i=r?r.value.get(n):undefined;return i?i.count:i}function aY(e,t,n,r){if(t[0].type!==TG)Object(dn["n"])("First argument to indata must be a string literal.");if(t[1].type!==TG)Object(dn["n"])("Second argument to indata must be a string literal.");var i=t[0].value,a=t[1].value,u=RG+a;if(!r.hasOwnProperty(u)){r[u]=n.getData(i).indataRef(n,a)}}function uY(e,t){var n=this.context.dataflow,r=this.context.data[e],i=r.input;n.pulse(i,n.changeset().remove(dn["db"]).insert(t));return 1}var oY={};function fY(e){return e.data}function cY(e,t){var n=nY.call(t,e);return n.root&&n.root.lookup||oY}function lY(e,t,n){var r=cY(e,this),i=r[t],a=r[n];return i&&a?i.path(a).map(fY):undefined}function sY(e,t){var n=cY(e,this)[t];return n?n.ancestors().map(fY):undefined}var dY=function(e,t,n){if(e){var r=this.context.dataflow,i=e.mark.source;r.pulse(i,r.changeset().encode(e,t))}return n!==undefined?n:e};function hY(e,t){return e===t||e!==e&&t!==t?true:Object(dn["z"])(e)&&Object(dn["z"])(t)&&e.length===t.length?pY(e,t):false}function pY(e,t){for(var n=0,r=e.length;n<r;++n){if(!hY(e[n],t[n]))return false}return true}function vY(e){return function(t){for(var n in e){if(!hY(t[n],e[n]))return false}return true}}var gY=function(e,t,n,r,i,a){var u=this.context.dataflow,o=this.context.data[e],f=o.input,c=o.changes,l=u.stamp(),s,d;if(u._trigger===false||!(f.value.length||t||r)){return 0}if(!c||c.stamp<l){o.changes=c=u.changeset();c.stamp=l;u.runAfter(function(){o.modified=true;u.pulse(f,c).run()},true,1)}if(n){s=n===true?dn["db"]:Object(dn["z"])(n)||mn(n)?n:vY(n);c.remove(s)}if(t){c.insert(t)}if(r){s=vY(r);if(f.value.some(s)){c.remove(s)}else{c.insert(r)}}if(i){for(d in a){c.modify(i,d,a[d])}}return 1};var mY="E",yY="R",bY="R-E",xY="R-LE",_Y="R-RE",wY="intersect",kY="union",OY="index:unit";function AY(e,t){var n=t.fields,r=t.values,i=n.length,a=0,u,o;for(;a<i;++a){o=n[a];o.getter=dn["t"].getter||Object(dn["t"])(o.field);u=o.getter(e);if(Object(dn["B"])(u))u=Object(dn["Z"])(u);if(Object(dn["B"])(r[a]))r[a]=Object(dn["Z"])(r[a]);if(Object(dn["B"])(r[a][0]))r[a]=r[a].map(dn["Z"]);if(o.type===mY){if(Object(dn["z"])(r[a])?r[a].indexOf(u)<0:u!==r[a]){return false}}else{if(o.type===yY){if(!gG(u,r[a]))return false}else if(o.type===_Y){if(!gG(u,r[a],true,false))return false}else if(o.type===bY){if(!gG(u,r[a],false,false))return false}else if(o.type===xY){if(!gG(u,r[a],false,true))return false}}}return true}function EY(e,t,n){var r=this.context.data[e],i=r?r.values.value:[],a=r?r[OY]&&r[OY].value:undefined,u=n===wY,o=i.length,f=0,c,l,s,d,h;for(;f<o;++f){c=i[f];if(a&&u){l=l||{};s=l[d=c.unit]||0;if(s===-1)continue;h=AY(t,c);l[d]=h?-1:++s;if(h&&a.size===1)return true;if(!h&&s===a.get(d).count)return false}else{h=AY(t,c);if(u^h)return h}}return o&&u}function MY(e,t,n,r){if(t[0].type!==TG)Object(dn["n"])("First argument to indata must be a string literal.");var i=t[0].value,a=t.length>=2&&t[t.length-1].value,u="unit",o=RG+u;if(a===wY&&!r.hasOwnProperty(o)){r[o]=n.getData(i).indataRef(n,u)}rY(e,t,n,r)}function SY(e,t){var n=this.context.data[e],r=n?n.values.value:[],i={},a={},u,o,f,c,l,s,d,h,p,v=r.length,g=0,m,y;for(;g<v;++g){u=r[g];c=u.unit;o=u.fields;f=u.values;for(m=0,y=o.length;m<y;++m){l=o[m];s=i[l.field]||(i[l.field]={});d=s[c]||(s[c]=[]);a[l.field]=h=l.type.charAt(0);p=CY[h+"_union"];s[c]=p(d,Object(dn["i"])(f[m]))}}t=t||kY;Object.keys(i).forEach(function(e){i[e]=Object.keys(i[e]).map(function(t){return i[e][t]}).reduce(function(n,r){return n===undefined?r:CY[a[e]+"_"+t](n,r)})});return i}var CY={E_union:function(e,t){if(!e.length)return t;var n=0,r=t.length;for(;n<r;++n)if(e.indexOf(t[n])<0)e.push(t[n]);return e},E_intersect:function(e,t){return!e.length?t:e.filter(function(e){return t.indexOf(e)>=0})},R_union:function(e,t){var n=Object(dn["Z"])(t[0]),r=Object(dn["Z"])(t[1]);if(n>r){n=t[1];r=t[0]}if(!e.length)return[n,r];if(e[0]>n)e[0]=n;if(e[1]<r)e[1]=r;return e},R_intersect:function(e,t){var n=Object(dn["Z"])(t[0]),r=Object(dn["Z"])(t[1]);if(n>r){n=t[1];r=t[0]}if(!e.length)return[n,r];if(r<e[0]||e[1]<n){return[]}else{if(e[0]<n)e[0]=n;if(e[1]>r)e[1]=r}return e}};var DY="bin_",jY="intersect",NY="union",FY="index:unit";function TY(e,t){var n=t.fields,r=t.values,i=t.getter||(t.getter=[]),a=n.length,u=0,o;for(;u<a;++u){i[u]=i[u]||Object(dn["t"])(n[u]);o=i[u](e);if(Object(dn["B"])(o))o=Object(dn["Z"])(o);if(Object(dn["B"])(r[u]))r[u]=Object(dn["Z"])(r[u]);if(t[DY+n[u]]){if(Object(dn["B"])(r[u][0]))r[u]=r[u].map(dn["Z"]);if(!gG(o,r[u],true,false))return false}else if(o!==r[u]){return false}}return true}function zY(e,t){var n=t.intervals,r=n.length,i=0,a,u,o;for(;i<r;++i){u=n[i].extent;a=n[i].getter||(n[i].getter=Object(dn["t"])(n[i].field));o=a(e);if(!u||u[0]===u[1])return false;if(Object(dn["B"])(o))o=Object(dn["Z"])(o);if(Object(dn["B"])(u[0]))u=n[i].extent=u.map(dn["Z"]);if(Object(dn["D"])(u[0])&&!gG(o,u))return false;else if(Object(dn["G"])(u[0])&&u.indexOf(o)<0)return false}return true}function RY(e,t,n,r){var i=this.context.data[e],a=i?i.values.value:[],u=i?i[FY]&&i[FY].value:undefined,o=n===jY,f=a.length,c=0,l,s,d,h,p;for(;c<f;++c){l=a[c];if(u&&o){s=s||{};d=s[h=l.unit]||0;if(d===-1)continue;p=r(t,l);s[h]=p?-1:++d;if(p&&u.size===1)return true;if(!p&&d===u.get(h).count)return false}else{p=r(t,l);if(o^p)return p}}return f&&o}function PY(e,t,n){return RY.call(this,e,t,n,TY)}function LY(e,t,n){return RY.call(this,e,t,n,zY)}function BY(e,t,n,r){if(t[0].type!==TG)Object(dn["n"])("First argument to indata must be a string literal.");var i=t[0].value,a=t.length>=2&&t[t.length-1].value,u="unit",o=RG+u;if(a===jY&&!r.hasOwnProperty(o)){r[o]=n.getData(i).indataRef(n,u)}rY(e,t,n,r)}function IY(e,t,n,r){var i=this.context.data[e],a=i?i.values.value:[],u=i?i[FY]&&i[FY].value:undefined,o=a[0],f=0,c,l,s,d,h;if(!o)return undefined;for(c=t?o.encodings.length:o.fields.length;f<c;++f){if(t&&o.encodings[f]===t||n&&o.fields[f]===n){l=f;d=o[DY+o.fields[f]];break}}if(u&&u.size===1){r=NY}if(u&&r===jY){h=a.reduce(function(e,t){var n=e[t.unit]||(e[t.unit]=[]);n.push({unit:t.unit,value:t.values[l]});return e},{});s=Object.keys(h).map(function(e){return{unit:e,value:d?WY(h[e],NY):qY(h[e],NY)}})}else{s=a.map(function(e){return{unit:e.unit,value:e.values[l]}})}return d?WY(s,r):qY(s,r)}function UY(e,t,n,r){var i=this.context.data[e],a=i?i.values.value:[],u=a[0],o=0,f,c,l,s,d;if(!u)return undefined;for(f=u.intervals.length;o<f;++o){c=u.intervals[o];if(t&&c.encoding===t||n&&c.field===n){if(!c.extent)return undefined;l=o;d=c.extent.length>2;break}}s=a.reduce(function(e,t){var n=t.intervals[l].extent,r=d?n.map(function(e){return{unit:t.unit,value:e}}):{unit:t.unit,value:n};if(d){e.push.apply(e,r)}else{e.push(r)}return e},[]);return d?qY(s,r):WY(s,r)}function qY(e,t){var n={},r=0,i={},a=[],u=0,o=e.length,f,c,l,s;for(;u<o;++u){f=e[u];c=f.unit;s=f.value;if(!n[c])n[c]=++r;if(!(l=i[s])){i[s]=l={value:s,units:{},count:0}}if(!l.units[c])l.units[c]=++l.count}for(s in i){l=i[s];if(t===jY&&l.count!==r)continue;a.push(l.value)}return a.length?a:undefined}function WY(e,t){var n=t===jY?GY:HY,r=0,i=e.length,a,u,o,f;for(;r<i;++r){a=e[r].value;if(Object(dn["B"])(a[0]))a=a.map(dn["Z"]);o=a[0];f=a[1];if(o>f){f=a[0];o=a[1]}u=u?n(u,o,f):[o,f]}return u&&u.length&&+u[0]!==+u[1]?u:undefined}function HY(e,t,n){if(e[0]>t)e[0]=t;if(e[1]<n)e[1]=n;return e}function GY(e,t,n){if(n<e[0]||e[1]<t){return[]}else{if(e[0]<t)e[0]=t;if(e[1]>n)e[1]=n}return e}var YY={random:function(){return lf()},isArray:dn["z"],isBoolean:dn["A"],isDate:dn["B"],isNumber:dn["D"],isObject:dn["E"],isRegExp:dn["F"],isString:dn["G"],isTuple:mn,toBoolean:dn["X"],toDate:dn["Y"],toNumber:dn["Z"],toString:dn["bb"],pad:dn["M"],peek:dn["R"],truncate:dn["cb"],rgb:X_,lab:vw,hcl:kw,hsl:ew,sequence:Rf,format:iG,utcFormat:uG,utcParse:fG,timeFormat:aG,timeParse:oG,monthFormat:sG,monthAbbrevFormat:dG,dayFormat:hG,dayAbbrevFormat:pG,quarter:bG,utcquarter:xG,warn:wG,info:kG,debug:OG,extent:vG,inScope:AG,clampRange:mG,pinchDistance:EG,pinchAngle:MG,screen:CG,containerSize:jG,windowSize:DG,span:yG,merge:FG,flush:NG,bandspace:GG,inrange:gG,setdata:uY,pathShape:tY,panLinear:dn["N"],panLog:dn["O"],panPow:dn["P"],zoomLinear:dn["hb"],zoomLog:dn["ib"],zoomPow:dn["jb"],encode:dY,modify:gY};var $Y=["view","item","group","xy","x","y"],VY="event.vega.",XY="this.",ZY={};function JY(e,t,n){if(arguments.length===1){return YY[e]}YY[e]=t;if(n)ZY[e]=n;if(e$)e$.functions[e]=XY+e;return this}JY("bandwidth",HG,UG);JY("copy",YG,UG);JY("domain",WG,UG);JY("range",qG,UG);JY("invert",VG,UG);JY("scale",$G,UG);JY("gradient",XG,UG);JY("geoArea",JG,UG);JY("geoBounds",QG,UG);JY("geoCentroid",KG,UG);JY("geoShape",eY,UG);JY("indata",iY,aY);JY("data",nY,rY);JY("treePath",lY,rY);JY("treeAncestors",sY,rY);JY("vlSelectionTest",EY,MY);JY("vlSelectionResolve",SY,MY);JY("vlSingle",PY,rY);JY("vlSingleDomain",IY,rY);JY("vlMulti",PY,BY);JY("vlMultiDomain",IY,BY);JY("vlInterval",LY,rY);JY("vlIntervalDomain",UY,rY);function QY(e){var t=KH(e);$Y.forEach(function(e){t[e]=VY+e});for(var n in YY){t[n]=XY+n}return t}var KY={blacklist:["_"],whitelist:["datum","event","item"],fieldvar:"datum",globalvar:function(e){return"_["+Object(dn["W"])("$"+e)+"]"},functions:QY,constants:QH,visitors:ZY};var e$=tG(KY);var t$="$";var n$=function(e,t,n){var r={},i,a;try{e=Object(dn["G"])(e)?e:Object(dn["W"])(e)+"";i=JH(e)}catch(t){Object(dn["n"])("Expression parse error: "+e)}i.visit(function e(n){if(n.type!=="CallExpression")return;var i=n.callee.name,a=KY.visitors[i];if(a)a(i,n.arguments,t,r)});a=e$(i);a.globals.forEach(function(e){var n=t$+e;if(!r.hasOwnProperty(n)&&t.getSignal(e)){r[n]=t.signalRef(e)}});return{$expr:n?n+"return("+a.code+");":a.code,$fields:a.fields,$params:r}};function r$(e,t,n,r){this.id=-1;this.type=e;this.value=t;this.params=n;if(r)this.parent=r}function i$(e,t,n,r){return new r$(e,t,n,r)}function a$(e,t){return i$("operator",e,t)}function u$(e){var t={$ref:e.id};if(e.id<0)(e.refs=e.refs||[]).push(t);return t}var o$={$tupleid:1,toString:function(){return":_tupleid_:"}};function f$(e,t){return t?{$field:e,$name:t}:{$field:e}}var c$=f$("key");function l$(e,t){return{$compare:e,$order:t}}function s$(e,t){var n={$key:e};if(t)n.$flat=true;return n}var d$="ascending";var h$="descending";function p$(e){return!Object(dn["E"])(e)?"":(e.order===h$?"-":"+")+v$(e.op,e.field)}function v$(e,t){return(e&&e.signal?"$"+e.signal:e||"")+(e&&t?"_":"")+(t&&t.signal?"$"+t.signal:t||"")}var g$="scope";var m$="view";function y$(e){return e&&e.signal}function b$(e){if(y$(e))return true;if(Object(dn["E"])(e))for(var t in e){if(b$(e[t]))return true}return false}function x$(e,t){return e!=null?e:t}function _$(e){return e&&e.signal||e}var w$="timer";function k$(e,t){var n=e.merge?A$:e.stream?E$:e.type?M$:Object(dn["n"])("Invalid stream specification: "+Object(dn["W"])(e));return n(e,t)}function O$(e){return e===g$?m$:e||m$}function A$(e,t){var n=e.merge.map(function(e){return k$(e,t)});var r=S$({merge:n},e,t);return t.addStream(r).id}function E$(e,t){var n=k$(e.stream,t),r=S$({stream:n},e,t);return t.addStream(r).id}function M$(e,t){var n,r;if(e.type===w$){n=t.event(w$,e.throttle);e={between:e.between,filter:e.filter}}else{n=t.event(O$(e.source),e.type)}r=S$({stream:n},e,t);return Object.keys(r).length===1?n:t.addStream(r).id}function S$(e,t,n){var r=t.between;if(r){if(r.length!==2){Object(dn["n"])('Stream "between" parameter must have 2 entries: '+Object(dn["W"])(t))}e.between=[k$(r[0],n),k$(r[1],n)]}r=t.filter?Object(dn["i"])(t.filter):[];if(t.marktype||t.markname||t.markrole){r.push(C$(t.marktype,t.markname,t.markrole))}if(t.source===g$){r.push("inScope(event.item)")}if(r.length){e.filter=n$("("+r.join(")&&(")+")").$expr}if((r=t.throttle)!=null){e.throttle=+r}if((r=t.debounce)!=null){e.debounce=+r}if(t.consume){e.consume=true}return e}function C$(e,t,n){var r="event.item";return r+(e&&e!=="*"?"&&"+r+".mark.marktype==='"+e+"'":"")+(n?"&&"+r+".mark.role==='"+n+"'":"")+(t?"&&"+r+".mark.name==='"+t+"'":"")}var D$=function(e,t,n){U$=t||j$;q$=n||W$;return Y$(e.trim()).map($$)};var j$="view",N$="[",F$="]",T$="{",z$="}",R$=":",P$=",",L$="@",B$=">",I$=/[[\]{}]/,U$,q$,W$={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};function H$(e){return q$.hasOwnProperty(e)}function G$(e,t,n,r,i){var a=0,u=e.length,o;for(;t<u;++t){o=e[t];if(!a&&o===n)return t;else if(i&&i.indexOf(o)>=0)--a;else if(r&&r.indexOf(o)>=0)++a}return t}function Y$(e){var t=[],n=0,r=e.length,i=0;while(i<r){i=G$(e,i,P$,N$+T$,F$+z$);t.push(e.substring(n,i).trim());n=++i}if(t.length===0){throw"Empty event selector: "+e}return t}function $$(e){return e[0]==="["?V$(e):X$(e)}function V$(e){var t=e.length,n=1,r,i;n=G$(e,n,F$,N$,F$);if(n===t){throw"Empty between selector: "+e}r=Y$(e.substring(1,n));if(r.length!==2){throw"Between selector must have two elements: "+e}e=e.slice(n+1).trim();if(e[0]!==B$){throw"Expected '>' after between selector: "+e}r=r.map($$);i=$$(e.slice(1).trim());if(i.between){return{between:r,stream:i}}else{i.between=r}return i}function X$(e){var t={source:U$},n=[],r=[0,0],i=0,a=0,u=e.length,o=0,f,c;if(e[u-1]===z$){o=e.lastIndexOf(T$);if(o>=0){try{r=Z$(e.substring(o+1,u-1))}catch(t){throw"Invalid throttle specification: "+e}e=e.slice(0,o).trim();u=e.length}else throw"Unmatched right brace: "+e;o=0}if(!u)throw e;if(e[0]===L$)i=++o;f=G$(e,o,R$);if(f<u){n.push(e.substring(a,f).trim());a=o=++f}o=G$(e,o,N$);if(o===u){n.push(e.substring(a,u).trim())}else{n.push(e.substring(a,o).trim());c=[];a=++o;if(a===u)throw"Unmatched left bracket: "+e}while(o<u){o=G$(e,o,F$);if(o===u)throw"Unmatched left bracket: "+e;c.push(e.substring(a,o).trim());if(o<u-1&&e[++o]!==N$)throw"Expected left bracket: "+e;a=++o}if(!(u=n.length)||I$.test(n[u-1])){throw"Invalid event selector: "+e}if(u>1){t.type=n[1];if(i){t.markname=n[0].slice(1)}else if(H$(n[0])){t.marktype=n[0]}else{t.source=n[0]}}else{t.type=n[0]}if(t.type.slice(-1)==="!"){t.consume=true;t.type=t.type.slice(0,-1)}if(c!=null)t.filter=c;if(r[0])t.throttle=r[0];if(r[1])t.debounce=r[1];return t}function Z$(e){var t=e.split(P$);if(!e.length||t.length>2)throw e;return t.map(function(t){var n=+t;if(n!==n)throw e;return n})}var J$="var datum=event.item&&event.item.datum;";var Q$=function(e,t,n){var r=e.events,i=e.update,a=e.encode,u=[],o="",f;if(!r){Object(dn["n"])("Signal update missing events specification.")}if(Object(dn["G"])(r)){r=D$(r,t.isSubscope()?g$:m$)}r=Object(dn["i"])(r).filter(function(e){if(e.signal||e.scale){u.push(e);return 0}else{return 1}});if(r.length){u.push(r.length>1?{merge:r}:r[0])}if(a!=null){if(i)Object(dn["n"])("Signal encode and update are mutually exclusive.");i="encode(item(),"+Object(dn["W"])(a)+")"}o=Object(dn["G"])(i)?n$(i,t,J$):i.expr!=null?n$(i.expr,t,J$):i.value!=null?i.value:i.signal!=null?{$expr:"_.value",$params:{value:t.signalRef(i.signal)}}:Object(dn["n"])("Invalid signal update specification.");f={target:n,update:o};if(e.force){f.options={force:true}}u.forEach(function(e){t.addUpdate(Object(dn["o"])(K$(e,t),f))})};function K$(e,t){return{source:e.signal?t.signalRef(e.signal):e.scale?t.scaleRef(e.scale):k$(e,t)}}var eV=function(e,t){var n=t.getSignal(e.name),r=e.update;if(e.init){if(r){Object(dn["n"])("Signals can not include both init and update expressions.")}else{r=e.init;n.initonly=true}}if(r){r=n$(r,t);n.update=r.$expr;n.params=r.$params}if(e.on){e.on.forEach(function(e){Q$(e,t,n.id)})}};function tV(e){return function(t,n,r){return i$(e,n,t||undefined,r)}}var nV=tV("aggregate");var rV=tV("axisticks");var iV=tV("bound");var aV=tV("collect");var uV=tV("compare");var oV=tV("datajoin");var fV=tV("encode");var cV=tV("expression");var lV=tV("extent");var sV=tV("facet");var dV=tV("field");var hV=tV("key");var pV=tV("legendentries");var vV=tV("load");var gV=tV("mark");var mV=tV("multiextent");var yV=tV("multivalues");var bV=tV("overlap");var xV=tV("params");var _V=tV("prefacet");var wV=tV("projection");var kV=tV("proxy");var OV=tV("relay");var AV=tV("render");var EV=tV("scale");var MV=tV("sieve");var SV=tV("sortitems");var CV=tV("viewlayout");var DV=tV("values");var jV=0;var NV=["identity","ordinal","band","point","bin-linear","bin-ordinal","quantize","quantile","threshold","linear","pow","sqrt","log","sequential","time","utc"];var FV=Object(dn["ab"])(NV),TV=Object(dn["ab"])(NV.slice(4,9)),zV=Object(dn["ab"])(NV.slice(9)),RV=Object(dn["ab"])(NV.slice(1,6));function PV(e){return RV.hasOwnProperty(e)}function LV(e){return TV.hasOwnProperty(e)}function BV(e){return zV.hasOwnProperty(e)}function IV(e){return e==="quantile"}function UV(e,t){var n=e.type||"linear";if(!FV.hasOwnProperty(n)){Object(dn["n"])("Unrecognized scale type: "+Object(dn["W"])(n))}t.addScale(e.name,{type:n,domain:undefined})}function qV(e,t){var n=t.getScale(e.name).params,r;n.domain=YV(e.domain,e,t);if(e.range!=null){n.range=rX(e,t,n)}if(e.interpolate!=null){nX(e.interpolate,n)}if(e.nice!=null){tX(e.nice,n)}for(r in e){if(n.hasOwnProperty(r)||r==="name")continue;n[r]=WV(e[r],t)}}function WV(e,t){return!Object(dn["E"])(e)?e:e.signal?t.signalRef(e.signal):Object(dn["n"])("Unsupported object: "+Object(dn["W"])(e))}function HV(e,t){return e.signal?t.signalRef(e.signal):e.map(function(e){return WV(e,t)})}function GV(e){Object(dn["n"])("Can not find data set: "+Object(dn["W"])(e))}function YV(e,t,n){if(!e){if(t.domainMin!=null||t.domainMax!=null){Object(dn["n"])("No scale domain defined for domainMin/domainMax to override.")}return}return e.signal?n.signalRef(e.signal):(Object(dn["z"])(e)?$V:e.fields?XV:VV)(e,t,n)}function $V(e,t,n){return e.map(function(e){return WV(e,n)})}function VV(e,t,n){var r=n.getData(e.data);if(!r)GV(e.data);return PV(t.type)?r.valuesRef(n,e.field,QV(e.sort,false)):IV(t.type)?r.domainRef(n,e.field):r.extentRef(n,e.field)}function XV(e,t,n){var r=e.data,i=e.fields.reduce(function(e,t){t=Object(dn["G"])(t)?{data:r,field:t}:Object(dn["z"])(t)||t.signal?ZV(t,n):t;e.push(t);return e},[]);return(PV(t.type)?JV:IV(t.type)?KV:eX)(e,n,i)}function ZV(e,t){var n="_:vega:_"+jV++,r=aV({});if(Object(dn["z"])(e)){r.value={$ingest:e}}else if(e.signal){var i="setdata("+Object(dn["W"])(n)+","+e.signal+")";r.params.input=t.signalRef(i)}t.addDataPipeline(n,[r,MV({})]);return{data:n,field:"data"}}function JV(e,t,n){var r,i,a,u;r=n.map(function(e){var n=t.getData(e.data);if(!n)GV(e.data);return n.countsRef(t,e.field)});i=t.add(nV({groupby:c$,ops:["sum"],fields:[t.fieldRef("count")],as:["count"],pulse:r}));a=t.add(aV({pulse:u$(i)}));u=t.add(DV({field:c$,sort:t.sortRef(QV(e.sort,true)),pulse:u$(a)}));return u$(u)}function QV(e,t){if(e){if(!e.field&&!e.op){if(Object(dn["E"])(e))e.field="key";else e={field:"key"}}else if(!e.field&&e.op!=="count"){Object(dn["n"])("No field provided for sort aggregate op: "+e.op)}else if(t&&e.field){Object(dn["n"])("Multiple domain scales can not sort by field.")}else if(t&&e.op&&e.op!=="count"){Object(dn["n"])("Multiple domain scales support op count only.")}}return e}function KV(e,t,n){var r=n.map(function(e){var n=t.getData(e.data);if(!n)GV(e.data);return n.domainRef(t,e.field)});return u$(t.add(yV({values:r})))}function eX(e,t,n){var r=n.map(function(e){var n=t.getData(e.data);if(!n)GV(e.data);return n.extentRef(t,e.field)});return u$(t.add(mV({extents:r})))}function tX(e,t){t.nice=Object(dn["E"])(e)?{interval:WV(e.interval),step:WV(e.step)}:WV(e)}function nX(e,t){t.interpolate=WV(e.type||e);if(e.gamma!=null){t.interpolateGamma=WV(e.gamma)}}function rX(e,t,n){var r=e.range,i=t.config.range;if(r.signal){return t.signalRef(r.signal)}else if(Object(dn["G"])(r)){if(i&&i.hasOwnProperty(r)){e=Object(dn["o"])({},e,{range:i[r]});return rX(e,t,n)}else if(r==="width"){r=[0,{signal:"width"}]}else if(r==="height"){r=PV(e.type)?[0,{signal:"height"}]:[{signal:"height"},0]}else{Object(dn["n"])("Unrecognized scale range value: "+Object(dn["W"])(r))}}else if(r.scheme){n.scheme=WV(r.scheme,t);if(r.extent)n.schemeExtent=HV(r.extent,t);if(r.count)n.schemeCount=WV(r.count,t);return}else if(r.step){n.rangeStep=WV(r.step,t);return}else if(PV(e.type)&&!Object(dn["z"])(r)){return YV(r,e,t)}else if(!Object(dn["z"])(r)){Object(dn["n"])("Unsupported range type: "+Object(dn["W"])(r))}return r.map(function(e){return WV(e,t)})}var iX=function(e,t){var n={};for(var r in e){if(r==="name")continue;n[r]=aX(e[r],r,t)}t.addProjection(e.name,n)};function aX(e,t,n){return Object(dn["z"])(e)?e.map(function(e){return aX(e,t,n)}):!Object(dn["E"])(e)?e:e.signal?n.signalRef(e.signal):t==="fit"?e:Object(dn["n"])("Unsupported parameter object: "+Object(dn["W"])(e))}var uX="top";var oX="left";var fX="right";var cX="bottom";var lX="center";var sX="vertical";var dX="start";var hX="middle";var pX="end";var vX="index";var gX="label";var mX="offset";var yX="perc";var bX="perc2";var xX="size";var _X="value";var wX="guide-label";var kX="guide-title";var OX="group-title";var AX="symbol";var EX="gradient";var MX="discrete";var SX=["size","shape","fill","stroke","strokeDash","opacity"];var CX={name:1,interactive:1};var DX=Object(dn["ab"])(["rule"]),jX=Object(dn["ab"])(["group","image","rect"]);var NX=function(e,t){var n="";if(DX[t])return n;if(e.x2){if(e.x){if(jX[t]){n+="if(o.x>o.x2)$=o.x,o.x=o.x2,o.x2=$;"}n+="o.width=o.x2-o.x;"}else{n+="o.x=o.x2-(o.width||0);"}}if(e.xc){n+="o.x=o.xc-(o.width||0)/2;"}if(e.y2){if(e.y){if(jX[t]){n+="if(o.y>o.y2)$=o.y,o.y=o.y2,o.y2=$;"}n+="o.height=o.y2-o.y;"}else{n+="o.y=o.y2-(o.height||0);"}}if(e.yc){n+="o.y=o.yc-(o.height||0)/2;"}return n};var FX=function(e,t,n,r){function i(e,i,a,u){var o=qX(null,i,t,n,r),f=qX(null,a,t,n,r),c=qX(null,u,t,n,r);return"this."+e+"("+[o,f,c].join(",")+").toString()"}return e.c?i("hcl",e.h,e.c,e.l):e.h||e.s?i("hsl",e.h,e.s,e.l):e.l||e.a?i("lab",e.l,e.a,e.b):e.r||e.g||e.b?i("rgb",e.r,e.g,e.b):null};var TX=function(e,t,n,r){var i=n$(e,t);i.$fields.forEach(function(e){r[e]=1});Object(dn["o"])(n,i.$params);return i.$expr};var zX=function(e,t,n,r){return RX(Object(dn["E"])(e)?e:{datum:e},t,n,r)};function RX(e,t,n,r){var i,a,u;if(e.signal){i="datum";u=TX(e.signal,t,n,r)}else if(e.group||e.parent){a=Math.max(1,e.level||1);i="item";while(a-- >0){i+=".mark.group"}if(e.parent){u=e.parent;i+=".datum"}else{u=e.group}}else if(e.datum){i="datum";u=e.datum}else{Object(dn["n"])("Invalid field reference: "+Object(dn["W"])(e))}if(!e.signal){if(Object(dn["G"])(u)){r[u]=1;u=Object(dn["V"])(u).map(dn["W"]).join("][")}else{u=RX(u,t,n,r)}}return i+"["+u+"]"}var PX=function(e,t,n,r,i){var a=BX(e.scale,n,r,i),u,o,f;if(e.range!=null){u=+e.range;o=a+".range()";t=u===0?o+"[0]":"($="+o+","+(u===1?"$[$.length-1]":"$[0]+"+u+"*($[$.length-1]-$[0])")+")"}else{if(t!==undefined)t=a+"("+t+")";if(e.band&&(f=LX(e.scale,n))){o=a+".bandwidth";u=+e.band;u=o+"()"+(u===1?"":"*"+u);if(f<0)u="("+o+"?"+u+":0)";t=(t?t+"+":"")+u;if(e.extra){t="(datum.extra?"+a+"(datum.extra.value):"+t+")"}}if(t==null)t="0"}return t};function LX(e,t){if(!Object(dn["G"])(e))return-1;var n=t.scaleType(e);return n==="band"||n==="point"?1:0}function BX(e,t,n,r){var i;if(Object(dn["G"])(e)){i=PG+e;if(!n.hasOwnProperty(i)){n[i]=t.scaleRef(e)}i=Object(dn["W"])(i)}else{for(i in t.scales){n[PG+i]=t.scaleRef(i)}i=Object(dn["W"])(PG)+"+"+(e.signal?"("+TX(e.signal,t,n,r)+")":zX(e,t,n,r))}return"_["+i+"]"}var IX=function(e,t,n,r){return"this.gradient("+BX(e.gradient,t,n,r)+","+Object(dn["W"])(e.start)+","+Object(dn["W"])(e.stop)+","+Object(dn["W"])(e.count)+")"};var UX=function(e,t,n,r){return Object(dn["E"])(e)?"("+qX(null,e,t,n,r)+")":e};var qX=function(e,t,n,r,i){if(t.gradient!=null){return IX(t,n,r,i)}var a=t.signal?TX(t.signal,n,r,i):t.color?FX(t.color,n,r,i):t.field!=null?zX(t.field,n,r,i):t.value!==undefined?Object(dn["W"])(t.value):undefined;if(t.scale!=null){a=PX(t,a,n,r,i)}if(a===undefined){a=null}if(t.exponent!=null){a="Math.pow("+a+","+UX(t.exponent,n,r,i)+")"}if(t.mult!=null){a+="*"+UX(t.mult,n,r,i)}if(t.offset!=null){a+="+"+UX(t.offset,n,r,i)}if(t.round){a="Math.round("+a+")"}return a};var WX=function(e,t,n){return e+"["+Object(dn["W"])(t)+"]="+n+";"};var HX=function(e,t,n,r,i){var a="";t.forEach(function(t){var u=qX(e,t,n,r,i);a+=t.test?TX(t.test,n,r,i)+"?"+u+":":u});if(Object(dn["R"])(a)===":"){a+="null"}return WX("o",e,a)};function GX(e,t,n,r){var i={},a="var o=item,datum=o.datum,$;",u,o,f;for(u in e){o=e[u];if(Object(dn["z"])(o)){a+=HX(u,o,r,n,i)}else{f=qX(u,o,r,n,i);a+=WX("o",u,f)}}a+=NX(e,t);a+="return 1;";return{$expr:a,$fields:Object.keys(i),$output:Object.keys(e)}}var YX="mark";var $X="frame";var VX="scope";var XX="axis";var ZX="axis-domain";var JX="axis-grid";var QX="axis-label";var KX="axis-tick";var eZ="axis-title";var tZ="legend";var nZ="legend-band";var rZ="legend-entry";var iZ="legend-gradient";var aZ="legend-label";var uZ="legend-symbol";var oZ="legend-title";var fZ="title";function cZ(e){return Object(dn["E"])(e)?Object(dn["o"])({},e):{value:e}}function lZ(e,t,n,r){if(n!=null){if(Object(dn["E"])(n)&&!Object(dn["z"])(n)){e.update[t]=n}else{e[r||"enter"][t]={value:n}}return 1}else{return 0}}function sZ(e,t,n){for(var r in t){if(n&&n.hasOwnProperty(r))continue;e[r]=Object(dn["o"])(e[r]||{},t[r])}return e}function dZ(e,t,n,r,i,a){var u,o;a=a||{};a.encoders={$encode:u={}};e=hZ(e,t,n,r,i.config);for(o in e){u[o]=GX(e[o],t,a,i)}return a}function hZ(e,t,n,r,i){var a={},u,o,f;if(n=="legend"||String(n).indexOf("axis")===0){n=null}f=n===$X?i.group:n===YX?Object(dn["o"])({},i.mark,i[t]):null;for(u in f){o=vZ(u,e)||(u==="fill"||u==="stroke")&&(vZ("fill",e)||vZ("stroke",e));if(!o)a[u]=pZ(f[u])}Object(dn["i"])(r).forEach(function(t){var n=i.style&&i.style[t];for(var r in n){if(!vZ(r,e)){a[r]=pZ(n[r])}}});e=Object(dn["o"])({},e);e.enter=Object(dn["o"])(a,e.enter);return e}function pZ(e){return e&&e.signal?{signal:e.signal}:{value:e}}function vZ(e,t){return t&&(t.enter&&t.enter[e]||t.update&&t.update[e])}var gZ=function(e,t,n,r,i,a,u){return{type:e,name:u?u.name:undefined,role:t,style:u&&u.style||n,key:r,from:i,interactive:!!(u&&u.interactive),encode:sZ(a,u,CX)}};function mZ(e,t,n){return x$(t[e],n[e])}function yZ(e,t){return x$(e.direction,t)===sX}function bZ(e,t){return x$(e.gradientLength,t.gradientLength||t.gradientWidth)}function xZ(e,t){return x$(e.gradientThickness,t.gradientThickness||t.gradientHeight)}function _Z(e,t){return x$(e.columns,x$(t.columns,+yZ(e,t.symbolDirection)))}function wZ(e,t){var n=t&&(t.update&&t.update[e]||t.enter&&t.enter[e]);return n&&n.signal?n:n?n.value:null}function kZ(e,t,n){var r=t.config.style[n];return r&&r[e]}var OZ="group";var AZ="rect";var EZ="rule";var MZ="symbol";var SZ="text";var CZ=function(e,t,n,r){var i={value:0},a=yZ(e,n.gradientDirection),u=xZ(e,n),o=bZ(e,n),f,c,l,s,d,h;if(a){l=[0,1];s=[0,0];d=u;h=o}else{l=[0,0];s=[1,0];d=o;h=u}f={enter:c={opacity:i,x:i,y:i,width:cZ(d),height:cZ(h)},update:Object(dn["o"])({},c,{opacity:{value:1},fill:{gradient:t,start:l,stop:s}}),exit:{opacity:i}};lZ(f,"stroke",mZ("gradientStrokeColor",e,n));lZ(f,"strokeWidth",mZ("gradientStrokeWidth",e,n));lZ(f,"opacity",mZ("gradientOpacity",e,n),"update");return gZ(AZ,iZ,null,undefined,undefined,f,r)};var DZ=function(e,t,n,r,i){var a={value:0},u=yZ(e,n.gradientDirection),o=xZ(e,n),f=bZ(e,n),c,l,s,d,h,p,v="";u?(s="y",h="y2",d="x",p="width",v="1-"):(s="x",h="x2",d="y",p="height");l={opacity:a,fill:{scale:t,field:_X}};l[s]={signal:v+"datum."+yX,mult:f};l[d]=a;l[h]={signal:v+"datum."+bX,mult:f};l[p]=cZ(o);c={enter:l,update:Object(dn["o"])({},l,{opacity:{value:1}}),exit:{opacity:a}};lZ(c,"stroke",mZ("gradientStrokeColor",e,n));lZ(c,"strokeWidth",mZ("gradientStrokeWidth",e,n));lZ(c,"opacity",mZ("gradientOpacity",e,n),"update");return gZ(AZ,nZ,null,_X,i,c,r)};var jZ="datum."+yX+'<=0?"left"'+":datum."+yX+'>=1?"right":"center"';var NZ="datum."+yX+'<=0?"bottom"'+":datum."+yX+'>=1?"top":"middle"';var FZ=function(e,t,n,r){var i={value:0},a=yZ(e,t.gradientDirection),u=cZ(xZ(e,t)),o=bZ(e,t),f=mZ("labelOverlap",e,t),c,l,s,d,h,p="";c={enter:l={opacity:i},update:s={opacity:{value:1},text:{field:gX}},exit:{opacity:i}};lZ(c,"fill",mZ("labelColor",e,t));lZ(c,"font",mZ("labelFont",e,t));lZ(c,"fontSize",mZ("labelFontSize",e,t));lZ(c,"fontWeight",mZ("labelFontWeight",e,t));lZ(c,"fillOpacity",mZ("labelOpacity",e,t));lZ(c,"limit",x$(e.labelLimit,t.gradientLabelLimit));if(a){l.align={value:"left"};l.baseline=s.baseline={signal:NZ};d="y";h="x";p="1-"}else{l.align=s.align={signal:jZ};l.baseline={value:"top"};d="x";h="y"}l[d]=s[d]={signal:p+"datum."+yX,mult:o};l[h]=s[h]=u;u.offset=x$(e.labelOffset,t.gradientLabelOffset)||0;e=gZ(SZ,aZ,wX,_X,r,c,n);if(f)e.overlap={method:f,order:"datum."+vX};return e};var TZ=function(e,t,n,r,i,a,u,o){return{type:OZ,name:n,role:e,style:t,from:r,interactive:i||false,encode:a,marks:u,layout:o}};var zZ={value:0};var RZ=function(e,t,n,r,i){var a=n.entries,u=!!(a&&a.interactive),o=a?a.name:undefined,f=mZ("clipHeight",e,t),c=mZ("symbolOffset",e,t),l={data:"value"},s={},d=i+"?"+"datum."+mX+":"+"datum."+xX,h=f?cZ(f):{field:xX},p="datum."+vX,v="max(1,"+i+")",g,m,y,b,x,_,w;h.mult=.5;s={enter:g={opacity:zZ,x:{signal:d,mult:.5,offset:c},y:h},update:m={opacity:{value:1},x:g.x,y:g.y},exit:{opacity:zZ}};if(!e.fill){lZ(s,"fill",t.symbolBaseFillColor);lZ(s,"stroke",t.symbolBaseStrokeColor)}lZ(s,"shape",mZ("symbolType",e,t));lZ(s,"size",mZ("symbolSize",e,t));lZ(s,"strokeWidth",mZ("symbolStrokeWidth",e,t));lZ(s,"fill",mZ("symbolFillColor",e,t));lZ(s,"stroke",mZ("symbolStrokeColor",e,t));lZ(s,"opacity",mZ("symbolOpacity",e,t),"update");SX.forEach(function(t){if(e[t]){m[t]=g[t]={scale:e[t],field:_X}}});b=gZ(MZ,uZ,null,_X,l,s,n.symbols);if(f)b.clip=true;y=cZ(c);y.offset=mZ("labelOffset",e,t);s={enter:g={opacity:zZ,x:{signal:d,offset:y},y:h},update:m={opacity:{value:1},text:{field:gX},x:g.x,y:g.y},exit:{opacity:zZ}};lZ(s,"align",mZ("labelAlign",e,t));lZ(s,"baseline",mZ("labelBaseline",e,t));lZ(s,"fill",mZ("labelColor",e,t));lZ(s,"font",mZ("labelFont",e,t));lZ(s,"fontSize",mZ("labelFontSize",e,t));lZ(s,"fontWeight",mZ("labelFontWeight",e,t));lZ(s,"limit",mZ("labelLimit",e,t));lZ(s,"fillOpacity",mZ("labelOpacity",e,t));x=gZ(SZ,aZ,wX,_X,l,s,n.labels);s={enter:{noBound:{value:true},width:zZ,height:f?cZ(f):zZ,opacity:zZ},exit:{opacity:zZ},update:m={opacity:{value:1},row:{signal:null},column:{signal:null}}};if(yZ(e,t.symbolDirection)){_="ceil(item.mark.items.length/"+v+")";m.row.signal=p+"%"+_;m.column.signal="floor("+p+"/"+_+")";w={field:["row",p]}}else{m.row.signal="floor("+p+"/"+v+")";m.column.signal=p+"%"+v;w={field:p}}m.column.signal=i+"?"+m.column.signal+":"+p;r={facet:{data:r,name:"value",groupby:vX}};e=TZ(VX,null,o,r,u,sZ(s,a,CX),[b,x]);e.sort=w;return e};function PZ(e,t){return{align:mZ("gridAlign",e,t),center:{row:true,column:false},columns:_Z(e,t),padding:{row:mZ("rowPadding",e,t),column:mZ("columnPadding",e,t)}}}var LZ=function(e,t,n,r){var i={value:0},a,u;a={enter:u={opacity:i,x:{field:{group:"padding"}},y:{field:{group:"padding"}}},update:{opacity:{value:1},text:cZ(e.title),x:u.x,y:u.y},exit:{opacity:i}};lZ(a,"align",mZ("titleAlign",e,t));lZ(a,"baseline",mZ("titleBaseline",e,t));lZ(a,"fill",mZ("titleColor",e,t));lZ(a,"font",mZ("titleFont",e,t));lZ(a,"fontSize",mZ("titleFontSize",e,t));lZ(a,"fontWeight",mZ("titleFontWeight",e,t));lZ(a,"limit",mZ("titleLimit",e,t));lZ(a,"fillOpacity",mZ("titleOpacity",e,t));return gZ(SZ,oZ,kX,null,r,a,n)};var BZ=function(e,t){var n;if(Object(dn["E"])(e)){if(e.signal){n=e.signal}else if(e.path){n="pathShape("+IZ(e.path)+")"}else if(e.sphere){n="geoShape("+IZ(e.sphere)+', {type: "Sphere"})'}}return n?t.signalRef(n):!!e};function IZ(e){return Object(dn["E"])(e)&&e.signal?e.signal:Object(dn["W"])(e)}var UZ=function(e){var t=e.role||"";return!t.indexOf("axis")||!t.indexOf("legend")?t:e.type===OZ?VX:t||YX};var qZ=function(e){return{marktype:e.type,name:e.name||undefined,role:e.role||UZ(e),zindex:+e.zindex||undefined}};var WZ=function(e,t){return e&&e.signal?t.signalRef(e.signal):e===false?false:true};var HZ=function(e,t){var n=Vo(e.type);if(!n)Object(dn["n"])("Unrecognized transform type: "+Object(dn["W"])(e.type));var r=i$(n.type.toLowerCase(),null,GZ(n,e,t));if(e.signal)t.addSignal(e.signal,t.proxy(r));r.metadata=n.metadata||{};return r};function GZ(e,t,n){var r={},i,a,u;for(a=0,u=e.params.length;a<u;++a){i=e.params[a];r[i.name]=YZ(i,t,n)}return r}function YZ(e,t,n){var r=e.type,i=t[e.name];if(r==="index"){return VZ(e,t,n)}else if(i===undefined){if(e.required){Object(dn["n"])("Missing required "+Object(dn["W"])(t.type)+" parameter: "+Object(dn["W"])(e.name))}return}else if(r==="param"){return XZ(e,t,n)}else if(r==="projection"){return n.projectionRef(t[e.name])}return e.array&&!y$(i)?i.map(function(t){return $Z(e,t,n)}):$Z(e,i,n)}function $Z(e,t,n){var r=e.type;if(y$(t)){return eJ(r)?Object(dn["n"])("Expression references can not be signals."):tJ(r)?n.fieldRef(t):nJ(r)?n.compareRef(t):n.signalRef(t.signal)}else{var i=e.expr||tJ(r);return i&&JZ(t)?n.exprRef(t.expr,t.as):i&&QZ(t)?f$(t.field,t.as):eJ(r)?n$(t,n):KZ(r)?u$(n.getData(t).values):tJ(r)?f$(t):nJ(r)?n.compareRef(t):t}}function VZ(e,t,n){if(!Object(dn["G"])(t.from)){Object(dn["n"])('Lookup "from" parameter must be a string literal.')}return n.getData(t.from).lookupRef(n,t.key)}function XZ(e,t,n){var r=t[e.name];if(e.array){if(!Object(dn["z"])(r)){Object(dn["n"])("Expected an array of sub-parameters. Instead: "+Object(dn["W"])(r))}return r.map(function(t){return ZZ(e,t,n)})}else{return ZZ(e,r,n)}}function ZZ(e,t,n){var r,i,a,u,o;for(u=0,o=e.params.length;u<o;++u){i=e.params[u];for(a in i.key){if(i.key[a]!==t[a]){i=null;break}}if(i)break}if(!i)Object(dn["n"])("Unsupported parameter: "+Object(dn["W"])(t));r=Object(dn["o"])(GZ(i,t,n),i.key);return u$(n.add(xV(r)))}function JZ(e){return e&&e.expr}function QZ(e){return e&&e.field}function KZ(e){return e==="data"}function eJ(e){return e==="expr"}function tJ(e){return e==="field"}function nJ(e){return e==="compare"}var rJ=function(e,t,n){var r,i,a,u,o;if(!e){u=u$(n.add(aV(null,[{}])))}else if(r=e.facet){if(!t)Object(dn["n"])("Only group marks can be faceted.");if(r.field!=null){u=o=iJ(r,n)}else{if(!e.data){a=HZ(Object(dn["o"])({type:"aggregate",groupby:Object(dn["i"])(r.groupby)},r.aggregate),n);a.params.key=n.keyRef(r.groupby);a.params.pulse=iJ(r,n);u=o=u$(n.add(a))}else{o=u$(n.getData(e.data).aggregate)}i=n.keyRef(r.groupby,true)}}if(!u){u=iJ(e,n)}return{key:i,pulse:u,parent:o}};function iJ(e,t){return e.$ref?e:e.data&&e.data.$ref?e.data:u$(t.getData(e.data).output)}function aJ(e,t,n,r,i){this.scope=e;this.input=t;this.output=n;this.values=r;this.aggregate=i;this.index={}}aJ.fromEntries=function(e,t){var n=t.length,r=1,i=t[0],a=t[n-1],u=t[n-2],o=null;e.add(t[0]);for(;r<n;++r){t[r].params.pulse=u$(t[r-1]);e.add(t[r]);if(t[r].type==="aggregate")o=t[r]}return new aJ(e,i,u,a,o)};var uJ=aJ.prototype;uJ.countsRef=function(e,t,n){var r=this,i=r.counts||(r.counts={}),a=oJ(t),u,o,f;if(a!=null){e=r.scope;u=i[a]}if(!u){f={groupby:e.fieldRef(t,"key"),pulse:u$(r.output)};if(n&&n.field)fJ(e,f,n);o=e.add(nV(f));u=e.add(aV({pulse:u$(o)}));u={agg:o,ref:u$(u)};if(a!=null)i[a]=u}else if(n&&n.field){fJ(e,u.agg.params,n)}return u.ref};function oJ(e){return Object(dn["G"])(e)?e:null}function fJ(e,t,n){var r=v$(n.op,n.field),i;if(t.ops){for(var a=0,u=t.as.length;a<u;++a){if(t.as[a]===r)return}}else{t.ops=["count"];t.fields=[null];t.as=["count"]}if(n.op){t.ops.push((i=n.op.signal)?e.signalRef(i):n.op);t.fields.push(e.fieldRef(n.field));t.as.push(r)}}function cJ(e,t,n,r,i,a,u){var o=t[n]||(t[n]={}),f=p$(a),c=oJ(i),l,s;if(c!=null){e=t.scope;c=c+(f?"|"+f:"");l=o[c]}if(!l){var d=a?{field:c$,pulse:t.countsRef(e,i,a)}:{field:e.fieldRef(i),pulse:u$(t.output)};if(f)d.sort=e.sortRef(a);s=e.add(i$(r,undefined,d));if(u)t.index[i]=s;l=u$(s);if(c!=null)o[c]=l}return l}uJ.tuplesRef=function(){return u$(this.values)};uJ.extentRef=function(e,t){return cJ(e,this,"extent","extent",t,false)};uJ.domainRef=function(e,t){return cJ(e,this,"domain","values",t,false)};uJ.valuesRef=function(e,t,n){return cJ(e,this,"vals","values",t,n||true)};uJ.lookupRef=function(e,t){return cJ(e,this,"lookup","tupleindex",t,false)};uJ.indataRef=function(e,t){return cJ(e,this,"indata","tupleindex",t,true,true)};var lJ=function(e,t,n){var r=e.from.facet,i=r.name,a=iJ(r,t),u,o,f,c;if(!r.name){Object(dn["n"])("Facet must have a name: "+Object(dn["W"])(r))}if(!r.data){Object(dn["n"])("Facet must reference a data set: "+Object(dn["W"])(r))}if(r.field){c=t.add(_V({field:t.fieldRef(r.field),pulse:a}))}else if(r.groupby){c=t.add(sV({key:t.keyRef(r.groupby),group:u$(t.proxy(n.parent)),pulse:a}))}else{Object(dn["n"])("Facet must specify groupby or field: "+Object(dn["W"])(r))}u=t.fork();o=u.add(aV());f=u.add(MV({pulse:u$(o)}));u.addData(i,new aJ(u,o,o,f));u.addSignal("parent",null);c.params.subflow={$subflow:BJ(e,u).toRuntime()}};var sJ=function(e,t,n){var r=t.add(_V({pulse:n.pulse})),i=t.fork();i.add(MV());i.addSignal("parent",null);r.params.subflow={$subflow:BJ(e,i).toRuntime()}};var dJ=function(e,t,n){var r=e.remove,i=e.insert,a=e.toggle,u=e.modify,o=e.values,f=t.add(a$()),c,l;c="if("+e.trigger+',modify("'+n+'",'+[i,r,a,u,o].map(function(e){return e==null?"null":e}).join(",")+"),0)";l=n$(c,t);f.update=l.$expr;f.params=l.$params};var hJ=function(e,t){var n=UZ(e),r=e.type===OZ,i=e.from&&e.from.facet,a=e.layout||n===VX||n===$X,u=n===YX||a||i,o=e.overlap,f,c,l,s,d,h,p,v,g,m,y,b,x;l=rJ(e.from,r,t);c=t.add(oV({key:l.key||(e.key?f$(e.key):undefined),pulse:l.pulse,clean:!r}));g=u$(c);c=s=t.add(aV({pulse:g}));c=t.add(gV({markdef:qZ(e),interactive:WZ(e.interactive,t),clip:BZ(e.clip,t),context:{$context:true},groups:t.lookup(),parent:t.signals.parent?t.signalRef("parent"):null,index:t.markpath(),pulse:u$(c)}));m=u$(c);c=t.add(fV(dZ(e.encode,e.type,n,e.style,t,{pulse:m})));c.params.parent=t.encode();if(e.transform){e.transform.forEach(function(e){var n=HZ(e,t);if(n.metadata.generates||n.metadata.changes){Object(dn["n"])("Mark transforms should not generate new data.")}n.params.pulse=u$(c);t.add(c=n)})}if(e.sort){c=t.add(SV({sort:t.compareRef(e.sort,true),pulse:u$(c)}))}y=u$(c);if(i||a){a=t.add(CV({layout:t.objectProperty(e.layout),legendMargin:t.config.legendMargin,mark:m,pulse:y}));b=u$(a)}d=t.add(iV({mark:m,pulse:b||y}));x=u$(d);if(r){if(u){f=t.operators;f.pop();if(a)f.pop()}t.pushState(y,b||x,g);i?lJ(e,t,l):u?sJ(e,t,l):BJ(e,t);t.popState();if(u){if(a)f.push(a);f.push(d)}}if(o){x=pJ(o,x,t)}h=t.add(AV({pulse:x}));p=t.add(MV({pulse:u$(h)},undefined,t.parent()));if(e.name!=null){v=e.name;t.addData(v,new aJ(t,s,h,p));if(e.on)e.on.forEach(function(e){if(e.insert||e.remove||e.toggle){Object(dn["n"])("Marks only support modify triggers.")}dJ(e,t,v)})}};function pJ(e,t,n){var r=e.method,i=e.bound,a;var u={method:y$(r)?n.signalRef(r.signal):r,pulse:t};if(e.order){u.sort=n.compareRef({field:e.order})}if(i){a=i.tolerance;u.boundTolerance=y$(a)?n.signalRef(a.signal):+a;u.boundScale=n.scaleRef(i.scale);u.boundOrient=i.orient}return u$(n.add(bV(u)))}var vJ=function(e,t){var n=t.config.legend,r=e.encode||{},i=r.legend||{},a=i.name||undefined,u=i.interactive,o=i.style,f,c,l,s,d,h,p,v,g;var m=SX.reduce(function(t,n){return t||e[n]},0);if(!m)Object(dn["n"])("Missing valid scale for legend.");d=gJ(e,t.scaleType(m));h={orient:mZ("orient",e,n),title:e.title!=null,type:d};p=u$(t.add(aV(null,[h])));i=sZ(yJ(e,n),i,CX);f={enter:{x:{value:0},y:{value:0}}};v=u$(t.add(pV(l={type:d,scale:t.scaleRef(m),count:t.objectProperty(e.tickCount),values:t.objectProperty(e.values),formatSpecifier:t.property(e.format)})));if(d===EX){s=[CZ(e,m,n,r.gradient),FZ(e,n,r.labels,v)];l.count=l.count||t.signalRef("max(2,2*floor(("+_$(bZ(e,n))+")/100))")}else if(d===MX){s=[DZ(e,m,n,r.gradient,v),FZ(e,n,r.labels,v)]}else{c=PZ(e,n);s=[RZ(e,n,r,v,_$(c.columns))];l.size=bJ(e,t,s[0].marks)}s=[TZ(rZ,null,null,p,u,f,s,c)];if(h.title){s.push(LZ(e,n,r.title,p))}g=TZ(tZ,o,a,p,u,i,s);if(e.zindex)g.zindex=e.zindex;return hJ(g,t)};function gJ(e,t){var n=e.type||AX;if(!e.type&&mJ(e)===1&&(e.fill||e.stroke)){n=BV(t)?EX:LV(t)?MX:AX}return n!==EX?n:LV(t)?MX:EX}function mJ(e){return SX.reduce(function(t,n){return t+(e[n]?1:0)},0)}function yJ(e,t){var n={enter:{},update:{}};lZ(n,"offset",mZ("offset",e,t));lZ(n,"padding",mZ("padding",e,t));lZ(n,"titlePadding",mZ("titlePadding",e,t));lZ(n,"fill",mZ("fillColor",e,t));lZ(n,"stroke",mZ("strokeColor",e,t));lZ(n,"strokeWidth",mZ("strokeWidth",e,t));lZ(n,"cornerRadius",mZ("cornerRadius",e,t));lZ(n,"strokeDash",t.strokeDash);return n}function bJ(e,t,n){var r,i,a,u;a=wZ("strokeWidth",n[0].encode);i=e.size?'scale("'+e.size+'",datum)':wZ("size",n[0].encode,t);r=xJ(n[1].encode,t,wX);u="max("+"ceil(sqrt("+_$(i)+")+"+_$(a)+"),"+_$(r)+")";return n$(u,t)}function xJ(e,t,n){return wZ("fontSize",e)||kZ("fontSize",t,n)}function _J(e,t,n){return'item.anchor==="'+dX+'"?'+e+':item.anchor==="'+pX+'"?'+t+":"+n}var wJ=_J(Object(dn["W"])(oX),Object(dn["W"])(fX),Object(dn["W"])(lX));var kJ=_J('+(item.orient==="'+fX+'")','+(item.orient!=="'+oX+'")',"0.5");var OJ=function(e,t){e=Object(dn["G"])(e)?{text:e}:e;var n=t.config.title,r=Object(dn["o"])({},e.encode),i,a,u;i={orient:mZ("orient",e,n)};a=u$(t.add(aV(null,[i])));r.name=e.name;r.interactive=e.interactive;u=AJ(e,n,r,a);if(e.zindex)u.zindex=e.zindex;return hJ(u,t)};function AJ(e,t,n,r){var i={value:0},a=e.text,u=mZ("orient",e,t),o=mZ("anchor",e,t),f=u===oX||u===uX?-1:1,c=u===uX||u===cX,l={group:c?"width":"height"},s,d,h,p,v;p={field:l,mult:{signal:kJ}};v=f<0?i:c?{field:{group:"height"}}:{field:{group:"width"}};s={enter:d={opacity:i},update:h={opacity:{value:1},text:cZ(a),anchor:cZ(o),orient:cZ(u),extent:{field:l},align:{signal:wJ}},exit:{opacity:i}};if(c){h.x=p;h.y=v;d.angle=i;d.baseline={value:u===uX?cX:uX}}else{h.x=v;h.y=p;d.angle={value:f*90};d.baseline={value:cX}}lZ(s,"align",mZ("align",e,t),"update");lZ(s,"angle",mZ("angle",e,t));lZ(s,"baseline",mZ("baseline",e,t));lZ(s,"fill",mZ("color",e,t));lZ(s,"font",mZ("font",e,t));lZ(s,"fontSize",mZ("fontSize",e,t));lZ(s,"fontWeight",mZ("fontWeight",e,t));lZ(s,"frame",mZ("frame",e,t));lZ(s,"limit",mZ("limit",e,t));lZ(s,"offset",mZ("offset",e,t)||0);return gZ(SZ,fZ,e.style||OX,null,r,s,n)}function EJ(e,t){var n=[];if(e.transform){e.transform.forEach(function(e){n.push(HZ(e,t))})}if(e.on){e.on.forEach(function(n){dJ(n,t,e.name)})}t.addDataPipeline(e.name,MJ(e,t,n))}function MJ(e,t,n){var r=[],i=null,a=false,u=false,o,f,c,l,s;if(e.values){r.push(i=SJ({$ingest:e.values,$format:e.format}))}else if(e.url){i=b$(e.url)||b$(e.format)?{$load:u$(t.add(CJ(t,e,i)))}:{$request:e.url,$format:e.format};r.push(i=SJ(i))}else if(e.source){i=o=Object(dn["i"])(e.source).map(function(e){return u$(t.getData(e).output)});r.push(null)}for(f=0,c=n.length;f<c;++f){l=n[f];s=l.metadata;if(!i&&!s.source){r.push(i=SJ())}r.push(l);if(s.generates)u=true;if(s.modifies&&!u)a=true;if(s.source)i=l;else if(s.changes)i=null}if(o){c=o.length-1;r[0]=OV({derive:a,pulse:c?o:o[0]});if(a||c){r.splice(1,0,SJ())}}if(!i)r.push(SJ());r.push(MV({}));return r}function SJ(e){var t=aV({},e);t.metadata={source:true};return t}function CJ(e,t){return vV({url:e.property(t.url),format:e.objectProperty(t.format)})}var DJ=function(e,t){var n=t.config,r=e.orient,i=r===uX||r===cX?n.axisX:n.axisY,a=n["axis"+r[0].toUpperCase()+r.slice(1)],u=t.scaleType(e.scale)==="band"&&n.axisBand;return i||a||u?Object(dn["o"])({},n.axis,i,a,u):n.axis};var jJ=function(e,t,n,r){var i=e.orient,a={value:0},u,o,f,c,l,s;u={enter:o={opacity:a},update:f={opacity:{value:1}},exit:{opacity:a}};lZ(u,"stroke",mZ("domainColor",e,t));lZ(u,"strokeWidth",mZ("domainWidth",e,t));lZ(u,"strokeOpacity",mZ("domainOpacity",e,t));if(i===uX||i===cX){c="x";s="y"}else{c="y";s="x"}l=c+"2";o[s]=a;f[c]=o[c]=NJ(e,0);f[l]=o[l]=NJ(e,1);return gZ(EZ,ZX,null,null,r,u,n)};function NJ(e,t){return{scale:e.scale,range:t}}var FJ=function(e,t,n,r){var i=e.orient,a=e.gridScale,u=i===oX||i===uX?1:-1,o=u*e.offset||0,f={value:0},c,l,s,d,h,p,v,g,m;c={enter:l={opacity:f},update:d={opacity:{value:1}},exit:s={opacity:f}};lZ(c,"stroke",mZ("gridColor",e,t));lZ(c,"strokeDash",mZ("gridDash",e,t));lZ(c,"strokeOpacity",mZ("gridOpacity",e,t));lZ(c,"strokeWidth",mZ("gridWidth",e,t));h={scale:e.scale,field:_X,band:mZ("bandPosition",e,t),round:mZ("tickRound",e,t),extra:mZ("tickExtra",e,t),offset:mZ("tickOffset",e,t)};if(i===uX||i===cX){p="x";v="y";m="height"}else{p="y";v="x";m="width"}g=v+"2";d[p]=l[p]=s[p]=h;if(a){l[v]={scale:a,range:0,mult:u,offset:o};d[g]=l[g]={scale:a,range:1,mult:u,offset:o}}else{l[v]={value:o};d[g]=l[g]={signal:m,mult:u,offset:o}}return gZ(EZ,JX,null,_X,r,c,n)};var TJ=function(e,t,n,r,i){var a=e.orient,u=a===oX||a===uX?-1:1,o={value:0},f,c,l,s,d,h;f={enter:c={opacity:o},update:s={opacity:{value:1}},exit:l={opacity:o}};lZ(f,"stroke",mZ("tickColor",e,t));lZ(f,"strokeOpacity",mZ("tickOpacity",e,t));lZ(f,"strokeWidth",mZ("tickWidth",e,t));d=cZ(i);d.mult=u;h={scale:e.scale,field:_X,band:mZ("bandPosition",e,t),round:mZ("tickRound",e,t),extra:mZ("tickExtra",e,t),offset:mZ("tickOffset",e,t)};if(a===uX||a===cX){s.y=c.y=o;s.y2=c.y2=d;s.x=c.x=l.x=h}else{s.x=c.x=o;s.x2=c.x2=d;s.y=c.y=l.y=h}return gZ(EZ,KX,null,_X,r,f,n)};function zJ(e,t,n,r,i){return{signal:'flush(range("'+e+'"), '+'scale("'+e+'", datum.value), '+t+","+n+","+r+","+i+")"}}var RJ=function(e,t,n,r,i){var a=e.orient,u=a===oX||a===uX?-1:1,o=a===uX||a===cX,f=e.scale,c=_$(mZ("labelFlush",e,t)),l=_$(mZ("labelFlushOffset",e,t)),s=c===0||!!c,d=mZ("labelAlign",e,t),h=mZ("labelBaseline",e,t),p={value:0},v,g,m,y,b,x,_,w,k;m=cZ(i);m.mult=u;m.offset=cZ(mZ("labelPadding",e,t)||0);m.offset.mult=u;y={scale:f,field:_X,band:.5,offset:mZ("tickOffset",e,t)};if(o){b=d||(s?zJ(f,c,'"left"','"right"','"center"'):"center");x=h||(a===uX?"bottom":"top");_=!d}else{b=d||(a===fX?"left":"right");x=h||(s?zJ(f,c,'"top"','"bottom"','"middle"'):"middle");_=!h}_=_&&s&&l?zJ(f,c,"-"+l,l,0):null;v={enter:g={opacity:p,x:o?y:m,y:o?m:y},update:{opacity:{value:1},text:{field:gX},x:g.x,y:g.y},exit:{opacity:p,x:g.x,y:g.y}};lZ(v,o?"dx":"dy",_);lZ(v,"align",b);lZ(v,"baseline",x);lZ(v,"angle",mZ("labelAngle",e,t));lZ(v,"fill",mZ("labelColor",e,t));lZ(v,"font",mZ("labelFont",e,t));lZ(v,"fontSize",mZ("labelFontSize",e,t));lZ(v,"fontWeight",mZ("labelFontWeight",e,t));lZ(v,"limit",mZ("labelLimit",e,t));lZ(v,"fillOpacity",mZ("labelOpacity",e,t));w=mZ("labelBound",e,t);k=mZ("labelOverlap",e,t);e=gZ(SZ,QX,wX,_X,r,v,n);if(k||w){e.overlap={method:k,order:"datum.index",bound:w?{scale:f,orient:a,tolerance:w}:null}}return e};var PJ=function(e,t,n,r){var i=e.orient,a=i===oX||i===uX?-1:1,u=i===uX||i===cX,o={value:0},f,c,l,s;f={enter:c={opacity:o},update:l={opacity:{value:1},text:cZ(e.title)},exit:{opacity:o}};s={scale:e.scale,range:.5};if(u){l.x=s;c.angle={value:0};c.baseline={value:i===uX?"bottom":"top"}}else{l.y=s;c.angle={value:a*90};c.baseline={value:"bottom"}}lZ(f,"align",mZ("titleAlign",e,t));lZ(f,"angle",mZ("titleAngle",e,t));lZ(f,"baseline",mZ("titleBaseline",e,t));lZ(f,"fill",mZ("titleColor",e,t));lZ(f,"font",mZ("titleFont",e,t));lZ(f,"fontSize",mZ("titleFontSize",e,t));lZ(f,"fontWeight",mZ("titleFontWeight",e,t));lZ(f,"limit",mZ("titleLimit",e,t));lZ(f,"fillOpacity",mZ("titleOpacity",e,t));!lZ(f,"x",mZ("titleX",e,t),"update")&&u&&!vZ("x",n)&&(f.enter.auto={value:true});!lZ(f,"y",mZ("titleY",e,t),"update")&&!u&&!vZ("y",n)&&(f.enter.auto={value:true});return gZ(SZ,eZ,kX,null,r,f,n)};var LJ=function(e,t){var n=DJ(e,t),r=e.encode||{},i=r.axis||{},a=i.name||undefined,u=i.interactive,o=i.style,f,c,l,s,d,h;f={orient:e.orient,ticks:!!mZ("ticks",e,n),labels:!!mZ("labels",e,n),grid:!!mZ("grid",e,n),domain:!!mZ("domain",e,n),title:!!x$(e.title,false)};c=u$(t.add(aV({},[f])));i=sZ({update:{range:{signal:'abs(span(range("'+e.scale+'")))'},offset:cZ(x$(e.offset,0)),position:cZ(x$(e.position,0)),titlePadding:cZ(mZ("titlePadding",e,n)),minExtent:cZ(mZ("minExtent",e,n)),maxExtent:cZ(mZ("maxExtent",e,n))}},r.axis,CX);l=u$(t.add(rV({scale:t.scaleRef(e.scale),extra:t.property(mZ("tickExtra",e,n)),count:t.objectProperty(e.tickCount),values:t.objectProperty(e.values),formatSpecifier:t.property(e.format)})));h=[];if(f.grid){h.push(FJ(e,n,r.grid,l))}if(f.ticks){s=mZ("tickSize",e,n);h.push(TJ(e,n,r.ticks,l,s))}if(f.labels){s=f.ticks?s:0;h.push(RJ(e,n,r.labels,l,s))}if(f.domain){h.push(jJ(e,n,r.domain,c))}if(f.title){h.push(PJ(e,n,r.title,c))}d=TZ(XX,o,a,c,u,i,h);if(e.zindex)d.zindex=e.zindex;return hJ(d,t)};var BJ=function(e,t,n){var r=Object(dn["i"])(e.signals),i=Object(dn["i"])(e.scales);if(!n)r.forEach(function(e){Hq(e,t)});Object(dn["i"])(e.projections).forEach(function(e){iX(e,t)});i.forEach(function(e){UV(e,t)});Object(dn["i"])(e.data).forEach(function(e){EJ(e,t)});i.forEach(function(e){qV(e,t)});r.forEach(function(e){eV(e,t)});Object(dn["i"])(e.axes).forEach(function(e){LJ(e,t)});Object(dn["i"])(e.marks).forEach(function(e){hJ(e,t)});Object(dn["i"])(e.legends).forEach(function(e){vJ(e,t)});if(e.title){OJ(e.title,t)}t.parseLambdas();return t};var IJ=Object(dn["ab"])(["width","height","padding","autosize"]);function UJ(e,t){var n=t.config,r,i,a,u,o;t.background=e.background||n.background;t.eventConfig=n.events;o=u$(t.root=t.add(a$()));t.addSignal("width",e.width||0);t.addSignal("height",e.height||0);t.addSignal("padding",Lq(e.padding,n));t.addSignal("autosize",Pq(e.autosize,n));Object(dn["i"])(e.signals).forEach(function(e){if(!IJ[e.name])Hq(e,t)});i=t.add(aV());a=sZ({enter:{x:{value:0},y:{value:0}},update:{width:{signal:"width"},height:{signal:"height"}}},e.encode);a=t.add(fV(dZ(a,OZ,$X,e.style,t,{pulse:u$(i)})));u=t.add(CV({layout:t.objectProperty(e.layout),legendMargin:n.legendMargin,autosize:t.signalRef("autosize"),mark:o,pulse:u$(a)}));t.operators.pop();t.pushState(u$(a),u$(u),null);BJ(e,t,true);t.operators.push(u);r=t.add(iV({mark:o,pulse:u$(u)}));r=t.add(AV({pulse:u$(r)}));r=t.add(MV({pulse:u$(r)}));t.addData("root",new aJ(t,i,i,r));return t}function qJ(e){this.config=e;this.bindings=[];this.field={};this.signals={};this.lambdas={};this.scales={};this.events={};this.data={};this.streams=[];this.updates=[];this.operators=[];this.background=null;this.eventConfig=null;this._id=0;this._subid=0;this._nextsub=[0];this._parent=[];this._encode=[];this._lookup=[];this._markpath=[]}function WJ(e){this.config=e.config;this.field=Object.create(e.field);this.signals=Object.create(e.signals);this.lambdas=Object.create(e.lambdas);this.scales=Object.create(e.scales);this.events=Object.create(e.events);this.data=Object.create(e.data);this.streams=[];this.updates=[];this.operators=[];this._id=0;this._subid=++e._nextsub[0];this._nextsub=e._nextsub;this._parent=e._parent.slice();this._encode=e._encode.slice();this._lookup=e._lookup.slice();this._markpath=e._markpath}var HJ=qJ.prototype=WJ.prototype;HJ.fork=function(){return new WJ(this)};HJ.isSubscope=function(){return this._subid>0};HJ.toRuntime=function(){this.finish();return{background:this.background,operators:this.operators,streams:this.streams,updates:this.updates,bindings:this.bindings,eventConfig:this.eventConfig}};HJ.id=function(){return(this._subid?this._subid+":":0)+this._id++};HJ.add=function(e){this.operators.push(e);e.id=this.id();if(e.refs){e.refs.forEach(function(t){t.$ref=e.id});e.refs=null}return e};HJ.proxy=function(e){var t=e instanceof r$?u$(e):e;return this.add(kV({value:t}))};HJ.addStream=function(e){this.streams.push(e);e.id=this.id();return e};HJ.addUpdate=function(e){this.updates.push(e);return e};HJ.finish=function(){var e,t;if(this.root)this.root.root=true;for(e in this.signals){this.signals[e].signal=e}for(e in this.scales){this.scales[e].scale=e}function n(e,t,n){var r,i;if(e){r=e.data||(e.data={});i=r[t]||(r[t]=[]);i.push(n)}}for(e in this.data){t=this.data[e];n(t.input,e,"input");n(t.output,e,"output");n(t.values,e,"values");for(var r in t.index){n(t.index[r],e,"index:"+r)}}return this};HJ.pushState=function(e,t,n){this._encode.push(u$(this.add(MV({pulse:e}))));this._parent.push(t);this._lookup.push(n?u$(this.proxy(n)):null);this._markpath.push(-1)};HJ.popState=function(){this._encode.pop();this._parent.pop();this._lookup.pop();this._markpath.pop()};HJ.parent=function(){return Object(dn["R"])(this._parent)};HJ.encode=function(){return Object(dn["R"])(this._encode)};HJ.lookup=function(){return Object(dn["R"])(this._lookup)};HJ.markpath=function(){var e=this._markpath;return++e[e.length-1]};HJ.fieldRef=function(e,t){if(Object(dn["G"])(e))return f$(e,t);if(!e.signal){Object(dn["n"])("Unsupported field reference: "+Object(dn["W"])(e))}var n=e.signal,r=this.field[n],i;if(!r){i={name:this.signalRef(n)};if(t)i.as=t;this.field[n]=r=u$(this.add(dV(i)))}return r};HJ.compareRef=function(e,t){function n(e){if(y$(e)){i=true;return r.signalRef(e.signal)}else{return e}}var r=this,i=false,a=Object(dn["i"])(e.field).map(n),u=Object(dn["i"])(e.order).map(n);if(t){a.push(o$)}return i?u$(this.add(uV({fields:a,orders:u}))):l$(a,u)};HJ.keyRef=function(e,t){function n(e){if(y$(e)){i=true;return u$(r[e.signal])}else{return e}}var r=this.signals,i=false;e=Object(dn["i"])(e).map(n);return i?u$(this.add(hV({fields:e,flat:t}))):s$(e,t)};HJ.sortRef=function(e){if(!e)return e;var t=[v$(e.op,e.field),o$],n=e.order||d$;return n.signal?u$(this.add(uV({fields:t,orders:[n=this.signalRef(n.signal),n]}))):l$(t,[n,n])};HJ.event=function(e,t){var n=e+":"+t;if(!this.events[n]){var r=this.id();this.streams.push({id:r,source:e,type:t});this.events[n]=r}return this.events[n]};HJ.addSignal=function(e,t){if(this.signals.hasOwnProperty(e)){Object(dn["n"])("Duplicate signal name: "+Object(dn["W"])(e))}var n=t instanceof r$?t:this.add(a$(t));return this.signals[e]=n};HJ.getSignal=function(e){if(!this.signals[e]){Object(dn["n"])("Unrecognized signal name: "+Object(dn["W"])(e))}return this.signals[e]};HJ.signalRef=function(e){if(this.signals[e]){return u$(this.signals[e])}else if(!this.lambdas.hasOwnProperty(e)){this.lambdas[e]=this.add(a$(null))}return u$(this.lambdas[e])};HJ.parseLambdas=function(){var e=Object.keys(this.lambdas);for(var t=0,n=e.length;t<n;++t){var r=e[t],i=n$(r,this),a=this.lambdas[r];a.params=i.$params;a.update=i.$expr}};HJ.property=function(e){return e&&e.signal?this.signalRef(e.signal):e};HJ.objectProperty=function(e){return!e||!Object(dn["E"])(e)?e:this.signalRef(e.signal||GJ(e))};function GJ(e){return(Object(dn["z"])(e)?YJ:$J)(e)}function YJ(e){var t="[",n=0,r=e.length,i;for(;n<r;++n){i=e[n];t+=(n>0?",":"")+(Object(dn["E"])(i)?i.signal||GJ(i):Object(dn["W"])(i))}return t+"]"}function $J(e){var t="{",n=0,r,i;for(r in e){i=e[r];t+=(++n>1?",":"")+Object(dn["W"])(r)+":"+(Object(dn["E"])(i)?i.signal||GJ(i):Object(dn["W"])(i))}return t+"}"}HJ.exprRef=function(e,t){var n={expr:n$(e,this)};if(t)n.expr.$name=t;return u$(this.add(cV(n)))};HJ.addBinding=function(e,t){if(!this.bindings){Object(dn["n"])("Nested signals do not support binding: "+Object(dn["W"])(e))}this.bindings.push(Object(dn["o"])({signal:e},t))};HJ.addScaleProj=function(e,t){if(this.scales.hasOwnProperty(e)){Object(dn["n"])("Duplicate scale or projection name: "+Object(dn["W"])(e))}this.scales[e]=this.add(t)};HJ.addScale=function(e,t){this.addScaleProj(e,EV(t))};HJ.addProjection=function(e,t){this.addScaleProj(e,wV(t))};HJ.getScale=function(e){if(!this.scales[e]){Object(dn["n"])("Unrecognized scale name: "+Object(dn["W"])(e))}return this.scales[e]};HJ.projectionRef=HJ.scaleRef=function(e){return u$(this.getScale(e))};HJ.projectionType=HJ.scaleType=function(e){return this.getScale(e).params.type};HJ.addData=function(e,t){if(this.data.hasOwnProperty(e)){Object(dn["n"])("Duplicate data set name: "+Object(dn["W"])(e))}return this.data[e]=t};HJ.getData=function(e){if(!this.data[e]){Object(dn["n"])("Undefined data set name: "+Object(dn["W"])(e))}return this.data[e]};HJ.addDataPipeline=function(e,t){if(this.data.hasOwnProperty(e)){Object(dn["n"])("Duplicate data set name: "+Object(dn["W"])(e))}return this.addData(e,aJ.fromEntries(this,t))};var VJ=function(e){var t=nQ();(e||[]).forEach(function(e){var n,r,i;if(e){for(n in e){if(n==="style"){i=t.style||(t.style={});for(n in e.style){i[n]=Object(dn["o"])(i[n]||{},e.style[n])}}else{r=e[n];t[n]=Object(dn["E"])(r)&&!Object(dn["z"])(r)?Object(dn["o"])(Object(dn["E"])(t[n])?t[n]:{},r):r}}}});return t};var XJ="sans-serif",ZJ=30,JJ=2,QJ="#4c78a8",KJ="#000",eQ="#888",tQ="#ddd";function nQ(){return{padding:0,autosize:"pad",background:null,events:{defaults:{allow:["wheel"]}},group:null,mark:null,arc:{fill:QJ},area:{fill:QJ},image:null,line:{stroke:QJ,strokeWidth:JJ},path:{stroke:QJ},rect:{fill:QJ},rule:{stroke:KJ},shape:{stroke:QJ},symbol:{fill:QJ,size:64},text:{fill:KJ,font:XJ,fontSize:11},style:{"guide-label":{fill:KJ,font:XJ,fontSize:10},"guide-title":{fill:KJ,font:XJ,fontSize:11,fontWeight:"bold"},"group-title":{fill:KJ,font:XJ,fontSize:13,fontWeight:"bold"},point:{size:ZJ,strokeWidth:JJ,shape:"circle"},circle:{size:ZJ,strokeWidth:JJ},square:{size:ZJ,strokeWidth:JJ,shape:"square"},cell:{fill:"transparent",stroke:tQ}},axis:{minExtent:0,maxExtent:200,bandPosition:.5,domain:true,domainWidth:1,domainColor:eQ,grid:false,gridWidth:1,gridColor:tQ,labels:true,labelAngle:0,labelLimit:180,labelPadding:2,ticks:true,tickColor:eQ,tickOffset:0,tickRound:true,tickSize:5,tickWidth:1,titleAlign:"center",titlePadding:4},axisBand:{tickOffset:-1},legend:{orient:"right",offset:18,padding:0,gridAlign:"each",columnPadding:10,rowPadding:2,symbolDirection:"vertical",gradientDirection:"vertical",gradientLength:200,gradientThickness:16,gradientStrokeColor:tQ,gradientStrokeWidth:0,gradientLabelOffset:2,labelAlign:"left",labelBaseline:"middle",labelLimit:160,labelOffset:4,labelOverlap:true,symbolType:"circle",symbolSize:100,symbolOffset:0,symbolStrokeWidth:1.5,symbolBaseFillColor:"transparent",symbolBaseStrokeColor:eQ,titleAlign:"left",titleBaseline:"top",titleLimit:180,titlePadding:5},title:{orient:"top",anchor:"middle",offset:4},range:{category:{scheme:"tableau10"},ordinal:{scheme:"blues",extent:[.2,1]},heatmap:{scheme:"viridis"},ramp:{scheme:"blues",extent:[.2,1]},diverging:{scheme:"blueorange"},symbol:["circle","square","triangle-up","cross","diamond","triangle-right","triangle-down","triangle-left"]}}}var rQ=function(e,t){if(!Object(dn["E"])(e))Object(dn["n"])("Input Vega specification must be an object.");return UJ(e,new qJ(VJ([t,e.config]))).toRuntime()};function iQ(e,t,n){if(t[t.length-1]!==";"){t="return("+t+");"}var r=Function.apply(null,e.concat(t));return n&&n.functions?r.bind(n.functions):r}function aQ(e,t){return iQ(["_"],e,t)}function uQ(e,t){return iQ(["datum","_"],e,t)}function oQ(e,t){return iQ(["event"],e,t)}function fQ(e,t){return iQ(["_","event"],e,t)}function cQ(e,t){return iQ(["item","_"],e,t)}function lQ(e,t,n){n=n||{};var r,i;for(r in e){i=e[r];n[r]=Object(dn["z"])(i)?i.map(function(e){return sQ(e,t,n)}):sQ(i,t,n)}return n}function sQ(e,t,n){if(!e||!Object(dn["E"])(e))return e;for(var r=0,i=dQ.length,a;r<i;++r){a=dQ[r];if(e.hasOwnProperty(a.key)){return a.parse(e,t,n)}}return e}var dQ=[{key:"$ref",parse:hQ},{key:"$key",parse:vQ},{key:"$expr",parse:pQ},{key:"$field",parse:gQ},{key:"$encode",parse:yQ},{key:"$compare",parse:mQ},{key:"$context",parse:bQ},{key:"$subflow",parse:xQ},{key:"$tupleid",parse:_Q}];function hQ(e,t){return t.get(e.$ref)||Object(dn["n"])("Operator not defined: "+e.$ref)}function pQ(e,t,n){if(e.$params){lQ(e.$params,t,n)}var r="e:"+e.$expr+"_"+e.$name;return t.fn[r]||(t.fn[r]=Object(dn["f"])(uQ(e.$expr,t),e.$fields,e.$name))}function vQ(e,t){var n="k:"+e.$key+"_"+!!e.$flat;return t.fn[n]||(t.fn[n]=Object(dn["H"])(e.$key,e.$flat))}function gQ(e,t){if(!e.$field)return null;var n="f:"+e.$field+"_"+e.$name;return t.fn[n]||(t.fn[n]=Object(dn["t"])(e.$field,e.$name))}function mQ(e,t){var n="c:"+e.$compare+"_"+e.$order,r=Object(dn["i"])(e.$compare).map(function(e){return e&&e.$tupleid?yn:e});return t.fn[n]||(t.fn[n]=Object(dn["k"])(r,e.$order))}function yQ(e,t){var n=e.$encode,r={},i,a;for(i in n){a=n[i];r[i]=Object(dn["f"])(cQ(a.$expr,t),a.$fields);r[i].output=a.$output}return r}function bQ(e,t){return t}function xQ(e,t){var n=e.$subflow;return function(e,r,i){var a=CQ(n,t.fork()),u=a.get(n.operators[0].id),o=a.signals.parent;if(o)o.set(i);return u}}function _Q(){return yn}function wQ(e){return(e+"").toLowerCase()}function kQ(e){return wQ(e)==="operator"}function OQ(e){return wQ(e)==="collect"}var AQ=function(e,t){if(kQ(e.type)||!e.type){t.operator(e,e.update?aQ(e.update,t):null)}else{t.transform(e,e.type)}};function EQ(e,t){if(e.params){var n=t.get(e.id);if(!n)Object(dn["n"])("Invalid operator id: "+e.id);t.dataflow.connect(n,n.parameters(lQ(e.params,t),e.react,e.initonly))}}var MQ=function(e,t){var n=e.filter!=null?oQ(e.filter,t):undefined,r=e.stream!=null?t.get(e.stream):undefined,i;if(e.source){r=t.events(e.source,e.type,n)}else if(e.merge){i=e.merge.map(t.get.bind(t));r=i[0].merge.apply(i[0],i.slice(1))}if(e.between){i=e.between.map(t.get.bind(t));r=r.between(i[0],i[1])}if(e.filter){r=r.filter(n)}if(e.throttle!=null){r=r.throttle(+e.throttle)}if(e.debounce!=null){r=r.debounce(+e.debounce)}if(r==null){Object(dn["n"])("Invalid stream definition: "+JSON.stringify(e))}if(e.consume)r.consume(true);t.stream(e,r)};var SQ=function(e,t){var n=Object(dn["E"])(n=e.source)?n.$ref:n,r=t.get(n),i=null,a=e.update,u=undefined;if(!r)Object(dn["n"])("Source not defined: "+e.source);if(e.target&&e.target.$expr){i=oQ(e.target.$expr,t)}else{i=t.get(e.target)}if(a&&a.$expr){if(a.$params){u=lQ(a.$params,t)}a=fQ(a.$expr,t)}t.update(e,r,i,a,u)};var CQ=function(e,t){var n=e.operators||[];if(e.background){t.background=e.background}if(e.eventConfig){t.eventConfig=e.eventConfig}n.forEach(function(e){AQ(e,t)});n.forEach(function(e){EQ(e,t)});(e.streams||[]).forEach(function(e){MQ(e,t)});(e.updates||[]).forEach(function(e){SQ(e,t)});return t.resolve()};var DQ={skip:true};function jQ(e){var t=this,n={};if(e.signals){var r=n.signals={};Object.keys(t.signals).forEach(function(n){var i=t.signals[n];if(e.signals(n,i)){r[n]=i.value}})}if(e.data){var i=n.data={};Object.keys(t.data).forEach(function(n){var r=t.data[n];if(e.data(n,r)){i[n]=r.input.value}})}if(t.subcontext&&e.recurse!==false){n.subcontext=t.subcontext.map(function(t){return t.getState(e)})}return n}function NQ(e){var t=this,n=t.dataflow,r=e.data,i=e.signals;Object.keys(i||{}).forEach(function(e){n.update(t.signals[e],i[e],DQ)});Object.keys(r||{}).forEach(function(e){n.pulse(t.data[e].input,n.changeset().remove(dn["db"]).insert(r[e]))});(e.subcontext||[]).forEach(function(e,n){var r=t.subcontext[n];if(r)r.setState(e)})}var FQ=function(e,t,n){return new TQ(e,t,n)};function TQ(e,t,n){this.dataflow=e;this.transforms=t;this.events=e.events.bind(e);this.signals={};this.scales={};this.nodes={};this.data={};this.fn={};if(n){this.functions=Object.create(n);this.functions.context=this}}function zQ(e){this.dataflow=e.dataflow;this.transforms=e.transforms;this.functions=e.functions;this.events=e.events;this.signals=Object.create(e.signals);this.scales=Object.create(e.scales);this.nodes=Object.create(e.nodes);this.data=Object.create(e.data);this.fn=Object.create(e.fn);if(e.functions){this.functions=Object.create(e.functions);this.functions.context=this}}TQ.prototype=zQ.prototype={fork:function(){var e=new zQ(this);(this.subcontext||(this.subcontext=[])).push(e);return e},get:function(e){return this.nodes[e]},set:function(e,t){return this.nodes[e]=t},add:function(e,t){var n=this,r=n.dataflow,i;n.set(e.id,t);if(OQ(e.type)&&(i=e.value)){if(i.$ingest){r.ingest(t,i.$ingest,i.$format)}else if(i.$load){n.get(i.$load.$ref).target=t}else if(i.$request){r.request(t,i.$request,i.$format)}else{r.pulse(t,r.changeset().insert(i))}}if(e.root){n.root=t}if(e.parent){var a=n.get(e.parent.$ref);if(a){r.connect(a,[t]);t.targets().add(a)}else{(n.unresolved=n.unresolved||[]).push(function(){a=n.get(e.parent.$ref);r.connect(a,[t]);t.targets().add(a)})}}if(e.signal){n.signals[e.signal]=t}if(e.scale){n.scales[e.scale]=t}if(e.data){for(var u in e.data){i=n.data[u]||(n.data[u]={});e.data[u].forEach(function(e){i[e]=t})}}},resolve:function(){(this.unresolved||[]).forEach(function(e){e()});delete this.unresolved;return this},operator:function(e,t){this.add(e,this.dataflow.add(e.value,t))},transform:function(e,t){this.add(e,this.dataflow.add(this.transforms[wQ(t)]))},stream:function(e,t){this.set(e.id,t)},update:function(e,t,n,r,i){this.dataflow.on(t,n,r,i,e.options)},getState:jQ,setState:NQ};var RQ=function(e,t,n){var r=n||YY;return CQ(t,FQ(e,$o,r))};function PQ(e){var t=this._runtime.scales;if(!t.hasOwnProperty(e)){Object(dn["n"])("Unrecognized scale or projection: "+e)}return t[e].value}var LQ="width",BQ="height",IQ="padding",UQ={skip:true};function qQ(e,t){var n=e.autosize(),r=e.padding();return t-(n&&n.contains===IQ?r.left+r.right:0)}function WQ(e,t){var n=e.autosize(),r=e.padding();return t-(n&&n.contains===IQ?r.top+r.bottom:0)}function HQ(e){var t=e._signals,n=t[LQ],r=t[BQ],i=t[IQ];function a(){e._autosize=e._resize=1}e._resizeWidth=e.add(null,function(t){e._width=t.size;e._viewWidth=qQ(e,t.size);a()},{size:n});e._resizeHeight=e.add(null,function(t){e._height=t.size;e._viewHeight=WQ(e,t.size);a()},{size:r});var u=e.add(null,a,{pad:i});e._resizeWidth.rank=n.rank+1;e._resizeHeight.rank=r.rank+1;u.rank=i.rank+1}function GQ(e,t,n,r,i,a){this.runAfter(function(u){var o=0;u._autosize=0;if(u.width()!==n){o=1;u.signal(LQ,n,UQ);u._resizeWidth.skip(true)}if(u.height()!==r){o=1;u.signal(BQ,r,UQ);u._resizeHeight.skip(true)}if(u._viewWidth!==e){u._resize=1;u._viewWidth=e}if(u._viewHeight!==t){u._resize=1;u._viewHeight=t}if(u._origin[0]!==i[0]||u._origin[1]!==i[1]){u._resize=1;u._origin=i}if(o)u.run("enter");if(a)u.runAfter(function(){u.resize()})},false,1)}function YQ(e){return this._runtime.getState(e||{data:$Q,signals:VQ,recurse:true})}function $Q(e,t){return t.modified&&Object(dn["z"])(t.input.value)&&e.indexOf("_:vega:_")}function VQ(e,t){return!(e==="parent"||t instanceof $o.proxy)}function XQ(e){var t=this;t.runAfter(function(){t._trigger=false;t._runtime.setState(e);t.run().runAfter(function(){t._trigger=true})});return this}var ZQ=function(e,t){function n(t){e({timestamp:Date.now(),elapsed:t})}this._timers.push(XP(n,t))};var JQ=function(e,t,n,r){var i=e.element();if(i)i.setAttribute("title",QQ(r))};function QQ(e){return e==null?"":Object(dn["z"])(e)?eK(e):Object(dn["E"])(e)&&!Object(dn["B"])(e)?KQ(e):e+""}function KQ(e){return Object.keys(e).map(function(t){var n=e[t];return t+": "+(Object(dn["z"])(n)?eK(n):tK(n))}).join("\n")}function eK(e){return"["+e.map(tK).join(", ")+"]"}function tK(e){return Object(dn["z"])(e)?"[â€¦]":Object(dn["E"])(e)&&!Object(dn["B"])(e)?"{â€¦}":e}function nK(e,t){var n=this;t=t||{};qo.call(n);n.loader(t.loader||n._loader);n.logLevel(t.logLevel||0);n._el=null;n._renderType=t.renderer||Gy.Canvas;n._scenegraph=new jm;var r=n._scenegraph.root;n._renderer=null;n._tooltip=t.tooltip||JQ,n._redraw=true;n._handler=(new Zm).scene(r);n._preventDefault=false;n._timers=[];n._eventListeners=[];n._resizeListeners=[];var i=RQ(n,e,t.functions);n._runtime=i;n._signals=i.signals;n._bind=(e.bindings||[]).map(function(e){return{state:null,param:Object(dn["o"])({},e)}});if(i.root)i.root.set(r);r.source=i.data.root.input;n.pulse(i.data.root.input,n.changeset().insert(r.items));n._background=i.background||null;n._eventConfig=uq(i.eventConfig);n._width=n.width();n._height=n.height();n._viewWidth=qQ(n,n._width);n._viewHeight=WQ(n,n._height);n._origin=[0,0];n._resize=0;n._autosize=1;HQ(n);WU(n)}var rK=Object(dn["x"])(nK,qo);rK.run=function(e){qo.prototype.run.call(this,e);if(this._pending){this.resize()}else if(this._redraw||this._resize){try{this.render()}catch(e){this.error(e)}}return this};rK.render=function(){if(this._renderer){if(this._resize){this._resize=0;KU(this)}this._renderer.render(this._scenegraph.root)}this._redraw=false;return this};rK.dirty=function(e){this._redraw=true;this._renderer&&this._renderer.dirty(e)};rK.container=function(){return this._el};rK.scenegraph=function(){return this._scenegraph};rK.origin=function(){return this._origin.slice()};function iK(e,t){return e._signals.hasOwnProperty(t)?e._signals[t]:Object(dn["n"])("Unrecognized signal name: "+Object(dn["W"])(t))}rK.signal=function(e,t,n){var r=iK(this,e);return arguments.length===1?r.value:this.update(r,t,n)};rK.background=function(e){if(arguments.length){this._background=e;this._resize=1;return this}else{return this._background}};rK.width=function(e){return arguments.length?this.signal("width",e):this.signal("width")};rK.height=function(e){return arguments.length?this.signal("height",e):this.signal("height")};rK.padding=function(e){return arguments.length?this.signal("padding",e):this.signal("padding")};rK.autosize=function(e){return arguments.length?this.signal("autosize",e):this.signal("autosize")};rK.renderer=function(e){if(!arguments.length)return this._renderType;if(!$y(e))Object(dn["n"])("Unrecognized renderer type: "+e);if(e!==this._renderType){this._renderType=e;this._resetRenderer()}return this};rK.tooltip=function(e){if(!arguments.length)return this._tooltip;if(e!==this._tooltip){this._tooltip=e;this._resetRenderer()}return this};rK.loader=function(e){if(!arguments.length)return this._loader;if(e!==this._loader){qo.prototype.loader.call(this,e);this._resetRenderer()}return this};rK.resize=function(){this._autosize=1;return this.touch(iK(this,"autosize"))};rK._resetRenderer=function(){if(this._renderer){this._renderer=null;this.initialize(this._el)}};rK._resizeView=GQ;rK.addEventListener=function(e,t,n){var r=t;if(!(n&&n.trap===false)){r=Sq(this,t);r.raw=t}this._handler.on(e,r);return this};rK.removeEventListener=function(e,t){var n=this._handler.handlers(e),r=n.length,i,a;while(--r>=0){a=n[r].type;i=n[r].handler;if(e===a&&(t===i||t===i.raw)){this._handler.off(a,i);break}}return this};rK.addResizeListener=function(e){var t=this._resizeListeners;if(t.indexOf(e)<0){t.push(e)}return this};rK.removeResizeListener=function(e){var t=this._resizeListeners,n=t.indexOf(e);if(n>=0){t.splice(n,1)}return this};function aK(e,t){var n=e._targets||[],r=n.filter(function(e){var n=e._update;return n&&n.handler===t});return r.length?r[0]:null}function uK(e,t,n,r){var i=aK(n,r);if(!i){i=Sq(this,function(){r(t,n.value)});i.handler=r;e.on(n,null,i)}return e}function oK(e,t,n){var r=aK(t,n);if(r)t._targets.remove(r);return e}rK.addSignalListener=function(e,t){return uK(this,e,iK(this,e),t)};rK.removeSignalListener=function(e,t){return oK(this,iK(this,e),t)};rK.addDataListener=function(e,t){return uK(this,e,GU(this,e).values,t)};rK.removeDataListener=function(e,t){return oK(this,GU(this,e).values,t)};rK.preventDefault=function(e){if(arguments.length){this._preventDefault=e;return this}else{return this._preventDefault}};rK.timer=ZQ;rK.events=fq;rK.finalize=hq;rK.hover=dq;rK.data=YU;rK.change=$U;rK.insert=VU;rK.remove=XU;rK.scale=PQ;rK.initialize=Dq;rK.toImageURL=Fq;rK.toCanvas=zq;rK.toSVG=Rq;rK.getState=YQ;rK.setState=XQ;Object(dn["o"])($o,r,i,o,f,c,l,s,d,h);var fK=n("rE/H");var cK=n.n(fK);function lK(e){return!!e.or}function sK(e){return!!e.and}function dK(e){return!!e.not}function hK(e,t){if(dK(e)){hK(e.not,t)}else if(sK(e)){for(var n=0,r=e.and;n<r.length;n++){var i=r[n];hK(i,t)}}else if(lK(e)){for(var a=0,u=e.or;a<u.length;a++){var i=u[a];hK(i,t)}}else{t(e)}}function pK(e,t){if(dK(e)){return{not:pK(e.not,t)}}else if(sK(e)){return{and:e.and.map(function(e){return pK(e,t)})}}else if(lK(e)){return{or:e.or.map(function(e){return pK(e,t)})}}else{return t(e)}}function vK(e,t){var n={};for(var r=0,i=t;r<i.length;r++){var a=i[r];if(e.hasOwnProperty(a)){n[a]=e[a]}}return n}function gK(e,t){var n=q({},e);for(var r=0,i=t;r<i.length;r++){var a=i[r];delete n[a]}return n}var mK=cK.a;function yK(e){if(Object(dn["D"])(e)){return e}var t=Object(dn["G"])(e)?e:cK()(e);if(t.length<100){return t}var n=0;for(var r=0;r<t.length;r++){var i=t.charCodeAt(r);n=(n<<5)-n+i;n=n&n}return n}function bK(e,t){return e.indexOf(t)>-1}function xK(e,t){return e.filter(function(e){return!bK(t,e)})}function _K(e,t){return e.concat(xK(t,e))}function wK(e,t){var n=0;for(var r=0;r<e.length;r++){if(t(e[r],r,n++)){return true}}return false}function kK(e,t){var n=0;for(var r=0;r<e.length;r++){if(!t(e[r],r,n++)){return false}}return true}function OK(e){return[].concat.apply([],e)}function AK(e){var t=[];for(var n=1;n<arguments.length;n++){t[n-1]=arguments[n]}for(var r=0,i=t;r<i.length;r++){var a=i[r];e=EK(e,a)}return e}function EK(e,t){if(typeof t!=="object"||t===null){return e}for(var n in t){if(!t.hasOwnProperty(n)){continue}if(t[n]===undefined){continue}if(typeof t[n]!=="object"||Object(dn["z"])(t[n])||t[n]===null){e[n]=t[n]}else if(typeof e[n]!=="object"||e[n]===null){e[n]=AK(Object(dn["z"])(t[n].constructor)?[]:{},t[n])}else{AK(e[n],t[n])}}return e}function MK(e,t){var n=[];var r={};var i;for(var a=0,u=e;a<u.length;a++){var o=u[a];i=t(o);if(i in r){continue}r[i]=1;n.push(o)}return n}function SK(e,t){for(var n in e){if(e.hasOwnProperty(n)){if(t[n]&&e[n]&&t[n]!==e[n]){return true}}}return false}function CK(e,t){for(var n in e){if(n in t){return true}}return false}function DK(e){return!isNaN(e)}function jK(e,t){if(e.length!==t.length){return true}e.sort();t.sort();for(var n=0;n<e.length;n++){if(t[n]!==e[n]){return true}}return false}var NK=Object.keys;function FK(e){var t=[];for(var n in e){if(e.hasOwnProperty(n)){t.push(e[n])}}return t}function TK(e){return NK(e)}function zK(e){return JSON.parse(JSON.stringify(e))}function RK(e){return e===true||e===false}function PK(e){var t=e.replace(/\W/g,"_");return(e.match(/^\d+/)?"_":"")+t}function LK(e,t){if(dK(e)){return"!("+LK(e.not,t)+")"}else if(sK(e)){return"("+e.and.map(function(e){return LK(e,t)}).join(") && (")+")"}else if(lK(e)){return"("+e.or.map(function(e){return LK(e,t)}).join(") || (")+")"}else{return t(e)}}function BK(e,t){if(t.length===0){return true}var n=t.shift();if(BK(e[n],t)){delete e[n]}return Object.keys(e).length===0}function IK(e){return e.charAt(0).toUpperCase()+e.substr(1)}function UK(e,t){if(t===void 0){t="datum"}var n=Object(dn["V"])(e);var r=[];for(var i=1;i<=n.length;i++){var a="["+n.slice(0,i).map(dn["W"]).join("][")+"]";r.push(""+t+a)}return r.join(" && ")}function qK(e,t){if(t===void 0){t="datum"}return t+"["+Object(dn["W"])(Object(dn["V"])(e).join("."))+"]"}function WK(e){return""+Object(dn["V"])(e).map(function(e){return e.replace(".","\\.")}).join("\\.")}function HK(e){return""+Object(dn["V"])(e).join(".")}function GK(e){if(!e){return 0}return Object(dn["V"])(e).length}var YK={argmax:1,argmin:1,average:1,count:1,distinct:1,max:1,mean:1,median:1,min:1,missing:1,q1:1,q3:1,ci0:1,ci1:1,stderr:1,stdev:1,stdevp:1,sum:1,valid:1,values:1,variance:1,variancep:1};var $K=TK(YK);function VK(e){return!!YK[e]}var XK=["count","valid","missing","distinct"];function ZK(e){return e&&bK(XK,e)}var JK=["count","sum","distinct","valid","missing"];var QK=["mean","average","median","q1","q3","min","max"];var KK=Object(dn["ab"])(QK);var e0=["domain","grid","labels","ticks","title"];var t0={grid:"grid",gridScale:"grid",domain:"main",labels:"main",labelFlush:"main",labelOverlap:"main",minExtent:"main",maxExtent:"main",offset:"main",ticks:"main",title:"main",values:"both",scale:"both",zindex:"both"};var n0={orient:1,domain:1,format:1,grid:1,labelBound:1,labelFlush:1,labelPadding:1,labels:1,labelOverlap:1,maxExtent:1,minExtent:1,offset:1,position:1,tickCount:1,ticks:1,tickSize:1,title:1,titlePadding:1,values:1,zindex:1};var r0=q({},n0,{encoding:1,labelAngle:1,titleMaxLength:1});var i0=q({scale:1},n0,{gridScale:1,encode:1});function a0(e){return!!r0[e]}var u0=TK(i0);var o0=TK(r0);var f0;(function(e){e.ROW="row";e.COLUMN="column";e.X="x";e.Y="y";e.X2="x2";e.Y2="y2";e.LATITUDE="latitude";e.LONGITUDE="longitude";e.LATITUDE2="latitude2";e.LONGITUDE2="longitude2";e.COLOR="color";e.FILL="fill";e.STROKE="stroke";e.SHAPE="shape";e.SIZE="size";e.OPACITY="opacity";e.TEXT="text";e.ORDER="order";e.DETAIL="detail";e.KEY="key";e.TOOLTIP="tooltip";e.HREF="href"})(f0||(f0={}));var c0=f0.X;var l0=f0.Y;var s0=f0.X2;var d0=f0.Y2;var h0=f0.LATITUDE;var p0=f0.LATITUDE2;var v0=f0.LONGITUDE;var g0=f0.LONGITUDE2;var m0=f0.ROW;var y0=f0.COLUMN;var b0=f0.SHAPE;var x0=f0.SIZE;var _0=f0.COLOR;var w0=f0.FILL;var k0=f0.STROKE;var O0=f0.TEXT;var A0=f0.DETAIL;var E0=f0.KEY;var M0=f0.ORDER;var S0=f0.OPACITY;var C0=f0.TOOLTIP;var D0=f0.HREF;var j0={longitude:1,longitude2:1,latitude:1,latitude2:1};var N0=TK(j0);var F0=q({x:1,y:1,x2:1,y2:1},j0,{color:1,fill:1,stroke:1,opacity:1,size:1,shape:1,order:1,text:1,detail:1,key:1,tooltip:1,href:1});function T0(e){return e==="color"||e==="fill"||e==="stroke"}var z0={row:1,column:1};var R0=q({},F0,z0);var P0=TK(R0);var L0=R0.order,B0=R0.detail,I0=W(R0,["order","detail"]);var U0=TK(I0);function q0(e){return!!R0[e]}var W0=TK(F0);var H0=F0.x,G0=F0.y,Y0=F0.x2,$0=F0.y2,V0=F0.latitude,X0=F0.longitude,Z0=F0.latitude2,J0=F0.longitude2,Q0=W(F0,["x","y","x2","y2","latitude","longitude","latitude2","longitude2"]);var K0=TK(Q0);var e1={x:1,y:1};var t1=TK(e1);var n1=Q0.text,r1=Q0.tooltip,i1=Q0.href,a1=Q0.detail,u1=Q0.key,o1=Q0.order,f1=W(Q0,["text","tooltip","href","detail","key","order"]);var c1=TK(f1);var l1=q({},e1,f1);var s1=TK(l1);function d1(e){return!!l1[e]}function h1(e,t){return t in p1(e)}function p1(e){switch(e){case _0:case w0:case k0:case A0:case E0:case C0:case D0:case M0:case S0:case m0:case y0:return{point:true,tick:true,rule:true,circle:true,square:true,bar:true,rect:true,line:true,trail:true,area:true,text:true,geoshape:true};case c0:case l0:case h0:case v0:return{point:true,tick:true,rule:true,circle:true,square:true,bar:true,rect:true,line:true,trail:true,area:true,text:true};case s0:case d0:case p0:case g0:return{rule:true,bar:true,rect:true,area:true};case x0:return{point:true,tick:true,rule:true,circle:true,square:true,bar:true,text:true,line:true,trail:true};case b0:return{point:true,geoshape:true};case O0:return{text:true}}}function v1(e){switch(e){case c0:case l0:case x0:case S0:case s0:case d0:return"continuous";case m0:case y0:case b0:case O0:case C0:case D0:return"discrete";case _0:case w0:case k0:return"flexible";case h0:case v0:case p0:case g0:case A0:case E0:case M0:return undefined}throw new Error("rangeType not implemented for "+e)}function g1(e){if(Object(dn["A"])(e)){return"bin"}return"bin"+NK(e).map(function(t){return PK("_"+t+"_"+e[t])}).join("")}function m1(e){return e&&!Object(dn["A"])(e)}function y1(e){switch(e){case m0:case y0:case x0:case _0:case w0:case k0:case S0:case b0:return 6;default:return 10}}var b1;(function(e){e.AREA="area";e.BAR="bar";e.LINE="line";e.POINT="point";e.RECT="rect";e.RULE="rule";e.TEXT="text";e.TICK="tick";e.TRAIL="trail";e.CIRCLE="circle";e.SQUARE="square";e.GEOSHAPE="geoshape"})(b1||(b1={}));var x1=b1.AREA;var _1=b1.BAR;var w1=b1.LINE;var k1=b1.POINT;var O1=b1.TEXT;var A1=b1.TICK;var E1=b1.TRAIL;var M1=b1.RECT;var S1=b1.RULE;var C1=b1.GEOSHAPE;var D1=b1.CIRCLE;var j1=b1.SQUARE;var N1={area:1,bar:1,line:1,point:1,text:1,tick:1,trail:1,rect:1,geoshape:1,rule:1,circle:1,square:1};function F1(e){return!!N1[e]}function T1(e){return bK(["line","area","trail"],e)}var z1=TK(N1);function R1(e){return e["type"]}var P1=Object(dn["ab"])(z1);function L1(e){var t=R1(e)?e.type:e;return t in P1}var B1=["stroke","strokeWidth","strokeDash","strokeDashOffset","strokeOpacity","strokeJoin","strokeMiterLimit"];var I1=["fill","fillOpacity"];var U1=[].concat(B1,I1);var q1=["filled","color"];var W1={area:["line","point"],bar:["binSpacing","continuousBandSize","discreteBandSize"],line:["point"],text:["shortTimeLabels"],tick:["bandSize","thickness"]};var H1={color:"#4c78a8"};var G1={binSpacing:1,continuousBandSize:5};var Y1={thickness:1};var $1=Object(dn["J"])(dn["e"]);var V1=$1;var X1=function(){function e(){this.warns=[];this.infos=[];this.debugs=[]}e.prototype.level=function(){return this};e.prototype.warn=function(){var e=[];for(var t=0;t<arguments.length;t++){e[t]=arguments[t]}var n;(n=this.warns).push.apply(n,e);return this};e.prototype.info=function(){var e=[];for(var t=0;t<arguments.length;t++){e[t]=arguments[t]}var n;(n=this.infos).push.apply(n,e);return this};e.prototype.debug=function(){var e=[];for(var t=0;t<arguments.length;t++){e[t]=arguments[t]}var n;(n=this.debugs).push.apply(n,e);return this};return e}();function Z1(e){return function(){V1=new X1;e(V1);Q1()}}function J1(e){V1=e;return V1}function Q1(){V1=$1;return V1}function K1(){var e=[];for(var t=0;t<arguments.length;t++){e[t]=arguments[t]}V1.warn.apply(V1,arguments)}function e2(){var e=[];for(var t=0;t<arguments.length;t++){e[t]=arguments[t]}V1.info.apply(V1,arguments)}function t2(){var e=[];for(var t=0;t<arguments.length;t++){e[t]=arguments[t]}V1.debug.apply(V1,arguments)}var n2;(function(e){e.INVALID_SPEC="Invalid spec";e.FIT_NON_SINGLE='Autosize "fit" only works for single views and layered views.';e.CANNOT_FIX_RANGE_STEP_WITH_FIT='Cannot use a fixed value of "rangeStep" when "autosize" is "fit".';function t(e){return'Cannot project a selection on encoding channel "'+e+'", which has no field.'}e.cannotProjectOnChannelWithoutField=t;function n(e){return'The "nearest" transform is not supported for '+e+" marks."}e.nearestNotSupportForContinuous=n;function r(e){return'Cannot find a selection named "'+e+'"'}e.selectionNotFound=r;e.SCALE_BINDINGS_CONTINUOUS="Scale bindings are currently only supported for scales with unbinned, continuous domains.";function i(e){return'Unknown repeated value "'+e+'".'}e.noSuchRepeatedValue=i;e.CONCAT_CANNOT_SHARE_AXIS="Axes cannot be shared in concatenated views.";e.REPEAT_CANNOT_SHARE_AXIS="Axes cannot be shared in repeated views.";function a(e){return'Cannot set title "anchor" for a '+e+" spec"}e.cannotSetTitleAnchor=a;function u(e){return'Unrecognized parse "'+e+'".'}e.unrecognizedParse=u;function o(e,t,n){return'An ancestor parsed field "'+e+'" as '+n+" but a child wants to parse the field as "+t+"."}e.differentParse=o;function f(e){return"Ignoring an invalid transform: "+mK(e)+"."}e.invalidTransformIgnored=f;e.NO_FIELDS_NEEDS_AS='If "from.fields" is not specified, "as" has to be a string that specifies the key to be used for the data from the secondary source.';function c(e){return"Layer's shared "+e.join(",")+" channel "+(e.length===1?"is":"are")+" overriden"}e.encodingOverridden=c;function l(e){var t=e.parentProjection,n=e.projection;return"Layer's shared projection "+mK(t)+" is overridden by a child projection "+mK(n)+"."}e.projectionOverridden=l;function s(e,t,n){return"Channel "+e+" is a "+t+". Converted to {value: "+mK(n)+"}."}e.primitiveChannelDef=s;function d(e){return'Invalid field type "'+e+'"'}e.invalidFieldType=d;function h(e,t,n){var r=n.scaleType?n.scaleType+" scale":n.zeroFalse?"scale with zero=false":"scale with custom domain that excludes zero";return"A "+r+" is used to encode "+e+"'s "+t+". This can be misleading as the "+(t==="x"?"width":"height")+" of the "+e+" can be arbitrary based on the scale domain. You may want to use point mark instead."}e.nonZeroScaleUsedWithLengthMark=h;function p(e,t){return'Invalid field type "'+e+'" for aggregate: "'+t+'", using "quantitative" instead.'}e.invalidFieldTypeForCountAggregate=p;function v(e){return'Invalid aggregation operator "'+e+'"'}e.invalidAggregate=v;function g(e,t,n){return'Invalid field type "'+e+'" for channel "'+t+'", using "'+n+'" instead.'}e.emptyOrInvalidFieldType=g;function m(e,t){var n=t.fill,r=t.stroke;return"Dropping color "+e+" as the plot also has "+(n&&r?"fill and stroke":n?"fill":"stroke")}e.droppingColor=m;function y(e,t){return"Dropping "+mK(e)+' from channel "'+t+'" since it does not contain data field or value.'}e.emptyFieldDef=y;function b(e,t,n){return e+"-encoding with type "+t+" is deprecated. Replacing with "+n+"-encoding."}e.latLongDeprecated=b;e.LINE_WITH_VARYING_SIZE="Line marks cannot encode size with a non-groupby field. You may want to use trail marks instead.";function x(e,t,n){return e+' dropped as it is incompatible with "'+t+'"'+(n?" when "+n:"")+"."}e.incompatibleChannel=x;function _(e){return e+"-encoding is dropped as "+e+" is not a valid encoding channel."}e.invalidEncodingChannel=_;function w(e){return e+" encoding should be discrete (ordinal / nominal / binned)."}e.facetChannelShouldBeDiscrete=w;function k(e,t){return'Using discrete channel "'+e+'" to encode "'+t+'" field can be misleading as it does not encode '+(t==="ordinal"?"order":"magnitude")+"."}e.discreteChannelCannotEncode=k;e.BAR_WITH_POINT_SCALE_AND_RANGESTEP_NULL="Bar mark should not be used with point scale when rangeStep is null. Please use band scale instead.";function O(e,t){var n=e&&t?"x2 and y2":e?"x2":"y2";return"Line mark is for continuous lines and thus cannot be used with "+n+". We will use the rule mark (line segments) instead."}e.lineWithRange=O;function A(e,t){return'Specified orient "'+e+'" overridden with "'+t+'"'}e.orientOverridden=A;e.CANNOT_UNION_CUSTOM_DOMAIN_WITH_FIELD_DOMAIN="custom domain scale cannot be unioned with default field-based domain";function E(e){return'Cannot use the scale property "'+e+'" with non-color channel.'}e.cannotUseScalePropertyWithNonColor=E;function M(e){return"Using unaggregated domain with raw field has no effect ("+mK(e)+")."}e.unaggregateDomainHasNoEffectForRawField=M;function S(e){return'Unaggregated domain not applicable for "'+e+'" since it produces values outside the origin domain of the source data.'}e.unaggregateDomainWithNonSharedDomainOp=S;function C(e){return"Unaggregated domain is currently unsupported for log scale ("+mK(e)+")."}e.unaggregatedDomainWithLogScale=C;function D(e){return'Cannot apply size to non-oriented mark "'+e+'".'}e.cannotApplySizeToNonOrientedMark=D;function j(e){return'rangeStep for "'+e+'" is dropped as top-level '+(e==="x"?"width":"height")+" is provided."}e.rangeStepDropped=j;function N(e,t,n){return'Channel "'+e+'" does not work with "'+t+'" scale. We are using "'+n+'" scale instead.'}e.scaleTypeNotWorkWithChannel=N;function F(e,t){return'FieldDef does not work with "'+e+'" scale. We are using "'+t+'" scale instead.'}e.scaleTypeNotWorkWithFieldDef=F;function T(e,t,n){return n+"-scale's \""+t+'" is dropped as it does not work with '+e+" scale."}e.scalePropertyNotWorkWithScaleType=T;function z(e,t){return'Scale type "'+t+'" does not work with mark "'+e+'".'}e.scaleTypeNotWorkWithMark=z;function R(e,t,n,r){return"Conflicting "+t.toString()+' property "'+e.toString()+'" ('+mK(n)+" and "+mK(r)+").  Using "+mK(n)+"."}e.mergeConflictingProperty=R;function P(e){return'Setting the scale to be independent for "'+e+'" means we also have to set the guide (axis or legend) to be independent.'}e.independentScaleMeansIndependentGuide=P;function L(e){return"Dropping sort property "+mK(e)+" as unioned domains only support boolean or op 'count'."}e.domainSortDropped=L;e.UNABLE_TO_MERGE_DOMAINS="Unable to merge domains";e.MORE_THAN_ONE_SORT="Domains that should be unioned has conflicting sort properties. Sort will be set to true.";e.INVALID_CHANNEL_FOR_AXIS="Invalid channel for axis.";function B(e){return'Cannot stack "'+e+'" if there is already "'+e+'2"'}e.cannotStackRangedMark=B;function I(e){return"Cannot stack non-linear scale ("+e+")"}e.cannotStackNonLinearScale=I;function U(e){return'Stacking is applied even though the aggregate function is non-summative ("'+e+'")'}e.stackNonSummativeAggregate=U;function q(e,t){return"Invalid "+e+": "+mK(t)}e.invalidTimeUnit=q;function W(e){return'Time unit "'+e+'" is not supported. We are replacing it with '+e.replace("day","date")+"."}e.dayReplacedWithDate=W;function H(e){return"Dropping day from datetime "+mK(e)+" as day cannot be combined with other units."}e.droppedDay=H})(n2||(n2={}));var r2=2006;function i2(e){return!!e&&(!!e.year||!!e.quarter||!!e.month||!!e.date||!!e.day||!!e.hours||!!e.minutes||!!e.seconds||!!e.milliseconds)}var a2=["january","february","march","april","may","june","july","august","september","october","november","december"];var u2=a2.map(function(e){return e.substr(0,3)});var o2=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"];var f2=o2.map(function(e){return e.substr(0,3)});function c2(e){if(Object(dn["D"])(e)){if(e>4){K1(n2.invalidTimeUnit("quarter",e))}return e-1+""}else{throw new Error(n2.invalidTimeUnit("quarter",e))}}function l2(e){if(Object(dn["D"])(e)){return e-1+""}else{var t=e.toLowerCase();var n=a2.indexOf(t);if(n!==-1){return n+""}var r=t.substr(0,3);var i=u2.indexOf(r);if(i!==-1){return i+""}throw new Error(n2.invalidTimeUnit("month",e))}}function s2(e){if(Object(dn["D"])(e)){return e%7+""}else{var t=e.toLowerCase();var n=o2.indexOf(t);if(n!==-1){return n+""}var r=t.substr(0,3);var i=f2.indexOf(r);if(i!==-1){return i+""}throw new Error(n2.invalidTimeUnit("day",e))}}function d2(e,t){if(t===void 0){t=false}var n=[];if(t&&e.day!==undefined){if(NK(e).length>1){K1(n2.droppedDay(e));e=zK(e);delete e.day}}if(e.year!==undefined){n.push(e.year)}else if(e.day!==undefined){n.push(r2)}else{n.push(0)}if(e.month!==undefined){var r=t?l2(e.month):e.month;n.push(r)}else if(e.quarter!==undefined){var i=t?c2(e.quarter):e.quarter;n.push(i+"*3")}else{n.push(0)}if(e.date!==undefined){n.push(e.date)}else if(e.day!==undefined){var a=t?s2(e.day):e.day;n.push(a+"+1")}else{n.push(1)}for(var u=0,o=["hours","minutes","seconds","milliseconds"];u<o.length;u++){var f=o[u];if(e[f]!==undefined){n.push(e[f])}else{n.push(0)}}if(e.utc){return"utc("+n.join(", ")+")"}else{return"datetime("+n.join(", ")+")"}}var h2;(function(e){e.YEAR="year";e.MONTH="month";e.DAY="day";e.DATE="date";e.HOURS="hours";e.MINUTES="minutes";e.SECONDS="seconds";e.MILLISECONDS="milliseconds";e.YEARMONTH="yearmonth";e.YEARMONTHDATE="yearmonthdate";e.YEARMONTHDATEHOURS="yearmonthdatehours";e.YEARMONTHDATEHOURSMINUTES="yearmonthdatehoursminutes";e.YEARMONTHDATEHOURSMINUTESSECONDS="yearmonthdatehoursminutesseconds";e.MONTHDATE="monthdate";e.HOURSMINUTES="hoursminutes";e.HOURSMINUTESSECONDS="hoursminutesseconds";e.MINUTESSECONDS="minutesseconds";e.SECONDSMILLISECONDS="secondsmilliseconds";e.QUARTER="quarter";e.YEARQUARTER="yearquarter";e.QUARTERMONTH="quartermonth";e.YEARQUARTERMONTH="yearquartermonth";e.UTCYEAR="utcyear";e.UTCMONTH="utcmonth";e.UTCDAY="utcday";e.UTCDATE="utcdate";e.UTCHOURS="utchours";e.UTCMINUTES="utcminutes";e.UTCSECONDS="utcseconds";e.UTCMILLISECONDS="utcmilliseconds";e.UTCYEARMONTH="utcyearmonth";e.UTCYEARMONTHDATE="utcyearmonthdate";e.UTCYEARMONTHDATEHOURS="utcyearmonthdatehours";e.UTCYEARMONTHDATEHOURSMINUTES="utcyearmonthdatehoursminutes";e.UTCYEARMONTHDATEHOURSMINUTESSECONDS="utcyearmonthdatehoursminutesseconds";e.UTCMONTHDATE="utcmonthdate";e.UTCHOURSMINUTES="utchoursminutes";e.UTCHOURSMINUTESSECONDS="utchoursminutesseconds";e.UTCMINUTESSECONDS="utcminutesseconds";e.UTCSECONDSMILLISECONDS="utcsecondsmilliseconds";e.UTCQUARTER="utcquarter";e.UTCYEARQUARTER="utcyearquarter";e.UTCQUARTERMONTH="utcquartermonth";e.UTCYEARQUARTERMONTH="utcyearquartermonth"})(h2||(h2={}));var p2={year:1,quarter:1,month:1,day:1,date:1,hours:1,minutes:1,seconds:1,milliseconds:1};var v2=TK(p2);function g2(e){return!!p2[e]}var m2={utcyear:1,utcquarter:1,utcmonth:1,utcday:1,utcdate:1,utchours:1,utcminutes:1,utcseconds:1,utcmilliseconds:1};function y2(e){return!!m2[e]}var b2={yearquarter:1,yearquartermonth:1,yearmonth:1,yearmonthdate:1,yearmonthdatehours:1,yearmonthdatehoursminutes:1,yearmonthdatehoursminutesseconds:1,quartermonth:1,monthdate:1,hoursminutes:1,hoursminutesseconds:1,minutesseconds:1,secondsmilliseconds:1};var x2={utcyearquarter:1,utcyearquartermonth:1,utcyearmonth:1,utcyearmonthdate:1,utcyearmonthdatehours:1,utcyearmonthdatehoursminutes:1,utcyearmonthdatehoursminutesseconds:1,utcquartermonth:1,utcmonthdate:1,utchoursminutes:1,utchoursminutesseconds:1,utcminutesseconds:1,utcsecondsmilliseconds:1};var _2=q({},m2,x2);function w2(e){return!!_2[e]}function k2(e){return e.substr(3)}var O2=q({},p2,m2,b2,x2);var A2=TK(O2);function E2(e){return!!O2[e]}var M2={year:"setFullYear",month:"setMonth",date:"setDate",hours:"setHours",minutes:"setMinutes",seconds:"setSeconds",milliseconds:"setMilliseconds",quarter:null,day:null};function S2(e,t){var n=w2(e);var r=n?new Date(Date.UTC(0,0,1,0,0,0,0)):new Date(0,0,1,0,0,0,0);for(var i=0,a=v2;i<a.length;i++){var u=a[i];if(j2(e,u)){switch(u){case h2.DAY:throw new Error("Cannot convert to TimeUnits containing 'day'");case h2.QUARTER:{var o=C2("month",n),f=o.getDateMethod,c=o.setDateMethod;r[c](Math.floor(t[f]()/3)*3);break}default:var l=C2(u,n),s=l.getDateMethod,d=l.setDateMethod;r[d](t[s]())}}}return r}function C2(e,t){var n=M2[e];var r=t?"setUTC"+n.substr(3):n;var i="get"+(t?"UTC":"")+n.substr(3);return{setDateMethod:r,getDateMethod:i}}function D2(e){return v2.reduce(function(t,n){if(j2(e,n)){return t.concat(n)}return t},[])}function j2(e,t){var n=e.indexOf(t);return n>-1&&(t!==h2.SECONDS||n===0||e.charAt(n-1)!=="i")}function N2(e,t){var n=UK(t);var r=w2(e)?"utc":"";function i(e){if(e===h2.QUARTER){return"("+r+"quarter("+n+")-1)"}else{return""+r+e+"("+n+")"}}var a=v2.reduce(function(t,n){if(j2(e,n)){t[n]=i(n)}return t},{});return d2(a)}function F2(e,t,n,r){if(!e){return undefined}var i=[];var a="";var u=j2(e,h2.YEAR);if(j2(e,h2.QUARTER)){a="'Q' + quarter("+t+")"}if(j2(e,h2.MONTH)){i.push(n!==false?"%b":"%B")}if(j2(e,h2.DAY)){i.push(n?"%a":"%A")}else if(j2(e,h2.DATE)){i.push("%d"+(u?",":""))}if(u){i.push(n?"%y":"%Y")}var o=[];if(j2(e,h2.HOURS)){o.push("%H")}if(j2(e,h2.MINUTES)){o.push("%M")}if(j2(e,h2.SECONDS)){o.push("%S")}if(j2(e,h2.MILLISECONDS)){o.push("%L")}var f=[];if(i.length>0){f.push(i.join(" "))}if(o.length>0){f.push(o.join(":"))}if(f.length>0){if(a){a+=" + ' ' + "}if(r){a+="utcFormat("+t+", '"+f.join(" ")+"')"}else{a+="timeFormat("+t+", '"+f.join(" ")+"')"}}return a||undefined}function T2(e){if(e!=="day"&&e.indexOf("day")>=0){K1(n2.dayReplacedWithDate(e));return e.replace("day","date")}return e}var z2;(function(e){e.QUANTITATIVE="quantitative";e.ORDINAL="ordinal";e.TEMPORAL="temporal";e.NOMINAL="nominal";e.LATITUDE="latitude";e.LONGITUDE="longitude";e.GEOJSON="geojson"})(z2||(z2={}));var R2={quantitative:1,ordinal:1,temporal:1,nominal:1,latitude:1,longitude:1,geojson:1};function P2(e){return!!R2[e]}var L2=z2.QUANTITATIVE;var B2=z2.ORDINAL;var I2=z2.TEMPORAL;var U2=z2.NOMINAL;var q2=z2.GEOJSON;function W2(e){if(e){e=e.toLowerCase();switch(e){case"q":case L2:return"quantitative";case"t":case I2:return"temporal";case"o":case B2:return"ordinal";case"n":case U2:return"nominal";case z2.LATITUDE:return"latitude";case z2.LONGITUDE:return"longitude";case q2:return"geojson"}}return undefined}function H2(e){return e["selection"]}function G2(e){return e&&!Object(dn["G"])(e)&&"repeat"in e}function Y2(e){var t=e.field,n=e.timeUnit,r=e.bin,i=e.aggregate;return q({},n?{timeUnit:n}:{},r?{bin:r}:{},i?{aggregate:i}:{},{field:t})}function $2(e){return!!e&&!!e.condition}function V2(e){return!!e&&!!e.condition&&!Object(dn["z"])(e.condition)&&Z2(e.condition)}function X2(e){return!!e&&!!e.condition&&(Object(dn["z"])(e.condition)||Q2(e.condition))}function Z2(e){return!!e&&(!!e["field"]||e["aggregate"]==="count")}function J2(e){return Z2(e)&&Object(dn["G"])(e.field)}function Q2(e){return e&&"value"in e&&e["value"]!==undefined}function K2(e){return!!e&&(!!e["scale"]||!!e["sort"])}function e3(e){return!!e["op"]}function t3(e,t){if(t===void 0){t={}}var n=e.field;var r=t.prefix;var i=t.suffix;if(i3(e)){n="count_*"}else{var a=undefined;if(!t.nofn){if(e3(e)){a=e.op}else if(e.bin){a=g1(e.bin);i=t.binSuffix||""}else if(e.aggregate){a=String(e.aggregate)}else if(e.timeUnit){a=String(e.timeUnit)}}if(a){n=n?a+"_"+n:a}}if(i){n=n+"_"+i}if(r){n=r+"_"+n}if(t.expr){return qK(n,t.expr)}else{return WK(n)}}function n3(e){switch(e.type){case"nominal":case"ordinal":case"geojson":return true;case"quantitative":return!!e.bin;case"latitude":case"longitude":case"temporal":return false}throw new Error(n2.invalidFieldType(e.type))}function r3(e){return!n3(e)}function i3(e){return e.aggregate==="count"}function a3(e,t){var n=e.field,r=e.bin,i=e.timeUnit,a=e.aggregate;if(a==="count"){return t.countTitle}else if(r){return n+" (binned)"}else if(i){var u=D2(i).join("-");return n+" ("+u+")"}else if(a){return IK(a)+" of "+n}return n}function u3(e,t){var n=e.aggregate||e.timeUnit||e.bin&&"bin";if(n){return n.toUpperCase()+"("+e.field+")"}else{return e.field}}var o3=function(e,t){switch(t.fieldTitle){case"plain":return e.field;case"functional":return u3(e,t);default:return a3(e,t)}};var f3=o3;function c3(e){f3=e}function l3(){c3(o3)}function s3(e,t){return f3(e,t)}function d3(e,t){if(e.timeUnit){return"temporal"}if(e.bin){return"quantitative"}switch(v1(t)){case"continuous":return"quantitative";case"discrete":return"nominal";case"flexible":return"nominal";default:return"quantitative"}}function h3(e){if(Z2(e)){return e}else if(V2(e)){return e.condition}return undefined}function p3(e,t){if(Object(dn["G"])(e)||Object(dn["D"])(e)||Object(dn["A"])(e)){var n=Object(dn["G"])(e)?"string":Object(dn["D"])(e)?"number":"boolean";K1(n2.primitiveChannelDef(t,n,e));return{value:e}}if(Z2(e)){return v3(e,t)}else if(V2(e)){return q({},e,{condition:v3(e.condition,t)})}return e}function v3(e,t){if(e.aggregate&&!VK(e.aggregate)){var n=e.aggregate,r=W(e,["aggregate"]);K1(n2.invalidAggregate(e.aggregate));e=r}if(e.timeUnit){e=q({},e,{timeUnit:T2(e.timeUnit)})}if(e.bin){e=q({},e,{bin:g3(e.bin,t)})}if(e.type){var i=W2(e.type);if(e.type!==i){e=q({},e,{type:i})}if(e.type!=="quantitative"){if(ZK(e.aggregate)){K1(n2.invalidFieldTypeForCountAggregate(e.type,e.aggregate));e=q({},e,{type:"quantitative"})}}}else{var a=d3(e,t);K1(n2.emptyOrInvalidFieldType(e.type,t,a));e=q({},e,{type:a})}var u=y3(e,t),o=u.compatible,f=u.warning;if(!o){K1(f)}return e}function g3(e,t){if(Object(dn["A"])(e)){return{maxbins:y1(t)}}else if(!e.maxbins&&!e.step){return q({},e,{maxbins:y1(t)})}else{return e}}var m3={compatible:true};function y3(e,t){var n=e.type;switch(t){case"row":case"column":if(r3(e)){return{compatible:false,warning:n2.facetChannelShouldBeDiscrete(t)}}return m3;case"x":case"y":case"color":case"fill":case"stroke":case"text":case"detail":case"key":case"tooltip":case"href":return m3;case"longitude":case"longitude2":case"latitude":case"latitude2":if(n!==L2){return{compatible:false,warning:"Channel "+t+" should be used with a quantitative field only, not "+e.type+" field."}}return m3;case"opacity":case"size":case"x2":case"y2":if(n==="nominal"&&!e["sort"]||n==="geojson"){return{compatible:false,warning:"Channel "+t+" should not be used with an unsorted discrete field."}}return m3;case"shape":if(e.type!=="nominal"&&e.type!=="geojson"){return{compatible:false,warning:"Shape channel should be used with only either nominal or geojson data"}}return m3;case"order":if(e.type==="nominal"&&!("sort"in e)){return{compatible:false,warning:"Channel order is inappropriate for nominal field, which has no inherent order."}}return m3}throw new Error("channelCompatability not implemented for channel "+t)}function b3(e){return e.type==="quantitative"||!!e.bin}function x3(e){return e.type==="temporal"||!!e.timeUnit}function _3(e,t){var n=t.timeUnit,r=t.type,i=t.time,a=t.undefinedIfExprNotRequired;var u;var o=undefined;if(i2(e)){o=d2(e,true)}else if(Object(dn["G"])(e)||Object(dn["D"])(e)){if(n||r==="temporal"){if(g2(n)){o=d2((u={},u[n]=e,u),true)}else if(y2(n)){o=_3(e,{timeUnit:k2(n)})}else{o="datetime("+JSON.stringify(e)+")"}}}if(o){return i?"time("+o+")":o}return a?undefined:JSON.stringify(e)}function w3(e,t){var n=e.timeUnit,r=e.type;return t.map(function(e){var t=_3(e,{timeUnit:n,type:r,undefinedIfExprNotRequired:true});if(t!==undefined){return{signal:t}}return e})}function k3(e,t){var n=e&&e[t];if(n){if(Object(dn["z"])(n)){return wK(n,function(e){return!!e.field})}else{return Z2(n)||V2(n)}}return false}function O3(e){return wK(P0,function(t){if(k3(e,t)){var n=e[t];if(Object(dn["z"])(n)){return wK(n,function(e){return!!e.aggregate})}else{var r=h3(n);return r&&!!r.aggregate}}return false})}function A3(e,t){return NK(e).reduce(function(n,r){var i;if(!q0(r)){K1(n2.invalidEncodingChannel(r));return n}if(!h1(r,t)){K1(n2.incompatibleChannel(r,t));return n}if(r==="size"&&t==="line"){var a=h3(e[r]);if(a&&a.aggregate){K1(n2.LINE_WITH_VARYING_SIZE);return n}}if(r==="color"&&("fill"in e||"stroke"in e)){K1(n2.droppingColor("encoding",{fill:"fill"in e,stroke:"stroke"in e}));return n}var u=e[r];if(r==="detail"||r==="order"&&!Object(dn["z"])(u)&&!Q2(u)||r==="tooltip"&&Object(dn["z"])(u)){if(u){n[r]=(Object(dn["z"])(u)?u:[u]).reduce(function(e,t){if(!Z2(t)){K1(n2.emptyFieldDef(t,r))}else{e.push(v3(t,r))}return e},[])}}else{var a=h3(e[r]);if(a&&bK([z2.LATITUDE,z2.LONGITUDE],a.type)){var o=r,f=n[o],c=W(n,[typeof o==="symbol"?o:o+""]);var l=r==="x"?"longitude":r==="y"?"latitude":r==="x2"?"longitude2":r==="y2"?"latitude2":undefined;K1(n2.latLongDeprecated(r,a.type,l));return q({},c,(i={},i[l]=q({},p3(a,r),{type:"quantitative"}),i))}if(!Z2(u)&&!Q2(u)&&!$2(u)){K1(n2.emptyFieldDef(u,r));return n}n[r]=p3(u,r)}return n},{})}function E3(e){return e&&(!!e.x&&!!e.x2||!!e.y&&!!e.y2)}function M3(e){var t=[];P0.forEach(function(n){if(k3(e,n)){var r=e[n];(Object(dn["z"])(r)?r:[r]).forEach(function(e){if(Z2(e)){t.push(e)}else if(V2(e)){t.push(e.condition)}})}});return t}function S3(e,t,n){if(!e){return}var r=function(r){if(Object(dn["z"])(e[r])){e[r].forEach(function(e){t.call(n,e,r)})}else{t.call(n,e[r],r)}};for(var i=0,a=NK(e);i<a.length;i++){var u=a[i];r(u)}}function C3(e,t,n,r){if(!e){return n}return NK(e).reduce(function(n,i){var a=e[i];if(Object(dn["z"])(a)){return a.reduce(function(e,n){return t.call(r,e,n,i)},n)}else{return t.call(r,n,a,i)}},n)}function D3(e,t){var n;var r=e[t];return r!==undefined?(n={},n[t]={value:r},n):{}}var j3="box-plot";function N3(e){return!!e["type"]}var F3=["boxWhisker","box","boxMid"];var T3={box:["size","color","extent"],boxWhisker:["color"],boxMid:["color"]};var z3=["x","y","color","detail","opacity","size"];function R3(e){return q({},e,{encoding:C3(e.encoding,function(e,t,n){if(z3.indexOf(n)>-1){e[n]=t}else{K1(n2.incompatibleChannel(n,j3))}return e},{})})}function P3(e,t){var n,r,i,a;e=R3(e);var u=e.mark,o=e.encoding,f=e.selection,c=e.projection,l=W(e,["mark","encoding","selection","projection"]);var s=undefined;if(Object(dn["D"])(t.box.extent)){s=t.box.extent}if(N3(u)){if(u.extent){if(u.extent==="min-max"){s=undefined}}}var d=L3(e);var h=I3(e,d,s),p=h.transform,v=h.continuousAxisChannelDef,g=h.continuousAxis,m=h.encodingWithoutContinuousAxis;var y=m.color,b=m.size,x=W(m,["color","size"]);var _=b?{size:b}:D3(t.box,"size");var w={};if(v.scale){w["scale"]=v.scale}if(v.axis){w["axis"]=v.axis}return q({},l,{transform:p,layer:[{mark:{type:"rule",style:"boxWhisker"},encoding:q((n={},n[g]=q({field:"lower_whisker_"+v.field,type:v.type},w),n[g+"2"]={field:"lower_box_"+v.field,type:v.type},n),x,D3(t.boxWhisker,"color"))},{mark:{type:"rule",style:"boxWhisker"},encoding:q((r={},r[g]={field:"upper_box_"+v.field,type:v.type},r[g+"2"]={field:"upper_whisker_"+v.field,type:v.type},r),x,D3(t.boxWhisker,"color"))},q({},f?{selection:f}:{},{mark:{type:"bar",style:"box"},encoding:q((i={},i[g]={field:"lower_box_"+v.field,type:v.type},i[g+"2"]={field:"upper_box_"+v.field,type:v.type},i),m,m.color?{}:D3(t.box,"color"),_)}),{mark:{type:"tick",style:"boxMid"},encoding:q((a={},a[g]={field:"mid_box_"+v.field,type:v.type},a),x,D3(t.boxMid,"color"),_)}]})}function L3(e){var t=e.mark,n=e.encoding,r=e.projection,i=W(e,["mark","encoding","projection"]);if(Z2(n.x)&&r3(n.x)){if(Z2(n.y)&&r3(n.y)){if(n.x.aggregate===undefined&&n.y.aggregate===j3){return"vertical"}else if(n.y.aggregate===undefined&&n.x.aggregate===j3){return"horizontal"}else if(n.x.aggregate===j3&&n.y.aggregate===j3){throw new Error("Both x and y cannot have aggregate")}else{if(N3(t)&&t.orient){return t.orient}return"vertical"}}return"horizontal"}else if(Z2(n.y)&&r3(n.y)){return"vertical"}else{throw new Error("Need a valid continuous axis for boxplots")}}function B3(e,t){var n=e.mark,r=e.encoding,i=e.projection,a=W(e,["mark","encoding","projection"]);var u;var o;if(t==="vertical"){o="y";u=r.y}else{o="x";u=r.x}if(u&&u.aggregate){var f=u.aggregate,c=W(u,["aggregate"]);if(f!==j3){K1("Continuous axis should not have customized aggregation function "+f)}u=c}return{continuousAxisChannelDef:u,continuousAxis:o}}function I3(e,t,n){var r=B3(e,t),i=r.continuousAxisChannelDef,a=r.continuousAxis;var u=e.encoding;var o=n===undefined;var f=[{op:"q1",field:i.field,as:"lower_box_"+i.field},{op:"q3",field:i.field,as:"upper_box_"+i.field},{op:"median",field:i.field,as:"mid_box_"+i.field}];var c=[];f.push({op:"min",field:i.field,as:(o?"lower_whisker_":"min_")+i.field});f.push({op:"max",field:i.field,as:(o?"upper_whisker_":"max_")+i.field});if(!o){c=[{calculate:"datum.upper_box_"+i.field+" - datum.lower_box_"+i.field,as:"iqr_"+i.field},{calculate:"min(datum.upper_box_"+i.field+" + datum.iqr_"+i.field+" * "+n+", datum.max_"+i.field+")",as:"upper_whisker_"+i.field},{calculate:"max(datum.lower_box_"+i.field+" - datum.iqr_"+i.field+" * "+n+", datum.min_"+i.field+")",as:"lower_whisker_"+i.field}]}var l=[];var s=[];var d=[];var h={};S3(u,function(e,t){if(t===a){return}if(Z2(e)){if(e.aggregate&&e.aggregate!==j3){f.push({op:e.aggregate,field:e.field,as:t3(e)})}else if(e.aggregate===undefined){var n=t3(e);var r=e.bin;if(r){var i=e.field;s.push({bin:r,field:i,as:n})}else if(e.timeUnit){var o=e.timeUnit,i=e.field;d.push({timeUnit:o,field:i,as:n})}l.push(n)}h[t]={field:t3(e),type:e.type}}else{h[t]=u[t]}});return{transform:[].concat(s,d,[{aggregate:f,groupby:l}],c),continuousAxisChannelDef:i,continuousAxis:a,encodingWithoutContinuousAxis:h}}var U3="error-bar";function q3(e){var t=e.mark,n=e.selection,r=e.projection,i=e.encoding,a=W(e,["mark","selection","projection","encoding"]);var u=i.size,o=W(i,["size"]);var f=i.x2,c=i.y2,l=W(i,["x2","y2"]);var s=l.x,d=l.y,h=W(l,["x","y"]);if(!i.x2&&!i.y2){throw new Error("Neither x2 or y2 provided")}return q({},a,{layer:[{mark:"rule",encoding:o},{mark:"tick",encoding:l},{mark:"tick",encoding:i.x2?q({x:i.x2,y:i.y},h):q({x:i.x,y:i.y2},h)}]})}var W3={};function H3(e,t){W3[e]=t}function G3(e){delete W3[e]}var Y3=F3;var $3=q({},T3);H3(j3,P3);H3(U3,q3);function V3(e,t){var n=R1(e.mark)?e.mark.type:e.mark;var r=W3[n];if(r){return r(e,t)}throw new Error('Invalid mark type "'+n+'"')}var X3=["shortTimeLabels"];var Z3={};var J3={entryPadding:1,format:1,offset:1,orient:1,padding:1,tickCount:1,title:1,type:1,values:1,zindex:1};var Q3=q({},J3,{opacity:1,shape:1,stroke:1,fill:1,size:1,encode:1});var K3=TK(J3);var e6=TK(Q3);var t6;(function(e){e.LINEAR="linear";e.BIN_LINEAR="bin-linear";e.LOG="log";e.POW="pow";e.SQRT="sqrt";e.TIME="time";e.UTC="utc";e.SEQUENTIAL="sequential";e.QUANTILE="quantile";e.QUANTIZE="quantize";e.THRESHOLD="threshold";e.ORDINAL="ordinal";e.BIN_ORDINAL="bin-ordinal";e.POINT="point";e.BAND="band"})(t6||(t6={}));var n6={linear:"numeric",log:"numeric",pow:"numeric",sqrt:"numeric","bin-linear":"bin-linear",time:"time",utc:"time",sequential:"sequential",ordinal:"ordinal","bin-ordinal":"bin-ordinal",point:"ordinal-position",band:"ordinal-position"};var r6=NK(n6);function i6(e,t){var n=n6[e];var r=n6[t];return n===r||n==="ordinal-position"&&r==="time"||r==="ordinal-position"&&n==="time"}var a6={linear:0,log:1,pow:1,sqrt:1,time:0,utc:0,point:10,band:11,"bin-linear":0,sequential:0,ordinal:0,"bin-ordinal":0};function u6(e){return a6[e]}var o6=["linear","bin-linear","log","pow","sqrt","time","utc"];var f6=Object(dn["ab"])(o6);var c6=o6.concat(["sequential"]);var l6=Object(dn["ab"])(c6);var s6=["ordinal","bin-ordinal","point","band"];var d6=Object(dn["ab"])(s6);var h6=Object(dn["ab"])(["bin-linear","bin-ordinal"]);var p6=["time","utc"];function v6(e){return e in d6}function g6(e){return e in h6}function m6(e){return e in l6}function y6(e){return e in f6}var b6={textXRangeStep:90,rangeStep:21,pointPadding:.5,bandPaddingInner:.1,facetSpacing:16,minBandSize:2,minFontSize:8,maxFontSize:40,minOpacity:.3,maxOpacity:.8,minSize:9,minStrokeWidth:1,maxStrokeWidth:4};function x6(e){return e&&!!e["name"]}function _6(e){return e&&e["selection"]}var w6={type:1,domain:1,range:1,rangeStep:1,scheme:1,reverse:1,round:1,clamp:1,nice:1,base:1,exponent:1,interpolate:1,zero:1,padding:1,paddingInner:1,paddingOuter:1};var k6=TK(w6);var O6=w6.type,A6=w6.domain,E6=w6.range,M6=w6.rangeStep,S6=w6.scheme,C6=W(w6,["type","domain","range","rangeStep","scheme"]);var D6=TK(C6);var j6=P6();function N6(e,t){switch(t){case"type":case"domain":case"reverse":case"range":return true;case"scheme":return bK(["sequential","ordinal","bin-ordinal","quantile","quantize"],e);case"interpolate":return bK(["linear","bin-linear","pow","log","sqrt","utc","time"],e);case"round":return y6(e)||e==="band"||e==="point";case"padding":return y6(e)||bK(["point","band"],e);case"paddingOuter":case"rangeStep":return bK(["point","band"],e);case"paddingInner":return e==="band";case"clamp":return y6(e)||e==="sequential";case"nice":return y6(e)||e==="sequential"||e==="quantize";case"exponent":return e==="pow";case"base":return e==="log";case"zero":return m6(e)&&!bK(["log","time","utc","bin-linear","threshold","quantile"],e)}throw new Error("Invalid scale property "+t+".")}function F6(e,t){switch(t){case"interpolate":case"scheme":if(!T0(e)){return n2.cannotUseScalePropertyWithNonColor(e)}return undefined;case"type":case"domain":case"range":case"base":case"exponent":case"nice":case"padding":case"paddingInner":case"paddingOuter":case"rangeStep":case"reverse":case"round":case"clamp":case"zero":return undefined}throw new Error('Invalid scale property "'+t+'".')}function T6(e,t,n){if(bK([z2.ORDINAL,z2.NOMINAL],t)){return e===undefined||v6(e)}else if(t===z2.TEMPORAL){return bK([t6.TIME,t6.UTC,t6.SEQUENTIAL,undefined],e)}else if(t===z2.QUANTITATIVE){if(n){return bK([t6.BIN_LINEAR,t6.BIN_ORDINAL,t6.LINEAR],e)}return bK([t6.LOG,t6.POW,t6.SQRT,t6.QUANTILE,t6.QUANTIZE,t6.LINEAR,t6.SEQUENTIAL,undefined],e)}return true}function z6(e,t){switch(e){case f0.X:case f0.Y:case f0.SIZE:case f0.OPACITY:return y6(t)||bK(["band","point"],t);case f0.COLOR:case f0.FILL:case f0.STROKE:return t!=="band";case f0.SHAPE:return t==="ordinal"}return false}function R6(e,t,n){return j6[L6(e,t,n)]}function P6(){var e={};for(var t=0,n=P0;t<n.length;t++){var r=n[t];for(var i=0,a=NK(R2);i<a.length;i++){var u=a[i];for(var o=0,f=r6;o<f.length;o++){var c=f[o];for(var l=0,s=[false,true];l<s.length;l++){var d=s[l];var h=L6(r,u,d);if(z6(r,c)&&T6(c,u,d)){e[h]=e[h]||[];e[h].push(c)}}}}}return e}function L6(e,t,n){var r=e+"_"+t;return n?r+"_bin":r}var B6="_vgsid_";var I6={single:{on:"click",fields:[B6],resolve:"global",empty:"all"},multi:{on:"click",fields:[B6],toggle:"event.shiftKey",resolve:"global",empty:"all"},interval:{on:"[mousedown, window:mouseup] > window:mousemove!",encodings:["x","y"],translate:"[mousedown, window:mouseup] > window:mousemove!",zoom:"wheel!",mark:{fill:"#333",fillOpacity:.125,stroke:"white"},resolve:"global"}};function U6(e){var t=e.anchor,n=e.offset,r=e.orient,i=e.color,a=W(e,["anchor","offset","orient","color"]);var u=q({},a,i?{fill:i}:{});var o=q({},t?{anchor:t}:{},n?{offset:n}:{},r?{orient:r}:{});return{mark:u,nonMark:o}}var q6={width:200,height:200};var W6={padding:5,timeFormat:"",countTitle:"Number of Records",invalidValues:"filter",view:q6,mark:H1,area:{},bar:G1,circle:{},geoshape:{},line:{},point:{},rect:{},rule:{color:"black"},square:{},text:{color:"black"},tick:Y1,trail:{},box:{size:14,extent:1.5},boxWhisker:{},boxMid:{color:"white"},scale:b6,projection:{},axis:{},axisX:{},axisY:{minExtent:30},axisLeft:{},axisRight:{},axisTop:{},axisBottom:{},axisBand:{},legend:Z3,selection:I6,style:{},title:{}};function H6(e){return AK(zK(W6),e)}var G6=["view"].concat(z1,Y3);var Y6=["padding","numberFormat","timeFormat","countTitle","stack","scale","selection","invalidValues","overlay"];var $6=q({view:["width","height"]},W1,$3);function V6(e){e=zK(e);for(var t=0,n=Y6;t<n.length;t++){var r=n[t];delete e[r]}if(e.axis){for(var i=0,a=X3;i<a.length;i++){var r=a[i];delete e.axis[r]}}if(e.legend){for(var u=0,o=X3;u<o.length;u++){var r=o[u];delete e.legend[r]}}if(e.mark){for(var f=0,c=q1;f<c.length;f++){var r=c[f];delete e.mark[r]}}for(var l=0,s=G6;l<s.length;l++){var d=s[l];for(var h=0,p=q1;h<p.length;h++){var r=p[h];delete e[d][r]}var v=$6[d];if(v){for(var g=0,m=v;g<m.length;g++){var r=m[g];delete e[d][r]}}X6(e,d)}X6(e,"title","group-title");for(var r in e){if(Object(dn["E"])(e[r])&&NK(e[r]).length===0){delete e[r]}}return NK(e).length>0?e:undefined}function X6(e,t,n){var r=t==="title"?U6(e.title).mark:e[t];if(t==="view"){n="cell"}var i=q({},r,e.style[t]);if(NK(i).length>0){e.style[n||t]=i}delete e[t]}var Z6={zero:1,center:1,normalize:1};function J6(e){return!!Z6[e]}var Q6=[_1,x1,S1,k1,D1,j1,w1,O1,A1];var K6=[_1,x1];function e5(e){var t=e.x;var n=e.y;if(Z2(t)&&Z2(n)){if(t.type==="quantitative"&&n.type==="quantitative"){if(t.stack){return"x"}else if(n.stack){return"y"}if(!!t.aggregate!==!!n.aggregate){return t.aggregate?"x":"y"}}else if(t.type==="quantitative"){return"x"}else if(n.type==="quantitative"){return"y"}}else if(Z2(t)&&t.type==="quantitative"){return"x"}else if(Z2(n)&&n.type==="quantitative"){return"y"}return undefined}function t5(e,t,n){var r=R1(e)?e.type:e;if(!bK(Q6,r)){return null}var i=e5(t);if(!i){return null}var a=t[i];var u=J2(a)?t3(a,{}):undefined;var o=i==="x"?"y":"x";var f=t[o];var c=J2(f)?t3(f,{}):undefined;var l=K0.reduce(function(e,n){if(k3(t,n)){var r=t[n];(Object(dn["z"])(r)?r:[r]).forEach(function(t){var r=h3(t);if(r.aggregate){return}var i=J2(r)?t3(r,{}):undefined;if(!i||i!==c&&i!==u){e.push({channel:n,fieldDef:r})}})}return e},[]);if(l.length===0){return null}var s=undefined;if(a.stack!==undefined){s=a.stack}else if(bK(K6,r)){s=n===undefined?"zero":n}else{s=n}if(!s||!J6(s)){return null}if(a.scale&&a.scale.type&&a.scale.type!==t6.LINEAR){K1(n2.cannotStackNonLinearScale(a.scale.type))}if(k3(t,i===c0?s0:d0)){if(a.stack!==undefined){K1(n2.cannotStackRangedMark(i))}return null}if(a.aggregate&&!bK(JK,a.aggregate)){K1(n2.stackNonSummativeAggregate(a.aggregate))}return{groupbyChannel:f?o:undefined,fieldChannel:i,impute:T1(r),stackBy:l,offset:s}}function n5(e){return e["facet"]!==undefined}function r5(e){return!!e["mark"]}function i5(e){return e["layer"]!==undefined}function a5(e){return e["repeat"]!==undefined}function u5(e){return o5(e)||f5(e)}function o5(e){return e["vconcat"]!==undefined}function f5(e){return e["hconcat"]!==undefined}function c5(e,t){if(n5(e)){return l5(e,t)}if(i5(e)){return h5(e,t)}if(a5(e)){return p5(e,t)}if(o5(e)){return v5(e,t)}if(f5(e)){return g5(e,t)}if(r5(e)){var n=k3(e.encoding,m0);var r=k3(e.encoding,y0);if(n||r){return m5(e,t)}return _5(e,t)}throw new Error(n2.INVALID_SPEC)}function l5(e,t){var n=e.spec,r=W(e,["spec"]);return q({},r,{spec:c5(n,t)})}function s5(e){var t=e.parentEncoding,n=e.encoding;if(t&&n){var r=NK(t).reduce(function(e,t){if(n[t]){e.push(t)}return e},[]);if(r.length>0){K1(n2.encodingOverridden(r))}}var i=q({},t||{},n||{});return NK(i).length>0?i:undefined}function d5(e){var t=e.parentProjection,n=e.projection;if(t&&n){K1(n2.projectionOverridden({parentProjection:t,projection:n}))}return n||t}function h5(e,t,n,r){var i=e.layer,a=e.encoding,u=e.projection,o=W(e,["layer","encoding","projection"]);var f=s5({parentEncoding:n,encoding:a});var c=d5({parentProjection:r,projection:u});return q({},o,{layer:i.map(function(e){if(i5(e)){return h5(e,t,f,c)}return _5(e,t,f,c)})})}function p5(e,t){var n=e.spec,r=W(e,["spec"]);return q({},r,{spec:c5(n,t)})}function v5(e,t){var n=e.vconcat,r=W(e,["vconcat"]);return q({},r,{vconcat:n.map(function(e){return c5(e,t)})})}function g5(e,t){var n=e.hconcat,r=W(e,["hconcat"]);return q({},r,{hconcat:n.map(function(e){return c5(e,t)})})}function m5(e,t){var n=e.encoding,r=n.row,i=n.column,a=W(n,["row","column"]);var u=e.mark,o=e.width,f=e.projection,c=e.height,l=e.selection,s=e.encoding,d=W(e,["mark","width","projection","height","selection","encoding"]);return q({},d,{facet:q({},r?{row:r}:{},i?{column:i}:{}),spec:_5(q({},f?{projection:f}:{},{mark:u},o?{width:o}:{},c?{height:c}:{},{encoding:a},l?{selection:l}:{}),t)})}function y5(e){return L1(e.mark)}function b5(e,t,n){if(e.point==="transparent"){return{opacity:0}}else if(e.point){return Object(dn["E"])(e.point)?e.point:{}}else if(e.point!==undefined){return null}else{if(t.point||n.shape){return Object(dn["E"])(t.point)?t.point:{}}return null}}function x5(e,t){if(e.line){return e.line===true?{}:e.line}else if(e.line!==undefined){return null}else{if(t.line){return t.line===true?{}:t.line}return null}}function _5(e,t,n,r){var i=e.encoding,a=e.projection;var u=R1(e.mark)?e.mark.type:e.mark;if(n||r){var o=d5({parentProjection:r,projection:a});var f=s5({parentEncoding:n,encoding:i});return _5(q({},e,o?{projection:o}:{},f?{encoding:f}:{}),t)}if(y5(e)){if(E3(i)){return w5(e)}if(u==="line"&&(i.x2||i.y2)){K1(n2.lineWithRange(!!i.x2,!!i.y2));return _5(q({mark:"rule"},e),t,n,r)}if(T1(u)){return O5(e,t)}return e}else{return V3(e,t)}}function w5(e){var t=k3(e.encoding,c0);var n=k3(e.encoding,l0);var r=k3(e.encoding,s0);var i=k3(e.encoding,d0);if(r&&!t||i&&!n){var a=zK(e);if(r&&!t){a.encoding.x=a.encoding.x2;delete a.encoding.x2}if(i&&!n){a.encoding.y=a.encoding.y2;delete a.encoding.y2}return a}return e}function k5(e){var t=e.point,n=e.line,r=W(e,["point","line"]);return NK(r).length>1?r:r.type}function O5(e,t){if(t===void 0){t={}}var n;var r=e.selection,i=e.projection,a=e.encoding,u=e.mark,o=W(e,["selection","projection","encoding","mark"]);var f=R1(u)?u:{type:u};var c=b5(f,t[f.type],a);var l=f.type==="area"&&x5(f,t[f.type]);if(!c&&!l){return q({},e,{mark:k5(f)})}var s=[q({},r?{selection:r}:{},{mark:k5(q({},f,f.type==="area"?{opacity:.7}:{})),encoding:gK(a,["shape"])})];var d=t5(f,a,t?t.stack:undefined);var h=a;if(d){var p=d.fieldChannel,v=d.offset;h=q({},a,(n={},n[p]=q({},a[p],v?{stack:v}:{}),n))}if(l){s.push(q({},i?{projection:i}:{},{mark:q({type:"line"},vK(f,["clip","interpolate"]),l),encoding:h}))}if(c){s.push(q({},i?{projection:i}:{},{mark:q({type:"point",opacity:1,filled:true},vK(f,["clip"]),c),encoding:h}))}return q({},o,{layer:s})}function A5(e,t){t.forEach(function(t){var n=["field","type","value","timeUnit","bin","aggregate"].reduce(function(e,n){if(t[n]!==undefined){e[n]=t[n]}return e},{});var r=yK(n);e[r]=e[r]||t});return e}function E5(e,t){if(t===void 0){t={}}if(i5(e)){e.layer.forEach(function(e){if(r5(e)){A5(t,M3(e.encoding))}else{E5(e,t)}})}else if(n5(e)){A5(t,M3(e.facet));E5(e.spec,t)}else if(a5(e)){E5(e.spec,t)}else if(u5(e)){var n=o5(e)?e.vconcat:e.hconcat;n.forEach(function(e){return E5(e,t)})}else{A5(t,M3(e.encoding))}return t}function M5(e){return FK(E5(e))}function S5(e,t){t=t||e.config;if(L1(e.mark)){return t5(e.mark,e.encoding,t?t.stack:undefined)!==null}return false}function C5(e){var t=e||{},n=t.align,r=n===void 0?undefined:n,i=t.center,a=i===void 0?undefined:i,u=t.bounds,o=u===void 0?undefined:u,f=t.spacing,c=f===void 0?undefined:f;return{align:r,bounds:o,center:a,spacing:c}}function D5(e){return Object(dn["G"])(e)?{type:e}:e||{}}function j5(e,t,n){if(n===void 0){n=true}var r=q({type:"pad"},D5(t),D5(e));if(r.type==="fit"){if(!n){K1(n2.FIT_NON_SINGLE);r.type="pad"}}return r}var N5=["background","padding","datasets"];function F5(e){return N5.reduce(function(t,n){if(e&&e[n]!==undefined){t[n]=e[n]}return t},{})}function T5(e){return!!e["url"]}function z5(e){return!!e["values"]}function R5(e){return!!e["name"]&&!T5(e)&&!z5(e)}var P5="main";var L5="raw";function B5(e){return!!e["signal"]}function I5(e){return!!e["step"]}function U5(e){if(!Object(dn["z"])(e)){return"fields"in e&&!("data"in e)}return false}function q5(e){if(!Object(dn["z"])(e)){return"fields"in e&&"data"in e}return false}function W5(e){if(!Object(dn["z"])(e)){return"field"in e&&"data"in e}return false}function H5(e){if(!Object(dn["z"])(e)){return"signal"in e}return false}var G5={opacity:1,fill:1,fillOpacity:1,stroke:1,strokeCap:1,strokeWidth:1,strokeOpacity:1,strokeDash:1,strokeDashOffset:1,strokeJoin:1,strokeMiterLimit:1,size:1,shape:1,interpolate:1,tension:1,orient:1,align:1,baseline:1,text:1,dir:1,dx:1,dy:1,ellipsis:1,limit:1,radius:1,theta:1,angle:1,font:1,fontSize:1,fontWeight:1,fontStyle:1,cursor:1,href:1,tooltip:1,cornerRadius:1};var Y5=TK(G5);function $5(e,t){if(Object(dn["z"])(e)){return e.map(function(e){return s3(e,t)}).join(", ")}return e}function V5(e,t,n,r){if(r===void 0){r={header:false}}var i=e.combine(),a=i.orient,u=i.scale,o=i.title,f=i.zindex,c=W(i,["orient","scale","title","zindex"]);NK(c).forEach(function(e){var n=t0[e];if(n&&n!==t&&n!=="both"){delete c[e]}});if(t==="grid"){if(!c.grid){return undefined}if(c.encode){var l=c.encode.grid;c.encode=q({},l?{grid:l}:{});if(NK(c.encode).length===0){delete c.encode}}return q({scale:u,orient:a},c,{domain:false,labels:false,maxExtent:0,minExtent:0,ticks:false,zindex:f!==undefined?f:0})}else{if(!r.header&&e.mainExtracted){return undefined}if(c.encode){for(var s=0,d=e0;s<d.length;s++){var h=d[s];if(!e.hasAxisPart(h)){delete c.encode[h]}}if(NK(c.encode).length===0){delete c.encode}}var p=$5(o,n);return q({scale:u,orient:a,grid:false},p?{title:p}:{},c,{zindex:f!==undefined?f:1})}}function X5(e,t){var n=e.x,r=n===void 0?[]:n,i=e.y,a=i===void 0?[]:i;return r.map(function(e){return V5(e,"main",t)}).concat(r.map(function(e){return V5(e,"grid",t)}),a.map(function(e){return V5(e,"main",t)}),a.map(function(e){return V5(e,"grid",t)})).filter(function(e){return e})}var Z5={titleAnchor:"anchor",titleAngle:"angle",titleBaseline:"baseline",titleColor:"color",titleFont:"font",titleFontSize:"fontSize",titleFontWeight:"fontWeight",titleLimit:"limit"};var J5={labelAngle:"angle",labelColor:"color",labelFont:"font",labelFontSize:"fontSize",labelLimit:"limit"};var Q5=Object.keys(Z5);var K5=Object.keys(J5);function e8(e){return!!e&&(e["op"]==="count"||!!e["field"])&&!!e["op"]}function t8(e){return!!e&&Object(dn["z"])(e)}function n8(e,t,n,r,i,a){if(Z2(t)&&i&&e===i.fieldChannel){return u8(t,n,{suffix:"end"})}return c8(e,t,n,r,i,a)}function r8(e,t,n,r,i,a,u){if(Z2(t)&&a&&e.charAt(0)===a.fieldChannel.charAt(0)){return u8(t,r,{suffix:"start"})}return c8(e,n,r,i,a,u)}function i8(e,t){var n=e+"Offset";var r=t[n];if(r){return r}return undefined}function a8(e,t,n,r){var i=n==="start"?undefined:"end";return u8(e,t,{binSuffix:i},r?{offset:r}:{})}function u8(e,t,n,r){var i=q({},t?{scale:t}:{},{field:t3(e,n)});if(r){return q({},i,r)}return i}function o8(e,t){if(t===void 0){t=true}return{scale:e,band:t}}function f8(e,t){return{signal:"("+('scale("'+t+'", '+t3(e,{expr:"datum"})+")")+" + "+('scale("'+t+'", '+t3(e,{binSuffix:"end",expr:"datum"})+")")+")/2"}}function c8(e,t,n,r,i,a){if(t){if(Z2(t)){if(t.bin){if(bK([c0,l0],e)&&t.type===L2){if(i&&i.impute){return u8(t,n,{binSuffix:"mid"})}return f8(t,n)}return u8(t,n,G8(t,e)?{binSuffix:"range"}:{})}if(r){var u=r.get("type");if(v6(u)){if(u==="band"){return u8(t,n,{binSuffix:"range"},{band:.5})}return u8(t,n,{binSuffix:"range"})}}return u8(t,n,{})}else if(Q2(t)){var o=t.value;if(bK(["x","x2"],e)&&o==="width"){return{field:{group:"width"}}}else if(bK(["y","y2"],e)&&o==="height"){return{field:{group:"height"}}}return{value:o}}}return Object(dn["C"])(a)?a():a}function l8(e,t){if(e){if(Z2(e)){return T8(e,e.format,"datum",t)}else if(Q2(e)){return{value:e.value}}}return undefined}function s8(e){return q({},e,{mult:.5})}function d8(e){if(e.get("zero")!==false){return true}var t=e.domains;if(Object(dn["z"])(t)){return wK(t,function(e){return Object(dn["z"])(e)&&e.length===2&&e[0]<=0&&e[1]>=0})}return false}function h8(e,t,n,r,i){return function(){if(Object(dn["G"])(e)){if(n){var a=r.get("type");if(bK([t6.LOG,t6.TIME,t6.UTC],a)){if(i==="bar"||i==="area"){K1(n2.nonZeroScaleUsedWithLengthMark(i,t,{scaleType:a}))}}else{if(d8(r)){return{scale:n,value:0}}if(i==="bar"||i==="area"){K1(n2.nonZeroScaleUsedWithLengthMark(i,t,{zeroFalse:r.explicit.zero===false}))}}}if(e==="zeroOrMin"){return t==="x"?{value:0}:{field:{group:"height"}}}else{return t==="x"?{field:{group:"width"}}:{value:0}}}return e}}function p8(e,t){if(t===void 0){t={valueOnly:false}}var n,r;var i=e.markDef,a=e.encoding,u=e.config;var o=i.filled,f=i.type;var c={fill:F8("fill",i,u),stroke:F8("stroke",i,u),color:F8("color",i,u)};var l=bK(["bar","point","circle","square","geoshape"],f)?"transparent":undefined;var s={fill:i.fill||c.fill||l,stroke:i.stroke||c.stroke};var d=o?"fill":"stroke";var h=q({},s.fill?{fill:{value:s.fill}}:{},s.stroke?{stroke:{value:s.stroke}}:{});if(a.fill||a.stroke){if(i.color){K1(n2.droppingColor("property",{fill:"fill"in a,stroke:"stroke"in a}))}return q({},x8("fill",e,{defaultValue:s.fill||l}),x8("stroke",e,{defaultValue:s.stroke}))}else if(a.color){return q({},h,x8("color",e,{vgChannel:d,defaultValue:i[d]||i.color||c[d]||c.color||(o?l:undefined)}))}else if(i.fill||i.stroke){if(i.color){K1(n2.droppingColor("property",{fill:"fill"in i,stroke:"stroke"in i}))}return h}else if(i.color){return q({},h,(n={},n[d]={value:i.color},n))}else if(c.fill||c.stroke){return h}else if(c.color){return q({},l?{fill:{value:"transparent"}}:{},(r={},r[d]={value:c.color},r))}return{}}function v8(e,t){return q({},g8(e.markDef,t),p8(e),x8("opacity",e),w8(e),k8(e,"href"))}function g8(e,t){return Y5.reduce(function(n,r){if(e[r]!==undefined&&t[r]!=="ignore"){n[r]={value:e[r]}}return n},{})}function m8(e,t){var n;if(t!==undefined){return n={},n[e]={value:t},n}return undefined}function y8(e){return e+" !== null && !isNaN("+e+")"}function b8(e){if(e.config.invalidValues==="filter"){var t=["x","y"].map(function(t){var n=e.getScaleComponent(t);if(n){var r=n.get("type");if(m6(r)){return e.vgField(t,{expr:"datum"})}}return undefined}).filter(function(e){return!!e}).map(y8);if(t.length>0){return{defined:{signal:t.join(" && ")}}}}return{}}function x8(e,t,n){if(n===void 0){n={}}var r=n.defaultValue,i=n.vgChannel;var a=n.defaultRef||(r!==undefined?{value:r}:undefined);var u=t.encoding[e];return _8(t,u,i||e,function(n){return c8(e,n,t.scaleName(e),t.getScaleComponent(e),null,a)})}function _8(e,t,n,r){var i,a;var u=t&&t.condition;var o=r(t);if(u){var f=Object(dn["z"])(u)?u:[u];var c=f.map(function(t){var n=r(t);var i=H2(t)?ree(e,t.selection):wee(e,t.test);return q({test:i},n)});return i={},i[n]=c.concat(o!==undefined?[o]:[]),i}else{return o!==undefined?(a={},a[n]=o,a):{}}}function w8(e){var t="tooltip";var n=e.encoding[t];if(Object(dn["z"])(n)){var r=n.map(function(t){var n=t.title!==undefined?t.title:t3(t,{binSuffix:"range"});var r=l8(t,e.config).signal;return'"'+n+'": '+r});return{tooltip:{signal:"{"+r.join(", ")+"}"}}}else{return O8(e,t,n)}}function k8(e,t){if(t===void 0){t="text"}var n=e.encoding[t];return O8(e,t,n)}function O8(e,t,n){return _8(e,n,t,function(t){return l8(t,e.config)})}function A8(e,t,n){var r,i,a;var u=n.scaleName(t);var o=t==="x"?"width":"height";if(n.encoding.size||n.markDef.size!==undefined){var f=n.markDef.orient;if(f){var c=(r={},r[t+"c"]=u8(e,u,{},{band:.5}),r);if(h3(n.encoding.size)){return q({},c,x8("size",n,{vgChannel:o}))}else if(Q2(n.encoding.size)){return q({},c,x8("size",n,{vgChannel:o}))}else if(n.markDef.size!==undefined){return q({},c,(i={},i[o]={value:n.markDef.size},i))}}else{K1(n2.cannotApplySizeToNonOrientedMark(n.markDef.type))}}return a={},a[t]=u8(e,u,{binSuffix:"range"}),a[o]=o8(u),a}function E8(e,t,n,r){var i=e==="x"?"xc":"yc";var a=e==="x"?"width":"height";return q({},S8(e,t,n,i),x8("size",t,{defaultRef:r,vgChannel:a}))}function M8(e,t,n,r,i){if(t==="x"){return{x2:a8(e,n,"start",i?0:r),x:a8(e,n,"end",i?r:0)}}else{return{y2:a8(e,n,"start",i?r:0),y:a8(e,n,"end",i?0:r)}}}function S8(e,t,n,r){var i;var a=t.encoding,u=t.mark,o=t.stack;var f=a[e];var c=t.scaleName(e);var l=t.getScaleComponent(e);var s=i8(e,t.markDef);var d=!f&&(a.latitude||a.longitude)?{field:t.getName(e)}:q({},n8(e,a[e],c,l,o,h8(n,e,c,l,u)),s?{offset:s}:{});return i={},i[r||e]=d,i}function C8(e,t,n){var r;var i=e.encoding,a=e.mark,u=e.stack;var o=n==="x2"?"x":"y";var f=i[o];var c=e.scaleName(o);var l=e.getScaleComponent(o);var s=i8(n,e.markDef);var d=!f&&(i.latitude||i.longitude)?{field:e.getName(n)}:q({},r8(n,f,i[n],c,l,u,h8(t,o,c,l,a)),s?{offset:s}:{});return r={},r[n]=d,r}function D8(e,t,n){for(var r=0,i=n;r<i.length;r++){var a=i[r];var u=t[a];if(u!==undefined){e[a]={value:u}}}return e}function j8(e,t,n){for(var r=0,i=n;r<i.length;r++){var a=i[r];var u=F8(a,t.markDef,t.config);if(u!==undefined){e[a]={value:u}}}return e}function N8(e){return[].concat(e.type,e.style||[])}function F8(e,t,n){var r=n.mark[e];var i=n[t.type];if(i[e]!==undefined){r=i[e]}var a=N8(t);for(var u=0,o=a;u<o.length;u++){var f=o[u];var c=n.style[f];var l=e;if(c&&c[l]!==undefined){r=c[l]}}return r}function T8(e,t,n,r){var i=R8(e,t,r);if(e.bin){var a=t3(e,{expr:n});var u=t3(e,{expr:n,binSuffix:"end"});return{signal:B8(a,u,i,r)}}else if(e.type==="quantitative"){return{signal:""+P8(t3(e,{expr:n,binSuffix:"range"}),i)}}else if(x3(e)){var o=K2(e)&&e["scale"]&&e["scale"].type===t6.UTC;return{signal:I8(t3(e,{expr:n}),e.timeUnit,t,r.text.shortTimeLabels,r.timeFormat,o,true)}}else{return{signal:"''+"+t3(e,{expr:n})}}}function z8(e,t){if(e!==undefined){return e}return t}function R8(e,t,n){if(e.type===L2){if(t){return t}return n.numberFormat}return undefined}function P8(e,t){return"format("+e+', "'+(t||"")+'")'}function L8(e,t,n){return P8(e,t||n.numberFormat)}function B8(e,t,n,r){return e+" === null || isNaN("+e+') ? "null" : '+L8(e,n,r)+' + " - " + '+L8(t,n,r)}function I8(e,t,n,r,i,a,u){if(u===void 0){u=false}if(!t||n){n=n||i;if(n||u){return(a?"utc":"time")+"Format("+e+", '"+n+"')"}else{return undefined}}else{return F2(t,e,r,a)}}function U8(e,t){return(Object(dn["z"])(e)?e:[e]).reduce(function(e,n){e.field.push(t3(n,t));e.order.push(n.sort||"ascending");return e},{field:[],order:[]})}function q8(e,t){var n=e.slice();t.forEach(function(e){for(var t=0,r=n;t<r.length;t++){var i=r[t];if(mK(i)===mK(e)){return}}n.push(e)});return n}function W8(e,t){return e===t?e:e+", "+t}function H8(e,t){if(Object(dn["z"])(e.value)&&Object(dn["z"])(t.value)){return{explicit:e.explicit,value:q8(e.value,t.value)}}else if(!Object(dn["z"])(e.value)&&!Object(dn["z"])(t.value)){return{explicit:e.explicit,value:W8(e.value,t.value)}}throw new Error("It should never reach here")}function G8(e,t){if(!e.bin){console.warn("Only use this method with binned field defs");return false}return d1(t)&&bK(["ordinal","nominal"],e.type)}function Y8(e,t){return NK(e).reduce(function(n,r){var i=e[r];return q({},n,_8(t,i,r,function(e){return{value:e.value}}))},{})}var $8=function(){function e(e,t){this.debugName=t;this._children=[];this._parent=null;if(e){this.parent=e}}e.prototype.clone=function(){throw new Error("Cannot clone node")};e.prototype.producedFields=function(){return{}};e.prototype.dependentFields=function(){return{}};Object.defineProperty(e.prototype,"parent",{get:function(){return this._parent},set:function(e){this._parent=e;e.addChild(this)},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"children",{get:function(){return this._children},enumerable:true,configurable:true});e.prototype.numChildren=function(){return this._children.length};e.prototype.addChild=function(e){this._children.push(e)};e.prototype.removeChild=function(e){this._children.splice(this._children.indexOf(e),1)};e.prototype.remove=function(){for(var e=0,t=this._children;e<t.length;e++){var n=t[e];n.parent=this._parent}this._parent.removeChild(this)};e.prototype.insertAsParentOf=function(e){var t=e.parent;t.removeChild(this);this.parent=t;e.parent=this};e.prototype.swapWithParent=function(){var e=this._parent;var t=e.parent;for(var n=0,r=this._children;n<r.length;n++){var i=r[n];i.parent=e}this._children=[];e.removeChild(this);e.parent.removeChild(e);this.parent=t;e.parent=this};return e}();var V8=function(e){U(t,e);function t(t,n,r,i){var a=e.call(this,t,n)||this;a.type=r;a.refCounts=i;a._source=a._name=n;if(a.refCounts&&!(a._name in a.refCounts)){a.refCounts[a._name]=0}return a}t.prototype.clone=function(){var e=new this.constructor;e.debugName="clone_"+this.debugName;e._source=this._source;e._name="clone_"+this._name;e.type=this.type;e.refCounts=this.refCounts;e.refCounts[e._name]=0;return e};t.prototype.getSource=function(){this.refCounts[this._name]++;return this._source};t.prototype.isRequired=function(){return!!this.refCounts[this._name]};t.prototype.setSource=function(e){this._source=e};return t}($8);var X8=function(e){U(t,e);function t(t,n){var r=e.call(this,t)||this;r.transform=n;return r}t.prototype.clone=function(){return new t(null,zK(this.transform))};t.parseAllForSortIndex=function(e,n){n.forEachFieldDef(function(n,r){if(!K2(n)){return}if(t8(n.sort)){var i=n.field,a=n.timeUnit;var u=n.sort;var o=u.map(function(e,t){return Aee({field:i,timeUnit:a,equal:e})+" ? "+t+" : "}).join("")+u.length;e=new t(e,{calculate:o,as:Z8(n,r)})}});return e};t.prototype.producedFields=function(){var e={};e[this.transform.as]=true;return e};t.prototype.assemble=function(){return{type:"formula",expr:this.transform.calculate,as:this.transform.as}};return t}($8);function Z8(e,t,n){return t3(e,{prefix:t,suffix:"sort_index",expr:n})}var J8=["row","column"];var Q8=["header","footer"];function K8(e){if(e==="top"||e==="left"){return"header"}return"footer"}function e7(e,t){var n=e.component.layoutHeaders[t].title;var r=t==="row"?"left":undefined;var i=e.config?e.config:undefined;var a=e.component.layoutHeaders[t].facetFieldDef?e.component.layoutHeaders[t].facetFieldDef:undefined;return{name:t+"-title",type:"group",role:t+"-title",title:q({text:n,offset:10,orient:r,style:"guide-title"},u7(i,a,Q5,Z5))}}function t7(e,t){var n=e.component.layoutHeaders[t];var r=[];for(var i=0,a=Q8;i<a.length;i++){var u=a[i];if(n[u]){for(var o=0,f=n[u];o<f.length;o++){var c=f[o];r.push(a7(e,t,u,n,c))}}}return r}function n7(e){e=(e%360+360)%360;if((e+90)%180===0){return{}}else if(e<90||270<e){return{align:{value:"right"}}}else if(135<=e&&e<225){return{align:{value:"left"}}}return{}}function r7(e){e=(e%360+360)%360;if(45<=e&&e<=135){return{baseline:"top"}}return{baseline:"middle"}}function i7(e,t){var n=e.sort;if(e8(n)){return{field:t3(n,{expr:"datum"}),order:n.order||"ascending"}}else if(Object(dn["z"])(n)){return{field:Z8(e,t,"datum"),order:"ascending"}}else{return{field:t3(e,{expr:"datum"}),order:n||"ascending"}}}function a7(e,t,n,r,i){var a;if(i){var u=null;var o=r.facetFieldDef;if(o&&i.labels){var f=o.header,c=f===void 0?{}:f;var l=c.format,s=c.labelAngle;var d=e.config?e.config:undefined;var h=q({},n7(s));u=q({text:T8(o,l,"parent",e.config),offset:10,orient:t==="row"?"left":"top",style:"guide-label"},u7(d,o,K5,J5),NK(h).length>0?{encode:{update:h}}:{})}var p=i.axes;var v=p&&p.length>0;if(u||v){var g=t==="row"?"height":"width";return q({name:e.getName(t+"_"+n),type:"group",role:t+"-"+n},r.facetFieldDef?{from:{data:e.getName(t+"_domain")},sort:i7(o,t)}:{},u?{title:u}:{},i.sizeSignal?{encode:{update:(a={},a[g]=i.sizeSignal,a)}}:{},v?{axes:p}:{})}}return null}function u7(e,t,n,r){var i={};for(var a=0,u=n;a<u.length;a++){var o=u[a];if(e&&e.header){if(e.header[o]){i[r[o]]=e.header[o]}}if(t&&t.header){if(t.header[o]){i[r[o]]=t.header[o]}}}return i}function o7(e){return[].concat(f7(e,"width"),f7(e,"height"))}function f7(e,t){var n=t==="width"?"x":"y";var r=e.component.layoutSize.get(t);if(!r||r==="merged"){return[]}var i=e.getSizeSignalRef(t).signal;if(r==="range-step"){var a=e.getScaleComponent(n);if(a){var u=a.get("type");var o=a.get("range");if(v6(u)&&I5(o)){var f=e.scaleName(n);if(a9(e.parent)){var c=e.parent.component.resolve;if(c.scale[n]==="independent"){return[c7(f,o)]}}return[c7(f,o),{name:i,update:l7(f,a,"domain('"+f+"').length")}]}}throw new Error("layout size is range step although there is no rangeStep.")}else{return[{name:i,value:r}]}}function c7(e,t){return{name:e+"_step",value:t.step}}function l7(e,t,n){var r=t.get("type");var i=t.get("padding");var a=t.get("paddingOuter");a=a!==undefined?a:i;var u=t.get("paddingInner");u=r==="band"?u!==undefined?u:i:1;return"bandspace("+n+", "+u+", "+a+") * "+e+"_step"}function s7(e,t){if(f9(t)||a9(t)){return"shared"}else if(o9(t)||u9(t)){return bK(t1,e)?"independent":"shared"}throw new Error("invalid model type for resolve")}function d7(e,t){var n=e.scale[t];var r=bK(t1,t)?"axis":"legend";if(n==="independent"){if(e[r][t]==="shared"){K1(n2.independentScaleMeansIndependentGuide(t))}return"independent"}return e[r][t]||"shared"}var h7=function(){function e(e,t){if(e===void 0){e={}}if(t===void 0){t={}}this.explicit=e;this.implicit=t}e.prototype.clone=function(){return new e(zK(this.explicit),zK(this.implicit))};e.prototype.combine=function(){return q({},this.explicit,this.implicit)};e.prototype.get=function(e){return this.explicit[e]!==undefined?this.explicit[e]:this.implicit[e]};e.prototype.getWithExplicit=function(e){if(this.explicit[e]!==undefined){return{explicit:true,value:this.explicit[e]}}else if(this.implicit[e]!==undefined){return{explicit:false,value:this.implicit[e]}}return{explicit:false,value:undefined}};e.prototype.setWithExplicit=function(e,t){if(t.value!==undefined){this.set(e,t.value,t.explicit)}};e.prototype.set=function(e,t,n){delete this[n?"implicit":"explicit"][e];this[n?"explicit":"implicit"][e]=t;return this};e.prototype.copyKeyFromSplit=function(e,t){if(t.explicit[e]!==undefined){this.set(e,t.explicit[e],true)}else if(t.implicit[e]!==undefined){this.set(e,t.implicit[e],false)}};e.prototype.copyKeyFromObject=function(e,t){if(t[e]!==undefined){this.set(e,t[e],true)}};e.prototype.copyAll=function(e){for(var t=0,n=NK(e.combine());t<n.length;t++){var r=n[t];var i=e.getWithExplicit(r);this.setWithExplicit(r,i)}};return e}();function p7(e){return{explicit:true,value:e}}function v7(e){return{explicit:false,value:e}}function g7(e){return function(t,n,r,i){var a=e(t.value,n.value);if(a>0){return t}else if(a<0){return n}return m7(t,n,r,i)}}function m7(e,t,n,r){if(e.explicit&&t.explicit){K1(n2.mergeConflictingProperty(n,r,e.value,t.value))}return e}function y7(e,t,n,r,i){if(i===void 0){i=m7}if(e===undefined||e.value===undefined){return t}if(e.explicit&&!t.explicit){return e}else if(t.explicit&&!e.explicit){return t}else if(mK(e.value)===mK(t.value)){return e}else{return i(e,t,n,r)}}var b7=function(e){U(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t}(h7);function x7(e,t,n,r,i){if(i==="gradient"){return undefined}var a=q({},j8({},n,U1),p8(n));switch(n.mark){case _1:case A1:case O1:a.shape={value:"square"};break;case D1:case j1:a.shape={value:n.mark};break;case k1:case w1:case C1:case x1:break}var u=n.markDef,o=n.encoding;var f=u.filled;if(a.fill){if(r==="fill"||f&&r===_0){delete a.fill}else{if(a.fill["field"]){delete a.fill}else if(Object(dn["z"])(a.fill)){var c=O7(o.fill||o.color)||u.fill||f&&u.color;if(c){a.fill={value:c}}}}}if(a.stroke){if(r==="stroke"||!f&&r===_0){delete a.stroke}else{if(a.stroke["field"]){delete a.stroke}else if(Object(dn["z"])(a.stroke)){var l=O7(o.stroke||o.color)||u.stroke||!f&&u.color;if(l){a.stroke={value:l}}}}}if(a.fill&&a.fill["value"]!=="transparent"&&!a.stroke){a.stroke={value:"transparent"}}if(r!==b0){var s=O7(o.shape)||u.shape;if(s){a.shape={value:s}}}if(r!==S0){var d=k7(o.opacity)||u.opacity;if(d){a.opacity={value:d}}}a=q({},a,t);return NK(a).length>0?a:undefined}function _7(e,t,n,r,i){var a={};if(i==="gradient"){var u=k7(n.encoding.opacity)||n.markDef.opacity;if(u){a.opacity={value:u}}}a=q({},a,t);return NK(a).length>0?a:undefined}function w7(e,t,n,r,i){var a=n.legend(r);var u=n.config;var o={};if(x3(e)){var f=n.getScaleComponent(r).get("type")===t6.UTC;var c=I8("datum.value",e.timeUnit,a.format,u.legend.shortTimeLabels,u.timeFormat,f);t=q({},c?{text:{signal:c}}:{},t)}o=q({},o,t);return NK(o).length>0?o:undefined}function k7(e){return A7(e,function(e,t){return Math.max(e,t.value)})}function O7(e){return A7(e,function(e,t){return e!==undefined?e:t.value})}function A7(e,t){if(X2(e)){return(Object(dn["z"])(e.condition)?e.condition:[e.condition]).reduce(t,e.value)}else if(Q2(e)){return e.value}return undefined}function E7(e,t){var n=e.values;if(n){return w3(t,n)}return undefined}function M7(e,t,n){if(T0(t)&&(e==="quantitative"&&!g6(n)||e==="temporal"&&bK(["time","utc"],n))){return"gradient"}return undefined}function S7(e){if(i9(e)){e.component.legends=C7(e)}else{e.component.legends=F7(e)}}function C7(e){var t=e.encoding;return[_0,w0,k0,x0,b0,S0].reduce(function(n,r){var i=t[r];if(e.legend(r)&&e.getScaleComponent(r)&&!(Z2(i)&&(r===b0&&i.type===q2))){n[r]=j7(e,r)}return n},{})}function D7(e,t){var n;switch(t){case _0:var r=e.scaleName(_0);return e.markDef.filled?{fill:r}:{stroke:r};case w0:case k0:case x0:case b0:case S0:return n={},n[t]=e.scaleName(t),n}}function j7(e,t){var n=e.fieldDef(t);var r=e.legend(t);var i=new b7({},D7(e,t));K3.forEach(function(n){var a=N7(n,r,t,e);if(a!==undefined){var u=n==="values"?!!r.values:n==="title"&&a===e.fieldDef(t).title?true:a===r[n];if(u||e.config.legend[n]===undefined){i.set(n,a,u)}}});var a=r.encoding||{};var u=["labels","legend","title","symbols","gradient"].reduce(function(r,u){var o=Y8(a[u]||{},e);var f=z[u]?z[u](n,o,e,t,i.get("type")):o;if(f!==undefined&&NK(f).length>0){r[u]={update:f}}return r},{});if(NK(u).length>0){i.set("encode",u,!!r.encoding)}return i}function N7(e,t,n,r){var i=r.fieldDef(n);switch(e){case"format":return R8(i,t.format,r.config);case"title":var a=i.title!==undefined?i.title:t.title||(t.title===undefined?undefined:null);return z8(a,s3(i,r.config))||undefined;case"values":return E7(t,i);case"type":return z8(t.type,M7(i.type,n,r.getScaleComponent(n).get("type")))}return t[e]}function F7(e){var t=e.component,n=t.legends,r=t.resolve;var i=function(t){S7(t);NK(t.component.legends).forEach(function(i){r.legend[i]=d7(e.component.resolve,i);if(r.legend[i]==="shared"){n[i]=T7(n[i],t.component.legends[i]);if(!n[i]){r.legend[i]="independent";delete n[i]}}})};for(var a=0,u=e.children;a<u.length;a++){var o=u[a];i(o)}NK(n).forEach(function(t){for(var n=0,i=e.children;n<i.length;n++){var a=i[n];if(!a.component.legends[t]){continue}if(r.legend[t]==="shared"){delete a.component.legends[t]}}});return n}function T7(e,t){if(!e){return t.clone()}var n=e.getWithExplicit("orient");var r=t.getWithExplicit("orient");if(n.explicit&&r.explicit&&n.value!==r.value){return undefined}var i=false;var a=function(n){var r=y7(e.getWithExplicit(n),t.getWithExplicit(n),n,"legend",function(e,t){switch(n){case"title":return H8(e,t);case"type":i=true;return v7("symbol")}return m7(e,t,n,"legend")});e.setWithExplicit(n,r)};for(var u=0,o=e6;u<o.length;u++){var f=o[u];a(f)}if(i){if(((e.implicit||{}).encode||{}).gradient){BK(e.implicit,["encode","gradient"])}if(((e.explicit||{}).encode||{}).gradient){BK(e.explicit,["encode","gradient"])}}return e}function z7(e){var t=e.component.legends;var n={};for(var r=0,i=NK(t);r<i.length;r++){var a=i[r];var u=e.getScaleComponent(a);var o=mK(u.domains);if(n[o]){for(var f=0,c=n[o];f<c.length;f++){var l=c[f];var s=T7(l,t[a]);if(!s){n[o].push(t[a])}}}else{n[o]=[t[a].clone()]}}return OK(FK(n)).map(function(e){return e.combine()})}function R7(e){if(f9(e)||o9(e)||u9(e)){return P7(e)}else{return L7(e)}}function P7(e){return e.children.reduce(function(e,t){return e.concat(t.assembleProjections())},L7(e))}function L7(e){var t=e.component.projection;if(!t||t.merged){return[]}var n=t.combine();var r=n.name,i=W(n,["name"]);var a={signal:"["+t.size.map(function(e){return e.signal}).join(", ")+"]"};var u=t.data.reduce(function(t,n){var r=B5(n)?n.signal:"data('"+e.lookupDataSource(n)+"')";if(!bK(t,r)){t.push(r)}return t},[]);if(u.length<=0){throw new Error("Projection's fit didn't find any data sources")}return[q({name:r,size:a,fit:{signal:u.length>1?"["+u.join(", ")+"]":u[0]}},i)]}var B7=["type","clipAngle","clipExtent","center","rotate","precision","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];var I7=function(e){U(t,e);function t(t,n,r,i){var a=e.call(this,q({},n),{name:t})||this;a.specifiedProjection=n;a.size=r;a.data=i;a.merged=false;return a}return t}(h7);function U7(e){if(i9(e)){e.component.projection=q7(e)}else{e.component.projection=H7(e)}}function q7(e){var t=e.specifiedProjection,n=e.config,r=e.hasProjection;if(r){var i=[];[[v0,h0],[g0,p0]].forEach(function(t){if(e.channelHasField(t[0])||e.channelHasField(t[1])){i.push({signal:e.getName("geojson_"+i.length)})}});if(e.channelHasField(b0)&&e.fieldDef(b0).type===q2){i.push({signal:e.getName("geojson_"+i.length)})}if(i.length===0){i.push(e.requestDataName(P5))}return new I7(e.projectionName(true),q({},n.projection||{},t||{}),[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")],i)}return undefined}function W7(e,t){var n=kK(B7,function(n){if(!e.explicit.hasOwnProperty(n)&&!t.explicit.hasOwnProperty(n)){return true}if(e.explicit.hasOwnProperty(n)&&t.explicit.hasOwnProperty(n)&&mK(e.get(n))===mK(t.get(n))){return true}return false});var r=mK(e.size)===mK(t.size);if(r){if(n){return e}else if(mK(e.explicit)===mK({})){return t}else if(mK(t.explicit)===mK({})){return e}}return null}function H7(e){if(e.children.length===0){return undefined}var t;var n=kK(e.children,function(e){U7(e);var n=e.component.projection;if(!n){return true}else if(!t){t=n;return true}else{var r=W7(t,n);if(r){t=r}return!!r}});if(t&&n){var r=e.projectionName(true);var i=new I7(r,t.specifiedProjection,t.size,zK(t.data));e.children.forEach(function(e){if(e.component.projection){i.data=i.data.concat(e.component.projection.data);e.renameProjection(e.component.projection.get("name"),r);e.component.projection.merged=true}});return i}return undefined}function G7(e,t,n){if(n.bin){e[t3(n,{})]=true;e[t3(n,{binSuffix:"end"})]=true;if(G8(n,t)){e[t3(n,{binSuffix:"range"})]=true}}else{e[t3(n)]=true}return e}function Y7(e,t){for(var n in t){if(t.hasOwnProperty(n)){var r=t[n];for(var i in r){if(r.hasOwnProperty(i)){if(n in e){e[n][i]=r[i]}else{e[n]={op:r[i]}}}}}}}var $7=function(e){U(t,e);function t(t,n,r){var i=e.call(this,t)||this;i.dimensions=n;i.measures=r;return i}t.prototype.clone=function(){return new t(null,q({},this.dimensions),zK(this.measures))};t.makeFromEncoding=function(e,n){var r=false;n.forEachFieldDef(function(e){if(e.aggregate){r=true}});var i={};var a={};if(!r){return null}n.forEachFieldDef(function(e,t){var r=e.aggregate,u=e.field;if(r){if(r==="count"){i["*"]=i["*"]||{};i["*"]["count"]=t3(e)}else{i[u]=i[u]||{};i[u][r]=t3(e);if(d1(t)&&n.scaleDomain(t)==="unaggregated"){i[u]["min"]=t3({field:u,aggregate:"min"});i[u]["max"]=t3({field:u,aggregate:"max"})}}}else{G7(a,t,e)}});if(NK(a).length+NK(i).length===0){return null}return new t(e,a,i)};t.makeFromTransform=function(e,n){var r={};var i={};for(var a=0,u=n.aggregate;a<u.length;a++){var o=u[a];var f=o.op,c=o.field,l=o.as;if(f){if(f==="count"){i["*"]=i["*"]||{};i["*"]["count"]=l||t3(o)}else{i[c]=i[c]||{};i[c][f]=l||t3(o)}}}for(var s=0,d=n.groupby||[];s<d.length;s++){var o=d[s];r[o]=true}if(NK(r).length+NK(i).length===0){return null}return new t(e,r,i)};t.prototype.merge=function(e){if(!SK(this.dimensions,e.dimensions)){Y7(this.measures,e.measures);e.remove()}else{t2("different dimensions, cannot merge")}};t.prototype.addDimensions=function(e){var t=this;e.forEach(function(e){return t.dimensions[e]=true})};t.prototype.dependentFields=function(){var e={};NK(this.dimensions).forEach(function(t){return e[t]=true});NK(this.measures).forEach(function(t){return e[t]=true});return e};t.prototype.producedFields=function(){var e=this;var t={};NK(this.measures).forEach(function(n){NK(e.measures[n]).forEach(function(e){t[e+"_"+n]=true})});return t};t.prototype.assemble=function(){var e=[];var t=[];var n=[];for(var r=0,i=NK(this.measures);r<i.length;r++){var a=i[r];for(var u=0,o=NK(this.measures[a]);u<o.length;u++){var f=o[u];n.push(this.measures[a][f]);e.push(f);t.push(a)}}var c={type:"aggregate",groupby:NK(this.dimensions),ops:e,fields:t,as:n};return c};return t}($8);var V7=function(e){U(t,e);function t(t,n,r,i){var a=e.call(this,t)||this;a.model=n;a.name=r;a.data=i;for(var u=0,o=[y0,m0];u<o.length;u++){var f=o[u];var c=n.facet[f];if(c){var l=c.bin,s=c.sort;a[f]=q({name:n.getName(f+"_domain"),fields:[t3(c)].concat(l?[t3(c,{binSuffix:"end"})]:[])},e8(s)?{sortField:s}:Object(dn["z"])(s)?{sortIndexField:Z8(c,f)}:{})}}a.childModel=n.child;return a}Object.defineProperty(t.prototype,"fields",{get:function(){return(this.column&&this.column.fields||[]).concat(this.row&&this.row.fields||[])},enumerable:true,configurable:true});t.prototype.getSource=function(){return this.name};t.prototype.getChildIndependentFieldsWithStep=function(){var e={};for(var t=0,n=["x","y"];t<n.length;t++){var r=n[t];var i=this.childModel.component.scales[r];if(i&&!i.merged){var a=i.get("type");var u=i.get("range");if(v6(a)&&I5(u)){var o=A4(this.childModel,r);var f=O4(o);if(f){e[r]=f}else{K1("Unknown field for ${channel}.  Cannot calculate view size.")}}}}return e};t.prototype.assembleRowColumnData=function(e,t,n){var r=e==="row"?"y":"x";var i=[];var a=[];var u=[];if(n[r]){if(t){i.push("distinct_"+n[r]);a.push("max")}else{i.push(n[r]);a.push("distinct")}u.push("distinct_"+n[r])}var o=this[e],f=o.sortField,c=o.sortIndexField;if(f){var l=f.op,s=f.field;i.push(s);a.push(l);u.push(t3(f))}else if(c){i.push(c);a.push("max");u.push(c)}return{name:this[e].name,source:t||this.data,transform:[q({type:"aggregate",groupby:this[e].fields},i.length?{fields:i,ops:a,as:u}:{})]}};t.prototype.assemble=function(){var e=[];var t=null;var n=this.getChildIndependentFieldsWithStep();if(this.column&&this.row&&(n.x||n.y)){t="cross_"+this.column.name+"_"+this.row.name;var r=[].concat(n.x?[n.x]:[],n.y?[n.y]:[]);var i=r.map(function(){return"distinct"});e.push({name:t,source:this.data,transform:[{type:"aggregate",groupby:this.column.fields.concat(this.row.fields),fields:r,ops:i}]})}for(var a=0,u=[y0,m0];a<u.length;a++){var o=u[a];if(this[o]){e.push(this.assembleRowColumnData(o,t,n))}}return e};return t}($8);var X7=function(e){U(t,e);function t(t,n){var r=e.call(this,t)||this;r.fieldDefs=n;return r}t.prototype.clone=function(){return new t(null,q({},this.fieldDefs))};t.make=function(e,n){var r=n.config,i=n.mark;if(r.invalidValues!=="filter"){return null}var a=n.reduceFieldDef(function(e,t,r){var a=d1(r)&&n.getScaleComponent(r);if(a){var u=a.get("type");if(m6(u)&&!t.aggregate&&!T1(i)){e[t.field]=t}}return e},{});if(!NK(a).length){return null}return new t(e,a)};Object.defineProperty(t.prototype,"filter",{get:function(){return this.fieldDefs},enumerable:true,configurable:true});t.prototype.assemble=function(){var e=this;var t=NK(this.filter).reduce(function(t,n){var r=e.fieldDefs[n];var i=t3(r,{expr:"datum"});if(r!==null){t.push(i+" !== null");t.push("!isNaN("+i+")")}return t},[]);return t.length>0?{type:"filter",expr:t.join(" && ")}:null};return t}($8);function Z7(e,t){var n=UK(e);if(t==="number"){return"toNumber("+n+")"}else if(t==="boolean"){return"toBoolean("+n+")"}else if(t==="string"){return"toString("+n+")"}else if(t==="date"){return"toDate("+n+")"}else if(t==="flatten"){return n}else if(t.indexOf("date:")===0){var r=t.slice(5,t.length);return"timeParse("+n+","+r+")"}else if(t.indexOf("utc:")===0){var r=t.slice(4,t.length);return"utcParse("+n+","+r+")"}else{K1(n2.unrecognizedParse(t));return null}}var J7=function(e){U(t,e);function t(t,n){var r=e.call(this,t)||this;r._parse=n;return r}t.prototype.clone=function(){return new t(null,zK(this._parse))};t.makeExplicit=function(e,t,n){var r={};var i=t.data;if(i&&i.format&&i.format.parse){r=i.format.parse}return this.makeWithAncestors(e,r,{},n)};t.makeImplicitFromFilterTransform=function(e,t,n){var r={};hK(t.filter,function(e){if(_ee(e)){var t=null;if(pee(e)){t=e.equal}else if(bee(e)){t=e.range[0]}else if(xee(e)){t=(e.oneOf||e["in"])[0]}if(t){if(i2(t)){r[e.field]="date"}else if(Object(dn["D"])(t)){r[e.field]="number"}else if(Object(dn["G"])(t)){r[e.field]="string"}}if(e.timeUnit){r[e.field]="date"}}});if(NK(r).length===0){return null}return this.makeWithAncestors(e,{},r,n)};t.makeImplicitFromEncoding=function(e,t,n){var r={};if(i9(t)||a9(t)){t.forEachFieldDef(function(e){if(x3(e)){r[e.field]="date"}else if(b3(e)){if(!ZK(e.aggregate)){r[e.field]="number"}}else if(GK(e.field)>1){if(!(e.field in r)){r[e.field]="flatten"}}else if(K2(e)&&e8(e.sort)&&GK(e.sort.field)>1){if(!(e.sort.field in r)){r[e.sort.field]="flatten"}}})}return this.makeWithAncestors(e,{},r,n)};t.makeWithAncestors=function(e,n,r,i){for(var a=0,u=NK(r);a<u.length;a++){var o=u[a];var f=i.getWithExplicit(o);if(f.value!==undefined){if(f.explicit||f.value===r[o]||f.value==="derived"||r[o]==="flatten"){delete r[o]}else{K1(n2.differentParse(o,r[o],f.value))}}}for(var c=0,l=NK(n);c<l.length;c++){var o=l[c];var f=i.get(o);if(f!==undefined){if(f===n[o]){delete n[o]}else{K1(n2.differentParse(o,n[o],f))}}}var s=new h7(n,r);i.copyAll(s);var d={};for(var h=0,p=NK(s.combine());h<p.length;h++){var v=p[h];var g=s.get(v);if(g!==null){d[v]=g}}if(NK(d).length===0||i.parseNothing){return null}return new t(e,d)};Object.defineProperty(t.prototype,"parse",{get:function(){return this._parse},enumerable:true,configurable:true});t.prototype.merge=function(e){this._parse=q({},this._parse,e.parse);e.remove()};t.prototype.assembleFormatParse=function(){var e={};for(var t=0,n=NK(this._parse);t<n.length;t++){var r=n[t];var i=this._parse[r];if(GK(r)===1){e[r]=i}}return e};t.prototype.producedFields=function(){return Object(dn["ab"])(NK(this._parse))};t.prototype.dependentFields=function(){return Object(dn["ab"])(NK(this._parse))};t.prototype.assembleTransforms=function(e){var t=this;if(e===void 0){e=false}return NK(this._parse).filter(function(t){return e?GK(t)>1:true}).map(function(e){var n=Z7(e,t._parse[e]);if(!n){return null}var r={type:"formula",expr:n,as:HK(e)};return r}).filter(function(e){return e!==null})};return t}($8);var Q7=function(e){U(t,e);function t(t){var n=e.call(this,null)||this;t=t||{name:"source"};if(z5(t)){n._data={values:t.values}}else if(T5(t)){n._data={url:t.url};if(!t.format){t.format={}}if(!t.format||!t.format.type){var r=/(?:\.([^.]+))?$/.exec(t.url)[1];if(!bK(["json","csv","tsv","dsv","topojson"],r)){r="json"}t.format.type=r}}else if(R5(t)){n._data={}}if(t.name){n._name=t.name}if(t.format){var i=t.format,a=i.parse,u=a===void 0?null:a,o=W(i,["parse"]);n._data.format=o}return n}Object.defineProperty(t.prototype,"data",{get:function(){return this._data},enumerable:true,configurable:true});t.prototype.hasName=function(){return!!this._name};Object.defineProperty(t.prototype,"dataName",{get:function(){return this._name},set:function(e){this._name=e},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"parent",{set:function(e){throw new Error("Source nodes have to be roots.")},enumerable:true,configurable:true});t.prototype.remove=function(){throw new Error("Source nodes are roots and cannot be removed.")};t.prototype.hash=function(){if(z5(this._data)){if(!this._hash){this._hash=yK(this._data)}return this._hash}else if(T5(this._data)){return yK([this._data.url,this._data.format])}else{return this._name}};t.prototype.assemble=function(){return q({name:this._name},this._data,{transform:[]})};return t}($8);var K7=function(e){U(t,e);function t(t,n){var r=e.call(this,t)||this;r.formula=n;return r}t.prototype.clone=function(){return new t(null,zK(this.formula))};t.makeFromEncoding=function(e,n){var r=n.reduceFieldDef(function(e,t){if(t.timeUnit){var n=t3(t);e[n]={as:n,timeUnit:t.timeUnit,field:t.field}}return e},{});if(NK(r).length===0){return null}return new t(e,r)};t.makeFromTransform=function(e,n){var r;return new t(e,(r={},r[n.field]={as:n.as,timeUnit:n.timeUnit,field:n.field},r))};t.prototype.merge=function(e){this.formula=q({},this.formula,e.formula);e.remove()};t.prototype.producedFields=function(){var e={};FK(this.formula).forEach(function(t){e[t.as]=true});return e};t.prototype.dependentFields=function(){var e={};FK(this.formula).forEach(function(t){e[t.field]=true});return e};t.prototype.assemble=function(){return FK(this.formula).map(function(e){return{type:"formula",as:e.as,expr:N2(e.timeUnit,e.field)}})};return t}($8);function e4(e){function t(n){if(n instanceof Q7){return}var r=n.parent;if(e(n)){t(r)}}return t}function t4(e){var t=e.parent;if(e instanceof J7){if(t instanceof Q7){return false}if(t.numChildren()>1){return true}if(t instanceof J7){t.merge(e)}else{if(CK(t.producedFields(),e.dependentFields())){return true}e.swapWithParent()}}return true}function n4(e){if(e instanceof V8||e.numChildren()>0||e instanceof V7){return false}else{e.remove()}return true}function r4(e){var t={};return e4(function(e){if(e instanceof K7){var n=e.producedFields();var r=NK(n).every(function(e){return!!t[e]});if(r){e.remove()}else{t=q({},t,n)}}return true})(e)}function i4(e){return e.stack.stackBy.reduce(function(e,t){var n=t.fieldDef;var r=t3(n);if(r){e.push(r)}return e},[])}function a4(e){return Object(dn["z"])(e)&&e.every(function(e){return Object(dn["G"])(e)})&&e.length>1}var u4=function(e){U(t,e);function t(t,n){var r=e.call(this,t)||this;r._stack=n;return r}t.prototype.clone=function(){return new t(null,zK(this._stack))};t.makeFromTransform=function(e,n){var r=n.stack,i=n.groupby,a=n.as,u=n.offset,o=u===void 0?"zero":u;var f=[];var c=[];if(n.sort!==undefined){for(var l=0,s=n.sort;l<s.length;l++){var d=s[l];f.push(d.field);c.push(d.order===undefined?"ascending":d.order)}}var h={field:f,order:c};var p;if(a4(a)){p=a}else if(Object(dn["G"])(a)){p=[a,a+"_end"]}else{p=[n.stack+"_start",n.stack+"_end"]}return new t(e,{stackField:r,groupby:i,offset:o,sort:h,facetby:[],as:p})};t.makeFromEncoding=function(e,n){var r=n.stack;if(!r){return null}var i;if(r.groupbyChannel){i=n.fieldDef(r.groupbyChannel)}var a=i4(n);var u=n.encoding.order;var o;if(Object(dn["z"])(u)||Z2(u)){o=U8(u)}else{o=a.reduce(function(e,t){e.field.push(t);e.order.push("descending");return e},{field:[],order:[]})}var f=n.vgField(r.fieldChannel);return new t(e,{dimensionFieldDef:i,stackField:f,facetby:[],stackby:a,sort:o,offset:r.offset,impute:r.impute,as:[f+"_start",f+"_end"]})};Object.defineProperty(t.prototype,"stack",{get:function(){return this._stack},enumerable:true,configurable:true});t.prototype.addDimensions=function(e){this._stack.facetby=this._stack.facetby.concat(e)};t.prototype.dependentFields=function(){var e={};e[this._stack.stackField]=true;this.getGroupbyFields().forEach(function(t){return e[t]=true});this._stack.facetby.forEach(function(t){return e[t]=true});var t=this._stack.sort.field;Object(dn["z"])(t)?t.forEach(function(t){return e[t]=true}):e[t]=true;return e};t.prototype.producedFields=function(){return this._stack.as.reduce(function(e,t){e[t]=true;return e},{})};t.prototype.getGroupbyFields=function(){var e=this._stack,t=e.dimensionFieldDef,n=e.impute,r=e.groupby;if(t){if(t.bin){if(n){return[t3(t,{binSuffix:"mid"})]}return[t3(t,{}),t3(t,{binSuffix:"end"})]}return[t3(t)]}return r||[]};t.prototype.assemble=function(){var e=[];var t=this._stack,n=t.facetby,r=t.dimensionFieldDef,i=t.stackField,a=t.stackby,u=t.sort,o=t.offset,f=t.impute,c=t.as;if(f&&r){var l=r?t3(r,{binSuffix:"mid"}):undefined;if(r.bin){e.push({type:"formula",expr:"("+t3(r,{expr:"datum"})+"+"+t3(r,{expr:"datum",binSuffix:"end"})+")/2",as:l})}e.push({type:"impute",field:i,groupby:a,key:l,method:"value",value:0})}e.push({type:"stack",groupby:this.getGroupbyFields().concat(n),field:i,sort:u,as:c,offset:o});return e};return t}($8);var o4="scale_";function f4(e){function t(n){if(!(n instanceof V7)){var r=n.clone();if(r instanceof V8){var i=o4+r.getSource();r.setSource(i);e.model.component.data.outputNodes[i]=r}else if(r instanceof $7||r instanceof u4){r.addDimensions(e.fields)}OK(n.children.map(t)).forEach(function(e){return e.parent=r});return[r]}return OK(n.children.map(t))}return t}function c4(e){if(e instanceof V7){if(e.numChildren()===1&&!(e.children[0]instanceof V8)){var t=e.children[0];if(t instanceof $7||t instanceof u4){t.addDimensions(e.fields)}t.swapWithParent();c4(e)}else{l4(e.model.component.data.main);var n=OK(e.children.map(f4(e)));n.forEach(function(t){return t.parent=e.model.component.data.main})}}else{e.children.forEach(c4)}}function l4(e){if(e instanceof V8&&e.type===P5){if(e.numChildren()===1){var t=e.children[0];if(!(t instanceof V7)){t.swapWithParent();l4(e)}}}}function s4(e){if(e instanceof X7&&kK(FK(e.filter),function(e){return e===null})){e.remove()}if(e instanceof V8&&!e.isRequired()){e.remove()}e.children.forEach(s4)}function d4(e){var t=[];function n(e){if(e.numChildren()===0){t.push(e)}else{e.children.forEach(n)}}e.forEach(n);return t}function h4(e){var t=FK(e.sources);t.forEach(s4);t=t.filter(function(e){return e.numChildren()>0});d4(t).forEach(e4(n4));t=t.filter(function(e){return e.numChildren()>0});d4(t).forEach(e4(t4));d4(t).forEach(r4);t.forEach(c4);NK(e.sources).forEach(function(t){if(e.sources[t].numChildren()===0){delete e.sources[t]}})}function p4(e){if(i9(e)){v4(e)}else{g4(e)}}function v4(e){var t=e.specifiedScales;var n=e.component.scales;NK(n).forEach(function(r){var i=t[r];var a=i?i.domain:undefined;var u=y4(e,r);var o=n[r];o.domains=u;if(_6(a)){o.set("domainRaw",{signal:Z9+yK(a)},true)}if(e.component.data.isFaceted){var f=e;while(!a9(f)&&f.parent){f=f.parent}var c=f.component.resolve.scale[r];if(c==="shared"){for(var l=0,s=u;l<s.length;l++){var d=s[l];if(W5(d)){d.data=o4+d.data.replace(o4,"")}}}}})}function g4(e){for(var t=0,n=e.children;t<n.length;t++){var r=n[t];p4(r)}var i=e.component.scales;NK(i).forEach(function(t){var n;var r=null;for(var a=0,u=e.children;a<u.length;a++){var o=u[a];var f=o.component.scales[t];if(f){if(n===undefined){n=f.domains}else{n=n.concat(f.domains)}var c=f.get("domainRaw");if(r&&c&&r.signal!==c.signal){K1("The same selection must be used to override scale domains in a layered view.")}r=c}}i[t].domains=n;if(r){i[t].set("domainRaw",r,true)}})}function m4(e,t,n,r){if(e==="unaggregated"){var i=w4(t,n),a=i.valid,u=i.reason;if(!a){K1(u);return undefined}}else if(e===undefined&&r.useUnaggregatedDomain){var a=w4(t,n).valid;if(a){return"unaggregated"}}return e}function y4(e,t){var n=e.getScaleComponent(t).get("type");var r=m4(e.scaleDomain(t),e.fieldDef(t),n,e.config.scale);if(r!==e.scaleDomain(t)){e.specifiedScales[t]=q({},e.specifiedScales[t],{domain:r})}if(t==="x"&&e.channelHasField("x2")){if(e.channelHasField("x")){return x4(n,r,e,"x").concat(x4(n,r,e,"x2"))}else{return x4(n,r,e,"x2")}}else if(t==="y"&&e.channelHasField("y2")){if(e.channelHasField("y")){return x4(n,r,e,"y").concat(x4(n,r,e,"y2"))}else{return x4(n,r,e,"y2")}}return x4(n,r,e,t)}function b4(e,t,n){return e.map(function(e){var r=_3(e,{timeUnit:n,type:t});return{signal:"{data: "+r+"}"}})}function x4(e,t,n,r){var i=n.fieldDef(r);if(t&&t!=="unaggregated"&&!_6(t)){var a=i.type,u=i.timeUnit;if(a==="temporal"||u){return b4(t,a,u)}return[t]}var o=n.stack;if(o&&r===o.fieldChannel){if(o.offset==="normalize"){return[[0,1]]}var f=n.requestDataName(P5);return[{data:f,field:n.vgField(r,{suffix:"start"})},{data:f,field:n.vgField(r,{suffix:"end"})}]}var c=d1(r)?_4(n,r,e):undefined;if(t==="unaggregated"){var f=n.requestDataName(P5);var l=i.field;return[{data:f,field:t3({field:l,aggregate:"min"})},{data:f,field:t3({field:l,aggregate:"max"})}]}else if(i.bin){if(g6(e)){var s=n.getName(g1(i.bin)+"_"+i.field+"_bins");return[{signal:"sequence("+s+".start, "+s+".stop + "+s+".step, "+s+".step)"}]}if(v6(e)){return[{data:RK(c)?n.requestDataName(P5):n.requestDataName(L5),field:n.vgField(r,G8(i,r)?{binSuffix:"range"}:{}),sort:c===true||!e8(c)?{field:n.vgField(r,{}),op:"min"}:c}]}else{if(r==="x"||r==="y"){if(m1(i.bin)&&i.bin.extent){return[i.bin.extent]}var f=n.requestDataName(P5);return[{data:f,field:n.vgField(r,{})},{data:f,field:n.vgField(r,{binSuffix:"end"})}]}else{return[{data:n.requestDataName(P5),field:n.vgField(r,{})}]}}}else if(c){return[{data:RK(c)?n.requestDataName(P5):n.requestDataName(L5),field:n.vgField(r),sort:c}]}else{return[{data:n.requestDataName(P5),field:n.vgField(r)}]}}function _4(e,t,n){if(!v6(n)){return undefined}var r=e.fieldDef(t);var i=r.sort;if(t8(i)){return{op:"min",field:Z8(r,t),order:"ascending"}}if(e8(i)){return q({},i,i.field?{field:WK(i.field)}:{})}if(i==="descending"){return{op:"min",field:e.vgField(t),order:"descending"}}if(bK(["ascending",undefined],i)){return true}return undefined}function w4(e,t){if(!e.aggregate){return{valid:false,reason:n2.unaggregateDomainHasNoEffectForRawField(e)}}if(!KK[e.aggregate]){return{valid:false,reason:n2.unaggregateDomainWithNonSharedDomainOp(e.aggregate)}}if(e.type==="quantitative"){if(t==="log"){return{valid:false,reason:n2.unaggregatedDomainWithLogScale(e)}}}return{valid:true}}function k4(e){var t=MK(e.map(function(e){if(W5(e)){var t=e.sort,n=W(e,["sort"]);return n}return e}),yK);var n=MK(e.map(function(e){if(W5(e)){var t=e.sort;if(t!==undefined&&!RK(t)){if(t.op==="count"){delete t.field}if(t.order==="ascending"){delete t.order}}return t}return undefined}).filter(function(e){return e!==undefined}),yK);if(t.length===1){var r=e[0];if(W5(r)&&n.length>0){var i=n[0];if(n.length>1){K1(n2.MORE_THAN_ONE_SORT);i=true}return q({},r,{sort:i})}return r}var a=MK(n.map(function(e){if(e===true){return e}if(e.op==="count"){return e}K1(n2.domainSortDropped(e));return true}),yK);var u=undefined;if(a.length===1){u=a[0]}else if(a.length>1){K1(n2.MORE_THAN_ONE_SORT);u=true}var o=MK(e.map(function(e){if(W5(e)){return e.data}return null}),function(e){return e});if(o.length===1&&o[0]!==null){var r=q({data:o[0],fields:t.map(function(e){return e.field})},u?{sort:u}:{});return r}return q({fields:t},u?{sort:u}:{})}function O4(e){if(W5(e)&&Object(dn["G"])(e.field)){return e.field}else if(U5(e)){var t=void 0;for(var n=0,r=e.fields;n<r.length;n++){var i=r[n];if(W5(i)&&Object(dn["G"])(i.field)){if(!t){t=i.field}else if(t!==i.field){K1("Detected faceted independent scales that union domain of multiple fields from different data sources.  We will use the first field.  The result view size may be incorrect.");return t}}}K1("Detected faceted independent scales that union domain of identical fields from different source detected.  We will assume that this is the same field from a different fork of the same data source.  However, if this is not case, the result view size maybe incorrect.");return t}else if(q5(e)){K1("Detected faceted independent scales that union domain of multiple fields from the same data source.  We will use the first field.  The result view size may be incorrect.");var t=e.fields[0];return Object(dn["G"])(t)?t:undefined}return undefined}function A4(e,t){var n=e.component.scales[t];var r=n.domains.map(function(t){if(W5(t)){t.data=e.lookupDataSource(t.data)}return t});return k4(r)}function E4(e){if(f9(e)||o9(e)||u9(e)){return e.children.reduce(function(e,t){return e.concat(E4(t))},M4(e))}else{return M4(e)}}function M4(e){return NK(e.component.scales).reduce(function(t,n){var r=e.component.scales[n];if(r.merged){return t}var i=r.combine();var a=i.domainRaw,u=i.range;var o=i.name,f=i.type,c=i.domainRaw,l=i.range,s=W(i,["name","type","domainRaw","range"]);u=S4(u,o,e,n);if(a&&iee(a)){a=aee(e,a)}t.push(q({name:o,type:f,domain:A4(e,n)},a?{domainRaw:a}:{},{range:u},s));return t},[])}function S4(e,t,n,r){if(r==="x"||r==="y"){if(I5(e)){return{step:{signal:t+"_step"}}}else if(Object(dn["z"])(e)&&e.length===2){var i=e[0];var a=e[1];if(i===0&&B5(a)){return[0,{signal:n.getSizeName(a.signal)}]}else if(B5(i)&&a===0){return[{signal:n.getSizeName(i.signal)},0]}}}return e}var C4=function(e){U(t,e);function t(t,n){var r=e.call(this,{},{name:t})||this;r.merged=false;r.domains=[];r.setWithExplicit("type",n);return r}return t}(h7);var D4=["range","rangeStep","scheme"];function j4(e){if(i9(e)){N4(e)}else{W4(e,"range")}}function N4(e){var t=e.component.scales;s1.forEach(function(n){var r=t[n];if(!r){return}var i=e.getScaleComponent(n);var a=e.specifiedScales[n];var u=e.fieldDef(n);var o=n==="x"?"width":n==="y"?"height":undefined;var f=o?!!e.component.layoutSize.get(o):undefined;var c=i.get("type");var l=bK(["point","band"],c)||!!a.rangeStep;if(o&&e.fit&&!f&&l){K1(n2.CANNOT_FIX_RANGE_STEP_WITH_FIT);f=true}var s=F4(e);var d=T4(n,c,u.type,a,e.config,r.get("zero"),e.mark,f,e.getName(o),s);r.setWithExplicit("range",d)})}function F4(e){var t=[];var n=e.getScaleComponent("x");var r=n&&n.get("range");if(r&&I5(r)&&Object(dn["D"])(r.step)){t.push(r.step)}var i=e.getScaleComponent("y");var a=i&&i.get("range");if(a&&I5(a)&&Object(dn["D"])(a.step)){t.push(a.step)}return t}function T4(e,t,n,r,i,a,u,o,f,c){var l=o||r.rangeStep===null;for(var s=0,d=D4;s<d.length;s++){var h=d[s];if(r[h]!==undefined){var p=N6(t,h);var v=F6(e,h);if(!p){K1(n2.scalePropertyNotWorkWithScaleType(t,h,e))}else if(v){K1(v)}else{switch(h){case"range":return p7(r[h]);case"scheme":return p7(z4(r[h]));case"rangeStep":var g=r[h];if(g!==null){if(!o){return p7({step:g})}else{K1(n2.rangeStepDropped(e))}}}}}}return v7(R4(e,t,n,i,a,u,f,c,l))}function z4(e){if(x6(e)){var t={scheme:e.name};if(e.count){t.count=e.count}if(e.extent){t.extent=e.extent}return t}return{scheme:e}}function R4(e,t,n,r,i,a,u,o,f){switch(e){case c0:case l0:if(bK(["point","band"],t)&&!f){if(e===c0&&a==="text"){if(r.scale.textXRangeStep){return{step:r.scale.textXRangeStep}}}else{if(r.scale.rangeStep){return{step:r.scale.rangeStep}}}}if(e===l0&&m6(t)){return[{signal:u},0]}else{return[0,{signal:u}]}case x0:var c=P4(a,i,r);var l=L4(a,o,r);return[c,l];case b0:return"symbol";case _0:case w0:case k0:if(t==="ordinal"){return n==="nominal"?"category":"ordinal"}return a==="rect"||a==="geoshape"?"heatmap":"ramp";case S0:return[r.scale.minOpacity,r.scale.maxOpacity]}throw new Error("Scale range undefined for channel "+e)}function P4(e,t,n){if(t){return 0}switch(e){case"bar":case"tick":return n.scale.minBandSize;case"line":case"trail":case"rule":return n.scale.minStrokeWidth;case"text":return n.scale.minFontSize;case"point":case"square":case"circle":return n.scale.minSize}throw new Error(n2.incompatibleChannel("size",e))}function L4(e,t,n){var r=n.scale;switch(e){case"bar":case"tick":if(n.scale.maxBandSize!==undefined){return n.scale.maxBandSize}return B4(t,n.scale)-1;case"line":case"trail":case"rule":return n.scale.maxStrokeWidth;case"text":return n.scale.maxFontSize;case"point":case"square":case"circle":if(n.scale.maxSize){return n.scale.maxSize}var i=B4(t,r);return(i-2)*(i-2)}throw new Error(n2.incompatibleChannel("size",e))}function B4(e,t){if(e.length>0){return Math.min.apply(null,e)}if(t.rangeStep){return t.rangeStep}return 21}function I4(e,t){if(i9(e)){U4(e,t)}else{W4(e,t)}}function U4(e,t){var n=e.component.scales;NK(n).forEach(function(r){var i=e.specifiedScales[r];var a=n[r];var u=e.getScaleComponent(r);var o=e.fieldDef(r);var f=e.config;var c=i[t];var l=u.get("type");var s=N6(l,t);var d=F6(r,t);if(c!==undefined){if(!s){K1(n2.scalePropertyNotWorkWithScaleType(l,t,r))}else if(d){K1(d)}}if(s&&d===undefined){if(c!==undefined){a.copyKeyFromObject(t,i)}else{var h=q4(t,r,o,u.get("type"),u.get("padding"),u.get("paddingInner"),i.domain,e.markDef,f);if(h!==undefined){a.set(t,h,false)}}}})}function q4(e,t,n,r,i,a,u,o,f){var c=f.scale;switch(e){case"nice":return H4(r,t,n);case"padding":return G4(t,r,c,n,o,f.bar);case"paddingInner":return Y4(i,t,c);case"paddingOuter":return $4(i,t,r,a,c);case"reverse":return V4(r,n.sort);case"zero":return X4(t,n,u,o)}return c[e]}function W4(e,t){var n=e.component.scales;for(var r=0,i=e.children;r<i.length;r++){var a=i[r];if(t==="range"){j4(a)}else{I4(a,t)}}NK(n).forEach(function(r){var i;for(var a=0,u=e.children;a<u.length;a++){var o=u[a];var f=o.component.scales[r];if(f){var c=f.getWithExplicit(t);i=y7(i,c,t,"scale",g7(function(e,n){switch(t){case"range":if(e.step&&n.step){return e.step-n.step}return 0}return 0}))}}n[r].setWithExplicit(t,i)})}function H4(e,t,n){if(n.bin||bK([t6.TIME,t6.UTC],e)){return undefined}return bK([c0,l0],t)}function G4(e,t,n,r,i,a){if(bK([c0,l0],e)){if(y6(t)){if(n.continuousPadding!==undefined){return n.continuousPadding}var u=i.type,o=i.orient;if(u==="bar"&&!r.bin){if(o==="vertical"&&e==="x"||o==="horizontal"&&e==="y"){return a.continuousBandSize}}}if(t===t6.POINT){return n.pointPadding}}return undefined}function Y4(e,t,n){if(e!==undefined){return undefined}if(bK([c0,l0],t)){return n.bandPaddingInner}return undefined}function $4(e,t,n,r,i){if(e!==undefined){return undefined}if(bK([c0,l0],t)){if(n===t6.BAND){if(i.bandPaddingOuter!==undefined){return i.bandPaddingOuter}return r/2}}return undefined}function V4(e,t){if(m6(e)&&t==="descending"){return true}return undefined}function X4(e,t,n,r){var i=!!n&&n!=="unaggregated";if(i){return false}if(e==="size"&&t.type==="quantitative"){return true}if(!t.bin&&bK([c0,l0],e)){var a=r.orient,u=r.type;if(bK(["bar","area","line","trail"],u)){if(a==="horizontal"&&e==="y"||a==="vertical"&&e==="x"){return false}}return true}return false}function Z4(e,t,n,r,i){var a=J4(t,n,r,i);if(!d1(t)){return null}if(e!==undefined){if(!z6(t,e)){K1(n2.scaleTypeNotWorkWithChannel(t,e,a));return a}if(!T6(e,n.type,n.bin)){K1(n2.scaleTypeNotWorkWithFieldDef(e,a));return a}return e}return a}function J4(e,t,n,r){switch(t.type){case"nominal":case"ordinal":if(T0(e)||v1(e)==="discrete"){if(e==="shape"&&t.type==="ordinal"){K1(n2.discreteChannelCannotEncode(e,"ordinal"))}return"ordinal"}if(bK(["x","y"],e)){if(bK(["rect","bar","rule"],n)){return"band"}if(n==="bar"){return"band"}}return"point";case"temporal":if(T0(e)){return"sequential"}else if(v1(e)==="discrete"){K1(n2.discreteChannelCannotEncode(e,"temporal"));return"ordinal"}return"time";case"quantitative":if(T0(e)){if(t.bin){return"bin-ordinal"}return"sequential"}else if(v1(e)==="discrete"){K1(n2.discreteChannelCannotEncode(e,"quantitative"));return"ordinal"}if(t.bin&&e!=="x"&&e!=="y"){return"bin-linear"}return"linear";case"latitude":case"longitude":case"geojson":return undefined}throw new Error(n2.invalidFieldType(t.type))}function Q4(e){K4(e);p4(e);for(var t=0,n=D6;t<n.length;t++){var r=n[t];I4(e,r)}j4(e)}function K4(e){if(i9(e)){e.component.scales=e9(e)}else{e.component.scales=n9(e)}}function e9(e){var t=e.encoding,n=e.config,r=e.mark;return s1.reduce(function(i,a){var u;var o=undefined;var f=t[a];if(Z2(f)&&r===C1&&a===b0&&f.type===q2){return i}if(Z2(f)){u=f;o=f.scale}else if(V2(f)){u=f.condition;o=f.condition["scale"]}else if(a===c0){u=h3(t.x2)}else if(a===l0){u=h3(t.y2)}if(u&&o!==null&&o!==false){o=o||{};var c=o.type;var l=Z4(o.type,a,u,r,n.scale);i[a]=new C4(e.scaleName(a+"",true),{value:l,explicit:c===l})}return i},{})}var t9=g7(function(e,t){return u6(e)-u6(t)});function n9(e){var t=e.component.scales={};var n={};var r=e.component.resolve;var i=function(t){K4(t);NK(t.component.scales).forEach(function(i){r.scale[i]=r.scale[i]||s7(i,e);if(r.scale[i]==="shared"){var a=n[i];var u=t.component.scales[i].getWithExplicit("type");if(a){if(i6(a.value,u.value)){n[i]=y7(a,u,"type","scale",t9)}else{r.scale[i]="independent";delete n[i]}}else{n[i]=u}}})};for(var a=0,u=e.children;a<u.length;a++){var o=u[a];i(o)}NK(n).forEach(function(r){var i=e.scaleName(r,true);var a=n[r];t[r]=new C4(i,a);for(var u=0,o=e.children;u<o.length;u++){var f=o[u];var c=f.component.scales[r];if(c){f.renameScale(c.get("name"),i);c.merged=true}}});return t}var r9=function(){function e(){this.nameMap={}}e.prototype.rename=function(e,t){this.nameMap[e]=t};e.prototype.has=function(e){return this.nameMap[e]!==undefined};e.prototype.get=function(e){while(this.nameMap[e]&&e!==this.nameMap[e]){e=this.nameMap[e]}return e};return e}();function i9(e){return e&&e.type==="unit"}function a9(e){return e&&e.type==="facet"}function u9(e){return e&&e.type==="repeat"}function o9(e){return e&&e.type==="concat"}function f9(e){return e&&e.type==="layer"}var c9=function(){function e(e,t,n,r,i,a){var u=this;this.children=[];this.correctDataNames=function(e){if(e.from&&e.from.data){e.from.data=u.lookupDataSource(e.from.data)}if(e.from&&e.from.facet&&e.from.facet.data){e.from.facet.data=u.lookupDataSource(e.from.facet.data)}return e};this.parent=t;this.config=r;this.repeater=i;this.name=e.name||n;this.title=Object(dn["G"])(e.title)?{text:e.title}:e.title;this.scaleNameMap=t?t.scaleNameMap:new r9;this.projectionNameMap=t?t.projectionNameMap:new r9;this.layoutSizeNameMap=t?t.layoutSizeNameMap:new r9;this.data=e.data;this.description=e.description;this.transforms=zee(e.transform||[]);this.layout=r5(e)||i5(e)?undefined:C5(e);this.component={data:{sources:t?t.component.data.sources:{},outputNodes:t?t.component.data.outputNodes:{},outputNodeRefCounts:t?t.component.data.outputNodeRefCounts:{},isFaceted:n5(e)||t&&t.component.data.isFaceted&&!e.data},layoutSize:new h7,layoutHeaders:{row:{},column:{}},mark:null,resolve:q({scale:{},axis:{},legend:{}},a||{}),selection:null,scales:null,projection:null,axes:{},legends:{}}}Object.defineProperty(e.prototype,"width",{get:function(){return this.getSizeSignalRef("width")},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"height",{get:function(){return this.getSizeSignalRef("height")},enumerable:true,configurable:true});e.prototype.initSize=function(e){var t=e.width,n=e.height;if(t){this.component.layoutSize.set("width",t,true)}if(n){this.component.layoutSize.set("height",n,true)}};e.prototype.parse=function(){this.parseScale();this.parseLayoutSize();this.renameTopLevelLayoutSize();this.parseSelection();this.parseProjection();this.parseData();this.parseAxisAndHeader();this.parseLegend();this.parseMarkGroup()};e.prototype.parseScale=function(){Q4(this)};e.prototype.parseProjection=function(){U7(this)};e.prototype.renameTopLevelLayoutSize=function(){if(this.getName("width")!=="width"){this.renameLayoutSize(this.getName("width"),"width")}if(this.getName("height")!=="height"){this.renameLayoutSize(this.getName("height"),"height")}};e.prototype.parseLegend=function(){S7(this)};e.prototype.assembleGroupStyle=function(){if(this.type==="unit"||this.type==="layer"){return"cell"}return undefined};e.prototype.assembleLayoutSize=function(){if(this.type==="unit"||this.type==="layer"){return{width:this.getSizeSignalRef("width"),height:this.getSizeSignalRef("height")}}return undefined};e.prototype.assembleLayout=function(){if(!this.layout){return undefined}var e=this.layout,t=e.align,n=e.bounds,r=e.center,i=e.spacing,a=i===void 0?{}:i;return q({padding:Object(dn["D"])(a)?a:{row:a.row||10,column:a.column||10}},this.assembleDefaultLayout(),t?{align:t}:{},n?{bounds:n}:{},r?{center:r}:{})};e.prototype.assembleDefaultLayout=function(){return{}};e.prototype.assembleHeaderMarks=function(){var e=this.component.layoutHeaders;var t=[];for(var n=0,r=J8;n<r.length;n++){var i=r[n];if(e[i].title){t.push(e7(this,i))}}for(var a=0,u=J8;a<u.length;a++){var i=u[a];t=t.concat(t7(this,i))}return t};e.prototype.assembleAxes=function(){return X5(this.component.axes,this.config)};e.prototype.assembleLegends=function(){return z7(this)};e.prototype.assembleProjections=function(){return R7(this)};e.prototype.assembleTitle=function(){var e=q({},U6(this.config.title).nonMark,this.title);if(e.text){if(!bK(["unit","layer"],this.type)){if(e.anchor&&e.anchor!=="start"){K1(n2.cannotSetTitleAnchor(this.type))}e.anchor="start"}return NK(e).length>0?e:undefined}return undefined};e.prototype.assembleGroup=function(e){if(e===void 0){e=[]}var t={};e=e.concat(this.assembleSelectionSignals());if(e.length>0){t.signals=e}var n=this.assembleLayout();if(n){t.layout=n}t.marks=[].concat(this.assembleHeaderMarks(),this.assembleMarks());var r=!this.parent||a9(this.parent)?E4(this):[];if(r.length>0){t.scales=r}var i=this.assembleAxes();if(i.length>0){t.axes=i}var a=this.assembleLegends();if(a.length>0){t.legends=a}return t};e.prototype.hasDescendantWithFieldOnChannel=function(e){for(var t=0,n=this.children;t<n.length;t++){var r=n[t];if(i9(r)){if(r.channelHasField(e)){return true}}else{if(r.hasDescendantWithFieldOnChannel(e)){return true}}}return false};e.prototype.getName=function(e){return PK((this.name?this.name+"_":"")+e)};e.prototype.requestDataName=function(e){var t=this.getName(e);var n=this.component.data.outputNodeRefCounts;n[t]=(n[t]||0)+1;return t};e.prototype.getSizeSignalRef=function(e){if(a9(this.parent)){var t=e==="width"?"x":"y";var n=this.component.scales[t];if(n&&!n.merged){var r=n.get("type");var i=n.get("range");if(v6(r)&&I5(i)){var a=n.get("name");var u=A4(this,t);var o=O4(u);if(o){var f=t3({aggregate:"distinct",field:o},{expr:"datum"});return{signal:l7(a,n,f)}}else{K1("Unknown field for ${channel}.  Cannot calculate view size.");return null}}}}return{signal:this.layoutSizeNameMap.get(this.getName(e))}};e.prototype.lookupDataSource=function(e){var t=this.component.data.outputNodes[e];if(!t){return e}return t.getSource()};e.prototype.getSizeName=function(e){return this.layoutSizeNameMap.get(e)};e.prototype.renameLayoutSize=function(e,t){this.layoutSizeNameMap.rename(e,t)};e.prototype.renameScale=function(e,t){this.scaleNameMap.rename(e,t)};e.prototype.renameProjection=function(e,t){this.projectionNameMap.rename(e,t)};e.prototype.scaleName=function(e,t){if(t){return this.getName(e)}if(q0(e)&&d1(e)&&this.component.scales[e]||this.scaleNameMap.has(this.getName(e))){return this.scaleNameMap.get(this.getName(e))}return undefined};e.prototype.projectionName=function(e){if(e){return this.getName("projection")}if(this.component.projection&&!this.component.projection.merged||this.projectionNameMap.has(this.getName("projection"))){return this.projectionNameMap.get(this.getName("projection"))}return undefined};e.prototype.getScaleComponent=function(e){if(!this.component.scales){throw new Error("getScaleComponent cannot be called before parseScale().  Make sure you have called parseScale or use parseUnitModelWithScale().")}var t=this.component.scales[e];if(t&&!t.merged){return t}return this.parent?this.parent.getScaleComponent(e):undefined};e.prototype.getSelectionComponent=function(e,t){var n=this.component.selection[e];if(!n&&this.parent){n=this.parent.getSelectionComponent(e,t)}if(!n){throw new Error(n2.selectionNotFound(t))}return n};return e}();var l9=function(e){U(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.prototype.vgField=function(e,t){if(t===void 0){t={}}var n=this.fieldDef(e);if(!n){return undefined}return t3(n,t)};t.prototype.reduceFieldDef=function(e,t,n){return C3(this.getMapping(),function(t,n,r){var i=h3(n);if(i){return e(t,i,r)}return t},t,n)};t.prototype.forEachFieldDef=function(e,t){S3(this.getMapping(),function(t,n){var r=h3(t);if(r){e(r,n)}},t)};return t}(c9);var s9={has:function(e){return e.type==="interval"&&e.resolve==="global"&&e.bind&&e.bind==="scales"},parse:function(e,t,n){var r=n.scales=[];n.project.forEach(function(t){var i=t.channel;var a=e.getScaleComponent(i);var u=a?a.get("type"):undefined;if(!a||!m6(u)||g6(u)){K1(n2.SCALE_BINDINGS_CONTINUOUS);return}a.set("domainRaw",{signal:see(n,i,"data")},true);r.push(i);if(e.repeater&&e.repeater.row===e.repeater.column){var o=e.getScaleComponent(i===c0?l0:c0);o.set("domainRaw",{signal:see(n,i,"data")},true)}})},topLevelSignals:function(e,t,n){if(!e.parent){return n}var r=t.scales.filter(function(e){return!n.filter(function(n){return n.name===see(t,e,"data")}).length});return n.concat(r.map(function(e){return{name:see(t,e,"data")}}))},signals:function(e,t,n){if(e.parent){t.scales.forEach(function(e){var r=n.filter(function(n){return n.name===see(t,e,"data")})[0];r.push="outer";delete r.value;delete r.update})}return n}};var d9=s9;function h9(e,t){var n=Object(dn["W"])(e.scaleName(t));return"domain("+n+")"}var p9="_brush";var v9="_scale_trigger";var g9={predicate:"vlInterval",scaleDomain:"vlIntervalDomain",signals:function(e,t){var n=t.name;var r=d9.has(t);var i=[];var a=[];var u=[];var o=[];if(t.translate&&!r){var f="!event.item || event.item.mark.name !== "+Object(dn["W"])(n+p9);b9(t,function(e,t){var n=t.between[0].filter||(t.between[0].filter=[]);if(n.indexOf(f)<0){n.push(f)}})}t.project.forEach(function(n){var r=n.channel;if(r!==c0&&r!==l0){K1("Interval selections only support x and y encoding channels.");return}var f=y9(e,t,r);var c=see(t,r,"data");var l=see(t,r,"visual");var s=Object(dn["W"])(e.scaleName(r));var d=e.getScaleComponent(r).get("type");var h=m6(d)?"+":"";i.push.apply(i,f);u.push(c);a.push("{encoding: "+Object(dn["W"])(r)+", "+("field: "+Object(dn["W"])(n.field)+", extent: "+c+"}"));o.push({scaleName:e.scaleName(r),expr:"(!isArray("+c+") || "+("("+h+"invert("+s+", "+l+")[0] === "+h+c+"[0] && ")+(h+"invert("+s+", "+l+")[1] === "+h+c+"[1]))")})});if(!r){i.push({name:n+v9,update:o.map(function(e){return e.expr}).join(" && ")+(" ? "+(n+v9)+" : {}")})}return i.concat({name:n+V9,on:[{events:u.map(function(e){return{signal:e}}),update:u.join(" && ")+(" ? {unit: "+cee(e)+", intervals: ["+a.join(", ")+"]} : null")}]})},modifyExpr:function(e,t){var n=t.name+V9;return n+", "+(t.resolve==="global"?"true":"{unit: "+cee(e)+"}")},marks:function(e,t,n){var r=t.name;var i=dee(t),a=i.xi,u=i.yi;var o="data("+Object(dn["W"])(t.name+$9)+")";if(d9.has(t)){return n}var f={x:a!==null?{signal:r+"_x[0]"}:{value:0},y:u!==null?{signal:r+"_y[0]"}:{value:0},x2:a!==null?{signal:r+"_x[1]"}:{field:{group:"width"}},y2:u!==null?{signal:r+"_y[1]"}:{field:{group:"height"}}};if(t.resolve==="global"){for(var c=0,l=NK(f);c<l.length;c++){var s=l[c];f[s]=[q({test:o+".length && "+o+"[0].unit === "+cee(e)},f[s]),{value:0}]}}var d=t.mark,h=d.fill,p=d.fillOpacity,v=W(d,["fill","fillOpacity"]);var g=NK(v).reduce(function(e,t){e[t]=[{test:[a!==null&&r+"_x[0] !== "+r+"_x[1]",u!=null&&r+"_y[0] !== "+r+"_y[1]"].filter(function(e){return e}).join(" && "),value:v[t]},{value:null}];return e},{});return[{name:r+p9+"_bg",type:"rect",clip:true,encode:{enter:{fill:{value:h},fillOpacity:{value:p}},update:f}}].concat(n,{name:r+p9,type:"rect",clip:true,encode:{enter:{fill:{value:"transparent"}},update:q({},f,g)}})}};var m9=g9;function y9(e,t,n){var r=see(t,n,"visual");var i=see(t,n,"data");var a=d9.has(t);var u=e.scaleName(n);var o=Object(dn["W"])(u);var f=e.getScaleComponent(n);var c=f?f.get("type"):undefined;var l=e.getSizeSignalRef(n===c0?"width":"height").signal;var s=n+"(unit)";var d=b9(t,function(e,t){return e.concat({events:t.between[0],update:"["+s+", "+s+"]"},{events:t,update:"["+r+"[0], clamp("+s+", 0, "+l+")]"})});d.push({events:{signal:t.name+v9},update:m6(c)&&!g6(c)?"[scale("+o+", "+i+"[0]), scale("+o+", "+i+"[1])]":"[0, 0]"});return a?[{name:i,on:[]}]:[{name:r,value:[],on:d},{name:i,on:[{events:{signal:r},update:r+"[0] === "+r+"[1] ? null : invert("+o+", "+r+")"}]}]}function b9(e,t){return e.events.reduce(function(e,n){if(!n.between){K1(n+" is not an ordered event stream for interval selections");return e}return t(e,n)},[])}var x9="voronoi";var _9={has:function(e){return e.type!=="interval"&&e.nearest},marks:function(e,t,n){var r=dee(t),i=r.x,a=r.y;var u=e.mark;if(T1(u)){K1(n2.nearestNotSupportForContinuous(u));return n}var o={name:e.getName(x9),type:"path",from:{data:e.getName("marks")},encode:{enter:{fill:{value:"transparent"},strokeWidth:{value:.35},stroke:{value:"transparent"},isVoronoi:{value:true}}},transform:[{type:"voronoi",x:{expr:i||!i&&!a?"datum.datum.x || 0":"0"},y:{expr:a||!i&&!a?"datum.datum.y || 0":"0"},size:[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]}]};var f=0;var c=false;n.forEach(function(t,n){var r=t.name||"";if(r===e.component.mark[0].name){f=n}else if(r.indexOf(x9)>=0){c=true}});if(!c){n.splice(f+1,0,o)}return n}};var w9=_9;function k9(e,t){var n=t.project;var r=w9.has(t)?"(item().isVoronoi ? datum.datum : datum)":"datum";var i=[];var a=n.map(function(e){return Object(dn["W"])(e.channel)}).filter(function(e){return e}).join(", ");var u=n.map(function(e){return Object(dn["W"])(e.field)}).join(", ");var o=n.map(function(t){var n=t.channel;var a=e.fieldDef(n);return a&&a.bin?(i.push(t.field),"["+UK(e.vgField(n,{}),r)+", "+(UK(e.vgField(n,{binSuffix:"end"}),r)+"]")):""+UK(t.field,r)}).join(", ");return[{name:t.name+V9,value:{},on:[{events:t.events,update:"datum && item().mark.marktype !== 'group' ? "+("{unit: "+cee(e)+", encodings: ["+a+"], ")+("fields: ["+u+"], values: ["+o+"]")+(i.length?", "+i.map(function(e){return Object(dn["W"])("bin_"+e)+": 1"}).join(", "):"")+"} : null",force:true}]}]}var O9={predicate:"vlMulti",scaleDomain:"vlMultiDomain",signals:k9,modifyExpr:function(e,t){var n=t.name+V9;return n+", "+(t.resolve==="global"?"null":"{unit: "+cee(e)+"}")}};var A9=O9;var E9={predicate:"vlSingle",scaleDomain:"vlSingleDomain",signals:k9,topLevelSignals:function(e,t,n){var r=n.filter(function(e){return e.name===t.name});var i="data("+Object(dn["W"])(t.name+$9)+")";var a=i+"[0].values";return r.length?n:n.concat({name:t.name,update:i+".length && {"+t.project.map(function(e,t){return e.field+": "+a+"["+t+"]"}).join(", ")+"}"})},modifyExpr:function(e,t){var n=t.name+V9;return n+", "+(t.resolve==="global"?"true":"{unit: "+cee(e)+"}")}};var M9=E9;var S9={has:function(e){return e.type==="single"&&e.resolve==="global"&&e.bind&&e.bind!=="scales"},topLevelSignals:function(e,t,n){var r=t.name;var i=t.project;var a=t.bind;var u=w9.has(t)?"(item().isVoronoi ? datum.datum : datum)":"datum";i.forEach(function(e){var i=PK(r+"_"+e.field);var o=n.filter(function(e){return e.name===i});if(!o.length){n.unshift({name:i,value:"",on:[{events:t.events,update:"datum && item().mark.marktype !== 'group' ? "+UK(e.field,u)+" : null"}],bind:a[e.field]||a[e.channel]||a})}});return n},signals:function(e,t,n){var r=t.name;var i=t.project;var a=n.filter(function(e){return e.name===r+V9})[0];var u=i.map(function(e){return Object(dn["W"])(e.field)}).join(", ");var o=i.map(function(e){return PK(r+"_"+e.field)});if(o.length){a.update=o.join(" && ")+" ? {fields: ["+u+"], values: ["+o.join(", ")+"]} : null"}delete a.value;delete a.on;return n}};var C9=S9;var D9={has:function(e){var t=e;return t.fields!==undefined||t.encodings!==undefined},parse:function(e,t,n){var r={};var i={};(t.fields||[]).forEach(function(e){return r[e]=null});(t.encodings||[]).forEach(function(t){var n=e.fieldDef(t);if(n){if(n.timeUnit){var a=e.vgField(t);r[a]=t;i[a]={as:a,field:n.field,timeUnit:n.timeUnit}}else{r[n.field]=t}}else{K1(n2.cannotProjectOnChannelWithoutField(t))}});var a=n.project||(n.project=[]);for(var u in r){if(r.hasOwnProperty(u)){a.push({field:u,channel:r[u]})}}var o=n.fields||(n.fields={});a.filter(function(e){return e.channel}).forEach(function(e){return o[e.channel]=e.field});if(NK(i).length){n.timeUnit=new K7(null,i)}}};var j9=D9;var N9="_toggle";var F9={has:function(e){return e.type==="multi"&&e.toggle},signals:function(e,t,n){return n.concat({name:t.name+N9,value:false,on:[{events:t.events,update:t.toggle}]})},modifyExpr:function(e,t,n){var r=t.name+V9;var i=t.name+N9;return i+" ? null : "+r+", "+(t.resolve==="global"?i+" ? null : true, ":i+" ? null : {unit: "+cee(e)+"}, ")+(i+" ? "+r+" : null")}};var T9=F9;var z9="_translate_anchor";var R9="_translate_delta";var P9={has:function(e){return e.type==="interval"&&e.translate},signals:function(e,t,n){var r=t.name;var i=d9.has(t);var a=r+z9;var u=dee(t),o=u.x,f=u.y;var c=D$(t.translate,"scope");if(!i){c=c.map(function(e){return e.between[0].markname=r+p9,e})}n.push({name:a,value:{},on:[{events:c.map(function(e){return e.between[0]}),update:"{x: x(unit), y: y(unit)"+(o!==null?", extent_x: "+(i?h9(e,c0):"slice("+see(t,"x","visual")+")"):"")+(f!==null?", extent_y: "+(i?h9(e,l0):"slice("+see(t,"y","visual")+")"):"")+"}"}]},{name:r+R9,value:{},on:[{events:c,update:"{x: "+a+".x - x(unit), y: "+a+".y - y(unit)}"}]});if(o!==null){B9(e,t,c0,"width",n)}if(f!==null){B9(e,t,l0,"height",n)}return n}};var L9=P9;function B9(e,t,n,r,i){var a=t.name;var u=d9.has(t);var o=i.filter(function(e){return e.name===see(t,n,u?"data":"visual")})[0];var f=a+z9;var c=a+R9;var l=e.getSizeSignalRef(r).signal;var s=e.getScaleComponent(n);var d=s.get("type");var h=u&&n===c0?"-":"";var p=f+".extent_"+n;var v=""+h+c+"."+n+" / "+(u?""+l:"span("+p+")");var g=!u?"panLinear":d==="log"?"panLog":d==="pow"?"panPow":"panLinear";var m=g+"("+p+", "+v+(u&&d==="pow"?", "+(s.get("exponent")||1):"")+")";o.on.push({events:{signal:c},update:u?m:"clampRange("+m+", 0, "+l+")"})}var I9="_zoom_anchor";var U9="_zoom_delta";var q9={has:function(e){return e.type==="interval"&&e.zoom},signals:function(e,t,n){var r=t.name;var i=d9.has(t);var a=r+U9;var u=dee(t),o=u.x,f=u.y;var c=Object(dn["W"])(e.scaleName(c0));var l=Object(dn["W"])(e.scaleName(l0));var s=D$(t.zoom,"scope");if(!i){s=s.map(function(e){return e.markname=r+p9,e})}n.push({name:r+I9,on:[{events:s,update:!i?"{x: x(unit), y: y(unit)}":"{"+[c?"x: invert("+c+", x(unit))":"",l?"y: invert("+l+", y(unit))":""].filter(function(e){return!!e}).join(", ")+"}"}]},{name:a,on:[{events:s,force:true,update:"pow(1.001, event.deltaY * pow(16, event.deltaMode))"}]});if(o!==null){H9(e,t,"x","width",n)}if(f!==null){H9(e,t,"y","height",n)}return n}};var W9=q9;function H9(e,t,n,r,i){var a=t.name;var u=d9.has(t);var o=i.filter(function(e){return e.name===see(t,n,u?"data":"visual")})[0];var f=e.getSizeSignalRef(r).signal;var c=e.getScaleComponent(n);var l=c.get("type");var s=u?h9(e,n):o.name;var d=a+U9;var h=""+a+I9+"."+n;var p=!u?"zoomLinear":l==="log"?"zoomLog":l==="pow"?"zoomPow":"zoomLinear";var v=p+"("+s+", "+h+", "+d+(u&&l==="pow"?", "+(c.get("exponent")||1):"")+")";o.on.push({events:{signal:d},update:u?v:"clampRange("+v+", 0, "+f+")"})}var G9={project:j9,toggle:T9,scales:d9,translate:L9,zoom:W9,inputs:C9,nearest:w9};function Y9(e,t){for(var n in G9){if(G9[n].has(e)){t(G9[n])}}}var $9="_store";var V9="_tuple";var X9="_modify";var Z9="_selection_domain_";function J9(e,t){var n={};var r=e.config.selection;var i=function(i){if(!t.hasOwnProperty(i)){return"continue"}var a=t[i];var u=r[a.type];for(var o in u){if(o==="encodings"&&a.fields||o==="fields"&&a.encodings){continue}if(o==="mark"){a[o]=q({},u[o],a[o])}if(a[o]===undefined||a[o]===true){a[o]=u[o]||a[o]}}i=PK(i);var f=n[i]=q({},a,{name:i,events:Object(dn["G"])(a.on)?D$(a.on,"scope"):a.on});Y9(f,function(t){if(t.parse){t.parse(e,a,f)}})};for(var a in t){i(a)}return n}function Q9(e,t){uee(e,function(n,r){var i=n.name;var a=r.modifyExpr(e,n);t.push.apply(t,r.signals(e,n));Y9(n,function(r){if(r.signals){t=r.signals(e,n,t)}if(r.modifyExpr){a=r.modifyExpr(e,n,a)}});t.push({name:i+X9,on:[{events:{signal:i+V9},update:"modify("+Object(dn["W"])(n.name+$9)+", "+a+")"}]})});var n=fee(e);if(t.length&&n){var r=Object(dn["W"])(n.getName("cell"));t.unshift({name:"facet",value:{},on:[{events:D$("mousemove","scope"),update:"isTuple(facet) ? facet : group("+r+").datum"}]})}return t}function K9(e,t){var n=false;uee(e,function(r,i){if(i.topLevelSignals){t=i.topLevelSignals(e,r,t)}Y9(r,function(n){if(n.topLevelSignals){t=n.topLevelSignals(e,r,t)}});n=true});if(n){var r=t.filter(function(e){return e.name==="unit"});if(!r.length){t.unshift({name:"unit",value:{},on:[{events:"mousemove",update:"isTuple(group()) ? group() : unit"}]})}}return t}function eee(e,t){uee(e,function(e){var n=t.filter(function(t){return t.name===e.name+$9});if(!n.length){t.push({name:e.name+$9})}});return t}function tee(e,t){uee(e,function(n,r){t=r.marks?r.marks(e,n,t):t;Y9(n,function(r){if(r.marks){t=r.marks(e,n,t)}})});return t}function nee(e,t){e.children.forEach(function(e){if(i9(e)){t=tee(e,t)}});return t}function ree(e,t,n){var r=[];function i(t){var i=PK(t);var a=e.getSelectionComponent(i,t);var u=Object(dn["W"])(i+$9);if(a.timeUnit){var o=n||e.component.data.raw;var f=a.timeUnit.clone();if(o.parent){f.insertAsParentOf(o)}else{o.parent=f}}if(a.empty!=="none"){r.push(u)}return oee(a.type).predicate+("("+u+", datum")+(a.resolve==="global"?")":", "+Object(dn["W"])(a.resolve)+")")}var a=LK(t,i);return(r.length?"!("+r.map(function(e){return"length(data("+e+"))"}).join(" || ")+") || ":"")+("("+a+")")}function iee(e){return e.signal.indexOf(Z9)>=0}function aee(e,t){var n=JSON.parse(t.signal.replace(Z9,""));var r=PK(n.selection);var i=e.component.selection&&e.component.selection[r];if(i){K1('Use "bind": "scales" to setup a binding for scales and selections within the same view.')}else{i=e.getSelectionComponent(r,n.selection);if(!n.encoding&&!n.field){n.field=i.project[0].field;if(i.project.length>1){K1('A "field" or "encoding" must be specified when using a selection as a scale domain. '+('Using "field": '+Object(dn["W"])(n.field)+"."))}}return{signal:oee(i.type).scaleDomain+("("+Object(dn["W"])(r+$9)+", "+Object(dn["W"])(n.encoding||null)+", ")+Object(dn["W"])(n.field||null)+(i.resolve==="global"?")":", "+Object(dn["W"])(i.resolve)+")")}}return{signal:"null"}}function uee(e,t){var n=e.component.selection;for(var r in n){if(n.hasOwnProperty(r)){var i=n[r];t(i,oee(i.type))}}}function oee(e){switch(e){case"single":return M9;case"multi":return A9;case"interval":return m9}return null}function fee(e){var t=e.parent;while(t){if(a9(t)){break}t=t.parent}return t}function cee(e){var t=Object(dn["W"])(e.name);var n=fee(e);if(n){t+=(n.facet.row?" + '_' + ("+UK(n.vgField("row"),"facet")+")":"")+(n.facet.column?" + '_' + ("+UK(n.vgField("column"),"facet")+")":"")}return t}function lee(e){var t=false;uee(e,function(e){t=t||e.project.some(function(e){return e.field===B6})});return t}function see(e,t,n){var r=e._signalNames||(e._signalNames={});if(r[t]&&r[t][n]){return r[t][n]}r[t]=r[t]||{};var i=PK(e.name+"_"+(n==="visual"?t:e.fields[t]));var a=i;var u=1;while(r[a]){a=i+"_"+u++}return r[a]=r[t][n]=a}function dee(e){var t=null;var n=null;var r=null;var i=null;e.project.forEach(function(e,a){if(e.channel===c0){t=e;n=a}else if(e.channel===l0){r=e;i=a}});return{x:t,xi:n,y:r,yi:i}}function hee(e){return e&&e["selection"]}function pee(e){return e&&!!e.field&&e.equal!==undefined}function vee(e){return e&&!!e.field&&e.lt!==undefined}function gee(e){return e&&!!e.field&&e.lte!==undefined}function mee(e){return e&&!!e.field&&e.gt!==undefined}function yee(e){return e&&!!e.field&&e.gte!==undefined}function bee(e){if(e&&e.field){if(Object(dn["z"])(e.range)&&e.range.length===2){return true}}return false}function xee(e){return e&&!!e.field&&(Object(dn["z"])(e.oneOf)||Object(dn["z"])(e.in))}function _ee(e){return xee(e)||pee(e)||bee(e)||vee(e)||mee(e)||gee(e)||yee(e)}function wee(e,t,n){return LK(t,function(t){if(Object(dn["G"])(t)){return t}else if(hee(t)){return ree(e,t.selection,n)}else{return Aee(t)}})}function kee(e,t){return _3(e,{timeUnit:t,time:true})}function Oee(e,t){return e.map(function(e){return kee(e,t)})}function Aee(e,t){if(t===void 0){t=true}var n=e.field,r=e.timeUnit;var i=r?"time("+N2(r,n)+")":t3(e,{expr:"datum"});if(pee(e)){return i+"==="+kee(e.equal,r)}else if(vee(e)){var a=e.lt;return i+"<"+kee(a,r)}else if(mee(e)){var u=e.gt;return i+">"+kee(u,r)}else if(gee(e)){var a=e.lte;return i+"<="+kee(a,r)}else if(yee(e)){var u=e.gte;return i+">="+kee(u,r)}else if(xee(e)){var o=e.oneOf;o=o||e["in"];return"indexof(["+Oee(o,r).join(",")+"], "+i+") !== -1"}else if(bee(e)){var u=e.range[0];var a=e.range[1];if(u!==null&&a!==null&&t){return"inrange("+i+", ["+kee(u,r)+", "+kee(a,r)+"])"}var f=[];if(u!==null){f.push(i+" >= "+kee(u,r))}if(a!==null){f.push(i+" <= "+kee(a,r))}return f.length>0?f.join(" && "):"true"}throw new Error("Invalid field predicate: "+JSON.stringify(e))}function Eee(e){if(_ee(e)&&e.timeUnit){return q({},e,{timeUnit:T2(e.timeUnit)})}return e}function Mee(e){return e["filter"]!==undefined}function See(e){return e["lookup"]!==undefined}function Cee(e){return e["window"]!==undefined}function Dee(e){return e["calculate"]!==undefined}function jee(e){return!!e["bin"]}function Nee(e){return e["timeUnit"]!==undefined}function Fee(e){return e["aggregate"]!==undefined}function Tee(e){return e["stack"]!==undefined}function zee(e){return e.map(function(e){if(Mee(e)){return{filter:pK(e.filter,Eee)}}return e})}function Ree(e,t,n,r){if(G8(t,n)){var i=i9(e)?e.axis(n)||e.legend(n)||{}:{};var a=t3(t,{expr:"datum"});var u=t3(t,{expr:"datum",binSuffix:"end"});return{formulaAs:t3(t,{binSuffix:"range"}),formula:B8(a,u,i.format,r)}}return{}}function Pee(e,t){return g1(e)+"_"+t}function Lee(e,t){return{signal:e.getName(t+"_bins"),extentSignal:e.getName(t+"_extent")}}function Bee(e){return"as"in e}function Iee(e,t){var n;if(Bee(e)){n=Object(dn["G"])(e.as)?[e.as,e.as+"_end"]:[e.as[0],e.as[1]]}else{n=[t3(e,{}),t3(e,{binSuffix:"end"})]}var r=g3(e.bin,undefined)||{};var i=Pee(r,e.field);var a=Lee(t,i),u=a.signal,o=a.extentSignal;var f=q({bin:r,field:e.field,as:n},u?{signal:u}:{},o?{extentSignal:o}:{});return{key:i,binComponent:f}}var Uee=function(e){U(t,e);function t(t,n){var r=e.call(this,t)||this;r.bins=n;return r}t.prototype.clone=function(){return new t(null,zK(this.bins))};t.makeFromEncoding=function(e,n){var r=n.reduceFieldDef(function(e,t,r){if(t.bin){var i=Iee(t,n),a=i.key,u=i.binComponent;e[a]=q({},u,e[a],Ree(n,t,r,n.config))}return e},{});if(NK(r).length===0){return null}return new t(e,r)};t.makeFromTransform=function(e,n,r){var i;var a=Iee(n,r),u=a.key,o=a.binComponent;return new t(e,(i={},i[u]=o,i))};t.prototype.merge=function(e){this.bins=q({},this.bins,e.bins);e.remove()};t.prototype.producedFields=function(){var e={};FK(this.bins).forEach(function(t){t.as.forEach(function(t){return e[t]=true})});return e};t.prototype.dependentFields=function(){var e={};FK(this.bins).forEach(function(t){e[t.field]=true});return e};t.prototype.assemble=function(){return OK(FK(this.bins).map(function(e){var t=[];var n=q({type:"bin",field:e.field,as:e.as,signal:e.signal},e.bin);if(!e.bin.extent&&e.extentSignal){t.push({type:"extent",field:e.field,signal:e.extentSignal});n.extent={signal:e.extentSignal}}t.push(n);if(e.formula){t.push({type:"formula",expr:e.formula,as:e.formulaAs})}return t}))};return t}($8);var qee=function(e){U(t,e);function t(t,n,r){var i=e.call(this,t)||this;i.model=n;i.filter=r;i.expr=wee(i.model,i.filter,i);return i}t.prototype.clone=function(){return new t(null,this.model,zK(this.filter))};t.prototype.assemble=function(){return{type:"filter",expr:this.expr}};return t}($8);var Wee=function(e){U(t,e);function t(t,n,r,i){var a=e.call(this,t)||this;a.fields=n;a.geojson=r;a.signal=i;return a}t.prototype.clone=function(){return new t(null,zK(this.fields),this.geojson,this.signal)};t.parseAll=function(e,n){var r=0;[[v0,h0],[g0,p0]].forEach(function(i){var a=i.map(function(e){return n.channelHasField(e)?n.fieldDef(e).field:undefined});if(a[0]||a[1]){e=new t(e,a,null,n.getName("geojson_"+r++))}});if(n.channelHasField(b0)){var i=n.fieldDef(b0);if(i.type===q2){e=new t(e,null,i.field,n.getName("geojson_"+r++))}}return e};t.prototype.assemble=function(){return q({type:"geojson"},this.fields?{fields:this.fields}:{},this.geojson?{geojson:this.geojson}:{},{signal:this.signal})};return t}($8);var Hee=function(e){U(t,e);function t(t,n,r,i){var a=e.call(this,t)||this;a.projection=n;a.fields=r;a.as=i;return a}t.prototype.clone=function(){return new t(null,this.projection,zK(this.fields),zK(this.as))};t.parseAll=function(e,n){if(!n.projectionName()){return e}[[v0,h0],[g0,p0]].forEach(function(r){var i=r.map(function(e){return n.channelHasField(e)?n.fieldDef(e).field:undefined});var a=r[0]===g0?"2":"";if(i[0]||i[1]){e=new t(e,n.projectionName(),i,[n.getName("x"+a),n.getName("y"+a)])}});return e};t.prototype.assemble=function(){return{type:"geopoint",projection:this.projection,fields:this.fields,as:this.as}};return t}($8);var Gee=function(e){U(t,e);function t(t){return e.call(this,t)||this}t.prototype.clone=function(){return new t(null)};t.prototype.producedFields=function(){var e;return e={},e[B6]=true,e};t.prototype.assemble=function(){return{type:"identifier",as:B6}};return t}($8);var Yee=function(e){U(t,e);function t(t,n,r){if(t===void 0){t={}}if(n===void 0){n={}}if(r===void 0){r=false}var i=e.call(this,t,n)||this;i.explicit=t;i.implicit=n;i.parseNothing=r;return i}t.prototype.clone=function(){var t=e.prototype.clone.call(this);t.parseNothing=this.parseNothing;return t};return t}(h7);var $ee=function(e){U(t,e);function t(t,n,r){var i=e.call(this,t)||this;i.transform=n;i.secondary=r;return i}t.make=function(e,n,r,i){var a=n.component.data.sources;var u=new Q7(r.from.data);var o=a[u.hash()];if(!o){a[u.hash()]=u;o=u}var f=n.getName("lookup_"+i);var c=new V8(o,f,"lookup",n.component.data.outputNodeRefCounts);n.component.data.outputNodes[f]=c;return new t(e,r,c.getSource())};t.prototype.producedFields=function(){return Object(dn["ab"])(this.transform.from.fields||(this.transform.as instanceof Array?this.transform.as:[this.transform.as]))};t.prototype.assemble=function(){var e;if(this.transform.from.fields){e=q({values:this.transform.from.fields},this.transform.as?{as:this.transform.as instanceof Array?this.transform.as:[this.transform.as]}:{})}else{var t=this.transform.as;if(!Object(dn["G"])(t)){K1(n2.NO_FIELDS_NEEDS_AS);t="_lookup"}e={as:[t]}}return q({type:"lookup",from:this.secondary,key:this.transform.from.key,fields:[this.transform.lookup]},e,this.transform.default?{default:this.transform.default}:{})};return t}($8);function Vee(e){console.log(""+e.constructor.name+(e.debugName?" ("+e.debugName+")":"")+" -> "+e.children.map(function(e){return""+e.constructor.name+(e.debugName?" ("+e.debugName+")":"")}));console.log(e);e.children.forEach(Vee)}function Xee(e){var t=0;function n(r,i){if(r instanceof Q7){if(!T5(r.data)){e.push(i);var a={name:null,source:i.name,transform:[]};i=a}}if(r instanceof J7){if(r.parent instanceof Q7&&!i.source){i.format=q({},i.format||{},{parse:r.assembleFormatParse()});i.transform=i.transform.concat(r.assembleTransforms(true))}else{i.transform=i.transform.concat(r.assembleTransforms())}}if(r instanceof V7){if(!i.name){i.name="data_"+t++}if(!i.source||i.transform.length>0){e.push(i);r.data=i.name}else{r.data=i.source}r.assemble().forEach(function(t){return e.push(t)});return}if(r instanceof qee||r instanceof X8||r instanceof Hee||r instanceof Wee||r instanceof $7||r instanceof $ee||r instanceof hte||r instanceof Gee){i.transform.push(r.assemble())}if(r instanceof X7||r instanceof Uee||r instanceof K7||r instanceof u4){i.transform=i.transform.concat(r.assemble())}if(r instanceof $7){if(!i.name){i.name="data_"+t++}}if(r instanceof V8){if(i.source&&i.transform.length===0){r.setSource(i.source)}else if(r.parent instanceof V8){r.setSource(i.name)}else{if(!i.name){i.name="data_"+t++}r.setSource(i.name);if(r.numChildren()===1){e.push(i);var a={name:null,source:i.name,transform:[]};i=a}}}switch(r.numChildren()){case 0:if(r instanceof V8&&(!i.source||i.transform.length>0)){e.push(i)}break;case 1:n(r.children[0],i);break;default:if(!i.name){i.name="data_"+t++}var u=i.name;if(!i.source||i.transform.length>0){e.push(i)}else{u=i.source}r.children.forEach(function(e){var t={name:null,source:u,transform:[]};n(e,t)});break}}return n}function Zee(e){var t=[];var n=Xee(t);e.children.forEach(function(t){return n(t,{source:e.name,name:null,transform:[]})});return t}function Jee(e,t){var n=FK(e.sources);var r=[];var i=Xee(r);var a=0;n.forEach(function(e){if(!e.hasName()){e.dataName="source_"+a++}var t=e.assemble();i(e,t)});r.forEach(function(e){if(e.transform.length===0){delete e.transform}});var u=0;for(var o=0;o<r.length;o++){var f=r[o];if((f.transform||[]).length===0&&!f.source){r.splice(u++,0,r.splice(o,1)[0])}}for(var c=0,l=r;c<l.length;c++){var f=l[c];for(var s=0,d=f.transform||[];s<d.length;s++){var h=d[s];if(h.type==="lookup"){h.from=e.outputNodes[h.from].getSource()}}}for(var p=0,v=r;p<v.length;p++){var f=v[p];if(f.name in t){f.values=t[f.name]}}return r}function Qee(e){tte(e);var t=e.component.layoutSize;t.setWithExplicit("width",nte(e,"width"));t.setWithExplicit("height",nte(e,"height"))}var Kee=Qee;function ete(e){tte(e);var t=e.component.layoutSize;var n=e.isVConcat?"width":"height";t.setWithExplicit(n,nte(e,n))}function tte(e){for(var t=0,n=e.children;t<n.length;t++){var r=n[t];r.parseLayoutSize()}}function nte(e,t){var n=t==="width"?"x":"y";var r=e.component.resolve;var i;for(var a=0,u=e.children;a<u.length;a++){var o=u[a];var f=o.component.layoutSize.getWithExplicit(t);var c=r.scale[n];if(c==="independent"&&f.value==="range-step"){i=undefined;break}if(i){if(c==="independent"&&i.value!==f.value){i=undefined;break}i=y7(i,f,t,"")}else{i=f}}if(i){for(var l=0,s=e.children;l<s.length;l++){var o=s[l];e.renameLayoutSize(o.getName(t),e.getName(t));o.component.layoutSize.set(t,"merged",false)}return i}else{return{explicit:false,value:undefined}}}function rte(e){var t=e.component.layoutSize;if(!t.explicit.width){var n=ite(e,"width");t.set("width",n,false)}if(!t.explicit.height){var r=ite(e,"height");t.set("height",r,false)}}function ite(e,t){var n=t==="width"?"x":"y";var r=e.config;var i=e.getScaleComponent(n);if(i){var a=i.get("type");var u=i.get("range");if(v6(a)&&I5(u)){return"range-step"}else{return r.view[t]}}else if(e.hasProjection){return r.view[t]}else{if(t==="width"&&e.mark==="text"){return r.scale.textXRangeStep}return r.scale.rangeStep||b6.rangeStep}}function ate(e,t){return lte(e,t)}function ute(e,t){return lte(e,t)}function ote(e,t){if(G2(e.field)){if(e.field.repeat in t){return q({},e,{field:t[e.field.repeat]})}else{K1(n2.noSuchRepeatedValue(e.field.repeat));return undefined}}return e}function fte(e,t){e=ote(e,t);if(e===undefined){return undefined}if(e.sort&&e8(e.sort)){var n=ote(e.sort,t);e=q({},e,n?{sort:n}:{})}return e}function cte(e,t){if(Z2(e)){var n=fte(e,t);if(n){return n}else if($2(e)){return{condition:e.condition}}}else{if(V2(e)){var n=fte(e.condition,t);if(n){return q({},e,{condition:n})}else{var r=e.condition,i=W(e,["condition"]);return i}}return e}return undefined}function lte(e,t){var n={};for(var r in e){if(e.hasOwnProperty(r)){var i=e[r];if(Object(dn["z"])(i)){n[r]=i.map(function(e){return cte(e,t)}).filter(function(e){return e})}else{var a=cte(i,t);if(a){n[r]=a}}}}return n}function ste(e,t,n){return t3(t,{expr:n,suffix:"by_"+t3(e)})}var dte=function(e){U(t,e);function t(t,n,r,i,a){var u=e.call(this,t,n,r,a,i,t.resolve)||this;u.type="facet";u.child=Ane(t.spec,u,u.getName("child"),undefined,i,a,false);u.children=[u.child];var o=ate(t.facet,i);u.facet=u.initFacet(o);return u}t.prototype.initFacet=function(e){return C3(e,function(e,t,n){if(!bK([m0,y0],n)){K1(n2.incompatibleChannel(n,"facet"));return e}if(t.field===undefined){K1(n2.emptyFieldDef(t,n));return e}e[n]=p3(t,n);return e},{})};t.prototype.channelHasField=function(e){return!!this.facet[e]};t.prototype.fieldDef=function(e){return this.facet[e]};t.prototype.parseData=function(){this.component.data=gte(this);this.child.parseData()};t.prototype.parseLayoutSize=function(){tte(this)};t.prototype.parseSelection=function(){this.child.parseSelection();this.component.selection=this.child.component.selection};t.prototype.parseMarkGroup=function(){this.child.parseMarkGroup()};t.prototype.parseAxisAndHeader=function(){this.child.parseAxisAndHeader();this.parseHeader("column");this.parseHeader("row");this.mergeChildAxis("x");this.mergeChildAxis("y")};t.prototype.parseHeader=function(e){if(this.channelHasField(e)){var t=this.facet[e];var n=t.header||{};var r=t.title!==undefined?t.title:n.title!==undefined?n.title:s3(t,this.config);if(this.child.component.layoutHeaders[e].title){r+=" / "+this.child.component.layoutHeaders[e].title;this.child.component.layoutHeaders[e].title=null}this.component.layoutHeaders[e]={title:r,facetFieldDef:t,header:[this.makeHeaderComponent(e,true)]}}};t.prototype.makeHeaderComponent=function(e,t){var n=e==="row"?"height":"width";return{labels:t,sizeSignal:this.child.component.layoutSize.get(n)?this.child.getSizeSignalRef(n):undefined,axes:[]}};t.prototype.mergeChildAxis=function(e){var t=this.child;if(t.component.axes[e]){var n=this.component,r=n.layoutHeaders,i=n.resolve;i.axis[e]=d7(i,e);if(i.axis[e]==="shared"){var a=e==="x"?"column":"row";var u=r[a];for(var o=0,f=t.component.axes[e];o<f.length;o++){var c=f[o];var l=K8(c.get("orient"));u[l]=u[l]||[this.makeHeaderComponent(a,false)];var s=V5(c,"main",this.config,{header:true});u[l][0].axes.push(s);c.mainExtracted=true}}else{}}};t.prototype.assembleSelectionTopLevelSignals=function(e){return this.child.assembleSelectionTopLevelSignals(e)};t.prototype.assembleSelectionSignals=function(){this.child.assembleSelectionSignals();return[]};t.prototype.assembleSelectionData=function(e){return this.child.assembleSelectionData(e)};t.prototype.getHeaderLayoutMixins=function(){var e=this;var t={};["row","column"].forEach(function(n){["header","footer"].forEach(function(r){var i=e.component.layoutHeaders[n];var a=i[r];if(a&&a[0]){var u=n==="row"?"height":"width";var o=r==="header"?"headerBand":"footerBand";if(!e.child.component.layoutSize.get(u)){t[o]=t[o]||{};t[o][n]=.5}if(i.title){t.offset=t.offset||{};t.offset[n==="row"?"rowTitle":"columnTitle"]=10}}})});return t};t.prototype.assembleDefaultLayout=function(){var e=this.channelHasField("column")?this.columnDistinctSignal():1;return q({},this.getHeaderLayoutMixins(),{columns:e,bounds:"full",align:"all"})};t.prototype.assembleLayoutSignals=function(){return this.child.assembleLayoutSignals()};t.prototype.columnDistinctSignal=function(){if(this.parent&&this.parent instanceof t){return undefined}else{var e=this.getName("column_domain");return{signal:"length(data('"+e+"'))"}}};t.prototype.assembleGroup=function(n){if(this.parent&&this.parent instanceof t){return q({},this.channelHasField("column")?{encode:{update:{columns:{field:t3(this.facet.column,{prefix:"distinct"})}}}}:{},e.prototype.assembleGroup.call(this,n))}return e.prototype.assembleGroup.call(this,n)};t.prototype.getCardinalityAggregateForChild=function(){var e=[];var n=[];var r=[];if(this.child instanceof t){if(this.child.channelHasField("column")){var i=t3(this.child.facet.column);e.push(i);n.push("distinct");r.push("distinct_"+i)}}else{for(var a=0,u=["x","y"];a<u.length;a++){var o=u[a];var f=this.child.component.scales[o];if(f&&!f.merged){var c=f.get("type");var l=f.get("range");if(v6(c)&&I5(l)){var s=A4(this.child,o);var i=O4(s);if(i){e.push(i);n.push("distinct");r.push("distinct_"+i)}else{K1("Unknown field for ${channel}.  Cannot calculate view size.")}}}}}return{fields:e,ops:n,as:r}};t.prototype.assembleFacet=function(){var e=this;var t=this.component.data.facetRoot,n=t.name,r=t.data;var i=this.facet,a=i.row,u=i.column;var o=this.getCardinalityAggregateForChild(),f=o.fields,c=o.ops,l=o.as;var s=[];["row","column"].forEach(function(t){var n=e.facet[t];if(n){s.push(t3(n));var r=n.sort;if(e8(r)){var i=r.field,o=r.op;var d=ste(n,r);if(a&&u){f.push(d);c.push("max");l.push(d)}else{f.push(i);c.push(o);l.push(d)}}else if(Object(dn["z"])(r)){var d=Z8(n,t);f.push(d);c.push("max");l.push(d)}}});var d=!!a&&!!u;return q({name:n,data:r,groupby:s},d||f.length?{aggregate:q({},d?{cross:d}:{},f.length?{fields:f,ops:c,as:l}:{})}:{})};t.prototype.headerSortFields=function(e){var t=this.facet;var n=t[e];if(n){if(e8(n.sort)){return[ste(n,n.sort,"datum")]}else if(Object(dn["z"])(n.sort)){return[Z8(n,e,"datum")]}return[t3(n,{expr:"datum"})]}return[]};t.prototype.headerSortOrder=function(e){var t=this.facet;var n=t[e];if(n){var r=n.sort;var i=(e8(r)?r.order:!Object(dn["z"])(r)&&r)||"ascending";return[i]}return[]};t.prototype.assembleMarks=function(){var e=this.child;var t=this.component.data.facetRoot;var n=Zee(t);var r=e.assembleLayoutSize();var i=e.assembleTitle();var a=e.assembleGroupStyle();var u=q({name:this.getName("cell"),type:"group"},i?{title:i}:{},a?{style:a}:{},{from:{facet:this.assembleFacet()},sort:{field:this.headerSortFields("row").concat(this.headerSortFields("column")),order:this.headerSortOrder("row").concat(this.headerSortOrder("column"))}},n.length>0?{data:n}:{},r?{encode:{update:r}}:{},e.assembleGroup());return[u]};t.prototype.getMapping=function(){return this.facet};return t}(l9);var hte=function(e){U(t,e);function t(t,n){var r=e.call(this,t)||this;r.transform=n;return r}t.makeFromFacet=function(e,n){var r=n.row,i=n.column;if(r&&i){var a=null;for(var u=0,o=[r,i];u<o.length;u++){var f=o[u];if(e8(f.sort)){var c=f.sort,l=c.field,s=c.op;e=a=new t(e,{window:[{op:s,field:l,as:ste(f,f.sort)}],groupby:[t3(f)],frame:[null,null]})}}return a}return null};t.prototype.clone=function(){return new t(this.parent,zK(this.transform))};t.prototype.producedFields=function(){var e=this;var t={};this.transform.window.forEach(function(n){t[e.getDefaultName(n)]=true});return t};t.prototype.getDefaultName=function(e){return e.as||t3(e)};t.prototype.assemble=function(){var e=[];var t=[];var n=[];var r=[];for(var i=0,a=this.transform.window;i<a.length;i++){var u=a[i];t.push(u.op);n.push(this.getDefaultName(u));r.push(u.param===undefined?null:u.param);e.push(u.field===undefined?null:u.field)}var o=this.transform.frame;var f=this.transform.groupby;var c=[];var l=[];if(this.transform.sort!==undefined){for(var s=0,d=this.transform.sort;s<d.length;s++){var h=d[s];c.push(h.field);l.push(h.order||"ascending")}}var p={field:c,order:l};var v=this.transform.ignorePeers;var g={type:"window",params:r,as:n,ops:t,fields:e,sort:p};if(v!==undefined){g.ignorePeers=v}if(f!==undefined){g.groupby=f}if(o!==undefined){g.frame=o}return g};return t}($8);function pte(e,t){if(e.data||!e.parent){var n=new Q7(e.data);var r=n.hash();if(r in t){return t[r]}else{t[r]=n;return n}}else{return e.parent.component.data.facetRoot?e.parent.component.data.facetRoot:e.parent.component.data.main}}function vte(e,t,n){var r=0;t.transforms.forEach(function(i){if(Dee(i)){e=new X8(e,i);n.set(i.as,"derived",false)}else if(Mee(i)){e=J7.makeImplicitFromFilterTransform(e,i,n)||e;e=new qee(e,t,i.filter)}else if(jee(i)){var a=e=Uee.makeFromTransform(e,i,t);for(var u=0,o=NK(a.producedFields());u<o.length;u++){var f=o[u];n.set(f,"number",false)}}else if(Nee(i)){e=K7.makeFromTransform(e,i);n.set(i.as,"date",false)}else if(Fee(i)){var c=e=$7.makeFromTransform(e,i);if(lee(t)){e=new Gee(e)}for(var l=0,s=NK(c.producedFields());l<s.length;l++){var f=s[l];n.set(f,"derived",false)}}else if(See(i)){var d=e=$ee.make(e,t,i,r++);for(var h=0,p=NK(d.producedFields());h<p.length;h++){var f=p[h];n.set(f,"derived",false)}}else if(Cee(i)){var v=e=new hte(e,i);for(var g=0,m=NK(v.producedFields());g<m.length;g++){var f=m[g];n.set(f,"derived",false)}}else if(Tee(i)){var y=e=u4.makeFromTransform(e,i);for(var b=0,x=NK(y.producedFields());b<x.length;b++){var f=x[b];n.set(f,"derived",false)}}else{K1(n2.invalidTransformIgnored(i));return}});return e}function gte(e){var t=pte(e,e.component.data.sources);var n=e.component.data,r=n.outputNodes,i=n.outputNodeRefCounts;var a=e.parent?e.parent.component.data.ancestorParse.clone():new Yee;if(e.data&&e.data.format&&e.data.format.parse===null){a.parseNothing=true}t=J7.makeExplicit(t,e,a)||t;if(lee(e)&&(i9(e)||f9(e))){t=new Gee(t)}var u=e.parent&&f9(e.parent);if(i9(e)||a9(e)){if(u){t=Uee.makeFromEncoding(t,e)||t}}if(e.transforms.length>0){t=vte(t,e,a)}t=J7.makeImplicitFromEncoding(t,e,a)||t;if(i9(e)){t=Wee.parseAll(t,e);t=Hee.parseAll(t,e)}if(i9(e)||a9(e)){if(!u){t=Uee.makeFromEncoding(t,e)||t}t=K7.makeFromEncoding(t,e)||t;t=X8.parseAllForSortIndex(t,e)}var o=e.getName(L5);var f=new V8(t,o,L5,i);r[o]=f;t=f;if(i9(e)){var c=$7.makeFromEncoding(t,e);if(c){t=c;if(lee(e)){t=new Gee(t)}}t=u4.makeFromEncoding(t,e)||t}if(i9(e)){t=X7.make(t,e)||t}var l=e.getName(P5);var s=new V8(t,l,P5,i);r[l]=s;t=s;var d=null;if(a9(e)){var h=e.getName("facet");t=X8.parseAllForSortIndex(t,e);t=hte.makeFromFacet(t,e.facet)||t;d=new V7(t,e,h,s.getSource());r[h]=d;t=d}return q({},e.component.data,{outputNodes:r,outputNodeRefCounts:i,raw:f,main:s,facetRoot:d,ancestorParse:a})}var mte=function(e){U(t,e);function t(t,n,r,i,a,u){return e.call(this,t,n,r,i,a,u)||this}t.prototype.parseData=function(){this.component.data=gte(this);this.children.forEach(function(e){e.parseData()})};t.prototype.parseSelection=function(){var e=this;this.component.selection={};var t=function(t){t.parseSelection();NK(t.component.selection).forEach(function(n){e.component.selection[n]=t.component.selection[n]})};for(var n=0,r=this.children;n<r.length;n++){var i=r[n];t(i)}};t.prototype.parseMarkGroup=function(){for(var e=0,t=this.children;e<t.length;e++){var n=t[e];n.parseMarkGroup()}};t.prototype.parseAxisAndHeader=function(){for(var e=0,t=this.children;e<t.length;e++){var n=t[e];n.parseAxisAndHeader()}};t.prototype.assembleSelectionTopLevelSignals=function(e){return this.children.reduce(function(e,t){return t.assembleSelectionTopLevelSignals(e)},e)};t.prototype.assembleSelectionSignals=function(){this.children.forEach(function(e){return e.assembleSelectionSignals()});return[]};t.prototype.assembleLayoutSignals=function(){return this.children.reduce(function(e,t){return e.concat(t.assembleLayoutSignals())},o7(this))};t.prototype.assembleSelectionData=function(e){return this.children.reduce(function(e,t){return t.assembleSelectionData(e)},e)};t.prototype.assembleMarks=function(){return this.children.map(function(e){var t=e.assembleTitle();var n=e.assembleGroupStyle();var r=e.assembleLayoutSize();return q({type:"group",name:e.getName("group")},t?{title:t}:{},n?{style:n}:{},r?{encode:{update:r}}:{},e.assembleGroup())})};return t}(c9);var yte=function(e){U(t,e);function t(t,n,r,i,a){var u=e.call(this,t,n,r,a,i,t.resolve)||this;u.type="concat";if(t.resolve&&t.resolve.axis&&(t.resolve.axis.x==="shared"||t.resolve.axis.y==="shared")){K1(n2.CONCAT_CANNOT_SHARE_AXIS)}u.isVConcat=o5(t);u.children=(o5(t)?t.vconcat:t.hconcat).map(function(e,t){return Ane(e,u,u.getName("concat_"+t),undefined,i,a,false)});return u}t.prototype.parseLayoutSize=function(){ete(this)};t.prototype.parseAxisGroup=function(){return null};t.prototype.assembleDefaultLayout=function(){return q({},this.isVConcat?{columns:1}:{},{bounds:"full",align:"each"})};return t}(mte);function bte(e){return e===false||e===null}var xte=function(e){U(t,e);function t(t,n,r){if(t===void 0){t={}}if(n===void 0){n={}}if(r===void 0){r=false}var i=e.call(this)||this;i.explicit=t;i.implicit=n;i.mainExtracted=r;return i}t.prototype.clone=function(){return new t(zK(this.explicit),zK(this.implicit),this.mainExtracted)};t.prototype.hasAxisPart=function(e){if(e==="axis"){return true}if(e==="grid"||e==="title"){return!!this.get(e)}return!bte(this.get(e))};return t}(h7);function _te(e,t,n,r,i){if(r===void 0){r=""}var a=(i==="band"?["axisBand"]:[]).concat([n==="x"?"axisX":"axisY","axis"+r.substr(0,1).toUpperCase()+r.substr(1),"axis"]);for(var u=0,o=a;u<o.length;u++){var f=o[u];if(t[f]&&t[f][e]!==undefined){return t[f][e]}}return undefined}function wte(e,t,n,r){var i=e.fieldDef(t)||(t==="x"?e.fieldDef("x2"):t==="y"?e.fieldDef("y2"):undefined);var a=e.axis(t);var u=e.config;var o={};if(x3(i)){var f=e.getScaleComponent(t).get("type")===t6.UTC;var c=I8("datum.value",i.timeUnit,a.format,u.axis.shortTimeLabels,u.timeFormat,f);if(c){o.text={signal:c}}}var l=_te("labelAngle",e.config,t,r,e.getScaleComponent(t).get("type"));if(l===undefined){l=Ote(a,t,i);if(l){o.angle={value:l}}}if(l!==undefined){var s=Ate(l,r);if(s){o.align={value:s}}o.baseline=kte(l,r)}o=q({},o,n);return NK(o).length===0?undefined:o}function kte(e,t){if(t==="top"||t==="bottom"){if(e<=45||315<=e){return{value:t==="top"?"bottom":"top"}}else if(135<=e&&e<=225){return{value:t==="top"?"top":"bottom"}}else{return{value:"middle"}}}else{if(e<=45||315<=e||135<=e&&e<=225){return{value:"middle"}}else if(45<=e&&e<=135){return{value:t==="left"?"top":"bottom"}}else{return{value:t==="left"?"bottom":"top"}}}}function Ote(e,t,n){if(e.labelAngle!==undefined){return(e.labelAngle%360+360)%360}else{if(t===c0&&bK([U2,B2],n.type)){return 270}}return undefined}function Ate(e,t){e=(e%360+360)%360;if(t==="top"||t==="bottom"){if(e%180===0){return"center"}else if(0<e&&e<180){return t==="top"?"right":"left"}else{return t==="top"?"left":"right"}}else{if((e+90)%180===0){return"center"}else if(90<=e&&e<270){return t==="left"?"left":"right"}else{return t==="left"?"right":"left"}}}function Ete(e,t){return!v6(e)&&!t.bin}function Mte(e,t){var n=t==="x"?"y":"x";if(e.getScaleComponent(n)){return e.scaleName(n)}return undefined}function Ste(e,t,n){if(n.labelFlush!==undefined){return n.labelFlush}if(t==="x"&&bK(["quantitative","temporal"],e.type)){return true}return undefined}function Cte(e,t,n,r){if(t.labelOverlap!==undefined){return t.labelOverlap}if(e.type!=="nominal"){if(r==="log"){return"greedy"}return true}return undefined}function Dte(e){switch(e){case c0:return"bottom";case l0:return"left"}throw new Error(n2.INVALID_CHANNEL_FOR_AXIS)}function jte(e,t,n,r){if(!v6(n)&&n!=="log"&&!bK(["month","hours","day","quarter"],t.timeUnit)){if(t.bin){return{signal:"ceil("+r.signal+"/20)"}}return{signal:"ceil("+r.signal+"/40)"}}return undefined}function Nte(e,t,n){var r=s3(t,n);return e?Object(dn["cb"])(r,e):r}function Fte(e,t,n,r){var i=e.values;if(i){return w3(n,i)}if(n.bin&&n.type===L2){var a=t.scaleDomain(r);if(a&&a!=="unaggregated"&&!_6(a)){return undefined}var u=t.getName(g1(n.bin)+"_"+n.field+"_bins");return{signal:"sequence("+u+".start, "+u+".stop + "+u+".step, "+u+".step)"}}return undefined}function Tte(e){return t1.reduce(function(t,n){if(e.component.scales[n]&&e.axis(n)){t[n]=[Ite(n,e)]}return t},{})}var zte={bottom:"top",top:"bottom",left:"right",right:"left"};function Rte(e){var t=e.component,n=t.axes,r=t.resolve;var i={top:0,bottom:0,right:0,left:0};for(var a=0,u=e.children;a<u.length;a++){var o=u[a];o.parseAxisAndHeader();for(var f=0,c=NK(o.component.axes);f<c.length;f++){var l=c[f];r.axis[l]=d7(e.component.resolve,l);if(r.axis[l]==="shared"){n[l]=Pte(n[l],o.component.axes[l]);if(!n[l]){r.axis[l]="independent";delete n[l]}}}}for(var s=0,d=[c0,l0];s<d.length;s++){var l=d[s];for(var h=0,p=e.children;h<p.length;h++){var o=p[h];if(!o.component.axes[l]){continue}if(r.axis[l]==="independent"){n[l]=(n[l]||[]).concat(o.component.axes[l]);for(var v=0,g=o.component.axes[l];v<g.length;v++){var m=g[v];var y=m.getWithExplicit("orient"),b=y.value,x=y.explicit;if(i[b]>0&&!x){var _=zte[b];if(i[b]>i[_]){m.set("orient",_,false)}}i[b]++}}delete o.component.axes[l]}}}function Pte(e,t){if(e){if(e.length!==t.length){return undefined}var n=e.length;for(var r=0;r<n;r++){var i=e[r];var a=t[r];if(!!i!==!!a){return undefined}else if(i&&a){var u=i.getWithExplicit("orient");var o=a.getWithExplicit("orient");if(u.explicit&&o.explicit&&u.value!==o.value){return undefined}else{e[r]=Lte(i,a)}}}}else{return t.map(function(e){return e.clone()})}return e}function Lte(e,t){var n=function(n){var r=y7(e.getWithExplicit(n),t.getWithExplicit(n),n,"axis",function(e,t){switch(n){case"title":return H8(e,t);case"gridScale":return{explicit:e.explicit,value:e.value||t.value}}return m7(e,t,n,"axis")});e.setWithExplicit(n,r)};for(var r=0,i=u0;r<i.length;r++){var a=i[r];n(a)}return e}function Bte(e,t){var n=t==="x"?"x2":"y2";var r=e.fieldDef(t);var i=e.fieldDef(n);var a=r?r.title:undefined;var u=i?i.title:undefined;if(a&&u){return W8(a,u)}else if(a){return a}else if(u){return u}else if(a!==undefined){return a}else if(u!==undefined){return u}return undefined}function Ite(e,t){var n=t.axis(e);var r=new xte;u0.forEach(function(i){var a=Ute(i,n,e,t);if(a!==undefined){var u=i==="values"?!!n.values:i==="encode"?!!n.encoding||!!n.labelAngle:i==="title"&&a===Bte(t,e)?true:a===n[i];var o=_te(i,t.config,e,r.get("orient"),t.getScaleComponent(e).get("type"));if(u||o===undefined){r.set(i,a,u)}else if(i==="grid"&&o){r.set(i,o,false)}}});var i=n.encoding||{};var a=e0.reduce(function(n,a){if(!r.hasAxisPart(a)){return n}var u=Y8(i[a]||{},t);var o=a==="labels"?wte(t,e,u,r.get("orient")):u;if(o!==undefined&&NK(o).length>0){n[a]={update:o}}return n},{});if(NK(a).length>0){r.set("encode",a,!!n.encoding||n.labelAngle!==undefined)}return r}function Ute(e,t,n,r){var i=r.fieldDef(n);switch(e){case"scale":return r.scaleName(n);case"gridScale":return Mte(r,n);case"format":return R8(i,t.format,r.config);case"grid":{var a=r.getScaleComponent(n).get("type");return z8(t.grid,Ete(a,i))}case"labelFlush":return Ste(i,n,t);case"labelOverlap":{var a=r.getScaleComponent(n).get("type");return Cte(i,t,n,a)}case"orient":return z8(t.orient,Dte(n));case"tickCount":{var a=r.getScaleComponent(n).get("type");var u=n==="x"?"width":n==="y"?"height":undefined;var o=u?r.getSizeSignalRef(u):undefined;return z8(t.tickCount,jte(n,i,a,o))}case"title":var f=n==="x"?"x2":"y2";var c=r.fieldDef(f);var l=Bte(r,n);var s=l!==undefined?l:t.title===undefined?undefined:t.title;return z8(s,q8([Y2(i)],c?[Y2(c)]:[]));case"values":return Fte(t,r,i,n)}return a0(e)?t[e]:undefined}function qte(e,t,n){var r=R1(e)?q({},e):{type:e};var i=r.orient||F8("orient",r,n);r.orient=Yte(r.type,t,i);if(i!==undefined&&i!==r.orient){K1(n2.orientOverridden(r.orient,i))}var a=r.opacity!==undefined?r.opacity:F8("opacity",r,n);if(a===undefined){r.opacity=Hte(r.type,t)}var u=r.filled;if(u===undefined){r.filled=Gte(r,n)}var o=r.cursor||F8("cursor",r,n);if(o===undefined){r.cursor=Wte(r,t,n)}return r}function Wte(e,t,n){if(t.href||e.href||F8("href",e,n)){return"pointer"}return e.cursor}function Hte(e,t){if(bK([k1,A1,D1,j1],e)){if(!O3(t)){return.7}}return undefined}function Gte(e,t){var n=F8("filled",e,t);var r=e.type;return n!==undefined?n:r!==k1&&r!==w1&&r!==S1}function Yte(e,t,n){switch(e){case k1:case D1:case j1:case O1:case M1:return undefined}var r=t.y2;var i=t.x2;switch(e){case _1:if(r||i){if(n){return n}var a=t.x;if(!i&&Z2(a)&&a.type===L2&&!a.bin){return"horizontal"}var u=t.y;if(!r&&Z2(u)&&u.type===L2&&!u.bin){return"vertical"}}case S1:if(i&&r){return undefined}case x1:if(r){return"vertical"}else if(i){return"horizontal"}else if(e===S1){if(t.x&&!t.y){return"vertical"}else if(t.y&&!t.x){return"horizontal"}}case w1:case A1:var o=Z2(t.x)&&r3(t.x);var f=Z2(t.y)&&r3(t.y);if(o&&!f){return e!=="tick"?"horizontal":"vertical"}else if(!o&&f){return e!=="tick"?"vertical":"horizontal"}else if(o&&f){var a=t.x;var u=t.y;var c=a.type===I2;var l=u.type===I2;if(c&&!l){return e!=="tick"?"vertical":"horizontal"}else if(!c&&l){return e!=="tick"?"horizontal":"vertical"}if(!a.aggregate&&u.aggregate){return e!=="tick"?"vertical":"horizontal"}else if(a.aggregate&&!u.aggregate){return e!=="tick"?"horizontal":"vertical"}if(n){return n}return"vertical"}else{if(n){return n}return undefined}}return"vertical"}var $te={vgMark:"area",encodeEntry:function(e){return q({},v8(e,{size:"ignore",orient:"include"}),S8("x",e,"zeroOrMin"),S8("y",e,"zeroOrMin"),C8(e,"zeroOrMin",e.markDef.orient==="horizontal"?"x2":"y2"),b8(e))}};var Vte={vgMark:"rect",encodeEntry:function(e){return q({},v8(e,{size:"ignore",orient:"ignore"}),Xte(e),Zte(e))}};function Xte(e){var t=e.config,n=e.encoding,r=e.markDef,i=e.width;var a=r.orient;var u=n.size;var o=n.x;var f=n.x2;var c=e.scaleName(c0);var l=e.getScaleComponent(c0);if(a==="horizontal"||f){return q({},S8("x",e,"zeroOrMin"),C8(e,"zeroOrMin","x2"))}else{if(Z2(o)){var s=l.get("type");if(o.bin&&!u&&!v6(s)){return M8(o,"x",e.scaleName("x"),r.binSpacing===undefined?t.bar.binSpacing:r.binSpacing,l.get("reverse"))}else{if(s===t6.BAND){return A8(o,"x",e)}}}return E8("x",e,q({},s8(i)),Jte(r,c,l,t))}}function Zte(e){var t=e.config,n=e.encoding,r=e.height,i=e.markDef;var a=i.orient;var u=n.size;var o=n.y;var f=n.y2;var c=e.scaleName(l0);var l=e.getScaleComponent(l0);if(a==="vertical"||f){return q({},S8("y",e,"zeroOrMin"),C8(e,"zeroOrMin","y2"))}else{if(Z2(o)){var s=l.get("type");if(o.bin&&!u&&!v6(s)){return M8(o,"y",e.scaleName("y"),i.binSpacing===undefined?t.bar.binSpacing:i.binSpacing,l.get("reverse"))}else if(s===t6.BAND){return A8(o,"y",e)}}return E8("y",e,s8(r),Jte(i,c,l,t))}}function Jte(e,t,n,r){if(e.size!==undefined){return{value:e.size}}else if(r.bar.discreteBandSize){return{value:r.bar.discreteBandSize}}else if(n){var i=n.get("type");if(i===t6.POINT){var a=n.get("range");if(I5(a)&&Object(dn["D"])(a.step)){return{value:a.step-1}}K1(n2.BAR_WITH_POINT_SCALE_AND_RANGESTEP_NULL)}else if(i===t6.BAND){return o8(t)}else{return{value:r.bar.continuousBandSize}}}else if(r.scale.rangeStep&&r.scale.rangeStep!==null){return{value:r.scale.rangeStep-1}}return{value:20}}var Qte={vgMark:"shape",encodeEntry:function(e){return q({},v8(e,{size:"ignore",orient:"ignore"}))},postEncodingTransform:function(e){var t=e.encoding;var n=t.shape;var r=q({type:"geoshape",projection:e.projectionName()},n&&Z2(n)&&n.type===q2?{field:t3(n,{expr:"datum"})}:{});return[r]}};var Kte={vgMark:"line",encodeEntry:function(e){var t=e.width,n=e.height;return q({},v8(e,{size:"ignore",orient:"ignore"}),S8("x",e,s8(t)),S8("y",e,s8(n)),x8("size",e,{vgChannel:"strokeWidth"}),b8(e))}};var ene={vgMark:"trail",encodeEntry:function(e){var t=e.width,n=e.height;return q({},v8(e,{size:"include",orient:"ignore"}),S8("x",e,s8(t)),S8("y",e,s8(n)),x8("size",e),b8(e))}};function tne(e,t){var n=e.config,r=e.width,i=e.height;return q({},v8(e,{size:"include",orient:"ignore"}),S8("x",e,s8(r)),S8("y",e,s8(i)),x8("size",e),nne(e,n,t))}function nne(e,t,n){if(n){return{shape:{value:n}}}return x8("shape",e,{defaultValue:F8("shape",e.markDef,t)})}var rne={vgMark:"symbol",encodeEntry:function(e){return tne(e)}};var ine={vgMark:"symbol",encodeEntry:function(e){return tne(e,"circle")}};var ane={vgMark:"symbol",encodeEntry:function(e){return tne(e,"square")}};var une={vgMark:"rect",encodeEntry:function(e){return q({},v8(e,{size:"ignore",orient:"ignore"}),one(e),fne(e))}};function one(e){var t=e.encoding.x;var n=e.encoding.x2;var r=e.getScaleComponent(c0);var i=r?r.get("type"):undefined;if(Z2(t)&&t.bin&&!n){return M8(t,"x",e.scaleName("x"),0,r.get("reverse"))}else if(Z2(t)&&r&&v6(i)){if(i===t6.BAND){return A8(t,"x",e)}else{throw new Error(n2.scaleTypeNotWorkWithMark(M1,i))}}else{return q({},S8("x",e,"zeroOrMax"),C8(e,"zeroOrMin","x2"))}}function fne(e){var t=e.encoding.y;var n=e.encoding.y2;var r=e.getScaleComponent(l0);var i=r?r.get("type"):undefined;if(Z2(t)&&t.bin&&!n){return M8(t,"y",e.scaleName("y"),0,r.get("reverse"))}else if(Z2(t)&&r&&v6(i)){if(i===t6.BAND){return A8(t,"y",e)}else{throw new Error(n2.scaleTypeNotWorkWithMark(M1,i))}}else{return q({},S8("y",e,"zeroOrMax"),C8(e,"zeroOrMin","y2"))}}var cne={vgMark:"rule",encodeEntry:function(e){var t=e.config,n=e.markDef,r=e.width,i=e.height;var a=n.orient;if(!e.encoding.x&&!e.encoding.y&&!e.encoding.latitude&&!e.encoding.longitude){return{}}return q({},v8(e,{size:"ignore",orient:"ignore"}),S8("x",e,a==="horizontal"?"zeroOrMin":s8(r)),S8("y",e,a==="vertical"?"zeroOrMin":s8(i)),a!=="vertical"?C8(e,"zeroOrMax","x2"):{},a!=="horizontal"?C8(e,"zeroOrMax","y2"):{},x8("size",e,{vgChannel:"strokeWidth",defaultValue:n.size}))}};var lne={vgMark:"text",encodeEntry:function(e){var t=e.config,n=e.encoding,r=e.width,i=e.height,a=e.markDef;return q({},v8(e,{size:"ignore",orient:"ignore"}),S8("x",e,s8(r)),S8("y",e,s8(i)),k8(e),x8("size",e,q({},a.size?{defaultValue:a.size}:{},{vgChannel:"fontSize"})),m8("align",sne(e.markDef,n,t)))}};function sne(e,t,n){var r=e.align||F8("align",e,n);if(r===undefined){return"center"}return undefined}var dne={vgMark:"rect",encodeEntry:function(e){var t;var n=e.config,r=e.markDef,i=e.width,a=e.height;var u=r.orient;var o=u==="horizontal"?"width":"height";var f=u==="horizontal"?"height":"width";return q({},v8(e,{size:"ignore",orient:"ignore"}),S8("x",e,s8(i),"xc"),S8("y",e,s8(a),"yc"),x8("size",e,{defaultValue:hne(e),vgChannel:o}),(t={},t[f]={value:r.thickness||n.tick.thickness},t))}};function hne(e){var t=e.config,n=e.markDef;var r=n.orient;var i=e.getScaleComponent(r==="horizontal"?"x":"y");if(n.size!==undefined){return n.size}else if(t.tick.bandSize!==undefined){return t.tick.bandSize}else{var a=i?i.get("range"):undefined;var u=a&&I5(a)?a.step:t.scale.rangeStep;if(typeof u!=="number"){throw new Error("Function does not handle non-numeric rangeStep")}return u/1.5}}var pne={area:$te,bar:Vte,circle:ine,geoshape:Qte,line:Kte,point:rne,rect:une,rule:cne,square:ane,text:lne,tick:dne,trail:ene};function vne(e){if(bK([w1,x1,E1],e.mark)){return mne(e)}else{return bne(e)}}var gne="faceted_path_";function mne(e){var t=xne(e.mark,e.encoding);var n=bne(e,{fromPrefix:t.length>0?gne:""});if(t.length>0){return[{name:e.getName("pathgroup"),type:"group",from:{facet:{name:gne+e.requestDataName(P5),data:e.requestDataName(P5),groupby:t}},encode:{update:{width:{field:{group:"width"}},height:{field:{group:"height"}}}},marks:n}]}else{return n}}function yne(e){var t=e.encoding,n=e.stack,r=e.mark,i=e.markDef;var a=t.order;if(!Object(dn["z"])(a)&&Q2(a)){return undefined}else if((Object(dn["z"])(a)||Z2(a))&&!n){return U8(a,{expr:"datum"})}else if(T1(r)){var u=t[i.orient==="horizontal"?"y":"x"];if(Z2(u)){var o=u.sort;var f=e8(o)?t3({aggregate:O3(e.encoding)?o.op:undefined,field:o.field},{expr:"datum"}):t3(u,{binSuffix:e.stack&&e.stack.impute?"mid":undefined,expr:"datum"});return{field:f,order:"descending"}}return undefined}return undefined}function bne(e,t){if(t===void 0){t={fromPrefix:""}}var n=e.mark;var r=e.markDef.clip!==undefined?!!e.markDef.clip:_ne(e);var i=N8(e.markDef);var a=e.encoding.key;var u=yne(e);var o=pne[n].postEncodingTransform?pne[n].postEncodingTransform(e):null;return[q({name:e.getName("marks"),type:pne[n].vgMark},r?{clip:true}:{},i?{style:i}:{},a?{key:{field:a.field}}:{},u?{sort:u}:{},{from:{data:t.fromPrefix+e.requestDataName(P5)},encode:{update:pne[n].encodeEntry(e)}},o?{transform:o}:{})]}function xne(e,t){return NK(t).reduce(function(n,r){switch(r){case"x":case"y":case"order":case"tooltip":case"href":case"x2":case"y2":case"latitude":case"longitude":case"latitude2":case"longitude2":case"text":case"shape":return n;case"detail":case"key":var i=t[r];if(i){(Object(dn["z"])(i)?i:[i]).forEach(function(e){if(!e.aggregate){n.push(t3(e,{}))}})}return n;case"size":if(e==="trail"){return n}case"color":case"fill":case"stroke":case"opacity":var a=h3(t[r]);if(a&&!a.aggregate){n.push(t3(a,{}))}return n;default:throw new Error("Bug: Channel "+r+" unimplemented for line mark")}},[])}function _ne(e){var t=e.getScaleComponent("x");var n=e.getScaleComponent("y");return t&&t.get("domainRaw")||n&&n.get("domainRaw")?true:false}var wne=function(e){U(t,e);function t(t,n,r,i,a,u,o){if(i===void 0){i={}}var f=e.call(this,t,n,r,u,a,undefined)||this;f.fit=o;f.type="unit";f.specifiedScales={};f.specifiedAxes={};f.specifiedLegends={};f.specifiedProjection={};f.selection={};f.children=[];f.initSize(q({},i,t.width?{width:t.width}:{},t.height?{height:t.height}:{}));var c=R1(t.mark)?t.mark.type:t.mark;var l=f.encoding=A3(ute(t.encoding||{},a),c);f.markDef=qte(t.mark,l,u);f.stack=t5(c,l,f.config.stack);f.specifiedScales=f.initScales(c,l);f.specifiedAxes=f.initAxes(l);f.specifiedLegends=f.initLegend(l);f.specifiedProjection=t.projection;f.selection=t.selection;return f}Object.defineProperty(t.prototype,"hasProjection",{get:function(){var e=this.encoding;var t=this.mark===C1;var n=e&&N0.some(function(t){return Z2(e[t])});return t||n},enumerable:true,configurable:true});t.prototype.scaleDomain=function(e){var t=this.specifiedScales[e];return t?t.domain:undefined};t.prototype.axis=function(e){return this.specifiedAxes[e]};t.prototype.legend=function(e){return this.specifiedLegends[e]};t.prototype.initScales=function(e,t){return s1.reduce(function(e,n){var r;var i;var a=t[n];if(Z2(a)){r=a;i=a.scale}else if(V2(a)){r=a.condition;i=a.condition["scale"]}else if(n==="x"){r=h3(t.x2)}else if(n==="y"){r=h3(t.y2)}if(r){e[n]=i||{}}return e},{})};t.prototype.initAxes=function(e){return[c0,l0].reduce(function(t,n){var r=e[n];if(Z2(r)||n===c0&&Z2(e.x2)||n===l0&&Z2(e.y2)){var i=Z2(r)?r.axis:null;if(i!==null&&i!==false){t[n]=q({},i)}}return t},{})};t.prototype.initLegend=function(e){return c1.reduce(function(t,n){var r=e[n];if(r){var i=Z2(r)?r.legend:V2(r)?r.condition["legend"]:null;if(i!==null&&i!==false){t[n]=q({},i)}}return t},{})};t.prototype.parseData=function(){this.component.data=gte(this)};t.prototype.parseLayoutSize=function(){rte(this)};t.prototype.parseSelection=function(){this.component.selection=J9(this,this.selection)};t.prototype.parseMarkGroup=function(){this.component.mark=vne(this)};t.prototype.parseAxisAndHeader=function(){this.component.axes=Tte(this)};t.prototype.assembleSelectionTopLevelSignals=function(e){return K9(this,e)};t.prototype.assembleSelectionSignals=function(){return Q9(this,[])};t.prototype.assembleSelectionData=function(e){return eee(this,e)};t.prototype.assembleLayout=function(){return null};t.prototype.assembleLayoutSignals=function(){return o7(this)};t.prototype.assembleMarks=function(){var e=this.component.mark||[];if(!this.parent||!f9(this.parent)){e=tee(this,e)}return e.map(this.correctDataNames)};t.prototype.assembleLayoutSize=function(){return{width:this.getSizeSignalRef("width"),height:this.getSizeSignalRef("height")}};t.prototype.getMapping=function(){return this.encoding};t.prototype.toSpec=function(e,t){var n=zK(this.encoding);var r;r={mark:this.markDef,encoding:n};if(!e){r.config=zK(this.config)}if(!t){r.data=zK(this.data)}return r};Object.defineProperty(t.prototype,"mark",{get:function(){return this.markDef.type},enumerable:true,configurable:true});t.prototype.channelHasField=function(e){return k3(this.encoding,e)};t.prototype.fieldDef=function(e){var t=this.encoding[e];return h3(t)};return t}(l9);var kne=function(e){U(t,e);function t(n,r,i,a,u,o,f){var c=e.call(this,n,r,i,o,u,n.resolve)||this;c.type="layer";var l=q({},a,n.width?{width:n.width}:{},n.height?{height:n.height}:{});c.initSize(l);c.children=n.layer.map(function(e,n){if(i5(e)){return new t(e,c,c.getName("layer_"+n),l,u,o,f)}if(r5(e)){return new wne(e,c,c.getName("layer_"+n),l,u,o,f)}throw new Error(n2.INVALID_SPEC)});return c}t.prototype.parseData=function(){this.component.data=gte(this);for(var e=0,t=this.children;e<t.length;e++){var n=t[e];n.parseData()}};t.prototype.parseLayoutSize=function(){Qee(this)};t.prototype.parseSelection=function(){var e=this;this.component.selection={};var t=function(t){t.parseSelection();NK(t.component.selection).forEach(function(n){e.component.selection[n]=t.component.selection[n]})};for(var n=0,r=this.children;n<r.length;n++){var i=r[n];t(i)}};t.prototype.parseMarkGroup=function(){for(var e=0,t=this.children;e<t.length;e++){var n=t[e];n.parseMarkGroup()}};t.prototype.parseAxisAndHeader=function(){Rte(this)};t.prototype.assembleSelectionTopLevelSignals=function(e){return this.children.reduce(function(e,t){return t.assembleSelectionTopLevelSignals(e)},e)};t.prototype.assembleSelectionSignals=function(){return this.children.reduce(function(e,t){return e.concat(t.assembleSelectionSignals())},[])};t.prototype.assembleLayoutSignals=function(){return this.children.reduce(function(e,t){return e.concat(t.assembleLayoutSignals())},o7(this))};t.prototype.assembleSelectionData=function(e){return this.children.reduce(function(e,t){return t.assembleSelectionData(e)},e)};t.prototype.assembleTitle=function(){var t=e.prototype.assembleTitle.call(this);if(t){return t}for(var n=0,r=this.children;n<r.length;n++){var i=r[n];t=i.assembleTitle();if(t){return t}}return undefined};t.prototype.assembleLayout=function(){return null};t.prototype.assembleMarks=function(){return nee(this,OK(this.children.map(function(e){return e.assembleMarks()})))};t.prototype.assembleLegends=function(){return this.children.reduce(function(e,t){return e.concat(t.assembleLegends())},z7(this))};return t}(c9);var One=function(e){U(t,e);function t(t,n,r,i,a){var u=e.call(this,t,n,r,a,i,t.resolve)||this;u.type="repeat";if(t.resolve&&t.resolve.axis&&(t.resolve.axis.x==="shared"||t.resolve.axis.y==="shared")){K1(n2.REPEAT_CANNOT_SHARE_AXIS)}u.repeat=t.repeat;u.children=u._initChildren(t,u.repeat,i,a);return u}t.prototype._initChildren=function(e,t,n,r){var i=[];var a=t.row||[n?n.row:null];var u=t.column||[n?n.column:null];for(var o=0,f=a;o<f.length;o++){var c=f[o];for(var l=0,s=u;l<s.length;l++){var d=s[l];var h=(c?"_"+c:"")+(d?"_"+d:"");var p={row:c,column:d};i.push(Ane(e.spec,this,this.getName("child"+h),undefined,p,r,false))}}return i};t.prototype.parseLayoutSize=function(){Kee(this)};t.prototype.assembleDefaultLayout=function(){return{columns:this.repeat&&this.repeat.column?this.repeat.column.length:1,bounds:"full",align:"all"}};return t}(mte);function Ane(e,t,n,r,i,a,u){if(n5(e)){return new dte(e,t,n,i,a)}if(i5(e)){return new kne(e,t,n,r,i,a,u)}if(r5(e)){return new wne(e,t,n,r,i,a,u)}if(a5(e)){return new One(e,t,n,i,a)}if(u5(e)){return new yte(e,t,n,i,a)}throw new Error(n2.INVALID_SPEC)}function Ene(e,t){if(t===void 0){t={}}if(t.logger){J1(t.logger)}if(t.fieldTitle){c3(t.fieldTitle)}try{var n=H6(AK({},t.config,e.config));var r=c5(e,n);var i=j5(e.autosize,n.autosize,i5(r)||r5(r));var a=Ane(r,null,"",undefined,undefined,n,i.type==="fit");a.parse();h4(a.component.data);return Sne(a,Mne(e,n,i))}finally{if(t.logger){Q1()}if(t.fieldTitle){l3()}}}function Mne(e,t,n){return q({autosize:NK(n).length===1&&n.type?n.type:n},F5(t),F5(e))}function Sne(e,t){var n=e.config?V6(e.config):undefined;var r=[].concat(e.assembleSelectionData([]),Jee(e.component.data,t.datasets||{}));delete t.datasets;var i=e.assembleProjections();var a=e.assembleTitle();var u=e.assembleGroupStyle();var o=e.assembleLayoutSignals();o=o.filter(function(e){if((e.name==="width"||e.name==="height")&&e.value!==undefined){t[e.name]=+e.value;return false}return true});var f=q({$schema:"https://vega.github.io/schema/vega/v3.json"},e.description?{description:e.description}:{},t,a?{title:a}:{},u?{style:u}:{},{data:r},i.length>0?{projections:i}:{},e.assembleGroup(o.concat(e.assembleSelectionTopLevelSignals([]))),n?{config:n}:{});return{spec:f}}var Cne=n("r9P9");var Dne={text:["text"],line:["x","y"],trail:["x","y"],area:["x","y"]};var jne={bar:Object(dn["ab"])(["row","column","x","y","size","color","fill","stroke","detail"]),line:Object(dn["ab"])(["row","column","x","y","color","fill","stroke","color","detail"]),trail:Object(dn["ab"])(["row","column","x","y","color","fill","stroke","color","detail","size"]),area:Object(dn["ab"])(["row","column","x","y","color","fill","stroke","detail"]),tick:Object(dn["ab"])(["row","column","x","y","color","fill","stroke","detail"]),circle:Object(dn["ab"])(["row","column","x","y","color","fill","stroke","size","detail"]),square:Object(dn["ab"])(["row","column","x","y","color","fill","stroke","size","detail"]),point:Object(dn["ab"])(["row","column","x","y","color","fill","stroke","size","detail","shape"]),geoshape:Object(dn["ab"])(["row","column","color","fill","stroke","detail","shape"]),text:Object(dn["ab"])(["row","column","size","color","fill","stroke","text"])};function Nne(e,t,n){if(t===void 0){t=Dne}if(n===void 0){n=jne}var r=R1(e.mark)?e.mark.type:e.mark;var i=e.encoding;var a=t[r];var u=n[r];for(var o in a){if(!(a[o]in i)){return'Missing encoding channel "'+a[o]+'" for mark "'+r+'"'}}for(var f in i){if(!u[f]){return'Encoding channel "'+f+'" is not supported by mark type "'+r+'"'}}if(r===_1&&!i.x&&!i.y){return"Missing both x and y for bar"}return null}var Fne=n("qHvB");var Tne=Fne.version;var zne=n("gatG");var Rne=n.n(zne);const Pne="#4572a7";const Lne={background:"#fff",arc:{fill:Pne},area:{fill:Pne},line:{stroke:Pne,strokeWidth:2},path:{stroke:Pne},rect:{fill:Pne},shape:{stroke:Pne},symbol:{fill:Pne,strokeWidth:1.5,size:50},axis:{bandPosition:.5,grid:true,gridColor:"#000000",gridOpacity:1,gridWidth:.5,labelPadding:10,tickSize:5,tickWidth:.5},axisBand:{grid:false,tickExtra:true},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:50,symbolType:"square"},range:{category:["#4572a7","#aa4643","#8aa453","#71598e","#4598ae","#d98445","#94aace","#d09393","#b9cc98","#a99cbc"]}};var Bne=Lne;const Ine="#000";const Une={group:{fill:"#e5e5e5"},arc:{fill:Ine},area:{fill:Ine},line:{stroke:Ine},path:{stroke:Ine},rect:{fill:Ine},shape:{stroke:Ine},symbol:{fill:Ine,size:40},axis:{domain:false,grid:true,gridColor:"#FFFFFF",gridOpacity:1,labelColor:"#7F7F7F",labelPadding:4,tickColor:"#7F7F7F",tickSize:5.67,titleFontSize:16,titleFontWeight:"normal"},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:40},range:{category:["#000000","#7F7F7F","#1A1A1A","#999999","#333333","#B0B0B0","#4D4D4D","#C9C9C9","#666666","#DCDCDC"]}};var qne=Une;const Wne="#ab5787";const Hne="#979797";const Gne={background:"#f9f9f9",arc:{fill:Wne},area:{fill:Wne},line:{stroke:Wne},path:{stroke:Wne},rect:{fill:Wne},shape:{stroke:Wne},symbol:{fill:Wne,size:30},axis:{domainColor:Hne,domainWidth:.5,gridWidth:.2,labelColor:Hne,tickColor:Hne,tickWidth:.2,titleColor:Hne},axisBand:{grid:false},axisX:{grid:true,tickSize:10},axisY:{domain:false,grid:true,tickSize:0},legend:{labelFontSize:11,padding:1,symbolSize:30,symbolType:"square"},range:{category:["#ab5787","#51b2e5","#703c5c","#168dd9","#d190b6","#00609f","#d365ba","#154866","#666666","#c4c4c4"]}};var Yne=Gne;const $ne="#3e5c69";const Vne={background:"#fff",arc:{fill:$ne},area:{fill:$ne},line:{stroke:$ne},path:{stroke:$ne},rect:{fill:$ne},shape:{stroke:$ne},symbol:{fill:$ne},axis:{domainWidth:.5,grid:true,labelPadding:2,tickSize:5,tickWidth:.5,titleFontWeight:"normal"},axisBand:{grid:false},axisX:{gridWidth:.2},axisY:{gridDash:[3],gridWidth:.4},legend:{labelFontSize:11,padding:1,symbolType:"square"},range:{category:["#3e5c69","#6793a6","#182429","#0570b0","#3690c0","#74a9cf","#a6bddb","#e2ddf2"]}};var Xne=Vne;const Zne="#fff";const Jne="#888";const Qne={background:"#333",title:{color:Zne},style:{"guide-label":{fill:Zne},"guide-title":{fill:Zne}},axis:{domainColor:Zne,gridColor:Jne,tickColor:Zne}};var Kne=Qne;const ere="#30a2da";const tre="#cbcbcb";const nre="#999";const rre="#333";const ire="#f0f0f0";const are="#333";const ure={arc:{fill:ere},area:{fill:ere},axisBand:{grid:false},axisBottom:{domain:false,domainColor:are,domainWidth:3,grid:true,gridColor:tre,gridWidth:1,labelColor:nre,labelFontSize:10,labelPadding:4,tickColor:tre,tickSize:10,titleFontSize:14,titlePadding:10},axisLeft:{domainColor:tre,domainWidth:1,grid:true,gridColor:tre,gridWidth:1,labelColor:nre,labelFontSize:10,labelPadding:4,tickColor:tre,tickSize:10,ticks:true,titleFontSize:14,titlePadding:10},axisRight:{domainColor:are,domainWidth:1,grid:true,gridColor:tre,gridWidth:1,labelColor:nre,labelFontSize:10,labelPadding:4,tickColor:tre,tickSize:10,ticks:true,titleFontSize:14,titlePadding:10},axisTop:{domain:false,domainColor:are,domainWidth:3,grid:true,gridColor:tre,gridWidth:1,labelColor:nre,labelFontSize:10,labelPadding:4,tickColor:tre,tickSize:10,titleFontSize:14,titlePadding:10},background:ire,group:{fill:ire},legend:{labelColor:are,labelFontSize:11,padding:1,symbolSize:30,symbolType:"square",titleColor:are,titleFontSize:14,titlePadding:10},line:{stroke:ere,strokeWidth:2},path:{stroke:ere,strokeWidth:.5},rect:{fill:ere},range:{category:["#30a2da","#fc4f30","#e5ae38","#6d904f","#8b8b8b","#b96db8","#ff9e27","#56cc60","#52d2ca","#52689e","#545454","#9fe4f8"],diverging:["#cc0020","#e77866","#f6e7e1","#d6e8ed","#91bfd9","#1d78b5"],heatmap:["#d6e8ed","#cee0e5","#91bfd9","#549cc6","#1d78b5"]},symbol:{filled:true,shape:"circle"},shape:{stroke:ere},style:{bar:{binSpacing:2,fill:ere,stroke:null}},title:{anchor:"start",fontSize:24,fontWeight:600,offset:20}};var ore=ure;const fre=22;const cre="normal";const lre="Benton Gothic, sans";const sre=11.5;const dre="normal";const hre="#82c6df";const pre="#006d8f";const vre="#5789b8";const gre="#d94f54";const mre="Benton Gothic Bold, sans";const yre="normal";const bre=13;const xre={"category-6":["#ec8431","#829eb1","#c89d29","#3580b1","#adc839","#ab7fb4"],"fire-7":["#fbf2c7","#f9e39c","#f8d36e","#f4bb6a","#e68a4f","#d15a40","#ab4232"],"fireandice-6":["#e68a4f","#f4bb6a","#f9e39c","#dadfe2","#a6b7c6","#849eae"],"ice-7":["#edefee","#dadfe2","#c4ccd2","#a6b7c6","#849eae","#607785","#47525d"]};const _re={background:"#ffffff",title:{anchor:"start",font:mre,fontColor:"#000000",fontSize:fre,fontWeight:cre},arc:{fill:hre},area:{fill:hre},line:{stroke:hre,strokeWidth:2},path:{stroke:hre},rect:{fill:hre},shape:{stroke:hre},symbol:{fill:hre,size:30},axis:{labelFont:lre,labelFontSize:sre,labelFontWeight:dre,titleFont:mre,titleFontSize:bre,titleFontWeight:yre},axisX:{labelAngle:0,labelPadding:4,tickSize:3},axisY:{labelBaseline:"middle",maxExtent:45,minExtent:45,tickSize:2,titleAlign:"left",titleAngle:0,titleX:-45,titleY:-11},legend:{labelFont:lre,labelFontSize:sre,symbolType:"square",titleFont:mre,titleFontSize:bre,titleFontWeight:yre},range:{category:xre["category-6"],diverging:xre["fireandice-6"],heatmap:xre["fire-7"],ordinal:xre["fire-7"],ramp:xre["fire-7"]}};var wre=_re;var kre="#vg-tooltip-element {\n  visibility: hidden;\n  padding: 8px;\n  position: fixed;\n  z-index: 1000;\n  font-family: sans-serif;\n  font-size: 11px;\n  border-radius: 3px;\n  box-shadow: 2px 2px 4px rgba(0,0,0,0.1);\n\n  /* The default theme is the light theme. */\n  background-color: rgba(255, 255, 255, 0.95);\n  border: 1px solid #d9d9d9;\n  color: black;\n}\n#vg-tooltip-element.visible {\n  visibility: visible;\n}\n#vg-tooltip-element h2 {\n  margin-top: 0;\n  margin-bottom: 10px;\n  font-size: 13px;\n}\n#vg-tooltip-element table {\n  border-spacing: 0;\n}\n#vg-tooltip-element td {\n  overflow: hidden;\n  text-overflow: ellipsis;\n  padding-top: 2px;\n  padding-bottom: 2px;\n}\n#vg-tooltip-element td.key {\n  color: #808080;\n  max-width: 150px;\n  text-align: right;\n  padding-right: 4px;\n}\n#vg-tooltip-element td.value {\n  display: block;\n  max-width: 300px;\n  max-height: 7em;\n  text-align: left;\n}\n\n/* Dark and light color themes */\n#vg-tooltip-element.dark-theme {\n  background-color: rgba(32, 32, 32, 0.9);\n  border: 1px solid #f5f5f5;\n  color: white;\n}\n#vg-tooltip-element.dark-theme td.key {\n  color: #bfbfbf;\n}\n\n#vg-tooltip-element.light-theme {\n  background-color: rgba(255, 255, 255, 0.95);\n  border: 1px solid #d9d9d9;\n  color: black;\n}\n#vg-tooltip-element.light-theme td.key {\n  color: #808080;\n}";var Ore="vg-tooltip-element";var Are={offsetX:10,offsetY:10,id:Ore,styleId:"vega-tooltip-style",theme:"light",disableDefaultStyle:false,sanitize:Ere,maxDepth:2};function Ere(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;")}function Mre(e){if(!/^[A-Za-z]+[-:.\w]*$/.test(e)){throw new Error("Invalid HTML ID")}return kre.toString().replace(Ore,e)}function Sre(e,t,n){if(Object(dn["z"])(e)){return"["+e.map(function(e){return t(Object(dn["G"])(e)?e:Dre(e,n))}).join(", ")+"]"}if(Object(dn["E"])(e)){var r="";var i=e,a=i.title,u=W(i,["title"]);if(a){r+="<h2>"+t(a)+"</h2>"}var o=Object.keys(u);if(o.length>0){r+="<table>";for(var f=0,c=o;f<c.length;f++){var l=c[f];var s=u[l];if(Object(dn["E"])(s)){s=Dre(s,n)}r+='<tr><td class="key">'+t(l)+':</td><td class="value">'+t(s)+"</td></tr>"}r+="</table>"}return r||"{}"}return t(e)}function Cre(e){var t=[];return function(n,r){if(typeof r!=="object"||r===null){return r}var i=t.indexOf(this)+1;t.length=i;if(t.length>e){return"[Object]"}if(t.indexOf(r)>=0){return"[Circular]"}t.push(r);return r}}function Dre(e,t){return JSON.stringify(e,Cre(t))}function jre(e,t,n,r){var i=e.clientX+n;if(i+t.width>window.innerWidth){i=+e.clientX-n-t.width}var a=e.clientY+r;if(a+t.height>window.innerHeight){a=+e.clientY-r-t.height}return{x:i,y:a}}var Nre=function(){function e(e){this.options=q({},Are,e);var t=this.options.id;this.call=this.tooltip_handler.bind(this);if(!this.options.disableDefaultStyle&&!document.getElementById(this.options.styleId)){var n=document.createElement("style");n.setAttribute("id",this.options.styleId);n.innerHTML=Mre(t);if(document.head.childNodes.length>0){document.head.insertBefore(n,document.head.childNodes[0])}else{document.head.appendChild(n)}}this.el=document.getElementById(t);if(!this.el){this.el=document.createElement("div");this.el.setAttribute("id",t);this.el.classList.add("vg-tooltip");document.body.appendChild(this.el)}}e.prototype.tooltip_handler=function(e,t,n,r){if(r==null||r===""){this.el.classList.remove("visible",this.options.theme+"-theme");return}this.el.innerHTML=Sre(r,this.options.sanitize,this.options.maxDepth);this.el.classList.add("visible",this.options.theme+"-theme");var i=jre(t,this.el.getBoundingClientRect(),this.options.offsetX,this.options.offsetY),a=i.x,u=i.y;this.el.setAttribute("style","top: "+u+"px; left: "+a+"px")};return e}();var Fre=function(e,t){var n=new Nre(t);e.tooltip(n.call).run();return n};function Tre(e,t,n){var r=e.open(t);var i=1e4;var a=250;var u=~~(i/a);function o(t){if(t.source===r){u=0;e.removeEventListener("message",o,false)}}e.addEventListener("message",o,false);function f(){if(u<=0){return}r.postMessage(n,"*");setTimeout(f,a);u-=1}setTimeout(f,a)}var zre=".vega-embed {\n  position: relative;\n  display: inline-block;\n  padding-right: 38px;\n}\n\n.vega-embed .vega-actions-wrapper {\n  display: inline-flex;\n  position: absolute;\n  top: 0;\n  right: 0;\n  padding: 6px;\n  z-index: 1000;\n\n  opacity: 0.2;\n  background: white;\n  box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);\n  color: #1b1e23;\n  border: 1px solid #aaa;\n  border-radius: 999px;\n  transition: opacity 0.4s ease-in;\n}\n\n.vega-embed:hover .vega-actions-wrapper {\n  transition: opacity 0.2s ease;\n  opacity: 1;\n}\n\n.vega-embed .vega-actions {\n  position: absolute;\n  top: 0;\n  right: 0;\n  display: none;\n  flex-direction: column;\n\n  padding-bottom: 8px;\n  padding-top: 8px;\n  border-radius: 4px;\n  box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.2);\n  border: 1px solid #d9d9d9;\n  background: white;\n}\n\n.vega-embed .vega-actions-wrapper:hover {\n  background: transparent;\n  color: transparent;\n  border: none;\n  box-shadow: none;\n}\n\n.vega-embed .vega-actions-wrapper:hover .vega-actions {\n  display: flex;\n}\n\n.vega-embed .vega-actions a {\n  padding: 8px 16px;\n  font-family: sans-serif;\n  font-size: 14px;\n  font-weight: 600;\n  white-space: nowrap;\n  color: #434a56;\n  text-decoration: none;\n}\n\n.vega-embed .vega-actions a:hover {\n  background-color: #f7f7f9;\n  color: #1b1e23;\n}";function Rre(e){var t=[];for(var n=1;n<arguments.length;n++){t[n-1]=arguments[n]}for(var r=0,i=t;r<i.length;r++){var a=i[r];e=Pre(e,a)}return e}function Pre(e,t){if(typeof t!=="object"||t===null){return e}for(var n in t){if(!t.hasOwnProperty(n)){continue}if(t[n]===undefined){continue}if(typeof t[n]!=="object"||Object(dn["z"])(t[n])||t[n]===null){e[n]=t[n]}else if(typeof e[n]!=="object"||e[n]===null){e[n]=Rre(Object(dn["z"])(t[n].constructor)?[]:{},t[n])}else{Rre(e[n],t[n])}}return e}if(!String.prototype.startsWith){String.prototype.startsWith=function(e,t){return this.substr(!t||t<0?0:+t,e.length)===e}}function Lre(e){return e.startsWith("http://")||e.startsWith("https://")||e.startsWith("//")}n.d(t,"vega",function(){return Bre});n.d(t,"vl",function(){return Ire});n.d(t,"guessMode",function(){return Vre});n.d(t,"default",function(){return Zre});var Bre=p;var Ire=L;var Ure={vega:"Vega","vega-lite":"Vega-Lite"};var qre={vega:Bre.version,"vega-lite":Ire?Ire.version:"not available"};var Wre={vega:function(e,t){return e},"vega-lite":function(e,t){return Ire.compile(e,{config:t}).spec}};var Hre='\n<svg viewBox="0 0 16 16" fill="currentColor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round" width="14" height="14">\n  <circle r="2" cy="8" cx="2"></circle>\n  <circle r="2" cy="8" cx="8"></circle>\n  <circle r="2" cy="8" cx="14"></circle>\n</svg>';var Gre={COMPILED_ACTION:"View Vega",EDITOR_ACTION:"Open in Vega Editor",PNG_ACTION:"Save as PNG",SOURCE_ACTION:"View Source",SVG_ACTION:"Save as SVG"};function Yre(e){return typeof e==="function"}function $re(e,t,n,r){var i="<html><head>"+t+'</head><body><pre><code class="json">';var a="</code></pre>"+n+"</body></html>";var u=window.open("");u.document.write(i+e+a);u.document.title=Ure[r]+" JSON Source"}function Vre(e,t){if(e.$schema){var n=Rne()(e.$schema);if(t&&t!==n.library){console.warn("The given visualization spec is written in "+Ure[n.library]+", but mode argument sets "+Ure[t]+".")}var r=n.library;if(!Object(sn["satisfies"])(qre[r],"^"+n.version.slice(1))){console.warn("The input spec uses "+r+" "+n.version+", but the current version of "+Ure[r]+" is "+qre[r]+".")}return r}else{if("mark"in e||"encoding"in e||"layer"in e||"hconcat"in e||"vconcat"in e||"facet"in e||"repeat"in e){return"vega-lite"}if("marks"in e||"signals"in e||"scales"in e||"axes"in e){return"vega"}}return t||"vega"}function Xre(e){return!!(e&&"load"in e)}function Zre(e,t,n){if(n===void 0){n={}}return $(this,void 0,void 0,function(){var r,i,a,u,o,f,c,f,l,s,d,h,p,v,g,m,y,b,x,_,w,k,O,A;return V(this,function(E){switch(E.label){case 0:n=n||{};r=n.actions===true||n.actions===false?n.actions:Rre({},{export:{svg:true,png:true},source:true,compiled:false,editor:true},n.actions||{});i=q({},Gre,n.i18n);a=Xre(n.loader)?n.loader:Bre.loader(n.loader);u=n.renderer||"canvas";o=n.logLevel||Bre.Warn;if(!Bre.isString(t))return[3,2];return[4,a.load(t)];case 1:f=E.sent();return[2,Zre(e,JSON.parse(f),n)];case 2:c=n.config||{};if(!Bre.isString(c))return[3,4];return[4,a.load(c)];case 3:f=E.sent();return[2,Zre(e,t,q({},n,{config:JSON.parse(f)}))];case 4:if(n.defaultStyle){l="vega-embed-style";if(!document.getElementById(l)){s=document.createElement("style");s.id=l;s.innerText=n.defaultStyle===true?(zre||"").toString():n.defaultStyle;document.getElementsByTagName("head")[0].appendChild(s)}}if(n.theme){c=Rre({},B[n.theme],c)}d=Vre(t,n.mode);h=Wre[d](t,c);if(d==="vega-lite"){if(h.$schema){p=Rne()(h.$schema);if(!Object(sn["satisfies"])(qre.vega,"^"+p.version.slice(1))){console.warn("The compiled spec uses Vega "+p.version+", but current version is "+qre.vega+".")}}}v=Jt(e).classed("vega-embed",true).html("");if(n.onBeforeParse){h=n.onBeforeParse(h)}g=Bre.parse(h,d==="vega-lite"?{}:c);m=new Bre.View(g,{loader:a,logLevel:o,renderer:u}).initialize(e);if(n.tooltip!==false){y=void 0;if(Yre(n.tooltip)){y=n.tooltip}else{y=new Nre(n.tooltip===true?{}:n.tooltip).call}m.tooltip(y)}if(n.hover===undefined?d!=="vega-lite":n.hover){m.hover()}if(n){if(n.width){m.width(n.width)}if(n.height){m.height(n.height)}if(n.padding){m.padding(n.padding)}}if(!n.runAsync)return[3,6];return[4,m.runAsync()];case 5:E.sent();return[3,7];case 6:m.run();E.label=7;case 7:if(r!==false){b=v.append("div").attr("class","vega-actions-wrapper");if(n.defaultStyle===true){b.html(Hre)}x=b.insert("div").attr("class","vega-actions");if(r===true||r.export!==false){_=function(e){if(r===true||r.export===true||r.export[e]){var t=i[e.toUpperCase()+"_ACTION"];x.append("a").text(t).attr("href","#").attr("target","_blank").attr("download","visualization."+e).on("mousedown",function(){var t=this;m.toImageURL(e,n.scaleFactor).then(function(e){t.href=e}).catch(function(e){throw e});Tt.preventDefault()})}};for(w=0,k=["svg","png"];w<k.length;w++){O=k[w];_(O)}}if(r===true||r.source!==false){x.append("a").text(i.SOURCE_ACTION).attr("href","#").on("click",function(){$re(ln()(t),n.sourceHeader||"",n.sourceFooter||"",d);Tt.preventDefault()})}if(d==="vega-lite"&&(r===true||r.compiled!==false)){x.append("a").text(i.COMPILED_ACTION).attr("href","#").on("click",function(){$re(ln()(h),n.sourceHeader||"",n.sourceFooter||"","vega");Tt.preventDefault()})}if(r===true||r.editor!==false){A=n.editorUrl||"https://vega.github.io/editor/";x.append("a").text(i.EDITOR_ACTION).attr("href","#").on("click",function(){Tre(window,A,{config:c,mode:d,renderer:u,spec:ln()(t)});Tt.preventDefault()})}}return[2,{view:m,spec:t}]}})})}},gatG:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});function r(e){var t=/\/schema\/([\w-]+)\/([\w\.\-]+)\.json$/g;var n=t.exec(e).slice(1,3),r=n[0],i=n[1];return{library:r,version:i}}t.default=r},mw3f:function(e,t,n){"use strict";(function(e){var r=n("J29t");function i(t){return typeof e==="function"&&Object(r["C"])(e.isBuffer)?e.isBuffer(t):false}t["a"]=function(e,t){var n=t&&t.property?Object(r["t"])(t.property):r["w"];return Object(r["E"])(e)&&!i(e)?a(n(e)):n(JSON.parse(e))};function a(e,t){return t&&t.copy?JSON.parse(JSON.stringify(e)):e}}).call(this,n("tjlA").Buffer)},qHvB:function(e){e.exports={name:"vega-lite",author:'Jeffrey Heer, Dominik Moritz, Kanit "Ham" Wongsuphasawat',version:"2.6.0",collaborators:["Kanit Wongsuphasawat <kanitw@gmail.com> (http://kanitw.yellowpigz.com)","Dominik Moritz <domoritz@cs.washington.edu> (https://www.domoritz.de)","Jeffrey Heer <jheer@uw.edu> (http://jheer.org)"],homepage:"https://vega.github.io/vega-lite/",description:"Vega-Lite is a concise high-level language for interactive visualization.",main:"build/vega-lite.js",unpkg:"build/vega-lite.min.js",jsdelivr:"build/vega-lite.min.js",module:"build/src/index",types:"build/src/index.d.ts",bin:{vl2png:"./bin/vl2png",vl2svg:"./bin/vl2svg",vl2vg:"./bin/vl2vg"},directories:{test:"test"},scripts:{prebuild:"mkdir -p build/src",build:"npm run build:only","build:only":"tsc && rollup -c",postbuild:"uglifyjs build/vega-lite.js -cm --source-map content=build/vega-lite.js.map,filename=build/vega-lite.min.js.map -o build/vega-lite.min.js && npm run schema","build:examples":"npm run data && TZ=America/Los_Angeles scripts/build-examples.sh","build:examples-full":"TZ=America/Los_Angeles scripts/build-examples.sh 1","build:example":"TZ=America/Los_Angeles scripts/build-example.sh","build:toc":"bundle exec jekyll build -q && scripts/generate-toc","build:site":"tsc -p site && webpack --config site/webpack.config.js","build:versions":"scripts/update-version.sh","check:examples":"scripts/check-examples.sh","check:schema":"scripts/check-schema.sh",clean:"rm -rf build && rm -f examples/compiled/*.png && find site/examples ! -name 'index.md' -type f -delete",data:"rsync -r node_modules/vega-datasets/data/* data",deploy:"scripts/deploy.sh","deploy:gh":"scripts/deploy-gh.sh","deploy:schema":"scripts/deploy-schema.sh",preschema:"npm run prebuild",schema:"node --stack-size=1200 ./node_modules/.bin/ts-json-schema-generator --path tsconfig.json --type TopLevelSpec > build/vega-lite-schema.json && npm run renameschema && cp build/vega-lite-schema.json _data/",renameschema:"scripts/rename-schema.sh",presite:"npm run prebuild && npm run data && npm run build:site && npm run build:toc && npm run build:versions && scripts/create-example-pages",site:"bundle exec jekyll serve --incremental",lint:"tslint -p . -e 'package.json'",test:"jest test/ && npm run lint && npm run schema && jest examples/ && npm run test:runtime","test:inspect":"node --inspect-brk ./node_modules/.bin/jest --runInBand test","test:runtime":'TZ=America/Los_Angeles TS_NODE_COMPILER_OPTIONS=\'{"module":"commonjs"}\' wdio wdio.conf.js',"test:runtime:generate":"rm -Rf test-runtime/resources && VL_GENERATE_TESTS=true npm run test:runtime","watch:build":"npm run build:only && concurrently --kill-others -n Typescript,Rollup 'tsc -w' 'rollup -c -w'","watch:site":"concurrently --kill-others -n Typescript,Webpack 'tsc -p site --watch' 'webpack --config site/webpack.config.js --mode development --watch'","watch:test":"jest --watch"},repository:{type:"git",url:"https://github.com/vega/vega-lite.git"},license:"BSD-3-Clause",bugs:{url:"https://github.com/vega/vega-lite/issues"},devDependencies:{"@types/chai":"^4.1.4","@types/d3":"^5.0.0","@types/highlight.js":"^9.12.3","@types/jest":"^23.1.1","@types/mkdirp":"^0.5.2","@types/node":"^9.0.0","@types/webdriverio":"^4.10.2",ajv:"^6.5.1",chai:"^4.1.2",cheerio:"^1.0.0-rc.2",chromedriver:"^2.40.0",codecov:"^3.0.2",concurrently:"^3.6.0",d3:"^5.5.0","highlight.js":"^9.12.0",jest:"^23.1.0",mkdirp:"^0.5.1",rollup:"^0.59.4","rollup-plugin-commonjs":"^9.1.3","rollup-plugin-json":"^3.0.0","rollup-plugin-node-resolve":"^3.3.0","rollup-plugin-sourcemaps":"^0.4.2","source-map-support":"^0.5.6","svg2png-many":"^0.0.7","ts-jest":"^22.4.6","ts-json-schema-generator":"^0.28.0","ts-node":"^6.1.1",tslint:"5.10.0","tslint-eslint-rules":"^5.3.1",typescript:"^2.9.2","uglify-js":"^3.4.1",vega:"^4.0.0-rc.3","vega-datasets":"^1.19.0","vega-embed":"^3.16.0","vega-tooltip":"^0.11.0","wdio-chromedriver-service":"^0.1.3","wdio-dot-reporter":"0.0.9","wdio-mocha-framework":"^0.5.13","wdio-static-server-service":"^1.0.1",webdriverio:"^4.13.0",webpack:"^4.12.0","webpack-cli":"^3.0.8","yaml-front-matter":"^4.0.0"},dependencies:{"@types/json-stable-stringify":"^1.0.32","json-stable-stringify":"^1.0.1",tslib:"^1.9.2","vega-event-selector":"^2.0.0","vega-typings":"^0.3.17","vega-util":"^1.7.0",yargs:"^11.0.0"},jest:{transform:{"^.+\\.tsx?$":"ts-jest"},testRegex:"(/__tests__/.*|(\\.|/)(test|spec))\\.(jsx?|tsx?)$",moduleFileExtensions:["ts","tsx","js","jsx","json","node"],testPathIgnorePatterns:["node_modules","test-runtime","<rootDir>/build","_site","src"],coverageDirectory:"./coverage/",collectCoverage:false}}},r9P9:function(e,t){}}]);
//# sourceMappingURL=vendors~vega.70a9a6945c18f5c12a42.js.map